var G_ICON_FULL_SET="new save print undo redo copy cut paste text_paste find replace emoticon setting horizontal_line image_create image_editor image_property image_editor_property flash_create flash_property media_create media_property iframe_create iframe_property hyperlink_create hyperlink_property hyperlink_delete bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight table_group table_group_detail full_screen bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color align_group align_group_detail align_left align_center align_right align_full line_height indent outdent list_number list_bullets detail_list_number detail_list_bullets top_design top_source top_preview top_text design source preview text formatting font_family font_size about select_all insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom template grid tool_replace convert_table_to_text insert_link_media paste_word cell_border cell_bg_color table_indent table_outdent load_auto_save ruler pagebreak layout dirltr dirrtl insert_file file_open format_painter apply_format letter_spacing image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton input_same_width input_same_height input_same_width_height accessibility_validation table_copy table_paste intable_paste table_content_paste horizontal_sum vertical_sum horizontal_avg vertical_avg table_selection show_blocks table_lock cell_lock table_lock_property help tool_bar_grouping list_lower_alpha word_transform photo_editor photo_editor_property insert_file_property".split(" "),
G_FORMATTING=" h1 h2 h3 h4 h5".split(" "),DEXTTOP=parent;null!=DEXTTOP.DEXT5.config.DialogWindow&&(DEXTTOP=DEXTTOP.DEXT5.config.DialogWindow);try{DEXTTOP.IsCrossDomain=!1}catch(e$$4){alert("cross domain error")}setDEXTWINwindow();setDEXTDOCdocument();DEXTTOP.G_SELECTED_ELEMENT=null;DEXTTOP.G_CURREDITOR=null;DEXTTOP.G_COPIEDTABLE=null;DEXTTOP.G_COPIEDCELLDATA=null;DEXTTOP.G_SELECTED_IMAGE_ELEMENT=null;DEXTTOP.DEXT5=parent.DEXT5;parent.DEXTTOP=DEXTTOP;
var G_dext5plugIn=null,G_SUB_DIALOG=null,G_CURRENT_IFRAME=null,G_USE_EDITOR_ID=null,G_LAST_CMD=null,G_MAIN_ZINDEX=1E4,G_PutUndoCharCount=20,G_Progress_LoadTime=100,G_TIMEOUT_CNT=0,xmlHttpReqeust_Config,SIL=[],Z=[],___=DEXTTOP.DEXTWIN.location,_0_,_1_,_7_,G_BASE_COLOR_PICKER="#ff0000 #ff5e00 #ffbb00 #ffe400 #abf200 #1fda11 #00d8ff #0055ff #0900ff #6600ff #ff00dd #ff007f #000000 #ffffff #ffd8d8 #fae0d4 #faecc5 #faf4c0 #e4f7ba #cefbc9 #d4f4fa #d9e5ff #dad9ff #e8d9ff #ffd9fa #ffd9ec #f6f6f6 #eaeaea #ffa7a7 #ffc19e #ffe08c #faed7d #cef279 #b7f0b1 #b2ebf4 #b2ccff #b5b2ff #d1b2ff #ffb2f5 #ffb2d9 #d5d5d5 #bdbdbd #f15f5f #f29661 #f2cb61 #e5d85c #bce55c #86e57f #5cd1e5 #6699ff #6b66ff #a366ff #f261df #f261aa #a6a6a6 #8c8c8c #cc3d3d #cc723d #cca63d #c4b73b #9fc93c #47c83e #3db7cc #4174d9 #4641d9 #7e41d9 #d941c5 #d9418d #747474 #5d5d5d #980000 #993800 #997000 #998a00 #6b9900 #2f9d27 #008299 #003399 #050099 #3d0099 #990085 #99004c #4c4c4c #353535 #670000 #662500 #664b00 #665c00 #476600 #22741c #005766 #002266 #030066 #290066 #660058 #660033 #212121 #000000".split(" "),
_R_O_="c",R=[],T=[],K__="zu";function setDEXTWINwindow(){try{topURL=top.location.href,"undefined"==typeof topURL?(DEXTTOP.DEXTWIN=parent,DEXTTOP.IsCrossDomain=!0):(DEXTTOP.DEXTWIN=parent,DEXTTOP.IsCrossDomain=!1)}catch(a){DEXTTOP.DEXTWIN=parent,DEXTTOP.IsCrossDomain=!0}}
function setDEXTDOCdocument(){try{topURL=top.location.href,"undefined"==typeof topURL?(DEXTTOP.DEXTDOC=parent.document,DEXTTOP.IsCrossDomain=!0):(DEXTTOP.DEXTDOC=parent.document,DEXTTOP.IsCrossDomain=!1)}catch(a){DEXTTOP.DEXTDOC=parent.document,DEXTTOP.IsCrossDomain=!0}}SIL[0]="t";K__+="vw";
function DEXT5_EDITOR(a,c,b){this.ID=a;this.Frame=b;this.FrameStatus="";this.FrameID=b.FrameID;DEXTTOP.DEXT5.DEXTMULTIPLE[b.FrameID]=this;DEXTTOP.G_CURREDITOR=this;this._config=c;this._currentMode="design";this._BODY=this._DOC=null;this._EDITOR={};this._defaultHeight="";this._setting={};this._top_menu_click_flag=!1;this._top_menu_click_id="";this._docType={};this.UndoManager=new UndoManager;this.baseMenuToolbarHeight=0;this._PageProp={};this.remove_item=[];this.remove_context_item=[];this.____={};
this._LastRange=null;this._RangeBlurBug=!1;this._defaultWidth=this._defTableWidth=0;this._dextCustomData=[];this._dextframeHasFocus=this._dextCustomDataMode=!1;this.changeMultiValue={valueLength:0};this._FRAMEWIN=window;this._formatPainterList=null;this._contentsClass=["dext5_bookmark"];_R_O_+="/";_R_O_+="=";G_MAIN_ZINDEX=c.zIndex;this.setImageArr=[];this.getImageArr=[];this.sTextareaArr=[];this.applyEdgeMode=this.violationNode=this._editingCheckedValue=null;this._configXml=b.configXml;this.ShowBlocks=
"";this.lastElemForLock=this.dext_dragresize=null;this.Toolbar_group=[[],[]];this.detailSubCmd="list_decimal list_decimal_leading_zero list_lower_alpha list_lower_greek list_lower_roman list_upper_alpha list_upper_roman list_disc list_circle list_square".split(" ");this.initPaste=!0;this.imageForPhotoEditor=null;this.initSetSize=!0}K__+="CDE";
DEXT5_EDITOR.prototype={_Design2Source:function(){var a="table tbody tr td th ol ul li div".split(" ");"0"==this._config.sourceViewtype&&(a=[]);var c="";removeFakeLineHeight(this._BODY);if(this._BODY.hasChildNodes())for(var b=this._BODY.childNodes.length,d=0;d<b;d++){var e=this._BODY.childNodes[d];if(e)if(1===e.nodeType){var f=e.tagName.toLowerCase(),e=e.outerHTML;if("script"==f)e=e.replace(/<script([^>]+?)>[\s]+/gi,"<script$1>\r\n"),e=e.replace(/\;[\s]+/gi,";\r\n");else if("1"==this._config.sourceViewtype||
"2"==this._config.sourceViewtype)e=removeCRLFChar(e);c="table"==f||"ol"==f||"ul"==f?c+e:c+("\r\n"+e)}else{f=e.nodeValue;if("1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)f="#comment"!=e.nodeName?removeCRLFChar(f):"0"==this._config.removeComment?void 0!=e.data?"\x3c!--"+e.data+"--\x3e":void 0!=e.nodeValue?"\x3c!--"+e.nodeValue+"--\x3e":"":"";c+="\r\n"+f}else if(c=this._BODY.innerHTML,"1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)c=removeCRLFChar(c)}else if(c=
this._BODY.innerHTML,"1"==this._config.sourceViewtype||"2"==this._config.sourceViewtype)c=removeCRLFChar(c);c=CleanZeroChar(c);c=c.replace(/\t/g,"");b="";d=0;for(e=a.length;d<e;d++){var b=a[d],f=new RegExp("(<"+b+"[^>]*>)","gi"),g=new RegExp("</"+b+">","ig");"tbody"==b?(c=c.replace(f,function(a,b){return"\r\n\t"+b+"\r\n"}),c=c.replace(g,"\r\n\t</"+b+">")):"li"==b?c=c.replace(f,function(a,b){return"\r\n\t"+b}):"tr"==b?(c=c.replace(f,function(a,b){return"\r\n\t\t"+b+""}),c=c.replace(g,"\r\n\t\t</"+
b+">")):"td"==b||"th"==b?(c=c.replace(f,function(a,b){return"\r\n\t\t\t"+b+"\r\n\t\t\t\t"}),c=c.replace(g,"\r\n\t\t\t</"+b+">")):"table"==b||"ol"==b||"ul"==b?(c=c.replace(f,function(a,b){return"\r\n"+b+""}),c=c.replace(g,"\r\n</"+b+">\r\n")):c=c.replace(f,function(a,b){return"\r\n"+b+""})}c=changeRealTagToReplaceString(c);c=DEXTTOP.DEXT5.browser.ie&&9<=DEXTTOP.DEXT5.browser.ieVersion?c.replace(/\r?\n?\r?\n/g,"\r\n"):c.replace(/\r?\n?\r?\n/g,"\n");c=changeReplaceStringToRealTag(c);c=DEXTTOP.DEXT5.util.trim(c);
"1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64&&(c=DEXTTOP.DEXT5.util.ImageSrcConvert(c,!0,DEXTTOP.G_CURREDITOR.ID));"1"==DEXTTOP.G_CURREDITOR._config.xhtml_value&&(c=DEXTTOP.DEXT5.util.html2xhtml(c));this._EDITOR.source.value=c;a=this._EDITOR.source;a.focus();"setSelectionRange"in a?a.setSelectionRange(0,0):"createTextRange"in a&&a.createTextRange().moveStart("character",0)},_Design2Preview:function(){changeBodyImageProperty(!0);setHtmlToPreview();setFocusTopWindow()},_Design2Text:function(){var a=
this._BODY.innerHTML,a=a.replace(/\r/g,""),a=a.replace(/[\n|\t]/g,""),a=a.replace(/[\v|\f]/g,""),a=a.replace(/<p><br><\/p>/gi,"\n"),a=a.replace(/<P>&nbsp;<\/P>/gi,"\n"),a=a.replace(/<br(\s)*\/?>/gi,"\n"),a=a.replace(/<br(\s[^\/]*)?>/gi,"\n"),a=a.replace(/<\/p(\s[^\/]*)?>/gi,"\n"),a=a.replace(/<\/li(\s[^\/]*)?>/gi,"\n"),a=a.replace(/<\/tr(\s[^\/]*)?>/gi,"\n");nIdx=a.lastIndexOf("\n");-1<nIdx&&"\n"==a.substring(nIdx)&&(a=a.substring(0,nIdx));a=removeStripTags(a,null);a=unhtmlSpecialChars(a);this._EDITOR.text.value=
a;a=this._EDITOR.text;try{a.focus()}catch(c){}},getEditorMode:function(){return this._currentMode},setChangeMode:function(a){clearAllFormControlSelected();var c=this.getEditorMode();if(c!=a)if("1"!=this._config.formMode&&"0"!=this._config.userTableLock.use&&IsExistTableLock(this)&&(-1<a.indexOf("text")||-1<a.indexOf("source")))alert(dext5_lang.msg.notChangeMode);else{var b=!0;("top_text"==a||"text"==a)&&DEXTTOP.DEXT5.ShowTextChangeAlert&&(b=confirm(dext5_lang.msg.changeTextMode));if(b){null==this._EDITOR.preview&&
(b=document.getElementById("ue_editor_holder_"+this.ID),b=createEditorIframe(this._config,b,"dext5_preview_"+this.ID,dext5_lang.iframe_title.preview,this._docType[this._setting.doctype],this._setting.encoding,this._setting.lang,this._setting.xmlnsname,this._setting.font_family,this._setting.font_size,this._setting.line_height),b.style.width="0px",b.style.height="0px",DEXTTOP.DEXT5.browser.gecko||(b.style.display="none"),this._EDITOR.preview=document.getElementById("dext5_preview_"+this.ID));ClearDraggingTableCellSelected();
Mouse_Status=Mouse_IsPlain;g_findRepalceRange=ActiveCurrTable=DrageStartCell=null;this._iconSelected();for(var d=null,e=["top_design","top_source","top_preview","top_text"],b=0,f=e.length;b<f;b++)d=document.getElementById("ue_"+this.ID+e[b]),null!=d&&((0>a.indexOf("top_")?"top_"+a:a)==e[b]?d.className="on":d.className="");var g=null,e=null,d=["design","source","preview","text"];a=a.replace("top_","");b=0;for(f=d.length;b<f;b++)if(g=document.getElementById("ue_"+this.ID+d[b]),e=document.getElementById("dext5_"+
d[b]+"_"+this.ID),null!=g){if(a==d[b]){g.className=this._config.style.skinName;g.getElementsByTagName("A")[0].className="color_on";g.style.backgroundImage="url("+this._config.webPath.image+"skin/"+this._config.style.skinName+"/ue_btn_bg.gif)";if("source"==a||"text"==a){try{e.focus()}catch(h){}g=this._defaultHeight;DEXTTOP.DEXT5.browser.quirks?g-=5:DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(g-=3);e.style.height=g+"px";e.height=g+"px"}else e.style.height="100%";e.style.width="100%";
DEXTTOP.DEXT5.browser.gecko||(e.style.display="",e.style.overflow="");"design"==a&&(this._LastRange=null,setFocusToBody())}else g.className="",g.getElementsByTagName("A")[0].className="",g.style.backgroundImage="",e.style.width="0px",e.style.height="0px",DEXTTOP.DEXT5.browser.gecko||(e.style.display="none",e.style.overflow="hidden"),e.blur();e=document.getElementById("ue_diabled_div_"+this.ID);"BackCompat"==document.compatMode&&(e.style.height=document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).scrollHeight+
"px");document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="relative";e.style.width="design"==a?"0px":document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).scrollWidth+"px"}DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear();switch(c){case "design":setRemoveClass(["td","th"],["DEXT_dot"]);switch(a){case "source":ReplaceImageToRealObject();"1"==this._config.formMode&&ReplaceCustomDataToRealEvent();this._Design2Source();break;case "preview":ReplaceImageToRealObject();
"1"==this._config.formMode&&ReplaceCustomDataToRealEvent();this._Design2Preview();break;case "text":this._Design2Text()}break;case "source":_value=this._EDITOR.source.value;_value=_value.replace(/\t/g,"");_value=removeCRLFChar(_value);"1"!=DEXTTOP.G_CURREDITOR._config.plugInUse&&(_value=DEXTTOP.DEXT5.util.removeLocalFileImage(_value));"1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64&&(_value=DEXTTOP.DEXT5.util.ImageSrcConvert(_value,!1,DEXTTOP.G_CURREDITOR.ID));DEXTTOP.DEXT5.setBodyValue(_value,
"",!0,!0,!0);c=this.Frame;showRuler(c.editor);switch(a){case "design":"1"==this._config.formMode?(ReplaceRealEventToCustomData(),ReplaceRealObjectToImage(!1)):ReplaceRealObjectToImage();setAddClass(["td","th"],["DEXT_dot"]);break;case "preview":ReplaceImageToRealObject();"1"==this._config.formMode&&ReplaceCustomDataToRealEvent();setRemoveClass(["td","th"],["DEXT_dot"]);this._Design2Preview();break;case "text":this._Design2Text()}break;case "preview":c=this.Frame;showRuler(c.editor);ClearPreViewContent(c.editor);
switch(a){case "design":FixFlashError();"1"==this._config.formMode?(ReplaceRealEventToCustomData(),ReplaceRealObjectToImage(!1)):ReplaceRealObjectToImage();setAddClass(["td","th"],["DEXT_dot"]);break;case "source":this._Design2Source();break;case "text":this._Design2Text()}break;case "text":switch(_value=this._EDITOR.text.value,_value=htmlSpecialChars(_value),_value=addLineBreaker(this._config.enterTag,_value),DEXTTOP.DEXT5.setBodyValue(_value,"",!0,!0,!0),c=this.Frame,showRuler(c.editor),a){case "source":this._Design2Source();
break;case "preview":this._Design2Preview()}}this._currentMode=a;-1<a.indexOf("design")&&setFocusFirstChildForStyle(DEXTTOP.G_CURREDITOR._BODY)}}},start:function(){this._setEditorIcon(this._configXml)},_setEditorIcon:function(a){var c=this,b=this._config.style.skinName,d=this._config.webPath.image+"skin/"+b,e=DEXTTOP.DEXT5.util.xml.getNode(a,"top_menu"),f=DEXTTOP.DEXT5.util.xml.getNode(a,"tool_bar_1"),g=DEXTTOP.DEXT5.util.xml.getNode(a,"tool_bar_2"),h=DEXTTOP.DEXT5.util.xml.getNode(a,"tool_bar_admin");
DEXTTOP.DEXT5.util.xml.getNode(a,"font_size");DEXTTOP.DEXT5.util.xml.getNode(a,"letter_spacing");DEXTTOP.DEXT5.util.xml.getNode(a,"formatting");var m=DEXTTOP.DEXT5.util.xml.getNode(a,"status_bar");""!=DEXTTOP.DEXT5.config.StatusBarInitMode?this._config.statusBarInitMode=DEXTTOP.DEXT5.config.StatusBarInitMode:m&&m.getAttribute("init_mode")&&""!=m.getAttribute("init_mode")&&(this._config.statusBarInitMode=m.getAttribute("init_mode"));var n=DEXTTOP.DEXT5.util.xml.getNode(a,"setting"),p=DEXTTOP.DEXT5.util.xml.getNode(a,
"license");DEXTTOP.DEXT5.util.xml.getNode(a,"font_family");this.____.p=DEXTTOP.DEXT5.util.xml.getNodeValue(p,R[28]+R[21]+R[18]+R[11]+"u"+R[17]+R[14]+"_k"+R[12]+"y");_7_=DEXTTOP.DEXT5.util.xml.getNodeValue(p,"l"+T[10]+R[17]+R[12]+T[11]+T[4]+"_"+T[5]+"e"+T[7]);this.____.l=_L__.DE(_7_);try{this.____.l=this.____.l.split("|"),_0_=this.____.l,_1_=this.____.p}catch(q){}this._dextSetting(n);if(""!=DEXTTOP.DEXT5.config.RemoveItem)this.remove_item=DEXTTOP.DEXT5.config.RemoveItem.split(",");else for(var p=DEXTTOP.DEXT5.util.xml.getNode(a,
"remove_item"),u=DEXTTOP.DEXT5.util.xml.count(p,"item"),n=0;n<u;n++)this.remove_item[n]=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(p,"item",n);(0==DEXTTOP.DEXT5.browser.ie||11<DEXTTOP.DEXT5.browser.ieVersion)&&this.remove_item.push("table_selection");this.remove_item.push("grid");if(""!=DEXTTOP.DEXT5.config.RemoveContextItem)this.remove_context_item=DEXTTOP.DEXT5.config.RemoveContextItem.split(",");else if(a=DEXTTOP.DEXT5.util.xml.getNode(a,"remove_context_item"),void 0!=a)for(p=DEXTTOP.DEXT5.util.xml.count(a,
"item"),n=0;n<p;n++)this.remove_context_item[n]=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,"item",n);(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)&&this.remove_item.push("full_screen");DEXTTOP.DEXTWIN!=top&&"1"!=DEXTTOP.G_CURREDITOR._config.frameFullScreen&&this.remove_item.push("full_screen");if(""!=DEXTTOP.G_CURREDITOR._config.xss_remove_tags){n=DEXTTOP.G_CURREDITOR._config.xss_remove_tags.toLowerCase();a=0;-1<n.indexOf("iframe")&&(this.remove_item.push("iframe_create"),this.remove_item.push("insert_link_media"),
a+=1);if(-1<n.indexOf("object")||-1<n.indexOf("embed"))this.remove_item.push("media_create"),this.remove_item.push("flash_create"),this.remove_item.push("insert_link_media"),a+=1;2<=a&&this.remove_item.push("entity")}"0"==this._setting.auto_save&&this.remove_item.push("load_auto_save");0==this._config.ruler.use&&this.remove_item.push("ruler");if(""!=this._config.custom_code&&(a=DEXTTOP.DEXT5.util.CustomSetting("remove_item",this._config.custom_code),"undefined"!==typeof a))for(p=a.length,n=0;n<p;n++)this.remove_item.push(a[n]);
"1"==this._config.plugInUse&&"1"==this._config.imageEditorUse&&0!=DEXTTOP.DEXT5.browser.ie||this.remove_item.push("image_editor");("ieplugin"==this._config.runtimes||DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion)&&this.remove_item.push("photo_editor");"1"!=this._config.formMode&&(this.remove_item.push("table_lock"),this.remove_item.push("cell_lock"),this.remove_item.push("table_lock_property"));"1"!=this._config.plugInUse&&this.remove_item.push("word_transform");var t="";a="";p=isViewMode(this);
a+='<div id="ue_editor_main_'+this.ID+'" class="DEXT_fiVe_EdiTor" style="z-index:'+G_MAIN_ZINDEX+'; width:100%; "  oncontextmenu="return false">';n=DEXTTOP.DEXT5.util.xml.count(m,"status");0==n&&(this._config.status_bar="1");u="";u="1"==this._config.top_status_bar||p?u+"height:1px;":u+"height:28px;";if("1"==this._config.top_status_bar||p)u+="display:none;";""!=u&&(u=" style='"+u+"'");a+="<div id='dext_topstatusbar_"+this.ID+"' class='ue_as DEXT_fiVe_EdiTor_TopStatusBar_"+b+"'"+u+">";a+="    <ul class='"+
b+"'>";if(""!=this._config.statusBarItem)for(u=this._config.statusBarItem.split(","),t=u.length-1;0<=t;t--){var v=u[t],w="";this.getEditorMode()==v.replace("top_","")&&(w='class="on"');a+=" <li "+w+' id="ue_'+this.ID+"top_"+v+'"><a href="javascript:void(0);">DEXT_Top_Status</a></li>'}else for(t=n-1;0<=t;t--)v=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(m,"status",t),v=DEXTTOP.DEXT5.util.trim(v).toLowerCase(),w="",this.getEditorMode()==v.replace("top_","")&&(w='class="on"'),a+=" <li "+w+' id="ue_'+this.ID+
"top_"+v+'"><a href="javascript:void(0);">DEXT_Top_Status</a></li>';a+="    </ul></div>";a+='<div onselectstart="return false;" id="ue_toolbar_'+this.ID+'" style="width:100%" class="ue_as">';t=this._makeEditorTopMenu(e);a+=t;u="0"==this._config.editorborder?"_xxx":"";t="";DEXTTOP.DEXT5.browser.ie&&(7>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)&&(t="margin-bottom:-2px;");a="3"==this._config.tool_bar||isViewMode(this)?a+('\t\t<table id="dext_toolbar_'+this.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table" style="display:none; '+
t+'">'):a+('\t\t<table id="dext_toolbar_'+this.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table" style="'+t+'">');a+="\t\t\t<tr>";t="";"1"==this._config.top_menu&&"0"==this._config.top_status_bar&&(t="border-top-width:0px;");a+='\t\t\t\t<td class="ue_tg_'+b+u+'" style="background-image:url('+d+"/ue_tbg.gif);"+t+'">';a+='\t\t\t\t\t<table id="table_gecko_'+this.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table01" ';a+=">";t=DEXTTOP.DEXT5.util.xml.count(f,"tool");v=DEXTTOP.DEXT5.util.xml.count(g,
"tool");0==t&&0==v?this._config.tool_bar="3":0==t?this._config.tool_bar="1":0==v&&(this._config.tool_bar="2");t=this._makeEditorIcon(f,"1");a+=t;t=this._makeEditorIcon(g,"2");a+=t;t=this._makeEditorFormBar(h);a+=t;"1"==this._config.ruler.use&&(a+="<tr>",a+='<td class="ue_tdb_'+b+'01" id="dext_tab_tool3_'+this.ID+'" style="border:0px; padding:0px; height:18px; background-image:url(../images/bg/ruler.gif); background-repeat:no-repeat; display:none;">',a+='<img id="dext_ruler_point_'+this.ID+'" src="../images/bg/point.gif" alt="" style="vertical-align:top; border:0px; width:14px; height:9px; margin:0 0 0 -7; display:none;" />',
a+="</td>",a+="</tr>");a+="\t\t\t\t\t</table>";a+="\t\t\t\t</td>";a+="\t\t\t</tr>";a+="\t\t</table>";a+='\t<div id="ue_diabled_div_'+this.ID+'" style="background-color:#ffffff; filter:alpha(opacity=50); opacity:0.50; position:absolute; z-index:'+(G_MAIN_ZINDEX+1E3)+'; left:0px; top:0px; width:0px; height:100%;"></div>';"1"==this._config.tool_bar_grouping&&(a+='<div class="tool_bar_grouping_box" id="dext_div_tool_bar_grouping_box1" style="display:none; z-index:'+(G_MAIN_ZINDEX+900)+';">',a+='<div class="tool_bar_grouping_list tool_bar_grouping_list_'+
this._config.style.skinName+'" id="dext_tool_bar_grouping_list1">',a+='<ul id="ul_tool_bar_grouping_list1">',a+="</ul>",a+="</div>",a+="</div>",a+='<div class="tool_bar_grouping_box" id="dext_div_tool_bar_grouping_box2" style="display:none; z-index:'+(G_MAIN_ZINDEX+900)+';">',a+='<div class="tool_bar_grouping_list tool_bar_grouping_list_'+this._config.style.skinName+'" id="dext_tool_bar_grouping_list2">',a+='<ul id="ul_tool_bar_grouping_list2">',a+="</ul>",a+="</div>",a+="</div>");a+="</div>";"1"==
this._config.ruler.use&&(a+='<div id="dext_ruler_pointline_'+this.ID+'" style="position:absolute; z-index: 9999; border-left:dotted 1px rgb(255, 0, 0); display:none;"></div>');this._defaultHeight=this._config.style.height.replace("px","")+"";a+='\t<div id="ue_editor_holder_'+this.ID+'" class="ue_editor_'+b+"_lr"+u+'" ';if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)a+=' style="overflow:scroll; -webkit-overflow-scrolling:touch;"';a+="\t></div>";u="0"==this._config.editorborder?"_xxx":"";
a+='\t<div id="status_'+this.ID+'" class="ue_as" style="width:100%;">';a="1"==this._config.status_bar||p||0==n?a+('\t\t<table id="dext_statusbar_'+this.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table_'+b+u+'" style="background-image:url('+d+"/ue_gbg.gif); display:none; "):a+('\t\t<table id="dext_statusbar_'+this.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table_'+b+u+'" style="background-image:url('+d+"/ue_gbg.gif); ");a+='">';a+='\t\t    <tr id="status_tr_'+this.ID+
'" ';a+=">";a+="\t\t\t\t<td>";a+='\t\t\t\t\t<ul class="ue_btn_'+b+'" id="dext_tab_status_'+this.ID+'">';if(0==n)a+=' <li class="" id="ue_'+this.ID+'design" style="visibility:hidden;"><a href="javascript:void(0);">DEXT_Status</a></li>';else if(""!=this._config.statusBarItem)for(u=this._config.statusBarItem.split(","),t=0;t<u.length;t++)v=u[t],v=DEXTTOP.DEXT5.util.trim(v).toLowerCase(),a+=' <li class="" id="ue_'+this.ID+v+'"><a href="javascript:void(0);">DEXT_Status</a></li>';else for(t=0;t<n;t++)v=
DEXTTOP.DEXT5.util.xml.getNodeValueIdx(m,"status",t),v=DEXTTOP.DEXT5.util.trim(v).toLowerCase(),a+=' <li class="" id="ue_'+this.ID+v+'"><a href="javascript:void(0);">DEXT_Status</a></li>';a+="\t\t\t\t\t</ul>";a+="\t\t\t\t</td>";a+="\t\t\t</tr>";a+="\t\t</table>";a+="\t</div>";a+="</div>";document.getElementsByTagName("div")[0].innerHTML=a;b=document.getElementById("ue_editor_holder_"+this.ID);createEditorIframe(this._config,b,"dext5_design_"+this.ID,dext5_lang.iframe_title.design,this._docType[this._setting.doctype],
this._setting.encoding,this._setting.lang,this._setting.xmlnsname,this._setting.font_family,this._setting.font_size,this._setting.line_height);f=document.createElement("textarea");f.id="dext5_source_"+this.ID;f.title=dext5_lang.iframe_title.source;f.style.color="#111111";f.style.width="0px";f.style.height="0px";DEXTTOP.DEXT5.browser.gecko||(f.style.display="none");f.style.borderWidth="0px";f.style.margin="0px 0px";f.style.padding="0px";f.style.fontFamily=this._setting.font_family;f.style.fontSize=
this._setting.font_size;"1"==this._config.sourceViewtype&&("wrap"in f?f.wrap="off":"wordWrap"in f.style&&(f.style.wordWrap="normal"));b.appendChild(f);f=document.createElement("textarea");f.id="dext5_text_"+this.ID;f.title=dext5_lang.iframe_title.text;f.style.color="#111111";f.style.width="0px";f.style.height="0px";DEXTTOP.DEXT5.browser.gecko||(f.style.display="none");f.style.borderWidth="0px";f.style.margin="0px 0px";f.style.padding="0px";f.style.fontFamily=this._setting.font_family;f.style.fontSize=
this._setting.font_size;b.appendChild(f);if(b=document.getElementById("ue_"+this.ID+"design"))b.className=this._config.style.skinName,b.getElementsByTagName("A")[0].className="color_on",b.style.backgroundImage="url("+this._config.webPath.image+"skin/"+this._config.style.skinName+"/ue_btn_bg.gif)";setEditorHeight(this,!0);document.getElementById("ue_editor_holder_"+this.ID).style.height=0>this._defaultHeight?"0px":this._defaultHeight+"px";document.getElementById("dext_background")||(b=document.createElement("div"),
b.setAttribute("id","dext_background"),b.style.zIndex=G_MAIN_ZINDEX+1E3,document.getElementsByTagName("body")[0].appendChild(b));document.getElementById("dext_click_background")||(b=document.createElement("div"),b.setAttribute("id","dext_click_background"),b.style.zIndex=G_MAIN_ZINDEX+1E3,document.body.appendChild(b),DEXTTOP.DEXT5.util.addEvent(b,"click",function(){DEXT5_EDITOR.prototype.dialog._click_background()}),b.onmousedown=function(){return!1},b.unselectable="on");this._dextFormatting.init(c.ID);
this._dextLineHeight.init(c.ID);if(b=document.getElementById("ue_"+this.ID+"design"))b.style.backgroundImage="url("+d+"/ue_btn_bg.gif)";this._setTopMenuEvents(e);this._setIconEvents();this._iconEnable("default");setTimeout(_fn_0,2E3);"1"==this._config.resize_bar&&0<n&&DEXTTOP.DEXTWIN==top&&!DEXTTOP.DEXT5.browser.mobile&&!DEXTTOP.DEXT5.browser.iOS&&this._setEditorResizeBar();if("1"==this._config.tool_bar_grouping){groupingIcon();d=document.getElementById("dext_span_"+this.ID+"tool_bar_grouping1");
d.style.height="27px";var x=document.getElementById("dext_div_tool_bar_grouping_box1"),e=function(){return function(a){DEXTTOP.G_CURREDITOR=c;"block"==y.style.display&&hideGroupingBox();"block"==x.style.display?hideGroupingBox():(x.style.display="block",showGroupingBackground(),setPositionGroupingDiv(1))}}();DEXTTOP.DEXT5.util.addEvent(d,"click",e);d=document.getElementById("dext_span_"+this.ID+"tool_bar_grouping2");d.style.height="28px";10>DEXTTOP.DEXT5.browser.ieVersion&&(7==DEXTTOP.DEXT5.browser.ieVersion&&
(d.style.height="27px"),d.style.marginTop="-2px");var y=document.getElementById("dext_div_tool_bar_grouping_box2"),e=function(){return function(a){DEXTTOP.G_CURREDITOR=c;"block"==x.style.display&&hideGroupingBox();"block"==y.style.display?hideGroupingBox():(y.style.display="block",showGroupingBackground(),setPositionGroupingDiv(2))}}();DEXTTOP.DEXT5.util.addEvent(d,"click",e)}},_setLazyLoadFrame:function(a){"1"!=DEXTTOP.G_CURREDITOR._config.contextMenuDisable&&DEXT5_CONTEXT._create(a);"0"==DEXTTOP.G_CURREDITOR._config.top_menu&&
DEXT5_TOPMENU._create(a)},_setEditorResizeBar:function(){var a=new DextResize(DEXTTOP.G_CURREDITOR);a.createStatusResizeBar();a.apply(DEXTTOP.DEXTDOC)},_dextSetting:function(a){this._setting.grid_color=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"grid_color");this._setting.grid_color_nm=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"grid_color_nm");this._setting.grid_spans=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"grid_spans");this._setting.grid_form=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"grid_form");this._setting.encoding=
DEXTTOP.DEXT5.util.xml.getNodeValue(a,"encoding");this._PageProp.encoding=this._setting.encoding;var c="",c=""!=DEXTTOP.DEXT5.config.DocType?DEXTTOP.DEXT5.config.DocType:DEXTTOP.DEXT5.util.xml.getNodeValue(a,"doctype");this._setting.doctype=this._setting_DocType(c);this._PageProp.doctype=this._setting.doctype;this._setting.xmlnsname=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"xmlnsname");this._PageProp.xmlnsname=this._setting.xmlnsname;this._setting.lang=DEXTTOP.G_CURREDITOR._config.lang;if((this._PageProp.lang=
this._setting.lang)&&0<this._setting.lang.length){var c=document.getElementsByTagName("html")[0],b=this._setting.lang;-1<b.indexOf("-")&&(b=b.split("-")[0]);c.setAttribute("lang",b);c.setAttribute("xml:lang",b);0<this._setting.xmlnsname.length&&c.setAttribute("xmlns",this._setting.xmlnsname)}this._setting.font_family=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"font_family");this._setting.font_size=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"font_size");""!=DEXTTOP.DEXT5.config.userFontFamily&&("\ub9d1\uc740\uace0\ub515"==
DEXTTOP.DEXT5.config.userFontFamily&&(DEXTTOP.DEXT5.config.userFontFamily="\ub9d1\uc740 \uace0\ub515"),this._setting.font_family=DEXTTOP.DEXT5.config.userFontFamily);""!=DEXTTOP.DEXT5.config.userFontSize&&(this._setting.font_size=DEXTTOP.DEXT5.config.userFontSize+"pt");this._setting.line_height=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"line_height");this._setting.show_font_real=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"show_font_real");""==this._setting.show_font_real&&(this._setting.show_font_real="0");
"CCODE_001"==this._config.custom_code&&(this._setting.show_font_real="1");this._setting.enter_tag=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"enter_tag");this._setting.shift_enter_tag=DEXTTOP.DEXT5.util.xml.getNodeValue(a,"shift_enter_tag");a=getAutoSave(DEXTTOP.G_CURREDITOR);"0"!=a&&("1"==DEXTTOP.G_CURREDITOR._config.setAutoSave.mode?a="1,"+DEXTTOP.G_CURREDITOR._config.setAutoSave.interval:"0"==DEXTTOP.G_CURREDITOR._config.setAutoSave.mode&&(a="2"));this._setting.auto_save=a;this._setting.auto_save_fn=
null;this._setting.ruler_position=DEXTTOP.G_CURREDITOR._config.ruler.rulerInitPosition;this._docType.None="";this._docType["XHTML 1.1"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">';this._docType["XHTML 1.0 Transitional"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">';this._docType["XHTML 1.0 Strict"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">';
this._docType["XHTML 1.0 Frameset"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">';this._docType["HTML 5"]="<!DOCTYPE html>";this._docType["HTML 4.01 Transitional"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">';this._docType["HTML 4.01 Strict"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">';this._docType["HTML 4.01 Frameset"]=
'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">';this._docType["HTML 3.2"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">';this._docType["HTML 2.0"]='<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">'},_setting_DocType:function(a){for(var c="HTML 5",b="None;XHTML 1.1;XHTML 1.0 Transitional;XHTML 1.0 Strict;XHTML 1.0 Frameset;HTML 5;HTML 4.01 Transitional;HTML 4.01 Strict;HTML 4.01 Frameset;HTML 3.2;HTML 2.0".split(";"),d=b.length,e=0;e<
d;e++)if(a==b[e]){c=a;break}return c},_makeEditorTopMenu:function(a){var c=this._config.style.skinName,b="",d=DEXTTOP.DEXT5.util.xml.count(a,"menu");0==d&&(this._config.top_menu="1");var e="";borderLeftRight="";if("0"==this._config.top_status_bar||"0"==this._config.editorborder)e="border-top-width:0px;";"0"==this._config.editorborder&&(borderLeftRight="border-left-width:0px;border-right-width:0px;");var f="";""!=e+borderLeftRight&&(f=" style='"+e+borderLeftRight+"'");b="1"==this._config.top_menu||
isViewMode(this)?b+('<table style="display:none; height:0px;" border="0" cellpadding="0" cellspacing="0" class="ue_tm tm_'+c+'" id="dext_menu_'+this.ID+'" '+f+">"):b+('<table border="0" cellpadding="0" cellspacing="0" class="ue_tm tm_'+c+'" id="dext_menu_'+this.ID+'" '+f+">");b+='<tr><td><ul id="dext_tab_menu_'+this.ID+'">';for(c=0;c<d;c++)e=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,"menu",c),e=DEXTTOP.DEXT5.util.trim(e).toLowerCase(),b+='<li id="ue_'+this.ID+e+'"><a href="javascript:void(0);" id="'+
this.ID+":"+e+'">'+dext5_lang.top_menu[e]+"</a></li>";return b+="</ul></td></tr></table>"},_makeEditorIcon:function(a,c){var b=this._config.style.skinName,d=this._config.webPath.image,e=d+"skin/"+b,f='<span  class="ue_SM"><img style="margin:1px; padding: 0px; width: 11px; height: 26px;"  name="ue_spacebar" src="'+e+'/separator.gif" alt="" /></span>',g="",h=0,h="0"==c?DEXTTOP.DEXT5.util.xml.count(a,"menu"):DEXTTOP.DEXT5.util.xml.count(a,"tool"),m=isViewMode(this);"0"==c?g=g+"<tr>"+('\t<td class="ue_tdb_'+
b+'" style="padding: 1px 5px 0px 5px;" >'):"1"==c?(g+='<tr id="tool1_'+this.ID+'">',g="3"==this._config.tool_bar||"1"==this._config.tool_bar||m?g+('\t<td class="ue_tdb_'+b+'" style="padding: 1px 5px 0px 5px; display:none;" id="dext_tab_tool1_'+this.ID+'">'):g+('\t<td class="ue_tdb_'+b+'" style="padding: 1px 5px 0px 5px;" id="dext_tab_tool1_'+this.ID+'">'),"1"==this._config.tool_bar_grouping&&(g+='<span style="z-index:'+(G_MAIN_ZINDEX+850)+';" class="tool_bar_grouping" id="dext_span_'+this.ID+'tool_bar_grouping1">',
g+='\t<a href="javascript:;" id="ue_'+this.ID+'tool_bar_grouping1" class=""></a>',g+="</span>")):(g+='<tr id="tool2_'+this.ID+'">',g="3"==this._config.tool_bar||"2"==this._config.tool_bar||m?g+('\t<td class="ue_tdb_'+b+'01" style="padding: 2px 5px 0px 5px; background-image:url('+e+'/ue_tbg01.gif); display:none;" id="dext_tab_tool2_'+this.ID+'">'):g+('\t<td class="ue_tdb_'+b+'01" style="padding: 2px 5px 0px 5px; background-image:url('+e+'/ue_tbg01.gif);" id="dext_tab_tool2_'+this.ID+'">'),"1"==this._config.tool_bar_grouping&&
(g+='<span style="z-index:'+(G_MAIN_ZINDEX+850)+';" class="tool_bar_grouping" id="dext_span_'+this.ID+'tool_bar_grouping2">',g+='\t<a href="javascript:;" id="ue_'+this.ID+'tool_bar_grouping2" class=""></a>',g+="</span>"));for(e=0;e<h;e++){for(var m="0"==c?DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,"menu",e):DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,"tool",e),m=DEXTTOP.DEXT5.util.trim(m).toLowerCase(),n=this.remove_item.length,p=0;p<n;p++)if(this.remove_item[p]==m){m="remove";break}if("0"==c)g+='<span class="uebutton_combo_on" id="dext_span_'+
this.ID+m+'" >',g+="</span>",g+=f;else if(getCustomIconAttr(m).isCustom)n="custom",null!=DEXTTOP.DEXT5.ajax.load(d+this._config.style.iconName+"/"+getCustomIconAttr(m).command+".gif")&&(n=getCustomIconAttr(m).command),g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">',g+='\t<a href="javascript:;" id="'+this.ID+":"+m+'"><img style="margin: 2px 0px 0px 1.5px; padding: 0px; width: 16px; height: 16px;" id="ue_'+this.ID+m+'" class="ue_H ue_M" title="" alt="" src="'+d+this._config.style.iconName+
"/"+n+'.gif" /></a>',g+="</span>",G_ICON_FULL_SET.push(m);else switch(m){case "remove":break;case "separator":g+=f;break;case "formatting":case "font_family":case "font_size":case "line_height":case "letter_spacing":n="";"font_family"==m?n="Font_Btn_"+b:"font_size"==m?n="Font_Btn_"+b:"line_height"==m?n="Fsize_Btn_"+b:"formatting"==m?n="Font_Btn_"+b:"letter_spacing"==m&&(n="Font_Btn_"+b);g+='<span class="uebutton_combo_on" id="dext_span_'+this.ID+m+'" >';g+='\t<button unselectable="on" onmousedown="return false;" id="ue_'+
this.ID+m+'" class="'+n+'" type="button" title="" style="margin:0;"><span></span></button>';g+='\t<div style="position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<div id="dext_pan_'+m+"_"+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></div>';g+="\t</div>";g+="</span>";break;case "table_insert":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';g+='\t<a href="javascript:;" id="'+
this.ID+":"+m+'" class="'+m+'"><div id="ue_'+this.ID+m+'" style="width:16px; height:16px;"></div></a>';g+='\t<div style="position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<div id="dext_pan_'+m+"_"+this.ID+'" style="background-color:#ffffff; position:absolute; left:0px; top:0px; display:none; width:180px; height:200px; padding:5px; border:1px solid #cccccc; ">';g+='\t\t\t<span id="dext_table_rc_'+this.ID+'" style="font-size:12px;" padding-left:10px; >0 * 0</span>';g+="\t\t</div>";g+="\t</div>";
g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_table_insert">';g+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_table_insert" class="dialog"></a>';g+="</span>";break;case "detail_table_insert":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';g+='\t<a href="javascript:;" id="'+this.ID+":"+m+'" class="'+m+'"><div id="ue_'+this.ID+m+'" style="width:16px; height:16px;"></div></a>';g+='\t<div style="position:absolute; z-index:'+
(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<div id="dext_pan_'+m+"_"+this.ID+'" style="background-color:#ffffff; position:absolute; left:0px; top:0px; display:none; width:180px; height:200px; padding:5px; border:1px solid #cccccc; ">';g+='\t\t\t<span id="dext_table_rc_'+this.ID+'" style="font-size:12px;" padding-left:10px; >0 * 0</span>';g+="\t\t</div>";g+="\t</div>";g+="</span>";break;case "detail_table_insert_new":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';g+='\t<a href="javascript:;" id="'+
this.ID+":"+m+'" class="'+m+'"><div id="ue_'+this.ID+m+'" style="width:16px; height:16px;"></div></a>';g+='\t<div style="position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<div id="dext_pan_'+m+"_"+this.ID+'" style="background-color:#ffffff; position:absolute; left:0px; top:0px; display:none; width:180px; height:200px; padding:5px; border:1px solid #cccccc; ">';g+='\t\t\t<span id="dext_table_rc_'+this.ID+'" style="font-size:12px;" padding-left:10px; >0 * 0</span>';g+="\t\t</div>";g+="\t</div>";
g+="</span>";break;case "font_color":case "font_bg_color":case "cell_bg_color":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'"></a>';g+="</span>";break;case "list_number":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'"></a>';g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_list_number">';
g+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_list_number" class="dialog"></a>';g+='\t<div style="position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<div id="dext_pan_detail_list_number_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></div>';g+="\t</div>";g+="</span>";break;case "detail_list_number":break;case "list_bullets":g+='<span style="" class="uebutton_span_on" id="dext_span_'+
this.ID+m+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'"></a>';g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_list_bullets">';g+='\t<a href="javascript:;" id="ue_'+this.ID+'detail_list_bullets" class="dialog"></a>';g+='\t<div style="position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<div id="dext_pan_detail_list_bullets_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></div>';
g+="\t</div>";g+="</span>";break;case "detail_list_bullets":break;case "align_group":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'"></a>';g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'align_group_detail">';g+='\t<a href="javascript:;" id="ue_'+this.ID+'align_group_detail" class="dialog"></a>';g+='\t<div style="position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<div id="dext_span_align_group_detail_'+
this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></div>';g+="\t</div>";g+="</span>";break;case "align_group_detail":break;case "table_group":g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">';g+='\t<a href="javascript:;" id="ue_'+this.ID+m+'" class="'+m+'"></a>';g+="</span>";g+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'table_group_detail">';g+='\t<a href="javascript:;" id="ue_'+
this.ID+'table_group_detail" class="dialog"></a>';g+='\t<div style="position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';g+='\t\t<div id="dext_span_table_group_detail_'+this.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></div>';g+="\t</div>";g+="</span>";break;case "table_group_detail":break;default:g+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+m+'">',g+='\t<a href="javascript:;" id="ue_'+
this.ID+m+'" class="'+m+'"></a>',g+="</span>"}}if("1"==c){b=!1;n=this.remove_item.length;for(p=0;p<n;p++)if("about"==this.remove_item[p]){b=!0;break}0==b&&(g+='<span style="" class="uebutton_span_on">',g+='\t<a href="javascript:;" id="'+this.ID+':about" class="about"><div id="ue_'+this.ID+'about" style="width:16px; height:16px;"></div></a>',g+="</span>")}g+="\t</td>";return g+="</tr>"},_makeEditorFormBar:function(a){var c="";if("1"==this._config.formMode){var b=this._config.style.skinName,d='<span class="ue_SM"><img style="margin:1px; padding: 0px; width: 11px; height: 26px;"  name="ue_spacebar" src="'+
(this._config.webPath.image+"skin/"+b)+'/separator.gif" alt="" /></span>',e=0,e=DEXTTOP.DEXT5.util.xml.count(a,"tool");if(0<e&&"1"==this._config.formMode)for(c=c+('<table id="" class="ue_table02 tm_'+b+'2" border="0" cellpadding="0" cellspacing="0">')+"<tbody>",c+="<tr>",c+='<td class="ue_tdb_ty ue_tdb_'+b+'">',b=0;b<e;b++){var f;f=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,"tool",b);f=DEXTTOP.DEXT5.util.trim(f).toLowerCase();for(var g=this.remove_item.length,h=0;h<g;h++)if(this.remove_item[h]==f){f=
"remove";break}switch(f){case "remove":break;case "separator":c+=d;break;default:c+='<span id="dext_span_'+this.ID+f+'" class="uebutton_type_on"><a id="ue_'+this.ID+f+'" title="" href="javascript:;" class="'+f.replace("input_","type_")+'"></a></span>'}}c+="</td>";c+="</tr>";c+="</tbody>";c+="</table>"}return c},_div_pan_reset:function(a){},_iconEnable:function(a,c){if(0==DEXTTOP.G_CURREDITOR._config.editorBodyEditable&&(""==a||"default"==a))try{var b=getFirstRange().range.startContainer;3==b.nodeType&&
(b=b.parentNode);0==b.isContentEditable&&(a="editableFalse")}catch(d){}DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.element&&(a="focusImage");for(var e=null,f=null,g="",b=e="",h=0,m=G_ICON_FULL_SET.length;h<m;h++)if(g=DEXTTOP.DEXT5.util.trim(G_ICON_FULL_SET[h]).toLowerCase(),e=document.getElementById("ue_"+this.ID+g),f=document.getElementById("dext_span_"+this.ID+g),e&&(e.style.cursor="pointer"),f){switch(g){case "formatting":case "font_family":case "font_size":case "line_height":case "letter_spacing":e=
"uebutton_combo_";break;case "detail_table_insert":case "detail_list_number":case "detail_list_bullets":case "align_group_detail":case "table_group_detail":e="uebutton_dialog_";break;case "input_textfield":case "input_textarea":case "input_select":case "input_checkbox":case "input_radio":case "input_button":case "input_imagebutton":case "input_hiddenfield":case "input_align_left":case "input_align_right":case "input_valign_top":case "input_valign_bottom":case "input_same_width":case "input_same_height":case "input_word_spacing":case "input_line_height":case "input_same_width_height":case "table_lock":case "cell_lock":case "table_lock_property":e=
"uebutton_type_";break;default:e="uebutton_span_"}(b=DEXTTOP.DEXT5.util.getClass(f))&&-1<b.indexOf("_off")&&(DEXTTOP.DEXT5.util.setClass(f,e+"on"),f=f.getElementsByTagName("a")[0])&&(f.title=dext5_lang.icon[g])}b=[];switch(a){case "":case "default":b="copy cut table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight insert_row_column insert_row insert_column table_row_clone table_selection table_select cell_size align_vertical row_property table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property table_tool cell_border cell_bg_color table_group table_group_detail apply_format image_align_default image_align_left image_align_right table_lock cell_lock table_lock_property".split(" ");
break;case "selectedSingleCell":b="new save print pagebreak copy cut paste text_paste find replace template emoticon horizontal_line image_create image_editor flash_create insert_link_media media_create iframe_create hyperlink_create insert_file file_open bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete split_cell insert_row_up insert_row_down insert_column_left insert_column_right merge_cell cell_size table_same_width table_same_height table_same_widthheight full_screen entity insert_row_column insert_row insert_column table_row_clone table_selection table_select row_property column_property indent outdent format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton show_blocks photo_editor".split(" ");
break;case "selectedMultiCell":b="new save print pagebreak copy cut paste text_paste find replace emoticon horizontal_line template image_create image_editor flash_create insert_link_media media_create iframe_create hyperlink_create insert_file file_open bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete split_cell insert_row_up insert_row_down insert_column_left insert_column_right full_screen entity insert_row_column insert_row insert_column table_row_clone table_selection table_select row_property column_property indent outdent format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton show_blocks photo_editor".split(" ");
break;case "focusInCell":b="copy cut pagebreak merge_cell table_same_width table_same_height table_same_widthheight doc_bg_image merge_cell cell_size apply_format image_align_default image_align_left image_align_right".split(" ");break;case "focusTable":b="new save print pagebreak text_paste find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create hyperlink_create insert_file file_open insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell remove_css insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight font_color font_bg_color list_number list_bullets detail_list_number detail_list_bullets template undo redo entity table_delete insert_row_column insert_row insert_column formatting font_family font_size line_height letter_spacing bold italic underline strike_through superscript subscript remove_format table_row_clone table_selection table_select cell_size align_vertical row_property select_all table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail indent outdent image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton photo_editor".split(" ");
break;case "cellSelectText":b="new save print pagebreak text_paste find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight template undo redo entity table_delete insert_row_column insert_row insert_column table_row_clone table_selection table_select cell_size align_vertical row_property table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor".split(" ");
"1"!=this._config.allowInoutdentText&&(b.push("indent"),b.push("outdent"));break;case "selectArea":b="new save print pagebreak text_paste find replace emoticon horizontal_line image_create image_editor flash_create media_create template iframe_create insert_link_media bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight template undo redo entity table_delete insert_row_column insert_row insert_column table_row_clone table_selection table_select cell_size align_vertical row_property table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter image_align_default image_align_left image_align_right input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor".split(" ");
break;case "focusImage":b="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template hyperlink_create insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets indent outdent insert_row_column insert_row insert_column iframe_create table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor".split(" ");
break;case "focusEmbed":b="new save print pagebreak paste text_paste find replace bookmark symbol insert_link_media media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color image_create image_editor formatting font_family font_size entity template hyperlink_create insert_file file_open horizontal_line emoticon line_height letter_spacing list_number list_bullets indent outdent insert_row_column insert_row insert_column table_indent table_outdent table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom table_row_clone table_selection table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color table_group table_group_detail format_painter apply_format image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton table_lock cell_lock table_lock_property photo_editor".split(" ");
break;case "editableFalse":b="copy cut paste text_paste replace emoticon setting horizontal_line image_create image_editor image_property image_editor_property flash_create flash_property media_create media_property iframe_create iframe_property hyperlink_create hyperlink_property hyperlink_delete bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_image detail_table_insert detail_table_insert_new table_insert table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight table_group table_group_detail bold underline italic strike_through superscript subscript remove_format remove_css font_color font_bg_color align_group align_group_detail align_left align_center align_right align_full line_height indent outdent list_number list_bullets detail_list_number detail_list_bullets formatting font_family font_size select_all entity insert_row insert_column table_select cell_size align_vertical table_tool list_number list_bullets insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom grid tool_replace convert_table_to_text insert_link_media paste_word cell_border cell_bg_color table_indent table_outdent ruler pagebreak dirltr dirrtl insert_file format_painter apply_format letter_spacing align image_align_default image_align_left image_align_right list_blockquote input_textfield input_radio input_checkbox input_button input_hiddenfield input_textarea input_select input_imagebutton input_same_width input_same_height input_same_width_height accessibility_validation table_copy table_paste intable_paste table_content_paste horizontal_sum vertical_sum horizontal_avg vertical_avg table_selection show_blocks table_lock cell_lock table_lock_property list_lower_alpha word_transform photo_editor photo_editor_property insert_file_property".split(" ")}0==
this.UndoManager.canUndo&&(b[b.length]="undo");0==this.UndoManager.canRedo&&(b[b.length]="redo");if("editableFalse"!=a){c&&1==c&&(b=addDisalbeItemForNoActionTable(b));if("2"==this._setting.auto_save.toString().split(",")[0]||void 0==getAutoSaveHtml(this.ID)||""==getAutoSaveHtml(this.ID))b[b.length]="load_auto_save";null==this._formatPainterList&&(b[b.length]="apply_format");"focusImage"==a&&(g=DEXTTOP.G_SELECTED_IMAGE_ELEMENT)&&g.getAttribute("dext5customdata")&&""!=g.getAttribute("dext5customdata")&&
(g=g.getAttribute("dext5customdata"),"iframe"!=getDextCustomData(g).type&&(b.push("image_align_default"),b.push("image_align_left"),b.push("image_align_right")));(g=getFormControlSelectedItem())&&2>g.count&&(b.push("input_same_width"),b.push("input_same_height"),b.push("input_same_width_height"))}h=0;for(m=b.length;h<m;h++)if(g=DEXTTOP.DEXT5.util.trim(b[h]).toLowerCase(),e=document.getElementById("ue_"+this.ID+g),f=document.getElementById("dext_span_"+this.ID+g),e&&(e.style.cursor="default"),f){switch(g){case "formatting":case "font_family":case "font_size":case "line_height":case "letter_spacing":e=
"uebutton_combo_";break;case "detail_table_insert":case "detail_list_number":case "detail_list_bullets":case "table_group_detail":case "align_group_detail":e="uebutton_dialog_";break;case "input_textfield":case "input_textarea":case "input_select":case "input_checkbox":case "input_radio":case "input_button":case "input_imagebutton":case "input_hiddenfield":case "input_align_left":case "input_align_right":case "input_valign_top":case "input_valign_bottom":case "input_same_width":case "input_same_height":case "input_word_spacing":case "input_line_height":case "input_same_width_height":case "table_lock":case "cell_lock":case "table_lock_property":e=
"uebutton_type_";break;default:e="uebutton_span_"}DEXTTOP.DEXT5.util.setClass(f,e+"off");(f=f.getElementsByTagName("a")[0])&&0>f.title.indexOf(dext5_lang.icon.inactive_button)&&(f.title=dext5_lang.icon[g]+" "+dext5_lang.icon.inactive_button)}DEXT5_TOPMENU._disabeld_menu=b},_iconSelected:function(a){for(var c="bold italic underline align_left align_center align_right align_full strike_through subscript superscript full_screen grid list_number list_bullets dirltr dirrtl show_blocks table_lock cell_lock table_lock_property".split(" "),
b="",d=0,e=c.length;d<e;d++)if(_icon_id=DEXTTOP.DEXT5.util.trim(c[d]).toLowerCase(),_icon_span=document.getElementById("dext_span_"+this.ID+_icon_id))b=DEXTTOP.DEXT5.util.getClass(_icon_span),b=DEXTTOP.DEXT5.util.replaceAll(b,"uebutton_span_enter",""),b=DEXTTOP.DEXT5.util.trim(b),DEXTTOP.DEXT5.util.setClass(_icon_span,b),_icon_span.style.backgroundImage="";if(a)for(d=0,e=a.length;d<e;d++)if(_icon_id=DEXTTOP.DEXT5.util.trim(a[d]).toLowerCase(),_icon_span=document.getElementById("dext_span_"+this.ID+
_icon_id))b=DEXTTOP.DEXT5.util.getClass(_icon_span),b+=" uebutton_span_enter",DEXTTOP.DEXT5.util.setClass(_icon_span,b),-1<_icon_span.className.indexOf("uebutton_type")?_icon_span.style.backgroundImage="url("+this._config.webPath.image+"skin/"+this._config.style.skinName+"/form_skinback_release.gif)":_icon_span.style.backgroundImage="url("+this._config.webPath.image+"skin/"+this._config.style.skinName+"/skinback_release.gif)"},_setTopMenuEvents:function(a){for(var c=this,b=null,d="",e=0,f=DEXTTOP.DEXT5.util.xml.count(a,
"menu");e<f;e++)if(d=DEXTTOP.DEXT5.util.trim(DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,"menu",e)).toLowerCase(),b=document.getElementById("ue_"+c.ID+d)){switch(b){case "design":case "source":case "preview":case "text":"textContent"in b?b.textContent=dext5_lang.top_menu[d]:b.innerText=dext5_lang.top_menu[d]}var g=function(b){return function(d){var e=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+c._config.editor_id);null!=e&&(e.style.display="none");b==c._top_menu_click_id?(c._top_menu_click_flag?
(c._top_menu_click_flag=!1,c._top_menu_click_id="",hideTopMenuAndFocus()):(c._top_menu_click_id=b,c._top_menu_click_flag=!0,setTopMenu(d,c,b,c._config,a)),DEXTTOP.DEXT5.util.stopEvent(d)):b!=c._top_menu_click_id&&(c._top_menu_click_id=b,c._top_menu_click_flag=!0,setTopMenu(d,c,b,c._config,a),DEXTTOP.DEXT5.util.stopEvent(d));d=0;for(e=DEXTTOP.DEXT5.util.xml.count(a,"menu");d<e;d++)_m_id=DEXTTOP.DEXT5.util.trim(DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,"menu",d)).toLowerCase(),_m=document.getElementById("ue_"+
c.ID+_m_id),_m.childNodes[0].className=_m_id==c._top_menu_click_id?"on":""}}(d),h=function(b){return function(d){var e=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+c._config.editor_id);null!=e&&(e.style.display="none");c._top_menu_click_flag?(c._top_menu_click_id=b,setTopMenu(d,c,b,c._config,a)):(c._top_menu_click_id="",hideTopMenu());DEXTTOP.DEXT5.util.stopEvent(d);d=0;for(e=DEXTTOP.DEXT5.util.xml.count(a,"menu");d<e;d++)_m_id=DEXTTOP.DEXT5.util.trim(DEXTTOP.DEXT5.util.xml.getNodeValueIdx(a,
"menu",d)).toLowerCase(),_m=document.getElementById("ue_"+c.ID+_m_id),_m.childNodes[0].className=_m_id==c._top_menu_click_id?"on":""}}(d),d=function(a){return function(a){c._top_menu_click_flag&&(a=DEXTTOP.DEXTDOC.getElementById("dext_topmenu_background"+c._config.editor_id),null!=a&&(a.style.display=""))}}(d);DEXTTOP.DEXT5.util.addEvent(b,"click",g);DEXTTOP.DEXT5.util.addEvent(b,"mouseover",h);DEXTTOP.DEXT5.util.addEvent(b,"mouseout",d);b=b.getElementsByTagName("a")[0];g=function(a){return function(b){a.className=
"on"}}(b);h=function(a){return function(b){a.className=""}}(b);DEXTTOP.DEXT5.util.addEvent(b,"focus",g);DEXTTOP.DEXT5.util.addEvent(b,"blur",h)}},_setIconEvents:function(){for(var a=this,c=null,b="",d=0,e=G_ICON_FULL_SET.length;d<e;d++)if(b=DEXTTOP.DEXT5.util.trim(G_ICON_FULL_SET[d]).toLowerCase(),c=document.getElementById("ue_"+a.ID+b)){getCustomIconAttr(G_ICON_FULL_SET[d]).isCustom?(c.setAttribute("title",getCustomIconAttr(G_ICON_FULL_SET[d]).desc),c.setAttribute("alt",getCustomIconAttr(G_ICON_FULL_SET[d]).desc)):
null!=dext5_lang.icon[b]&&void 0!=dext5_lang.icon[b]&&(c.setAttribute("title",dext5_lang.icon[b]),c.setAttribute("alt",dext5_lang.icon[b]));switch(b){case "top_design":case "top_source":case "top_preview":case "top_text":c.getElementsByTagName("A")[0].title=dext5_lang.icon[b.replace("top_","")],c.getElementsByTagName("A")[0].innerHTML=dext5_lang.icon[b.replace("top_","")]}switch(b){case "design":case "source":case "preview":case "text":c.getElementsByTagName("A")[0].title=dext5_lang.icon[b],c.getElementsByTagName("A")[0].innerHTML=
dext5_lang.icon[b]}var f=function(b){return function(c){a._dextCommands(a.ID,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(b),g="";switch(b){case "font_family":case "font_size":case "letter_spacing":g="click";break;default:g="click"}DEXTTOP.DEXT5.util.addEvent(c,g,f);c.onmousedown=function(){return!1};c.unselectable="on";f=function(b){return function(c){if(!(-1<",detail_table_insert,detail_list_number,detail_list_bullets,align_group_detail,table_group_detail,".indexOf(","+b+","))){var d=document.getElementById("dext_span_"+
a.ID+b);null!=d&&(""==d.style.backgroundImage&&-1<d.className.indexOf("_on")&&(d.style.backgroundImage="url("+a._config.webPath.image+"skin/"+a._config.style.skinName+"/icon_skinback.gif)"),DEXTTOP.DEXT5.util.stopEvent(c))}}}(b);b=function(b){return function(c){var d=document.getElementById("dext_span_"+a.ID+b);null!=d&&(0<d.style.backgroundImage.indexOf("skinback.gif")&&(d.style.backgroundImage=""),DEXTTOP.DEXT5.util.stopEvent(c))}}(b);DEXTTOP.DEXT5.util.addEvent(c,"mouseover",f);DEXTTOP.DEXT5.util.addEvent(c,
"mouseout",b)}this._load_editor_frame(!0)},_load_editor_frame:function(a){var c=this;void 0==c._EDITOR&&DEXTTOP.G_CURREDITOR&&""!=DEXTTOP.G_CURREDITOR._config.directEditHtmlUrl&&(c=DEXTTOP.G_CURREDITOR);c._EDITOR.design=document.getElementById("dext5_design_"+c.ID);c._EDITOR.source=document.getElementById("dext5_source_"+c.ID);c._EDITOR.preview=document.getElementById("dext5_preview_"+c.ID);c._EDITOR.text=document.getElementById("dext5_text_"+c.ID);var b=c._EDITOR.design;c._DOC=b.contentDocument?
b.contentDocument:b.contentWindow.document;G_USE_EDITOR_ID=c.ID;DEXTTOP.G_CURREDITOR=c;c._BODY=c._DOC.body;"spellcheck"in c._BODY&&(c._BODY.spellcheck=!1);"contentEditable"in c._BODY&&(isViewMode(c)?c._BODY.contentEditable=!1:c._BODY.contentEditable=a&&""!=c._config.focusInitObjId?!1:!0,0==c._config.editorBodyEditable&&(c._BODY.contentEditable=!1));LayerFrame=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+DEXTTOP.G_CURREDITOR.ID);LayerFrame.title=dext5_lang.iframe_title.layer;dext_src_init_once(b,c);
dext_src_init(b);0<_iframeDoc.body.clientWidth&&(c._defTableWidth=_iframeDoc.body.clientWidth-30,c._defaultWidth=_iframeDoc.body.clientWidth-30);100>c._defTableWidth&&(c._defTableWidth=400,c._defaultWidth=400);document.getElementById("ue_"+c.ID+"font_size")&&("1"==c._setting.show_font_real?document.getElementById("ue_"+c.ID+"font_size").innerHTML="<span>"+c._setting.font_size+"</span>":document.getElementById("ue_"+c.ID+"font_size").innerHTML="<span>"+dext5_lang.icon.font_size+"</span>");document.getElementById("ue_"+
c.ID+"font_family")&&("1"==c._setting.show_font_real?document.getElementById("ue_"+c.ID+"font_family").innerHTML="<span>"+c._setting.font_family+"</span>":document.getElementById("ue_"+c.ID+"font_family").innerHTML="<span>"+dext5_lang.icon.font_family+"</span>");document.getElementById("ue_"+c.ID+"letter_spacing")&&(document.getElementById("ue_"+c.ID+"letter_spacing").innerHTML="<span>"+dext5_lang.icon.letter_spacing+"</span>");""!=c._config.defaultMessage&&(c._BODY.innerHTML="<p>"+c._config.defaultMessage+
"</p>");G_dext5plugIn=document.getElementById("dext5plugin");if(a){a=function(a){return function(b){try{resizeEditor(null,!1)}catch(c){}"1"==a._config.tool_bar_grouping&&(groupingIcon(a),setPositionGroupingDiv(1),setPositionGroupingDiv(2))}}(DEXTTOP.G_CURREDITOR);DEXTTOP.DEXT5.util.addEvent(window,"resize",a);try{var d=c.Frame;setTimeout(function(){try{setAutoSave(d.editor)}catch(a){}try{isViewMode(d.editor)||showRuler(d.editor)}catch(b){}try{if(""!=d.editor._config.setValueObjId){var c=DEXTTOP.DEXTDOC.getElementById(d.editor._config.setValueObjId);
if(c){var e=c.value;""!=e&&DEXTTOP.DEXT5.setHtmlContents(e,d.editor.ID)}}}catch(f){}c=d.editor._config.statusBarInitMode;if("design"!=c){for(var e=!1,q=d.editor._config.statusBarItem.split(","),u=q.length,t=0;t<u;t++)if("design"==q[t]){e=!0;break}e||(d.editor._EDITOR.design.style.width="0px",d.editor._EDITOR.design.style.height="0px");DEXTTOP.DEXT5.ShowTextChangeAlert=!1;d.editor._dextCommands(d.editor.ID,c);DEXTTOP.DEXT5.ShowTextChangeAlert=!0}try{try{DEXT5_EDITOR.prototype._setLazyLoadFrame(d.editor.ID)}catch(v){}DEXTTOP.DEXT5.setDirty(d.editor.ID);
d.editor._config.isLoadedEditor=!0;""==d.editor._config.LoadedEvent?(""!=d.editor._config.directEditHtmlUrl&&loadDirectEditHtmlUrl(d.editor._config),DEXTTOP.DEXTWIN.dext_editor_loaded_event(d)):"function"==typeof d.editor._config.LoadedEvent&&DEXTTOP.DEXT5.config.LoadedEvent(d)}catch(w){}try{if(""!=d.editor._config.focusInitObjId){var x=DEXTTOP.DEXTDOC.getElementById(d.editor._config.focusInitObjId);x?setTimeout(function(){var a=DEXTTOP.DEXTDOC.getElementById(d.editor._config.tabIndexObjId);a&&(a.tabIndex=
"0",d.editor._config.tabIndexObjId="");x.focus();d.editor._config.editorBodyEditable&&(d.editor._BODY.contentEditable=!0);d.editor._config.focusInitObjId=""},2E3):0==isViewMode(d.editor)&&setTimeout(function(){d.editor._config.editorBodyEditable&&(d.editor._BODY.contentEditable=!0);0==DEXTTOP.DEXT5.browser.ie&&setFocusToBody()},200)}}catch(y){}try{""!=d.editor._config.focusInitEditorObjId&&setTimeout(function(){DEXTTOP.DEXT5.setFocusToObject(d.editor._config.focusInitEditorObjId,!1,d.editor.ID);d.editor._config.focusInitEditorObjId=
""},2E3)}catch(z){}try{DEXTTOP.DEXTWIN.editor_loaded_event(d)}catch(C){}},100);if(0==this._config.style.InitVisible)try{this._config.visibility=!1,LayerFrame.parentElement.style.height="0px",LayerFrame.parentElement.style.display="none"}catch(e){}}catch(f){}}},_cmd_new:function(){0==DEXTTOP.DEXT5.isEmpty()?1==confirm(dext5_lang.msg.newDocument)&&(DEXTTOP.DEXT5.setBodyValue("","",!0),this._iconEnable(""),setBodyDefaultValue(),setFocusToBody(),DEXTTOP.G_CURREDITOR._config.printHeader=DEXTTOP.G_CURREDITOR._config.basePrintHeader,
DEXTTOP.G_CURREDITOR._config.printFooter=DEXTTOP.G_CURREDITOR._config.basePrintFooter):(DEXTTOP.DEXT5.setBodyValue("","",!0),this._iconEnable(""),setBodyDefaultValue(),setFocusToBody(),DEXTTOP.G_CURREDITOR._config.printHeader=DEXTTOP.G_CURREDITOR._config.basePrintHeader,DEXTTOP.G_CURREDITOR._config.printFooter=DEXTTOP.G_CURREDITOR._config.basePrintFooter)},_dextCommands:function(a,c,b){setDEXTWINDOC();G_USE_EDITOR_ID=a;DEXTTOP.G_CURREDITOR=this;var d=!1;null!=G_LAST_CMD&&-1<G_LAST_CMD.indexOf("align_")&&
-1<c.indexOf("align_")&&(d=!0);G_LAST_CMD=c;checkDefaultMessage();if("1"!=this._config.formMode&&"1"==this._config.userTableLock.use){var e=GetTableSelectionCells(),f=e.length;if(0<f){var g=GetParentbyTagName(e[0],"table"),h=this._config.userTableLock.defaultTableLockMode;g.getAttribute("lock_mode")&&""!=g.getAttribute("lock_mode")&&(h=g.getAttribute("lock_mode"));var m=!0;"1"==h&&(m=!1);h=!1;for(g=0;g<f;g++){if(checkLockAttr(e[g],!m)){h=!0;break}else{var n=[];n.push(e[g].getElementsByTagName("table"));
n.push(e[g].getElementsByTagName("td"));var p=n.length;for(j=0;j<p;j++){var q=n[j].length;for(k=0;k<q;k++)if(checkLockAttr(n[j][k],!0)){h=!0;break}if(h)break}}if(h)break}if(h)return}else if(m=getFirstRange().range.startContainer,3==m.nodeType&&(m=m.parentNode),e=GetTDTHCell(m),g=GetParentbyTagName(m,"table"),h=this._config.userTableLock.defaultTableLockMode,g&&g.getAttribute("lock_mode")&&""!=g.getAttribute("lock_mode")&&(h=g.getAttribute("lock_mode")),m=!0,"1"==h&&(m=!1),f=!1,f=m?checkLockAttr(g,
!m)||checkLockAttr(e,!m):checkLockAttr(e,!m))return}m=document.getElementById("ue_"+a+c);if(!m||!(m.parentNode&&null!=m.parentNode.className.match(/_off/gi)||m.parentNode.parentNode&&null!=m.parentNode.parentNode.className.match(/_off/gi)||m.parentNode.parentNode.parentNode&&null!=m.parentNode.parentNode.parentNode.className.match(/_off/gi))){if("1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&("detail_table_insert_new"==c||"detail_table_insert"==c||0>c.indexOf("detail"))&&"table_insert"!=c&&
"font_bg_color"!=c&&"font_color"!=c&&"font_family"!=c&&"font_size"!=c&&"line_height"!=c&&"formatting"!=c){e=!1;e=isGroupingIcon(a,c);if(!e)for(f=DEXTTOP.G_CURREDITOR.detailSubCmd,h=f.length,g=0;g<h;g++)if(f[g]==c){e=!0;break}e&&hideGroupingBox()}switch(c){case "grid":command_grid(a,this);break;case "insert_file":case "insert_file_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.insert_file);break;case "file_open":if(G_dext5plugIn)try{b&&b.hide(),file_open_plugin()}catch(u){DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.file_open)}else DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.file_open);break;case "new":this._cmd_new();break;case "save":command_saveAs(a,this);break;case "print":command_print(a,this);break;case "pagebreak":command_pagebreak(a,this);break;case "undo":command_undo(a,this);break;case "redo":command_redo(a,this);break;case "copy":command_copy(a,this);break;case "cut":command_cut(a,this);break;case "paste":!checkCanPasteToIamge()||"1"!=this._config.pasteToImage&&
"2"!=this._config.pasteToImage?command_pastehtml(a,this):command_pastehtml(a,this,"");break;case "paste_to_image":command_pastehtml(a,this,"jpg",!1);break;case "paste_to_image_detail":command_pastehtml(a,this,"",b);break;case "table_copy":command_tableCopy(a,this);break;case "table_content_paste":case "table_paste":command_tablePaste(a,this);break;case "intable_paste":command_intablePaste(a,this);break;case "paste_dialog":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.paste_dialog);
break;case "find":g_findRepalceRange=null;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.find);break;case "replace":g_findRepalceRange=null;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.replace);break;case "emoticon":null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.m_emoticon):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.emoticon);break;case "setting":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.setting);break;case "horizontal_line":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.horizontal_line);break;case "image_create":null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?
DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_image):G_dext5plugIn?showSetImageProperty(null):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.image);break;case "image_property":G_dext5plugIn&&DEXTTOP.G_SELECTED_ELEMENT&&-1!=DEXTTOP.G_SELECTED_ELEMENT.src.search("file:///")?showSetImageProperty(DEXTTOP.G_SELECTED_ELEMENT):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.image);break;case "image_editor":G_dext5plugIn&&
showImageEditor(null);break;case "image_editor_property":G_dext5plugIn&&DEXTTOP.G_SELECTED_ELEMENT&&-1!=DEXTTOP.G_SELECTED_ELEMENT.src.search("file:///")&&showImageEditor(DEXTTOP.G_SELECTED_ELEMENT);break;case "flash_create":case "flash_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.flash);break;case "media_create":case "media_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.media);break;case "iframe_create":case "iframe_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.iframe);break;case "hyperlink_create":case "hyperlink_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.hyperlink);break;case "bookmark":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.bookmark);break;case "symbol":b=getFirstRange().range;b=getMyElementNode(b.startContainer);d="";b&&1==b.nodeType&&(d=getElementInParentStyleProperty(b,"fontFamily"),""==d&&(d=getStyle(b,"fontFamily")));""==d&&(d=this._setting.font_family);
this._config.currFontFamily=d;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.symbol);break;case "doc_bg_image":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.doc_bg_img);break;case "detail_table_insert":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table);break;case "detail_table_insert_new":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table);break;case "table_insert":if(DEXTTOP.DEXT5.browser.mobile)DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.table);else{if("1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&(b=document.getElementById("ue_"+a+"table_insert"),(b=GetParentbyTagName(b,"ul"))&&-1<b.id.indexOf("ul_tool_bar_grouping"))){hideGroupingBox();DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table);break}this._dextTable.show(a)}break;case "table_delete":command_deleteTable(a,this);break;case "merge_cell":command_mergeCell(a,this);break;case "split_cell":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.split_cell);break;case "insert_row_up":command_insertRowUp(a,this);break;case "insert_row_down":command_insertRowDown(a,this);break;case "delete_row":command_deleteRow(a,this);break;case "insert_column_left":command_insertCellLeft(a,this);break;case "insert_column_right":command_insertCellRight(a,this);break;case "delete_column":command_deleteCell(a,this);break;case "table_indent":command_tableIndentOutdent(a,this,"indent");break;case "table_outdent":command_tableIndentOutdent(a,
this,"outdent");break;case "table_selection":command_tableSelection(a,this);break;case "table_select_cell":command_TableSelect(a,this,"select_cell");break;case "table_select_row":command_TableSelect(a,this,"select_row");break;case "table_select_column":command_TableSelect(a,this,"select_column");break;case "table_select_all":command_TableSelect(a,this,"select_all");break;case "table_same_width":command_TableSameWidthheight(a,this,"same_width");break;case "table_same_height":command_TableSameWidthheight(a,
this,"same_height");break;case "table_same_widthheight":command_TableSameWidthheight(a,this,"same_widthheight");break;case "table_row_clone":command_TableRowClone(a,this);break;case "convert_table_to_text":command_convertTableToText(a,this);break;case "cell_border":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.cell_border,DEXTTOP.G_SELECTED_ELEMENT);break;case "cell_bg_color":showColorPopup(document,m,void 0,"cell_bg_color");break;case "insert_row_column":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.insert_row_column);break;case "cell_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.cell_property,DEXTTOP.G_SELECTED_ELEMENT);break;case "row_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.row_property);break;case "column_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.column_property);break;case "table_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.table_property,DEXTTOP.G_SELECTED_ELEMENT);break;case "table_group":this._dextListTables.show(a);break;case "table_group_detail":this._dextListTables.show(a);break;case "bold":command_bold(a,this);break;case "underline":command_underline(a,this);break;case "italic":command_italic(a,this);break;case "strike_through":command_strikeThrough(a,this);break;case "superscript":command_superscript(a,this);break;case "subscript":command_subscript(a,this);break;case "remove_format":command_removeFormat(a,
this);break;case "remove_css":command_removeCss(a,this);break;case "font_color":showColorPopup(document,m,void 0,"font_color");break;case "font_bg_color":showColorPopup(document,m,void 0,"font_bg_color");break;case "align_left":command_align(a,this,"left",d);break;case "align_center":command_align(a,this,"center",d);break;case "align_right":command_align(a,this,"right",d);break;case "align_full":command_align(a,this,"justify",d);break;case "align_group":this._dextListAligns.show(a);break;case "align_group_detail":this._dextListAligns.show(a);
break;case "line_height":this._dextLineHeight.show(a);break;case "indent":command_indent(a,this);break;case "outdent":command_outdent(a,this);break;case "list_number":command_insertOrderedList(a,this);break;case "list_bullets":command_insertUnOrderedList(a,this);break;case "detail_list_number":this._dextListNumber.show(a);break;case "detail_list_bullets":this._dextListBullets.show(a);break;case "list_decimal":command_listDecimal(a,this);break;case "list_decimal_leading_zero":command_listDecimalLeadingZero(a,
this);break;case "list_lower_alpha":command_listLowerAlpha(a,this);break;case "list_lower_greek":command_listLowerGreek(a,this);break;case "list_lower_roman":command_listLowerRoman(a,this);break;case "list_upper_alpha":command_listUpperAlpha(a,this);break;case "list_upper_roman":command_listUpperRoman(a,this);break;case "list_disc":command_listDisc(a,this);break;case "list_circle":command_listCircle(a,this);break;case "list_square":command_listSquare(a,this);break;case "full_screen":command_fullScreen(a,
this);showRuler(this);break;case "formatting":this._dextFormatting.show(a);break;case "font_family":this._dextFontFamily.show(a);break;case "font_size":this._dextFontSize.show(a);break;case "letter_spacing":this._dextLetterSpacing.show(a);break;case "top_design":"1"==this._config.topStatusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("top_design"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("top_design");
break;case "top_source":"1"==this._config.topStatusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("top_source"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("top_source");break;case "top_preview":"1"==this._config.topStatusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("top_preview"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},
G_Progress_LoadTime)):this.setChangeMode("top_preview");break;case "top_text":"1"==this._config.topStatusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("top_text"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("top_text");break;case "design":"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("design"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},
G_Progress_LoadTime)):this.setChangeMode("design");break;case "source":"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("source"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("source");break;case "preview":"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("preview"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},
G_Progress_LoadTime)):this.setChangeMode("preview");break;case "text":"1"==this._config.statusBarLoading?(showProcessingBackground(),setTimeout(function(){try{DEXTTOP.G_CURREDITOR.setChangeMode("text"),hideProcessingBackground()}catch(a){hideProcessingBackground()}},G_Progress_LoadTime)):this.setChangeMode("text");break;case "about":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.about);break;case "select_all":command_selectAll(a,this);break;case "valign_up":command_VerticalAlignExcute(a,
this,"top");break;case "valign_center":command_VerticalAlignExcute(a,this,"middle");break;case "valign_baseline":command_VerticalAlignExcute(a,this,"baseline");break;case "valign_bottom":command_VerticalAlignExcute(a,this,"bottom");break;case "template":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.template);break;case "tool_replace":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.tool_replace);break;case "insert_link_media":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.insert_link_media);break;case "shortcut":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.shortcut);break;case "load_auto_save":command_loadAutoSave(this);break;case "ruler":command_useRuler(a);break;case "layout":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.layout);break;case "dirltr":command_Direction(a,this,"LTR");break;case "dirrtl":command_Direction(a,this,"RTL");break;case "format_painter":command_formatPainter(a,
this);break;case "apply_format":command_applyFormat(a,this);break;case "image_align_default":command_imageAlign(a,this,"");break;case "image_align_left":command_imageAlign(a,this,"left");break;case "image_align_right":command_imageAlign(a,this,"right");break;case "list_blockquote":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.blockquote);break;case "input_textfield":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_text);break;
case "input_radio":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_radio);break;case "input_checkbox":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_checkbox);break;case "input_button":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_button);break;case "input_hiddenfield":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_hidden);break;case "input_textarea":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.input_textarea);break;case "input_select":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_select);break;case "input_imagebutton":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.input_image);break;case "input_same_width":command_inputSameWidthHeight(a,this,"width");break;case "input_same_height":command_inputSameWidthHeight(a,this,"height");break;case "input_same_width_height":command_inputSameWidthHeight(a,this,
"widthheight");break;case "accessibility_validation":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.accessibility_validation);break;case "horizontal_sum":case "vertical_sum":case "horizontal_avg":case "vertical_avg":command_calculationFormula(a,this,c);break;case "show_blocks":command_showBlocks(a,this);break;case "table_lock":command_tableLock(a,this);break;case "cell_lock":command_cellLock(a,this);break;case "table_lock_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.table_lock_property);break;case "help":command_help(a,this);break;case "word_transform":command_wordTransform(a,this);break;case "photo_editor":command_InsertImagePhotoEdit(a,this);break;case "photo_editor_property":command_photoEditProperty(a,this)}c&&getCustomIconAttr(c).isCustom&&command_custom(a,this,getCustomIconAttr(c).command)}},_dextDialog:{make:function(a,c){var b;try{b=DEXTTOP.DEXTDOC.createElement("<iframe tabkey='-1' frameborder='0' scrolling='no'>")}catch(d){b=DEXTTOP.DEXTDOC.createElement("iframe"),
b.setAttribute("frameborder","0"),b.setAttribute("scrolling","no"),b.setAttribute("tabkey","-1")}b.title=dext5_lang.iframe_title.dialog;b.style.display="none";b.style.margin="0px";b.style.padding="0px";b.style.zIndex="1";var e=DEXTTOP.document.createElement("div");e.id="dext_dialog";e.style.display="none";e.style.position="absolute";var f=DEXTTOP.document.createElement("div");f.id="EdiTor_Popup_header";DEXTTOP.DEXT5.util.setClass(f,"EdiTor_Popup_header");var g=DEXTTOP.document.createElement("span");
g.className="subject";var h=DEXTTOP.document.createElement("span");h.className="text";h.innerHTML=c.system_title;var m=DEXTTOP.document.createElement("div");m.className="close";m.id="dext_dialog_close";var n=DEXTTOP.document.createElement("a");n.title="close";n.href="javascript:void(0);";m.appendChild(n);f.appendChild(g);f.appendChild(h);f.appendChild(m);e.appendChild(f);f=DEXTTOP.document.createElement("div");DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&(f.style.backgroundColor=
"#eeeeee",f.style.backgroundRepeat="no-repeat",f.style.backgroundPosition="50% 50%",f.style.backgroundImage="url("+c.webPath.image+"dialog/dailogmove.png)");f.appendChild(b);e.appendChild(f);m.onclick=function(){hideDialog(e);return!1};b.setAttribute("id","dext_dialog_"+a);var p;try{p=DEXTTOP.document.createElement("<iframe tabkey='-1' frameborder='0' scrolling='no'>")}catch(q){p=DEXTTOP.document.createElement("iframe"),p.setAttribute("frameborder","0"),p.setAttribute("scrolling","no"),b.setAttribute("tabkey",
"-1")}p.style.display="block";p.style.position="absolute";p.style.top="0";p.style.left="0";p.style.zIndex="-1";p.style.filter="alpha(opacity = 0)";p.style.width="100%";p.style.height="100%";e.appendChild(p);p.setAttribute("id","div_dlgmoveing_iframe_"+a);DEXTTOP.document.body.appendChild(e)}},_dextTable:{_getDextTable:function(a){return document.getElementById("dext_table_pan")},_self:function(a){return document.getElementById("dext_pan_table_insert_"+a)},make:function(a){var c=this;if(null!=this._self(a)){var b=
document.createElement("table"),d=document.createElement("tbody");b.setAttribute("id","dext_table_pan");for(var e,f,g,h=1;10>=h;h++){e=document.createElement("tr");for(var m="",n=1;10>=n;n++){m="trd_"+a+"_"+h+"_"+n;f=document.createElement("td");f.style.border="1px solid #000000";f.style.cursor="pointer";g=document.createElement("div");g.style.width="12px";g.style.height="12px";g.style.fontSize="1pt";var p=document.createElement("a");p.href="javascript:void(0);";p.style.width="12px";p.style.height=
"12px";p.style.marginTop="0px";p.style.marginLeft="0px";p.style.display="inline";g.appendChild(p);f.appendChild(g);f.setAttribute("id",m);e.appendChild(f);g=function(b){return function(d){c.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(d)}}(m);m=function(b){return function(d){c.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(d)}}(m);DEXTTOP.DEXT5.util.addEvent(f,"mouseover",g);DEXTTOP.DEXT5.util.addEvent(f,"click",m);m=function(b,e){return function(f){var g="which"in f?f.which:f.keyCode,h=function(a,
c){d.childNodes[b-1+a]&&d.childNodes[b-1+a].childNodes[e-1+c]&&(d.childNodes[b-1+a].childNodes[e-1+c].getElementsByTagName("a")[0].focus(),is_next=!0,DEXTTOP.DEXT5.util.cancelEvent(f))};39==g?h(0,1):37==g?h(0,-1):40==g?h(1,0):38==g?h(-1,0):27==g&&(c.hide(a),setTimeout(function(){setFocusToBody()},1))}}(h,n);DEXTTOP.DEXT5.util.addEvent(p,"focus",g);DEXTTOP.DEXT5.util.addEvent(p,"keydown",m);f.onmousedown=function(){return!1};f.unselectable="on"}d.appendChild(e)}b.appendChild(d);this._self(a).appendChild(b)}},
show:function(a){null==this._getDextTable(a)&&this.make(a);G_SUB_DIALOG=this._self(a);var c=G_SUB_DIALOG.getElementsByTagName("a").length,b=G_SUB_DIALOG.getElementsByTagName("a")[0],d=G_SUB_DIALOG.getElementsByTagName("a")[c-1];this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();setTimeout(function(){b.focus();setFocusFirstAndLast(document,b,d)},1);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background()},
click_func:function(a,c){c=c.replace("trd_"+a+"_","");var b=c.split("_");command_InsertTablebyRowCol(a,document.getElementById("dext5_design_"+a),b[0],b[1]);this.hide(a)},mouseover_func:function(a,c){c=c.replace("trd_"+a+"_","");for(var b=c.split("_"),d="",e=1;10>=e;e++)for(var f=1;10>=f;f++)d="trd_"+a+"_"+e+"_"+f,document.getElementById(d).style.backgroundColor="#ffffff";for(e=1;e<=b[0];e++)for(f=1;f<=b[1];f++)d="trd_"+a+"_"+e+"_"+f,document.getElementById(d).style.backgroundColor="#0697f7";document.getElementById("dext_table_rc_"+
a).innerHTML=b[0]+" * "+b[1]},reset:function(a){for(var c="",b=1;10>=b;b++)for(var d=1;10>=d;d++)c="trd_"+a+"_"+b+"_"+d,document.getElementById(c).style.backgroundColor="#ffffff";document.getElementById("dext_table_rc_"+a).innerHTML="0 * 0"}},_dextFontFamily:{_fontFamily:{},_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(a){return document.getElementById("dext_pan_font_family_"+a)},make:function(a,c,b){var d=DEXTTOP.document.getElementById("dext_fontfamily_iframe_"+
a);d&&d.parentNode.removeChild(d);null!=this._self(a)&&(this._editor_config=b,this._set_font_family(a,c))},_set_font_family:function(a,c){var b=this;if(null!=this._self(a)){var d,e;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.font_family;this._iframe.width="180px";this._iframe_id="dext_fontfamily_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";this._iframe.style.border="2px solid #cccccc";this._iframe.style.position="absolute";
this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.overflow="";this._iframe.style.overflowX="";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);d="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";d=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(d)+"}())":"";this._iframe.src=d;this._iframe_doc=this._iframe.contentWindow.document;d="<html><head><title>"+dext5_lang.font_family.frame_title+'</title></head><body  style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>';
getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(d);this._iframe_doc.close();this._fontFamily[a]=[];this._default_value=DEXTTOP.G_CURREDITOR._setting.font_family;0==this._default_value.length&&(this._default_value="gulim");this._fontFamily[a].push(this._default_value);if(0<DEXTTOP.G_CURREDITOR._config.fontFamilyList.length)this._fontFamily[a]=this._fontFamily[a].concat(DEXTTOP.G_CURREDITOR._config.fontFamilyList);else for(var f=DEXTTOP.DEXT5.util.xml.count(c,
"font"),g=0;g<f;g++)_font_family=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(c,"font",g),this._fontFamily[a].push(_font_family);f=this._fontFamily[a].length;for(g=0;g<f;g++){_font_family=this._fontFamily[a][g];var h="ff_"+a+"_"+g;d=this._iframe_doc.createElement("div");d.setAttribute("id",h);d.style.fontSize="14px";d.style.whiteSpace="nowrap";d.style.margin="3px";d.style.padding="3px";d.style.cursor="pointer";d.style.width="100%";e=this._iframe_doc.createElement("span");var m=_font_family;0==g&&(m=dext5_lang.icon.font_family);
"textContent"in e?e.textContent=m:e.innerText=m;e.style.fontFamily=_font_family;e.onmousedown=function(){return!1};e.unselectable="on";_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.appendChild(e);_a_tag.style.textDecoration="none";_a_tag.style.color="black";d.appendChild(_a_tag);e=function(c){return function(d){b.mouseover_func(a,c);DEXTTOP.DEXT5.util.stopEvent(d)}}(h);h=function(c){return function(d){b.click_func(a,c);DEXTTOP.DEXT5.util.stopEvent(d)}}(g);DEXTTOP.DEXT5.util.addEvent(d,
"mouseover",e);DEXTTOP.DEXT5.util.addEvent(d,"click",h);d.onmousedown=function(){return!1};d.unselectable="on";this._iframe_doc.body.appendChild(d)}}},mouseover_func:function(a,c){this.reset(a);this._iframe_doc.getElementById(c).style.backgroundColor="#e7e7e7"},click_func:function(a,c){var b=this.get_value(a,c),d=b;d==this._default_value&&(d=dext5_lang.icon.font_family);"0"!=DEXTTOP.G_CURREDITOR._setting.show_font_real&&(d=b);document.getElementById("ue_"+a+"font_family").innerHTML="<span>"+d+"</span>";
command_fontfamily(a,document.getElementById("dext5_design_"+a),b);this.hide(a)},show:function(a){if(null==this._iframe){var c=DEXTTOP.DEXT5.util.xml.getNode(DEXTTOP.G_CURREDITOR._configXml,"font_family");this.make(a,c,DEXTTOP.G_CURREDITOR._config)}G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),b=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+
a+"font_family")),d=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(d=-2);var e=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);this._iframe.style.left=b.left+c[0]+e.left+"px";this._iframe.style.top=b.bottom+c[1]+e.top+d+"px";this._iframe.style.display="";c=this._iframe.contentWindow;b=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&c.focus();"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&b.getElementsByTagName("A")[0].focus();var f=this;DEXTTOP.DEXT5.util.addEvent(b,
"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(f.hide(a),setTimeout(function(){setFocusToBody()},1))});setFocusFirstAndLast(b,b.getElementsByTagName("A")[0])},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"},reset:function(a){for(var c=this._iframe_doc.getElementsByTagName("div").length,b,d=0;d<c;d++)b="ff_"+a+"_"+d,this._iframe_doc.getElementById(b).style.backgroundColor=""},get_value:function(a,
c){return this._fontFamily[a][c]}},_dextFontSize:{_fontSize:{},_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(a){return document.getElementById("dext_pan_font_size_"+a)},make:function(a,c,b){var d=DEXTTOP.document.getElementById("dext_fontsize_iframe_"+a);d&&d.parentNode.removeChild(d);var e=this;if(null!=e._self(a)){e._editor_config=b;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.font_size;this._iframe.width=
"150px";this._iframe.height="270px";this._iframe_id="dext_fontsize_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";this._iframe.style.border="2px solid #cccccc";this._iframe.style.position="absolute";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.overflow="";this._iframe.style.overflowX="";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);d="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";d=
DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(d)+"}())":"";this._iframe.src=d;this._iframe_doc=this._iframe.contentWindow.document;d="<html><head><title>"+dext5_lang.font_size.frame_title+'</title></head><body  style="margin:0px; padding:0px; " oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(d);this._iframe_doc.close();this._fontSize[a]=[];this._default_value=DEXTTOP.G_CURREDITOR._setting.font_size;
0==this._default_value.length&&(this._default_value="12pt");this._fontSize[a].push(this._default_value);if(0<DEXTTOP.G_CURREDITOR._config.fontSizeList.length)this._fontSize[a]=this._fontSize[a].concat(DEXTTOP.G_CURREDITOR._config.fontSizeList);else for(var d=DEXTTOP.DEXT5.util.xml.count(c,"size"),f=0;f<d;f++)_font_size=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(c,"size",f),this._fontSize[a].push(_font_size);d=this._fontSize[a].length;for(f=0;f<d;f++){_font_size=this._fontSize[a][f];c="fs_"+a+"_"+f;_item=
this._iframe_doc.createElement("div");_item.setAttribute("id",c);_item.style.whiteSpace="nowrap";_item.style.margin="3px";_item.style.padding="5px";_item.style.cursor="pointer";_item.style.width="100%";var g="",g=-1<_font_size.indexOf("pt")?_font_size.replace("pt","")+" pt":-1<_font_size.indexOf("px")?_font_size.replace("px","")+" px":_font_size;0==f&&(g=dext5_lang.icon.font_size);1==b.style.isFontSizeUse?_item.style.fontSize=_font_size:(_item.style.fontSize="10 pt",g="        "+_font_size);_a_tag=
this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.innerHTML=g;_a_tag.style.textDecoration="none";_a_tag.style.color="black";_item.appendChild(_a_tag);c=function(b){return function(c){e.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(c);g=function(b){return function(c){e.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(f);DEXTTOP.DEXT5.util.addEvent(_item,"mouseover",c);DEXTTOP.DEXT5.util.addEvent(_item,"click",g);_item.onmousedown=function(){return!1};_item.unselectable=
"on";this._iframe_doc.body.appendChild(_item)}}},mouseover_func:function(a,c){this.reset(a);this._iframe_doc.getElementById(c).style.backgroundColor="#e7e7e7"},click_func:function(a,c){var b=this.get_value(a,c),d=b;d==this._default_value&&(d=dext5_lang.icon.font_size);"0"!=DEXTTOP.G_CURREDITOR._setting.show_font_real&&(d=b);document.getElementById("ue_"+a+"font_size").innerHTML="<span>"+d+"</span>";command_fontsize(a,document.getElementById("dext5_design_"+a),b);this.hide(a)},show:function(a){if(null==
this._iframe){var c=DEXTTOP.DEXT5.util.xml.getNode(DEXTTOP.G_CURREDITOR._configXml,"font_size");this.make(a,c,DEXTTOP.G_CURREDITOR._config)}G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),b=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);var d=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+
a+"font_size")),e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=-2);this._iframe.style.left=d.left+c[0]+b.left+"px";this._iframe.style.top=d.bottom+c[1]+b.top+e+"px";this._iframe.style.display="";c=this._iframe.contentWindow;b=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&c.focus();"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&b.getElementsByTagName("A")[0].focus();var f=this;DEXTTOP.DEXT5.util.addEvent(b,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(f.hide(a),setTimeout(function(){setFocusToBody()},
1))});setFocusFirstAndLast(b,b.getElementsByTagName("A")[0])},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"},reset:function(a){for(var c=this._iframe_doc.getElementsByTagName("div").length,b,d=0;d<c;d++)b="fs_"+a+"_"+d,this._iframe_doc.getElementById(b).style.backgroundColor=""},get_value:function(a,c){return this._fontSize[a][c]}},_dextFormatting:{_format:G_FORMATTING,_iframe:null,_iframe_id:"",_iframe_doc:null,
_self:function(a){return document.getElementById("dext_pan_formatting_"+a)},init:function(a){document.getElementById("ue_"+a+"formatting")&&(document.getElementById("ue_"+a+"formatting").innerHTML="<span>"+dext5_lang.icon.formatting+"</span>")},make:function(a,c,b){(c=DEXTTOP.document.getElementById("dext_formatting_iframe_"+a))&&c.parentNode.removeChild(c);var d=this;if(null!=d._self(a)){0<DEXTTOP.G_CURREDITOR._config.formattingList.length&&(d._format=DEXTTOP.G_CURREDITOR._config.formattingList);
c=d._format.length;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.formatting;this._iframe_id="dext_formatting_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.width="230px";this._iframe.height="200px";this._iframe.style.display="none";this._iframe.style.border="2px solid #cccccc";this._iframe.style.position="absolute";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);b="document.open();"+(isCustomDomain(document)?
'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";this._iframe.src=b;this._iframe_doc=this._iframe.contentWindow.document;b="<html><head><title>"+dext5_lang.formatting.frame_title+'</title></head><body  style="margin:0px; padding:0px; " oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(b);this._iframe_doc.close();
for(var e=null,f=0;f<c;f++){var g="fs_"+a+"_"+f;b=this._iframe_doc.createElement("div");b.setAttribute("id",g);b.style.whiteSpace="nowrap";b.style.width="100%";b.style.cursor="pointer";var h="("+d._format[f]+") Heading";""==d._format[f]?(e=this._iframe_doc.createElement("span"),h=dext5_lang.icon.formatting):e=this._iframe_doc.createElement(d._format[f]);e.style.fontFamily="Dotum Arial";_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.innerHTML=h;_a_tag.style.textDecoration=
"none";_a_tag.style.color="black";e.appendChild(_a_tag);b.innerHTML=e.outerHTML;e=function(b){return function(c){d.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(g);g=function(b){return function(c){d.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(f);DEXTTOP.DEXT5.util.addEvent(b,"mouseover",e);DEXTTOP.DEXT5.util.addEvent(b,"click",g);b.onmousedown=function(){return!1};b.unselectable="on";this._iframe_doc.body.appendChild(b)}document.getElementById("ue_"+a+"formatting").innerHTML="<span>"+
dext5_lang.icon.formatting+"</span>"}},mouseover_func:function(a,c){this.reset(a);this._iframe_doc.getElementById(c).style.backgroundColor="#e7e7e7"},click_func:function(a,c){var b=this.get_value(a,c),d=b;""==d&&(d=dext5_lang.icon.formatting);document.getElementById("ue_"+a+"formatting").innerHTML="<span>"+d+"</span>";command_formatting(a,document.getElementById("dext5_design_"+a),b);this.hide(a)},show:function(a){if(null==this._iframe){var c=DEXTTOP.DEXT5.util.xml.getNode(DEXTTOP.G_CURREDITOR._configXml,
"formatting");this.make(a,c,DEXTTOP.G_CURREDITOR._config)}G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),b=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);var d=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+a+"formatting")),e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=
-2);this._iframe.style.left=d.left+c[0]+b.left+"px";this._iframe.style.top=d.bottom+c[1]+b.top+e+"px";this._iframe.style.display="";c=this._iframe.contentWindow;b=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&c.focus();b.getElementsByTagName("A")[0].focus();var f=this;DEXTTOP.DEXT5.util.addEvent(b,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(f.hide(a),setTimeout(function(){setFocusToBody()},1))});setFocusFirstAndLast(b,b.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=
!0},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"},reset:function(a){for(var c=this._iframe_doc.getElementsByTagName("div").length,b,d=0;d<c;d++)b="fs_"+a+"_"+d,this._iframe_doc.getElementById(b).style.backgroundColor=""},get_value:function(a,c){return this._format[c]}},_dextLineHeight:{_iframe:null,_iframe_id:"",_iframe_doc:null,_line_height_item:" 100% 120% 150% 180% 200% 250% 300%".split(" "),
_self:function(a){return document.getElementById("dext_pan_line_height_"+a)},init:function(a){document.getElementById("ue_"+a+"line_height")&&("1"==DEXTTOP.G_CURREDITOR._setting.show_font_real?document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+DEXTTOP.G_CURREDITOR._setting.line_height+"</span>":document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+dext5_lang.icon.line_height+"</span>")},make:function(a){var c=DEXTTOP.document.getElementById("dext_lineheight_iframe_"+a);
c&&c.parentNode.removeChild(c);var b=this;if(null!=this._self(a)){var d;0<DEXTTOP.G_CURREDITOR._config.lineHeightList.length&&(b._line_height_item=DEXTTOP.G_CURREDITOR._config.lineHeightList);c=b._line_height_item.length;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.line_height;this._iframe.width="75px";this._iframe.height="200px";this._iframe_id="dext_lineheight_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";this._iframe.style.border=
"2px solid #cccccc";this._iframe.style.position="absolute";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.overflow="";this._iframe.style.overflowX="";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);d="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";d=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(d)+"}())":"";this._iframe.src=d;this._iframe_doc=this._iframe.contentWindow.document;d="<html><head><title>"+
dext5_lang.line_height.frame_title+'</title></head><body  style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(d);this._iframe_doc.close();for(var e=0;e<c;e++){var f="",f="lh_"+a+"_"+e;d=this._iframe_doc.createElement("div");d.setAttribute("id",f);d.style.whiteSpace="nowrap";d.style.fontSize="14px";d.style.margin="3px";d.style.padding="3px";d.style.cursor="pointer";_a_tag=this._iframe_doc.createElement("a");
_a_tag.href="javascript:void(0);";_a_tag.style.textDecoration="none";_a_tag.style.color="black";_a_tag.innerHTML=""==b._line_height_item[e]?dext5_lang.icon.line_height:b._line_height_item[e];d.appendChild(_a_tag);var f=function(c){return function(d){b.mouseover_func(a,c);DEXTTOP.DEXT5.util.stopEvent(d)}}(f),g=function(c){return function(d){b.click_func(a,c);DEXTTOP.DEXT5.util.stopEvent(d)}}(e);DEXTTOP.DEXT5.util.addEvent(d,"mouseover",f);DEXTTOP.DEXT5.util.addEvent(d,"click",g);d.onmousedown=function(){return!1};
d.unselectable="on";this._iframe_doc.body.appendChild(d)}"1"==DEXTTOP.G_CURREDITOR._setting.show_font_real?document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+DEXTTOP.G_CURREDITOR._setting.line_height+"</span>":document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+dext5_lang.icon.line_height+"</span>"}},mouseover_func:function(a,c){this.reset(a);this._iframe_doc.getElementById(c).style.backgroundColor="#e7e7e7"},click_func:function(a,c){var b=this.get_value(c),d=b;""==d&&
(d=dext5_lang.icon.line_height);document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+d+"</span>";""==b&&(b=DEXTTOP.G_CURREDITOR._setting.line_height);command_lineHeight(a,document.getElementById("dext5_design_"+a),b);this.hide(a)},show:function(a){null==this._iframe&&this.make(a);G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),b=getClientRect(_iframeWin.parent.frameElement);
getClientRect(_iframeWin.frameElement);var d=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+a+"line_height")),e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=-2);this._iframe.style.left=d.left+c[0]+b.left+"px";this._iframe.style.top=d.bottom+c[1]+b.top+e+"px";this._iframe.style.display="";c=this._iframe.contentWindow;b=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&c.focus();"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&b.getElementsByTagName("A")[0].focus();
var f=this;DEXTTOP.DEXT5.util.addEvent(b,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(f.hide(a),setTimeout(function(){setFocusToBody()},1))});setFocusFirstAndLast(b,b.getElementsByTagName("A")[0])},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"},reset:function(a){for(var c,b=this._line_height_item.length,d=0;d<b;d++)c="lh_"+a+"_"+d,this._iframe_doc.getElementById(c).style.backgroundColor=
""},get_value:function(a){return this._line_height_item[a]}},_dextLetterSpacing:{_letterSpacing:{},_iframe:null,_iframe_id:"",_iframe_doc:null,_default_value:"",_editor_config:null,_self:function(a){return document.getElementById("dext_pan_letter_spacing_"+a)},make:function(a,c,b){var d=this;if(null!=d._self(a)){d._editor_config=b;this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.letter_spacing;this._iframe.width="85px";this._iframe.height="270px";this._iframe_id=
"dext_letterspacing_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";this._iframe.style.border="2px solid #cccccc";this._iframe.style.position="absolute";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.overflow="";this._iframe.style.overflowX="";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+
encodeURIComponent(b)+"}())":"";this._iframe.src=b;this._iframe_doc=this._iframe.contentWindow.document;b="<html><head><title>"+dext5_lang.letter_spacing.frame_title+'</title></head><body style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>';getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(b);this._iframe_doc.close();this._letterSpacing[a]=[];this._default_value="";this._letterSpacing[a].push(this._default_value);b=DEXTTOP.DEXT5.util.xml.count(c,
"spacing");for(var e=0;e<b;e++)_letter_spacing=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(c,"spacing",e),this._letterSpacing[a].push(_letter_spacing);b=this._letterSpacing[a].length;for(e=0;e<b;e++){_letter_spacing=this._letterSpacing[a][e];c="ls_"+a+"_"+e;_item=this._iframe_doc.createElement("div");_item.setAttribute("id",c);_item.style.whiteSpace="nowrap";_item.style.fontSize="14px";_item.style.margin="3px";_item.style.padding="3px";_item.style.cursor="pointer";var f="",f=0==e?dext5_lang.icon.letter_spacing:
_letter_spacing;_a_tag=this._iframe_doc.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.innerHTML=f;_a_tag.style.textDecoration="none";_a_tag.style.color="black";_item.appendChild(_a_tag);c=function(b){return function(c){d.mouseover_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(c);f=function(b){return function(c){d.click_func(a,b);DEXTTOP.DEXT5.util.stopEvent(c)}}(e);DEXTTOP.DEXT5.util.addEvent(_item,"mouseover",c);DEXTTOP.DEXT5.util.addEvent(_item,"click",f);_item.onmousedown=function(){return!1};
_item.unselectable="on";this._iframe_doc.body.appendChild(_item)}}},mouseover_func:function(a,c){this.reset(a);this._iframe_doc.getElementById(c).style.backgroundColor="#e7e7e7"},click_func:function(a,c){var b=this.get_value(a,c),d=b;d==this._default_value&&(d=dext5_lang.icon.letter_spacing);document.getElementById("ue_"+a+"letter_spacing").innerHTML="<span>"+d+"</span>";command_letterSpacing(a,DEXTTOP.G_CURREDITOR,b);this.hide(a)},show:function(a){if(null==this._iframe){var c=DEXTTOP.DEXT5.util.xml.getNode(DEXTTOP.G_CURREDITOR._configXml,
"letter_spacing");this.make(a,c,DEXTTOP.G_CURREDITOR._config)}G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),b=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);var d=getClientRect(_iframeWin.parent.frameElement.contentWindow.document.getElementById("ue_"+a+"letter_spacing")),e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&
(e=-2);this._iframe.style.left=d.left+c[0]+b.left+"px";this._iframe.style.top=d.bottom+c[1]+b.top+e+"px";this._iframe.style.display="";c=this._iframe.contentWindow;b=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&c.focus();"CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code&&b.getElementsByTagName("A")[0].focus();var f=this;DEXTTOP.DEXT5.util.addEvent(b,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(f.hide(a),setTimeout(function(){setFocusToBody()},1))});setFocusFirstAndLast(b,
b.getElementsByTagName("A")[0])},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"},reset:function(a){for(var c=this._iframe_doc.getElementsByTagName("div").length,b,d=0;d<c;d++)b="ls_"+a+"_"+d,this._iframe_doc.getElementById(b).style.backgroundColor=""},get_value:function(a,c){return this._letterSpacing[a][c]}},_dextWorkProcessing:{_iframe:null,_iframe_id:"",_self:function(a){return document.getElementById("ue_editor_holder_"+
a)},make:function(a,c){if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe.title="dext5 work processing...";var b=this._self(a);this._iframe.width=b.clientWidth-10+"px";this._iframe.height="200px";this._iframe_id="dext_workprocessing_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";this._iframe.style.border="0px solid #cccccc";this._iframe.style.position="absolute";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);
b="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+"}())":"";this._iframe.src=b;this._iframe_doc=this._iframe.contentWindow.document;b="<html><head><title>"+this._iframe.title+'</title></head><body  style="margin:0px; padding:0px;" oncontextmenu="return false"><div style="text-align:center;"></div></body></html>';getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html",
"replace");this._iframe_doc.write(b);this._iframe_doc.close()}},show:function(a){setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);a={};a=getWindowScrollPos(DEXTTOP.DEXTWIN);var c=getClientRect(G_SUB_DIALOG),b=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);this._iframe.style.left=c.left+a[0]+b.left+"px";this._iframe.style.top=c.top+a[1]+b.top+50+"px";this._iframe.style.display=""},hide:function(a){dialogCancel();
this._iframe.style.display="none"}},_dextListNumber:{_iframe:null,_iframe_id:"",_line_number_item:"list_decimal list_decimal_leading_zero list_lower_alpha list_lower_greek list_lower_roman list_upper_alpha list_upper_roman".split(" "),_self:function(a){return document.getElementById("dext_pan_detail_list_number_"+a)},make:function(a){var c=DEXTTOP.document.getElementById("dext_detail_list_number_iframe_"+a);c&&c.parentNode.removeChild(c);var b=this;if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();
this._iframe_id="dext_detail_list_number_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position="absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency="true";a=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)a=2;this._iframe.style.width=
180+a+"px";a=this._line_number_item.length;7==DEXTTOP.DEXT5.browser.ieVersion&&(a-=2);this._iframe.style.height=24*a+2+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);a="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";a=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(a)+"}())":"";this._iframe.src=a;this._iframe_doc=this._iframe.contentWindow.document;c="";c=DEXTTOP.DEXT5.isRelease?
DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev;a="<html><head>"+('<link rel="stylesheet" type="text/css" href="'+c+"editor_context.css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">');a+='<link rel="stylesheet" type="text/css" href="'+c+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';a+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">';
a+='<div onselectstart="return false;" style="width:100%; height:100%" id="line_number_iframe_bg">';a+='<div class="DEXT_fiVe_ED_popup">';a+='<div class="DEXT_fiVe_EDP">';a+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';a+='<dl id="div_line_number_main"><dt>number_group</dt></dl>';a+="</div>";a+="</div>";a+="</div>";a+="</div>";a+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(a);this._iframe_doc.close();
a=this._iframe_doc.getElementById("div_line_number_main");for(var c=b._line_number_item.length,d=0;d<c;d++){var e=b._line_number_item[d],f=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<f;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==e)return;if(7!=DEXTTOP.DEXT5.browser.ieVersion||"list_decimal_leading_zero"!=e&&"list_lower_greek"!=e){f=this._iframe_doc.createElement("dd");f.id=e;var g=b.getImageIconUrl(e),h=b.getText(e),m=this._iframe_doc.createElement("div"),n=this._iframe_doc.createElement("div"),
p=this._iframe_doc.createElement("span");0<g.length&&(p.className=e,m.appendChild(p));"textContent"in n?n.textContent=h:n.innerText=h;m.className="s_left";n.className="s_right";var q=this._iframe_doc.createElement("a");q.href="javascript:void(0);";q.title=h;q.style.textDecoration="none";q.style.color="#545454";q.style.cursor="pointer";q.appendChild(m);q.appendChild(n);f.appendChild(q);var g=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(q,"focus",u);DEXTTOP.DEXT5.util.removeEvent(q,
"blur",t);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(f),h=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(q,"focus",u);DEXTTOP.DEXT5.util.addEvent(q,"blur",t);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(f),u=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(f),t=function(a){return function(b){"on_mouseover"==a.className&&(a.className=
"",DEXTTOP.DEXT5.util.stopEvent(b))}}(f),b=this,m=function(a){return function(c){_dext_editor._dextCommands(_dext_editor.ID,a.id);b.hide(_dext_editor.ID);DEXTTOP.DEXT5.util.stopEvent(c)}}(f);DEXTTOP.DEXT5.util.addEvent(f,"mouseover",g);DEXTTOP.DEXT5.util.addEvent(f,"mouseout",h);DEXTTOP.DEXT5.util.addEvent(f,"click",m);DEXTTOP.DEXT5.util.addEvent(q,"focus",u);DEXTTOP.DEXT5.util.addEvent(q,"blur",t);0<e.length&&(f.id=e);f.unselectable="on";a.appendChild(f)}}}},getImageIconUrl:function(a){var c="";
""!=a&&(c=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif");return c},getText:function(a){var c="";""!=a&&(c=dext5_lang.icon[a]);return c},show:function(a){null==this._iframe&&this.make(a);setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);DEXT5_EDITOR.prototype.dialog._click_background();var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),b=getClientRect(G_SUB_DIALOG),d=getClientRect(_iframeWin.parent.frameElement),
e=getClientRect(_iframeWin.frameElement),f=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)f+=2;var g=0;b.left+f>=e.right&&(g=b.left+f-e.right+30);e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=-15);f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(f=6);this._iframe.style.left=b.left+c[0]+d.left+e-g+"px";this._iframe.style.top=b.bottom+c[1]+d.top+f+"px";this._iframe.style.display="";c=this._iframe.contentWindow;b=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&c.focus();
b.getElementsByTagName("A")[0].focus();var h=this;DEXTTOP.DEXT5.util.addEvent(b,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(h.hide(a),setTimeout(function(){setFocusToBody()},1))});setFocusFirstAndLast(b,b.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"}},_dextListBullets:{_iframe:null,_iframe_id:"",_line_bullets_item:["list_disc","list_circle","list_square"],
_self:function(a){return document.getElementById("dext_pan_detail_list_bullets_"+a)},make:function(a){var c=DEXTTOP.document.getElementById("dext_detail_list_bullets_iframe_"+a);c&&c.parentNode.removeChild(c);var b=this;if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe_id="dext_detail_list_bullets_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position=
"absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency="true";a=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)a=2;this._iframe.style.width=180+a+"px";this._iframe.style.height=24*this._line_bullets_item.length+2+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);a="document.open();"+(isCustomDomain(document)?'document.domain="'+
document.domain+'";':"")+" document.close();";a=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(a)+"}())":"";this._iframe.src=a;this._iframe_doc=this._iframe.contentWindow.document;c="";c=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev;a="<html><head>"+('<link rel="stylesheet" type="text/css" href="'+c+"editor_context.css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">');a+='<link rel="stylesheet" type="text/css" href="'+
c+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';a+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">';a+='<div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">';a+='<div class="DEXT_fiVe_ED_popup">';a+='<div class="DEXT_fiVe_EDP">';a+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';a+='<dl id="div_line_bullets_main"><dt>bullets_group</dt></dl>';
a+="</div>";a+="</div>";a+="</div>";a+="</div>";a+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(a);this._iframe_doc.close();a=this._iframe_doc.getElementById("div_line_bullets_main");for(var c=b._line_bullets_item.length,d=0;d<c;d++){var e=b._line_bullets_item[d],f=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<f;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==e)return;f=this._iframe_doc.createElement("dd");f.id=e;var g=b.getImageIconUrl(e),
h=b.getText(e),m=this._iframe_doc.createElement("div"),n=this._iframe_doc.createElement("div"),p=this._iframe_doc.createElement("span");0<g.length&&(p.className=e,m.appendChild(p));"textContent"in n?n.textContent=h:n.innerText=h;m.className="s_left";n.className="s_right";var q=this._iframe_doc.createElement("a");q.href="javascript:void(0);";q.title=h;q.style.textDecoration="none";q.style.color="#545454";q.style.cursor="pointer";q.appendChild(m);q.appendChild(n);f.appendChild(q);var g=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(q,
"focus",u);DEXTTOP.DEXT5.util.removeEvent(q,"blur",t);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(f),h=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(q,"focus",u);DEXTTOP.DEXT5.util.addEvent(q,"blur",t);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(f),u=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(f),t=function(a){return function(b){"on_mouseover"==
a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(f),b=this,m=function(a){return function(c){_dext_editor._dextCommands(_dext_editor.ID,a.id);b.hide();DEXTTOP.DEXT5.util.stopEvent(c)}}(f);DEXTTOP.DEXT5.util.addEvent(f,"mouseover",g);DEXTTOP.DEXT5.util.addEvent(f,"mouseout",h);DEXTTOP.DEXT5.util.addEvent(f,"click",m);DEXTTOP.DEXT5.util.addEvent(q,"focus",u);DEXTTOP.DEXT5.util.addEvent(q,"blur",t);0<e.length&&(f.id=e);f.unselectable="on";a.appendChild(f)}}},getImageIconUrl:function(a){var c=
"";""!=a&&(c=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif");return c},getText:function(a){var c="";""!=a&&(c=dext5_lang.icon[a]);return c},show:function(a){null==this._iframe&&this.make(a);setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);DEXT5_EDITOR.prototype.dialog._click_background();var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),b=getClientRect(G_SUB_DIALOG),d=getClientRect(_iframeWin.parent.frameElement),
e=getClientRect(_iframeWin.frameElement),f=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)f+=2;var g=0;b.left+f>=e.right&&(g=b.left+f-e.right+30);e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=-15);f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(f=6);this._iframe.style.left=b.left+c[0]+d.left+e-g+"px";this._iframe.style.top=b.bottom+c[1]+d.top+f+"px";this._iframe.style.display="";c=this._iframe.contentWindow;b=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&c.focus();
b.getElementsByTagName("A")[0].focus();var h=this;DEXTTOP.DEXT5.util.addEvent(b,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(h.hide(a),setTimeout(function(){setFocusToBody()},1))});setFocusFirstAndLast(b,b.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"}},_dextListAligns:{_iframe:null,_iframe_id:"",_line_align_item:["align_left","align_center","align_right","align_full"],
_self:function(a){return document.getElementById("dext_span_align_group_detail_"+a)},make:function(a){var c=DEXTTOP.document.getElementById("dext_detail_align_group_iframe_"+a);c&&c.parentNode.removeChild(c);var b=this;if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe_id="dext_detail_align_group_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position=
"absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency="true";a=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)a=2;this._iframe.style.width=180+a+"px";this._iframe.style.height=24*this._line_align_item.length+2+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);a="document.open();"+(isCustomDomain(document)?'document.domain="'+
document.domain+'";':"")+" document.close();";a=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(a)+"}())":"";this._iframe.src=a;this._iframe_doc=this._iframe.contentWindow.document;a="";a=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev;c="<html><head>"+('<link rel="stylesheet" type="text/css" href="'+a+"editor_context.css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">');c+='<link rel="stylesheet" type="text/css" href="'+
a+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';c+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">';c+='<div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">';c+='<div class="DEXT_fiVe_ED_popup">';c+='<div class="DEXT_fiVe_EDP">';c+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';c+='<dl id="div_align_group_main"><dt>align_group</dt></dl>';
c+="</div>";c+="</div>";c+="</div>";c+="</div>";c+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(c);this._iframe_doc.close();a=this._iframe_doc.getElementById("div_align_group_main");for(var c=b._line_align_item.length,d=0;d<c;d++){var e=b._line_align_item[d],f=DEXTTOP.G_CURREDITOR.remove_item.length;for(r=0;r<f;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==e)return;f=this._iframe_doc.createElement("dd");f.id=e;var g=b.getImageIconUrl(e),
h=b.getText(e),m=this._iframe_doc.createElement("div"),n=this._iframe_doc.createElement("div"),p=this._iframe_doc.createElement("span");0<g.length&&(p.className=e,m.appendChild(p));"textContent"in n?n.textContent=h:n.innerText=h;m.className="s_left";n.className="s_right";var q=this._iframe_doc.createElement("a");q.href="javascript:void(0);";q.title=h;q.style.textDecoration="none";q.style.color="#545454";q.style.cursor="pointer";q.appendChild(m);q.appendChild(n);f.appendChild(q);var g=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(q,
"focus",u);DEXTTOP.DEXT5.util.removeEvent(q,"blur",t);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(f),h=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(q,"focus",u);DEXTTOP.DEXT5.util.addEvent(q,"blur",t);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(f),u=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(f),t=function(a){return function(b){"on_mouseover"==
a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(f),b=this,m=function(a){return function(c){_dext_editor._dextCommands(_dext_editor.ID,a.id);b.hide();DEXTTOP.DEXT5.util.stopEvent(c)}}(f);DEXTTOP.DEXT5.util.addEvent(f,"mouseover",g);DEXTTOP.DEXT5.util.addEvent(f,"mouseout",h);DEXTTOP.DEXT5.util.addEvent(f,"click",m);DEXTTOP.DEXT5.util.addEvent(q,"focus",u);DEXTTOP.DEXT5.util.addEvent(q,"blur",t);0<e.length&&(f.id=e);f.unselectable="on";a.appendChild(f)}}},getImageIconUrl:function(a){var c=
"";""!=a&&(c=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif");return c},getText:function(a){var c="";""!=a&&(c=dext5_lang.icon[a]);return c},show:function(a){null==this._iframe&&this.make(a);setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);DEXT5_EDITOR.prototype.dialog._click_background();var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),b=getClientRect(G_SUB_DIALOG),d=getClientRect(_iframeWin.parent.frameElement),
e=getClientRect(_iframeWin.frameElement),f=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)f+=2;var g=0;b.left+f>=e.right&&(g=b.left+f-e.right+30);e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=-15);f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(f=6);this._iframe.style.left=b.left+c[0]+d.left+e-g+"px";this._iframe.style.top=b.bottom+c[1]+d.top+f+"px";this._iframe.style.display="";c=this._iframe.contentWindow;b=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&c.focus();
b.getElementsByTagName("A")[0].focus();var h=this;DEXTTOP.DEXT5.util.addEvent(b,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(h.hide(a),setTimeout(function(){setFocusToBody()},1))});setFocusFirstAndLast(b,b.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"}},_dextListTables:{_iframe:null,_iframe_id:"",_table_item:"insert_row_down delete_column insert_column_right table_delete merge_cell split_cell table_same_width table_same_height".split(" "),
_self:function(a){return document.getElementById("dext_span_table_group_detail_"+a)},make:function(a){var c=DEXTTOP.document.getElementById("dext_detail_table_group_iframe_"+a);c&&c.parentNode.removeChild(c);var b=this;if(null!=this._self(a)){this._iframe=DEXTTOP.DEXT5.util.makeIframe();this._iframe_id="dext_detail_table_group_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.margin="0px";this._iframe.style.padding="0px";this._iframe.style.zIndex=G_MAIN_ZINDEX+2E3+"";this._iframe.style.position=
"absolute";this._iframe.scrolling="no";this._iframe.style.overflow="auto";this._iframe.style.overflowX="hidden";this._iframe.style.display="none";this._iframe.allowTransparency="true";a=0;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)a=2;this._iframe.style.width=180+a+"px";this._iframe.style.height=24*this._table_item.length+2+"px";this._iframe.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(this._iframe);a="document.open();"+(isCustomDomain(document)?'document.domain="'+
document.domain+'";':"")+" document.close();";a=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(a)+"}())":"";this._iframe.src=a;this._iframe_doc=this._iframe.contentWindow.document;a="";a=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev;c="<html><head>"+('<link rel="stylesheet" type="text/css" href="'+a+"editor_context.css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">');c+='<link rel="stylesheet" type="text/css" href="'+
a+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';c+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">';c+='<div onselectstart="return false;" style="width:100%; height:100%" id="line_bullets_iframe_bg">';c+='<div class="DEXT_fiVe_ED_popup">';c+='<div class="DEXT_fiVe_EDP">';c+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';c+='<dl id="div_table_group_main"><dt>table_group</dt></dl>';
c+="</div>";c+="</div>";c+="</div>";c+="</div>";c+="</body></html>";getDocWindow(this._iframe_doc);this._iframe_doc.open("text/html","replace");this._iframe_doc.write(c);this._iframe_doc.close();a=this._iframe_doc.getElementById("div_table_group_main");for(var c=b._table_item.length,d=DEXTTOP.G_CURREDITOR.remove_item.length,e=0;e<c;e++){var f=b._table_item[e];for(r=0;r<d;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==f)return;var g=this._iframe_doc.createElement("dd");g.id=f;var h=b.getImageIconUrl(f),
m=b.getText(f),n=this._iframe_doc.createElement("div"),p=this._iframe_doc.createElement("div"),q=this._iframe_doc.createElement("span");0<h.length&&(q.className=f,n.appendChild(q));"textContent"in p?p.textContent=m:p.innerText=m;n.className="s_left";p.className="s_right";var u=this._iframe_doc.createElement("a");u.href="javascript:void(0);";u.title=m;u.style.textDecoration="none";u.style.color="#545454";u.style.cursor="pointer";u.appendChild(n);u.appendChild(p);g.appendChild(u);var h=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(u,
"focus",t);DEXTTOP.DEXT5.util.removeEvent(u,"blur",v);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),m=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(u,"focus",t);DEXTTOP.DEXT5.util.addEvent(u,"blur",v);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),t=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),v=function(a){return function(b){"on_mouseover"==
a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(g),b=this,n=function(a){return function(c){"item_disabled"!=a.className&&(_dext_editor._dextCommands(_dext_editor.ID,a.id),b.hide(),DEXTTOP.DEXT5.util.stopEvent(c))}}(g);DEXTTOP.DEXT5.util.addEvent(g,"mouseover",h);DEXTTOP.DEXT5.util.addEvent(g,"mouseout",m);DEXTTOP.DEXT5.util.addEvent(g,"click",n);DEXTTOP.DEXT5.util.addEvent(u,"focus",t);DEXTTOP.DEXT5.util.addEvent(u,"blur",v);0<f.length&&(g.id=f);g.unselectable="on";a.appendChild(g)}}},
getImageIconUrl:function(a){var c="";""!=a&&(c=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif");return c},getText:function(a){var c="";""!=a&&(c=dext5_lang.icon[a]);return c},show:function(a){null==this._iframe&&this.make(a);setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=DEXTTOP.DEXTDOC.getElementById(this._iframe_id);DEXT5_EDITOR.prototype.dialog._click_background();var c={},c=getWindowScrollPos(DEXTTOP.DEXTWIN),b=getClientRect(G_SUB_DIALOG),
d=getClientRect(_iframeWin.parent.frameElement),e=getClientRect(_iframeWin.frameElement),f=180;if(7==DEXTTOP.DEXT5.browser.ieVersion||8==DEXTTOP.DEXT5.browser.ieVersion)f+=2;var g=0;b.left+f>=e.right&&(g=b.left+f-e.right+30);e=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(e=-15);f=0;7==DEXTTOP.DEXT5.browser.ieVersion&&(f=6);this._iframe.style.left=b.left+c[0]+d.left+e-g+"px";this._iframe.style.top=b.bottom+c[1]+d.top+f+"px";this._iframe.style.display="";c=DEXT5_TOPMENU._disabeld_menu;d=this._table_item.length;
b=c.length;for(g=0;g<d;g++)(e=G_CURRENT_IFRAME.contentWindow.document.getElementById(this._table_item[g]))&&removeAttribute(e,"class");for(d=0;d<b;d++)if(g=G_CURRENT_IFRAME.contentWindow.document.getElementById(c[d]))g.className="item_disabled";c=this._iframe.contentWindow;b=getIframeDocument(this._iframe);0==DEXTTOP.DEXT5.browser.ie&&c.focus();b.getElementsByTagName("A")[0].focus();var h=this;DEXTTOP.DEXT5.util.addEvent(b,"keyup",function(b){27==("which"in b?b.which:b.keyCode)&&(h.hide(a),setTimeout(function(){setFocusToBody()},
1))});setFocusFirstAndLast(b,b.getElementsByTagName("A")[0]);DEXTTOP.G_CURREDITOR._dextframeHasFocus=!0},hide:function(a){DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"}},setFocusToBody:function(){setFocusToBody()}};K__+="FA";R[0]="h";SIL[1]="u";K__+="BG";DEXT5_EDITOR.prototype.full_screen={toggle:function(){}};K__+=R[0];R[1]="t";K__+="i";
DEXT5_EDITOR.prototype.dialog={_self:function(a){return document.getElementById("dext_dialog_"+a)},_selfTopWindow:function(a){return DEXTTOP.document.getElementById("dext_dialog_"+a)},_background:function(a){var c=document.getElementById("dext_background");null!=c&&void 0!=c?1==a?(this.set_full_size(c),c.style.display="block"):c.style.display="none":alert("ErrCode : 2000")},_click_background:function(){var a=document.getElementById("dext_click_background");if(null!=a&&void 0!=a)if("block"==a.style.display)dialogCancel(),
G_SUB_DIALOG&&(isGroupingIcon(G_USE_EDITOR_ID,"",G_SUB_DIALOG)&&hideGroupingBox(),G_SUB_DIALOG.style.display="none"),G_CURRENT_IFRAME&&(G_CURRENT_IFRAME.style.display="none"),a.style.display="none";else{document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="";this.set_full_size(a);a.style.display="block";G_SUB_DIALOG.style.display="block";var a=getClientRect(G_SUB_DIALOG),c=getClientRect(_iframeWin.frameElement),b=parseInt(a.right,10)-parseInt(a.left,10);a.left+b>=c.right&&(a=a.left+
b-c.right+30,G_SUB_DIALOG.style.left=parseInt(G_SUB_DIALOG.style.left,10)-a+"px")}else alert("ErrCode : 2001")},set_full_size:function(a){var c=0,b=0;"BackCompat"==document.compatMode?(c=document.body.scrollWidth,b=document.body.scrollHeight):(c=document.documentElement.scrollWidth,b=document.documentElement.scrollHeight);a.style.width=c+"px";a.style.height=b+"px"},_set_resize:function(a){if(0==DEXTTOP.DEXT5.isPopUpCssLoaded){var c=DEXTTOP.document.createElement("link");c.type="text/css";c.rel="stylesheet";
c.href=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css+"editor_popup.css?ver="+DEXTTOP.DEXT5.ReleaseVer:DEXTTOP.G_CURREDITOR._config.webPath.css_dev+"editor_popup.css?ver="+DEXTTOP.DEXT5.ReleaseVer;DEXTTOP.document.getElementsByTagName("head")[0].appendChild(c);DEXTTOP.DEXT5.isPopUpCssLoaded=!0}var b;getElementsByClass("EdiTor_Popup_header",a.contentWindow.document)[0].style.display="none";a.contentWindow.document.body.getElementsByTagName("div")[0].style.border="0px";b="BackCompat"==
document.compatMode?a.contentWindow.document.body:a.contentWindow.document.documentElement;c=b.scrollWidth;b=b.scrollHeight;a.style.width=c+"px";a.style.height=b+"px";c=a.parentNode.parentNode;b=c.firstChild;var d=a.contentWindow.document.body.getElementsByTagName("div")[0].className,e=getElementsByClass("subject",a.contentWindow.document,"span")[0].innerHTML;c.className=d;b.className="EdiTor_Popup_header";b.firstChild.innerHTML=e;b=function(){return function(b){press_enter_esc_btn(b,a.contentWindow.document);
DEXTTOP.DEXT5.util.stopEvent(b)}}();DEXTTOP.DEXT5.util.addEvent(a.contentWindow.document,"keyup",b);locationDialog(c)},show:function(a,c){var b=this,d=this._selfTopWindow(DEXTTOP.G_CURREDITOR.ID);null==d&&(DEXTTOP.G_CURREDITOR._dextDialog.make(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._config),d=this._selfTopWindow(DEXTTOP.G_CURREDITOR.ID));d.contentWindow.location.replace(a+c);if("none"==d.parentNode.parentNode.style.display){d.parentNode.parentNode.style.display="block";d.parentNode.parentNode.style.left=
"-800px";d.parentNode.parentNode.style.top="-800px";d.style.display="block";d.style.position="relative";d.style.left="0px";d.style.top="0px";var e=function(a){DEXTTOP.DEXT5.util.removeEvent(d,"load",e);b._set_resize(d)};DEXTTOP.DEXT5.util.addEvent(d,"load",e)}},hide:function(){this._background(!1);var a=document.getElementById("dext_dialog_"+G_USE_EDITOR_ID);a&&(a.style.display="none",a.src="about:blank")}};Z[0]="h";K__+="j";
function event_dext_image_upload(a,c,b,d,e,f,g,h,m,n,p){command_InsertImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,f,g,h,m,n);n.continueInsert||hideDialog(p)}R[2]="t";function event_dext_flash_upload(a,c,b,d,e,f,g,h){command_InsertMedia(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),f,g);hideDialog(h)}K__+="k";R[3]="p";
function event_dext_media_upload(a,c,b,d,e,f,g,h){command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),g);hideDialog(h)}K__+="l";function event_dext_detail_table_insert(a,c,b,d,e,f,g,h,m,n,p,q,u,t,v,w,x,y,z,C,D,E,F,H,A,I,B,G,O,L,N){command_InsertDetailTable(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d,e,f,g,h,m,n,p,q,u,t,v,w,x,y,z,C,D,E,F,H,A,I,B,O,L,N);hideDialog(G)}K__+="m";
function event_dext_detail_table_insert_new(a,c,b,d,e,f,g,h,m,n,p,q,u,t,v,w,x,y,z,C,D,E,F,H,A,I,B,G,O,L,N,J){command_InsertDetailTable(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d,e,f,g,h,m,n,p,q,u,t,v,w,x,y,z,C,D,E,F,H,A,I,B,G,O,L,J);hideDialog(N)}Z[1]="t";K__+="n";R[4]=":";
function event_dext_table_property(a,c,b,d,e,f,g,h,m,n,p,q,u,t,v,w,x,y,z,C,D,E,F){command_InsertTableProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d,e,f,g,h,m,n,p,q,u,t,v,w,x,y,z,D,E,F);hideDialog(C)}function event_dext_cell_property(a,c,b,d,e,f,g,h,m,n,p,q,u,t,v){command_InsertCellProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d,e,f,g,h,m,n,p,q,u,v);hideDialog(t)}
function event_dext_cell_border(a,c,b,d,e){command_InsertCellBorder(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d);hideDialog(e)}R[5]="/";function event_dext_dog_bg_img_insert(a,c,b,d,e,f){command_InsertDogBGImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d,e);hideDialog(f)}
function event_dext_emoticon_insert(a,c){command_InsertImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),"","","","","",a);hideDialog(c)}R[6]="/";function event_dext_insert_row_column(a,c,b,d){command_InsertRowColumn(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b);hideDialog(d)}SIL[2]="o";function event_dext_setting(a,c){command_editorSetting(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}
Z[2]="t";function event_dext_horizontal_line(a,c,b,d){command_insertHorizontalLine(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b);hideDialog(d)}R[7]="w";function event_dext_row_property(a,c,b,d,e){command_RowProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d);hideDialog(e)}
function event_dext_column_property(a,c,b,d,e){command_ColumnProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d);hideDialog(e)}R[8]="w";function event_dext_bookmark_add(a,c){command_InsertBookmark(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c)}function event_dext_create_iframe(a,c){command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}R[9]="w";
function event_dext_create_hyperlink(a,c){command_InsertHyperLink(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}R[10]=".";function event_dext_split_cell(a,c,b){command_InsertSplitCell(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c);hideDialog(b)}T[0]="Li";function event_dext_symbol(a,c){command_InsertSymbol(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}R[11]="d";
function event_dext_template(a,c){var b=DEXTTOP.DEXT5.ajax.load(DEXTTOP.DEXT5.rootPath+a.url);null!=b&&(setHtmlValueToEditor(b),setStyleForTableBorderNodeClass(DEXTTOP.G_CURREDITOR),setCssForFormMode(DEXTTOP.G_CURREDITOR));DEXTTOP.G_CURREDITOR._config.printHeader="null"!=a.print_header?a.print_header:DEXTTOP.G_CURREDITOR._config.basePrintHeader;DEXTTOP.G_CURREDITOR._config.printFooter="null"!=a.print_footer?a.print_footer:DEXTTOP.G_CURREDITOR._config.basePrintFooter;hideDialog(c)}T[1]="c";
function event_dext_layout(a,c){var b=DEXTTOP.DEXT5.ajax.load(DEXTTOP.DEXT5.rootPath+"pages/layout/layout"+a.num+".html");null!=b&&DEXTTOP.DEXT5.setHtmlValueEx(b);hideDialog(c)}_R_O_+=R[11];function event_dext_upload_cancel(a){hideDialog(a);dialogCancel()}R[12]="e";function event_dext_find(a,c,b,d,e,f){command_find(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,d,e,b)}Z[3]="p";_R_O_+="g";
function event_dext_replace(a,c,b,d,e,f,g){command_replace(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,e,f,d)}R[13]="x";function event_dext_all_replace(a,c,b,d,e,f,g){command_replaceAll(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,e,f,d)}T[2]="e";_R_O_+="f";function event_dext_capital_small_letter(a,c){command_changeWordUpperLower(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a)}R[14]="t";
function event_dext_insert_link_media(a,c,b){a=getCustomParam(a);c&&""!=c&&(a.caption=c);command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(b)}function event_dext_modify_link_media(a,c,b,d){a=getCustomParam(a);c&&""!=c&&(a.caption=c);command_ModifyReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,b);hideDialog(d)}_R_O_+="e";T[3]="n";
function event_dext_insert_paste_dialog_html(a,c){command_InsertPasteDialogHtml(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}R[15]="5";function event_dext_insert_file(a,c){command_InsertHyperLink(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}_R_O_+="a";function event_dext_insert_open_file(a,c){command_InsertOpenFile(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}
R[16]=".";function event_dext_insert_blockquote(a,c){command_InsertBlockquote(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}T[4]="se";_R_O_+="b";function event_dext_insert_input_text(a,c){command_InsertInputText(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}R[17]="c";T[5]="k";
function event_dext_insert_input_radio_or_checkbox(a,c){command_InsertInputRadioOrCheckbox(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}_R_O_+="H";T[6]="e";function event_dext_insert_input_button(a,c){command_InsertInputButton(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}SIL[3]="b";
function event_dext_insert_input_select(a,c){command_InsertInputSelect(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}T[7]="y";function event_dext_insert_input_textarea(a,c){command_InsertInputTextarea(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}_R_O_+="M";
function event_dext_insert_input_hidden(a,c){command_InsertInputHidden(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}R[18]="o";T[8]=" i";function event_dext_insert_input_image(a,c){command_InsertInputImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}T[9]="s ";_R_O_+="N";
function event_dext_setAccessibility(a,c,b){command_setAccessibility(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b)}R[19]="m";T[10]="i";
function onlyNumber(a){window.netscape?34<a.which&&41>a.which||47<a.which&&58>a.which||95<a.which&&106>a.which||8==a.which||9==a.which||13==a.which||46==a.which||DEXTTOP.DEXT5.util.cancelEvent(a):34<a.keyCode&&41>a.keyCode||47<a.keyCode&&58>a.keyCode||95<a.keyCode&&106>a.keyCode||8==a.keyCode||9==a.keyCode||13==a.keyCode||46==a.keyCode||DEXTTOP.DEXT5.util.cancelEvent(a)}T[11]="n";R[20]="/";
function locationDialog(a){setFocusTopWindow();var c=DEXTTOP.document.createElement("div");c.setAttribute("id","dext_disabled");c.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:'+(G_MAIN_ZINDEX+1E3)+'; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';var b="CSS1Compat"==DEXTTOP.document.compatMode?DEXTTOP.document.documentElement.scrollHeight:
DEXTTOP.document.body.scrollHeight;c.firstChild.style.width=("CSS1Compat"==DEXTTOP.document.compatMode?DEXTTOP.document.documentElement.scrollWidth:DEXTTOP.document.body.scrollWidth)+"px";c.firstChild.style.height=b+"px";DEXTTOP.document.body.appendChild(c);DEXTTOP.DEXT5.util.addEvent(DEXTTOP.window,"resize",setLayerbgResize);a.style.display="block";a.style.zIndex=G_MAIN_ZINDEX+2E3;a.style.position="absolute";var d={},d=getWindowClientSize(DEXTTOP.window),c={},c=getWindowScrollPos(DEXTTOP.window),
b=a.getElementsByTagName("iframe")[0],e=a.getElementsByTagName("div")[2];b&&e&&(DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion&&(e.style.position=b.style.position),e.style.left=b.style.left,e.style.right=b.style.right,e.style.width=b.style.width,e.style.height=b.style.height);b=a.clientWidth;e=a.clientHeight;if("1"==DEXTTOP.G_CURREDITOR._config.showDialogPosition){var d=getClientRect(_iframeWin.parent.frameElement),e=getClientRect(_iframeWin.frameElement),f=0,g=0;if(null!=DEXTTOP.DEXT5.config.DialogWindow)for(var h=
_iframeWin.parent.parent;h!=DEXTTOP;)var m=getClientRect(h.frameElement),f=f+m.left,g=g+m.top,h=h.parent;a.style.left=c[0]+d.left+f+((e.right-e.left)/2-b/2)+"px";a.style.top=c[1]+d.top+e.top+g+10+"px"}else a.style.left=c[0]+d[0]/2-b/2+"px",a.style.top=c[1]+d[1]/2-e/2+"px";makeDragPopup(a)}Z[4]=":";T[12]="c";
function localToGlobal(a){var c=a.offsetWidth,b=a.offsetHeight,d=0,e=0,f={},g=function(h){if(h)d+=h.offsetLeft,e+=h.offsetTop,g(h.offsetParent);else return f={top:a.offsetTop+e,left:a.offsetLeft+d,bottom:a.offsetTop+e+b,right:a.offsetLeft+d+c}};g(a.offsetParent);return f}R[21]="r";
function setLayerbgResize(){var a=DEXTTOP.document.getElementById("dext_disabled"),c="CSS1Compat"==DEXTTOP.document.compatMode?DEXTTOP.document.documentElement.scrollHeight:DEXTTOP.document.body.scrollHeight;a.firstChild.style.width=("CSS1Compat"==DEXTTOP.document.compatMode?DEXTTOP.document.documentElement.scrollWidth:DEXTTOP.document.body.scrollWidth)+"px";a.firstChild.style.height=c+"px"}T[13]="o";
function hideDialog(a){dialogCancel();_dext_editor.violationNode&&(removeClassName(_dext_editor.violationNode,"DEXT_accessibility"),_dext_editor.violationNode=null,DEXTTOP.DEXT5.setEditorChangeMode("source",_dext_editor.ID),DEXTTOP.DEXT5.setEditorChangeMode("design",_dext_editor.ID));var c=DEXTTOP.document.getElementById("dext_disabled");null!=c&&(DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.window,"resize",setLayerbgResize),a.style.display="none",a=a.getElementsByTagName("iframe")[0],a.style.width="10px",
a.style.height="10px",DEXTTOP.document.body.removeChild(c),DEXTTOP.G_SELECTED_ELEMENT=null,DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.document,"keyup",press_enter_esc_btn))}_R_O_+="O";R[22]="a";
function getWindowClientSize(a){var c=0,b=0;"number"==typeof a.innerWidth?(c=a.innerWidth,b=a.innerHeight):a.document.documentElement&&(a.document.documentElement.clientWidth||a.document.documentElement.clientHeight)?(c=a.document.documentElement.clientWidth,b=a.document.documentElement.clientHeight):a.document.body&&(a.document.body.clientWidth||a.document.body.clientHeight)&&(c=a.document.body.clientWidth,b=a.document.body.clientHeight);return[c,b]}Z[5]="/";
function getWindowScrollPos(a){return"number"===typeof a.pageYOffset?[a.pageXOffset,a.pageYOffset]:a.document.body&&(a.document.body.scrollLeft||a.document.body.scrollTop)?[a.document.body.scrollLeft,a.document.body.scrollTop]:a.document.documentElement&&(a.document.documentElement.scrollLeft||a.document.documentElement.scrollTop)?[a.document.documentElement.scrollLeft,a.document.documentElement.scrollTop]:[0,0]}Z[6]="/";_R_O_+="P";R[23]="o";var _startXY={};
function _MD(a){if(isLeftClick(a)){var c=null,c=a.target?a.target:a.srcElement,c=c.parentElement;a=getMousePosition(a);_startXY.X=a.X-parseIntOr0(c.style.left);_startXY.Y=a.Y-parseIntOr0(c.style.top)}}T[14]="r";Z[7]="w";function _MM(a){if(isLeftClick(a)){var c=getMousePosition(a),b=null,b=a.target?a.target:a.srcElement,b=b.parentElement;b.style.left=c.X-_startXY.X+"px";b.style.top=c.Y-_startXY.Y+"px"}DEXTTOP.DEXT5.util.cancelEvent(a)}T[15]="r";function _MU(a){}Z[8]="w";_R_O_+="Q";T[16]="e";Z[9]="w";
function click_plus_func(a,c,b,d){b=parseIntOr0(a.value,10)+parseIntOr0(b,10);a.value="number"==typeof c?b>c?c:b:b;d&&d()}R[24]="n";T[17]="c";function click_minus_func(a,c,b,d,e){b=parseIntOr0(a.value,10)-parseIntOr0(b,10);a.value="number"==typeof c?b<c?c:b:b;void 0!==d&&1==d&&b<c&&(a.value="");e&&e()}Z[10]=".";function elementIndexOf(a,c){for(var b,d=document.getElementsByName(c),e=d.length,f=0;f<e;f++)if(d[f]==a){b=f;break}return b}Z[11]="d";_R_O_+="I";
function getElementsByClass(a,c,b){var d=[];null==c&&(c=document);null==b&&(b="*");c=c.getElementsByTagName(b);b=c.length;a=new RegExp("(^|\\s)"+a+"(\\s|$)");for(j=i=0;i<b;i++)a.test(c[i].className)&&(d[j]=c[i],j++);return d}T[18]="t";_R_O_+="J";R[25]=".";function getElementsById(a,c,b){var d=[];null==c&&(c=document);null==b&&(b="*");c=c.getElementsByTagName(b);b=c.length;for(j=i=0;i<b;i++)c[i].id==a&&(d[j]=c[i],j++);return d}Z[12]="e";function getIframeWin(){return _iframeWin}T[19]=". P";
function getIframeDoc(){return _iframeDoc}T[20]="l";_R_O_+="K";function isCustomDomain(a){if(!DEXTTOP.DEXT5.browser.ie)return!1;var c=a.domain;a=getDocWindow(a).location.hostname;return c!=a&&c!="["+a+"]"}Z[13]="x";function getDocWindow(a){return a.parentWindow||a.defaultView}R[26]="a";function getIframeDocument(a){return"undefined"!=typeof a.contentDocument?a.contentDocument:"undefined"!=typeof a.contentWindow?a.contentWindow.document:null}Z[14]="t";
function getIframeWindow(a){return"undefined"!=typeof a.contentWindow?a.contentWindow:"undefined"!=typeof a.contentDocument?a.contentDocument.defaultView:null}T[21]=T[2]+"a";
function createPopupIframe(a,c,b,d,e,f,g,h,m,n,p){var q=a.createElement("div");q.id=c;q.className=b;q.style.position="absolute";q.style.zIndex=d;q.style.width=e;q.style.height=f;q.style.display=g;c=a.createElement("iframe");c.frameBorder=0;c.style.top="0px";c.style.position="absolute";c.style.left="0px";c.width="100%";c.height="100%";c.scrolling="no";1==h&&(c.allowTransparency=!0);q.appendChild(c);a.body.appendChild(q);b="";void 0===m||""==m?(b="document.open();"+(isCustomDomain(a)?'document.domain="'+
a.domain+'";':"")+" document.close();",b=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+"}())":""):b=m;c.src=b;b=getIframeDocument(c);if(void 0===m||""==m)m="<html><head><title>"+_dext_editor._config.system_title+' Editor Popup Window</title></head><body style="padding:0; margin:0;"></body></html>',b.open("text/html","replace"),isCustomDomain(a)&&(b.domain=a.domain),b.write(m),b.close(),1==h&&(b.body.style.backgroundColor="transparent");a=b.getElementsByTagName("head")[0];
m=n.length;for(h=0;h<m;h++)d=b.createElement("link"),d.type="text/css",d.rel="stylesheet",d.href=n[h],a.appendChild(d);b=getIframeDocument(c);a=b.getElementsByTagName("head")[0];n=p.length;for(h=0;h<n;h++)m=b.createElement("script"),m.type="text/javascript",m.src=p[h],a.appendChild(m);p={};p.layer=q;p.iframe=c;p.iframeDoc=getIframeDocument(c);p.iframeWin=getIframeWindow(c);return p}Z[15]="5";_R_O_+="L";
function showColorPopup(a,c,b,d,e,f,g){var h="",m="";DEXTTOP.DEXT5.isRelease?(h=_dext_editor._config.webPath.css,m=_dext_editor._config.webPath.js):(h=_dext_editor._config.webPath.css_dev,m=_dext_editor._config.webPath.js_dev);var n=createPopupIframe(a,"popupCover","",G_MAIN_ZINDEX+2E3,"240px","135px","block",!0,"",[h+"editor.css"],[m+"jscolor/jscolor.js"]),p=a.createElement("div");p.setAttribute("id","dext_color_back");p.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:'+
(G_MAIN_ZINDEX+1E3)+'; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';h="CSS1Compat"==a.compatMode?a.documentElement.scrollHeight:a.body.scrollHeight;p.firstChild.style.width=("CSS1Compat"==a.compatMode?a.documentElement.scrollWidth:a.body.scrollWidth)+"px";p.firstChild.style.height=h+"px";a.body.appendChild(p);p.onclick=function(){a.body.removeChild(a.getElementById("popupCover"));a.body.removeChild(p);dialogCancel()};var h=getClientRect(c),m=c.ownerDocument||
c.document||a,q;"undefined"!=typeof m.defaultView?q=m.defaultView:"undefined"!=typeof m.parentWindow&&(q=m.parentWindow);var u=getDocWindow(a),m=null;q!==u&&(m=getClientRect(q.frameElement));null==e&&(e=0);null==f&&(f=0);0==h.left&&(h=getClientRect(c));var t=n.iframeDoc,v=n.iframeWin,w=G_BASE_COLOR_PICKER,x,y=w.length,z=t.createElement("ul");z.setAttribute("id","color_ul");DEXTTOP.DEXT5.util.setClass(z,"dext_color");"cssFloat"in z.style?z.style.cssFloat="left":z.style.styleFloat="left";for(var C=
0;C<y;C++){var D="",D="cp_"+G_USE_EDITOR_ID+"_"+C;x=t.createElement("li");x.setAttribute("id",D);x.style.fontSize="1pt";x.setAttribute("title",w[C]);x.style.backgroundColor=w[C];_a_tag=t.createElement("a");_a_tag.href="javascript:void(0);";_a_tag.style.width="14px";_a_tag.style.height="14px";_a_tag.style.display="block";_a_tag.title=w[C];x.appendChild(_a_tag);var E=function(e){return function(f){D=3<e.length?e:w[e];"#000000"==D&&(D="black");if(""!==b||void 0!==b)c.style[b]=D,0==DEXTTOP.DEXT5.browser.ie&&
u.focus(),a.body.focus(),c.parentNode.focus(),void 0!==d&&("font_color"==d?(isGroupingIcon(G_USE_EDITOR_ID,d)&&hideGroupingBox(),command_fontColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),D)):"font_bg_color"==d?(isGroupingIcon(G_USE_EDITOR_ID,d)&&hideGroupingBox(),command_fontBgColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),D)):"doc_bg_color"==d?command_docBGColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),
D):"cell_bg_color"==d?command_cellBGColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),D):"line_color"==d&&g&&g()),a.body.removeChild(p),a.body.removeChild(a.getElementById("popupCover"));DEXTTOP.DEXT5.util.stopEvent(f)}}(C);DEXTTOP.DEXT5.util.addEvent(x,"click",E);x.onmousedown=function(){return!1};x.unselectable="on";E=function(a,b,c){return function(c){function d(a,b,e){a.getElementsByTagName("li")[b+e]&&(a.getElementsByTagName("li")[b+e].getElementsByTagName("a")[0]&&
a.getElementsByTagName("li")[b+e].getElementsByTagName("a")[0].focus(),DEXTTOP.DEXT5.util.cancelEvent(c))}var e="which"in c?c.which:c.keyCode;37==e?d(a,b,-1):39==e?d(a,b,1):38==e?d(a,b,-14):40==e&&d(a,b,14)}}(z,C);DEXTTOP.DEXT5.util.addEvent(_a_tag,"keydown",E);z.appendChild(x)}z.style.width="226px";z.style.paddingLeft="2px";z.style.paddingRight="2px";z.style.margin="0px";z.style.backgroundColor="#ffffff";var F=/msie ([0-9]{1,}[.0-9]{0,})/;null!=F.exec(navigator.userAgent.toLowerCase())&&"6"==parseFloat(RegExp.$1)&&
(z.style.width="230px");if("CCODE_001"!=DEXTTOP.G_CURREDITOR._config.custom_code){var H=t.createElement("div");H.innerHTML="More";H.setAttribute("class","color");H.setAttribute("id","more_btn");H.style.cursor="pointer";H.style.textAlign="center";H.style.width="220px";z.appendChild(H);DEXTTOP.DEXT5.util.addEvent(H,"click",function(){(new v.jscolor.color(H,{},c,b,d,g)).showPicker();n.layer.style.height="285px";null!=F.exec(navigator.userAgent.toLowerCase())&&"6"==parseFloat(RegExp.$1)&&(n.iframe.style.height=
"285px");t.getElementById("color_picker").style.display=""})}x=t.createElement("div");x.className="DEXT_fiVe_EdiTor";x.appendChild(z);x.style.position="absolute";x.style.width="230px";x.style.border="solid 1px #cccccc";t.body.appendChild(x);q=n.iframe.contentWindow;x=getIframeDocument(n.iframe);0==DEXTTOP.DEXT5.browser.ie?q.focus():x.body.focus();DEXTTOP.DEXT5.util.addEvent(x,"keyup",function(b){b=b?b:q.event;27==("which"in b?b.which:b.keyCode)&&(a.body.removeChild(p),a.body.removeChild(a.getElementById("popupCover")),
setTimeout(function(){try{u==window?setFocusToBody():(0==DEXTTOP.DEXT5.browser.ie&&u.focus(),a.body.focus(),c.parentNode.focus())}catch(b){}},1))});a==document?(y=t.getElementsByTagName("div")[0],y=getClientRect(y),C=getClientRect(_iframeWin.frameElement),E=parseInt(y.right,10)-parseInt(y.left,10),parseInt(y.bottom,10),parseInt(y.top,10),h.left+E>=C.right?(n.layer.style.left=h.left-(h.left+E-C.right+30)+"px",n.layer.style.top=h.bottom+f+"px"):null==m?(n.layer.style.left=h.left+e+"px",n.layer.style.top=
h.bottom+f+"px"):(n.layer.style.left=m.left+h.left+e+"px",n.layer.style.top=m.top+h.bottom+f+"px")):null==m?(n.layer.style.left=h.left+e+"px",n.layer.style.top=h.bottom+f+"px"):(n.layer.style.left=m.left+h.left+e+"px",n.layer.style.top=m.top+h.bottom+f+"px");setFocusFirstAndLast(x,z.getElementsByTagName("a")[0])}T[22]=T[4];
function showAccessPopup(a,c,b,d,e,f){var g=a.createElement("div");g.setAttribute("id","dext_access_back");g.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:12; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';var h="CSS1Compat"==a.compatMode?a.documentElement.scrollHeight:a.body.scrollHeight;g.firstChild.style.width=("CSS1Compat"==
a.compatMode?a.documentElement.scrollWidth:a.body.scrollWidth)+"px";g.firstChild.style.height=h+"px";a.body.appendChild(g);g.onclick=function(){a.body.removeChild(g);b.style.display="none"};b.getElementsByTagName("p")[0].innerHTML=d;setTimeout(function(){var a=getClientRect(c);b.style.left=a.left+e+"px";b.style.top=a.top+f+"px";b.style.display=""},0)}Z[16]=".";_R_O_+="R";
function getClickCell(a,c){var b=null;a.srcElement?b=a.srcElement:a.target&&(b=a.target);if(null!=b)return GetParentbyTagName(b,c)}Z[17]="c";___=1==DEXTTOP.IsCrossDomain?___.href:top.location.href;
function createSelectProtocols(a,c){var b=["http://","https://","ftp://","news://","other"],d=["http://","https://","ftp://","news://",""],e=[],f;for(f in b)e.push(document.createElement("option")),e[f].innerHTML=b[f],e[f].setAttribute("value",d[f]),a.appendChild(e[f]);DEXTTOP.DEXT5.util.addEvent(c,"keyup",function(){for(var d in b)b[d]==c.value&&"other"!=b[d]&&(c.value="",a.options[d].selected="selected")})}function lastFocus(a){}R[27]="s";
function press_enter_esc_btn(a,c){var b=!1,d=!1;27==("which"in a?a.which:a.keyCode)&&(c?(b=closeWebAccessPopup(c),d=closeGridSelectPopop(c)):d=b=!0,b&&d&&hideDialog(DEXTTOP.DEXTDOC.getElementById("dext_dialog")))}T[23]=",";___=1==DEXTTOP.IsCrossDomain?DEXTTOP.DEXTDOC.referrer:___;
function closeWebAccessPopup(a){for(var c=a.getElementsByTagName("div"),b=c.length,d=!0,e=0;e<b;e++)if(-1<c[e].id.indexOf("access_div")&&"none"!=c[e].style.display){b=a.getElementById("dext_access_back");a.body.removeChild(b);c[e].style.display="none";d=!1;break}return d}Z[18]="o";function closeGridSelectPopop(a){a=a.getElementById("grid_select");var c=!0;a&&"none"!=a.style.display&&(a.style.display="none",c=!1);return c}Z[19]="m";K__+=Z[18];_R_O_+="S";T[24]=" c";
function setEditorHeight(a,c){var b={};c?b.height=parseIntOr0(a._config.style.height):b=getClientSize(window.frameElement);var d=b.height,b=getEditorFrameDoc(a),e=b.getElementById("dext_topstatusbar_"+a.ID),f=b.getElementById("dext_menu_"+a.ID),g=b.getElementById("dext_toolbar_"+a.ID),h=b.getElementById("dext_statusbar_"+a.ID),m=0,n=0;if(e){switch(a._config.top_status_bar){case "1":n=1;break;default:n=28}m+=n}if(f){switch(a._config.top_menu){case "1":n=0;break;default:n=29}m+=n}if(g){switch(a._config.tool_bar){case "1":n=
31;DEXTTOP.DEXT5.browser.quirks&&(n-=2);break;case "2":n=29;DEXTTOP.DEXT5.browser.quirks&&--n;break;case "3":n=1;DEXTTOP.DEXT5.browser.quirks&&(n-=3);break;case "4":n=93;break;default:n=59,DEXTTOP.DEXT5.browser.ie&&(DEXTTOP.DEXT5.browser.quirks||7>=DEXTTOP.DEXT5.browser.ieVersion)&&--n}m+=n;"1"==a._config.formMode&&(m+=35)}if(h){switch(a._config.status_bar){case "1":n=1;break;default:n=23}m+=n}"none"!=g.style.display&&"1"==a._config.ruler.use&&"1"==a._config.ruler.viewRuler&&(m+=18);a.baseMenuToolbarHeight=
m;-1<a._config.style.height.indexOf("%")&&(b.getElementsByTagName("html")[0].style.height="100%",d=b.getElementsByTagName("body")[0],d.style.height="100%",d.style.margin="0",b.body.getElementsByTagName("div")[0].style.height="100%",getClientRect(b.body.getElementsByTagName("div")[0]),d=Math.max(b.body.clientHeight,b.documentElement.clientHeight));isViewMode(a)&&(m=3,DEXTTOP.DEXT5.browser.quirks&&(m=0));a._defaultHeight=d-m}_R_O_+="T";K__+="p";
function _fn_0(){var a=T.toString(),a=a.replace(/,/gi,""),c,b,d,e,f,g;c=b=d=e=f=g="";try{g=_0_[3],c=_0_[4],b=_0_[5],d=_0_[7],f=_0_[8],e=_1_}catch(h){alert(a);return}try{if(0==e.length||e!=d){alert(a);return}}catch(m){alert(a);return}try{if(0==b.length){alert(a);return}if("0"!=b){var n=new Date;b=b.toString();b=b.split("-");var p=parseIntOr0(b[0]),q=parseIntOr0(b[1]),q=q-1,u=parseIntOr0(b[2]);if(n>new Date(p,q,u)){alert(a);return}}}catch(t){alert(a);return}try{if(0==c.length){alert(a);return}c=c.split(",");
b=!1;c.push("localhost");c.push("127.0.0.1");for(d=0;d<c.length;d++){var v=c[d].replace("*.","");""==DEXTTOP.DEXT5.util.trim(___)&&(___=DEXTTOP.DEXTWIN.location.href);if(-1!=___.search(v)){b=!0;break}else{var w=v.replace("www.","");if(w!=v&&(w="/"+w,-1!=___.search(w))){b=!0;break}}}if(0==b){alert(a);return}}catch(x){alert(a);return}c=!1;try{if(0==g.length){alert(a);return}if("I"==g){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){alert(a+" "+g);return}c=!0}else if("P"==g){if("1"==DEXTTOP.G_CURREDITOR._config.formMode||
"ieplugin"==DEXTTOP.G_CURREDITOR._config.runtimes){alert(a+" "+g);return}c=!0}else"A"==g?c=!0:"M"==g&&(c=!0)}catch(y){alert(a);return}try{if(1==c&&-1==f.indexOf("E")){alert(a);return}}catch(z){alert(a);return}_1_=!0}T[25]=T[13];K__+="XYZ";_R_O_+="x";
function checkDefaultMessage(a){try{var c=DEXTTOP.G_CURREDITOR._config.firstLoadType;""!=DEXTTOP.G_CURREDITOR._config.firstLoadType&&""==DEXTTOP.G_CURREDITOR._config.defaultMessage&&(DEXTTOP.G_CURREDITOR._config.defaultMessage=" ");if(""==DEXTTOP.G_CURREDITOR._config.defaultMessage)return!1;""!=DEXTTOP.G_CURREDITOR._config.defaultMessage&&(DEXTTOP.G_CURREDITOR._config.defaultMessage="",DEXTTOP.G_CURREDITOR._config.firstLoadType="");var b=!1;switch(c.toLowerCase()){case "bodyvalue":_setBodyValue(DEXTTOP.G_CURREDITOR._config.firstLoadMessage,
DEXTTOP.G_CURREDITOR._config.editor_id);b=!0;break;case "bodyvalueex":_setBodyValueEx(DEXTTOP.G_CURREDITOR._config.firstLoadMessage);b=!0;break;case "bodyvalueexlikediv":_setBodyValueExLikeDiv(DEXTTOP.G_CURREDITOR._config.firstLoadMessage);b=!0;break;case "htmlvalue":_setHtmlValue(DEXTTOP.G_CURREDITOR._config.firstLoadMessage);b=!0;break;case "htmlvalueex":_setHtmlValueEx(DEXTTOP.G_CURREDITOR._config.firstLoadMessage);b=!0;break;case "url":_loadHtmlValueExFromURL(DEXTTOP.G_CURREDITOR._config.firstLoadMessage,
DEXTTOP.G_CURREDITOR._config.editor_id);b=!0;break;default:_setBodyValue("",DEXTTOP.G_CURREDITOR._config.editor_id),DEXTTOP.G_CURREDITOR.UndoManager.reset(),DEXTTOP.G_CURREDITOR._iconEnable(""),setBodyDefaultValue(),setFocusToBody(),b=!0}}catch(d){}return b}_R_O_+="y";Z[20]="/";function isViewMode(a){var c=a;if(void 0==a||null==a)c=DEXTTOP.G_CURREDITOR;return"view"==c._config.mode?!0:!1}T[26]="n";K__+="qrstU";
function resizeEditor(a,c){try{if(null==a||void 0==a)a=DEXTTOP.G_CURREDITOR;setEditorHeight(a,c);var b=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+a.ID);("undefined"!=typeof b.contentDocument?b.contentDocument:"undefined"!=typeof b.contentWindow?b.contentWindow.document:document).getElementById("ue_editor_holder_"+a.ID).style.height=a._defaultHeight+"px";for(var b=["source","text"],d=b.length,e=0;e<d;e++){var f=document.getElementById("dext5_"+b[e]+"_"+a.ID),g=a._defaultHeight;DEXTTOP.DEXT5.browser.quirks?
g-=5:DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(g-=3);f.style.height=g+"px"}set_ruler_pointline_position(a)}catch(h){}}Z[21]="z";K__+="VW";function getCustomIconAttr(a){var c={isCustom:!1,command:"",desc:""};"c_"==a.substring(0,2)&&(c.isCustom=!0);c.isCustom&&(a=a.split("|"),c.command=a[0],a[1]&&(c.desc=a[1]));return c}K__+="67890";T[27]=T[18];
function removeCRLFChar(a){a=changeRealTagToReplaceString(a);a=a.replace(/\r\n/g,"");a=changeReplaceStringToRealTag(a);a=a.replace(/>\n</g,"><");return a=DEXTTOP.DEXT5.util.replaceOneSpaceToNbsp(a)}T[28]="a";
function setFocusFirstAndLast(a,c,b){try{var d=null;if(b)d=b;else var e=a.getElementsByTagName("a").length,d=a.getElementsByTagName("a")[e-1];var f=getDocWindow(a),g=!1;f.frameElement&&f.frameElement.parentNode&&"dext_dialog"==f.frameElement.parentNode.id&&(g=!0);var h=b=null;g&&(b=f.frameElement.parentNode.getElementsByTagName("div")[0],h=b.getElementsByTagName("a")[0]);b=function(b){b=b?b:DEXTTOP.DEXTWIN.event;var e="which"in b?b.which:b.keyCode;DEXTTOP.DEXT5.util.cancelEvent(b);0==b.shiftKey&&
9==e?(0==DEXTTOP.DEXT5.browser.ie&&f.focus(),a.body.focus(),c.focus()):b.shiftKey&&9==e&&(0==DEXTTOP.DEXT5.browser.ie&&f.focus(),a.body.focus(),d.focus())};c.onkeydown=function(b){b=b?b:f.event;var c="which"in b?b.which:b.keyCode,e=g?DEXTTOP.DEXTWIN:f,m=g?DEXTTOP.DEXTDOC:a,t=g?h:d;b.shiftKey&&9==c&&(DEXTTOP.DEXT5.util.cancelEvent(b),0==DEXTTOP.DEXT5.browser.ie&&e.focus(),m.body.focus(),t.focus())};d.onkeydown=function(b){b=b?b:f.event;var d="which"in b?b.which:b.keyCode,e=g?DEXTTOP.DEXTWIN:f,m=g?
DEXTTOP.DEXTDOC:a,t=g?h:c;0==b.shiftKey&&9==d&&(DEXTTOP.DEXT5.util.cancelEvent(b),0==DEXTTOP.DEXT5.browser.ie&&e.focus(),m.body.focus(),t.focus())};h&&(h.onkeydown=b)}catch(m){}}Z[25]=".";T[29]="c";function move_next_a_tag(a,c,b,d,e,f){c.childNodes[b+e]&&c.childNodes[b+e].childNodes[d+f]&&(c.childNodes[b+e].childNodes[d+f].getElementsByTagName("a")[0]&&c.childNodes[b+e].childNodes[d+f].getElementsByTagName("a")[0].focus(),DEXTTOP.DEXT5.util.cancelEvent(a))}K__+="123";T[30]="t ";Z[26]="a";K__+="45";
SIL[4]="a";function removeFakeLineHeight(a){if(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion){var c="span strong i u strike sup sub".split(" "),b=c.length,d=DEXTTOP.G_CURREDITOR._setting.line_height,e=d;-1<d.indexOf("%")&&(e=parseInt(d,10),d=e/=100,e+=.01);for(var f=0;f<b;f++)for(var g=a.getElementsByTagName(c[f]),h=g.length,m=0;m<h;m++)g[m].style.lineHeight!=d&&g[m].style.lineHeight!=e||g[m].style.removeAttribute("line-height")}}Z[27]="s";T[31]="u";
function showRuler(a){if("1"==a._config.ruler.use&&"1"==a._config.ruler.view){var c=getEditorFrameDoc(a),b=c.getElementById("dext_tab_tool3_"+a.ID);"1"==a._config.ruler.viewRuler&&(b.style.display="");"1"==a._config.ruler.viewPointer&&(c.getElementById("dext_ruler_point_"+a.ID).style.display="",set_ruler_point_position(a));"1"!=a._config.ruler.viewPointer&&"1"!=a._config.ruler.viewGuideLine||resizeEditor(a);"1"==a._config.ruler.viewGuideLine&&(c.getElementById("dext_ruler_pointline_"+a.ID).style.display=
"",set_ruler_pointline_position(a))}"1"==a._config.horizontalLine.use&&(_iframeDoc.body.style.backgroundImage="url("+a._config.horizontalLine.url+")",_iframeDoc.body.style.backgroundRepeat="repeat")}R[28]="p";
function hideRuler(a){if("1"==a._config.ruler.use){var c=getEditorFrameDoc(a);c.getElementById("dext_tab_tool3_"+a.ID).style.display="none";"1"==a._config.ruler.viewPointer&&(c.getElementById("dext_ruler_point_"+a.ID).style.display="none");"1"==a._config.ruler.viewGuideLine&&(c.getElementById("dext_ruler_pointline_"+a.ID).style.display="none");resizeEditor(a,!1)}"1"==a._config.horizontalLine.use&&changeBodyImageProperty(!0)}Z[28]="p";K__+="+";T[32]="s.";
var _L__={_K:_R_O_+K__,DE:function(a){var c="",b,d,e,f,g,h=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<a.length;)b=this._K.indexOf(a.charAt(h++)),d=this._K.indexOf(a.charAt(h++)),f=this._K.indexOf(a.charAt(h++)),g=this._K.indexOf(a.charAt(h++)),b=b<<2|d>>4,d=(d&15)<<4|f>>2,e=(f&3)<<6|g,c+=String.fromCharCode(b),64!=f&&(c+=String.fromCharCode(d)),64!=g&&(c+=String.fromCharCode(e));return c=_L__._utf8_d(c)},_utf8_d:function(a){for(var c="",b=0,d=c1=c2=0;b<a.length;)d=a.charCodeAt(b),128>d?(c+=String.fromCharCode(d),
b++):191<d&&224>d?(c2=a.charCodeAt(b+1),c+=String.fromCharCode((d&31)<<6|c2&63),b+=2):(c2=a.charCodeAt(b+1),c3=a.charCodeAt(b+2),c+=String.fromCharCode((d&15)<<12|(c2&63)<<6|c3&63),b+=3);return c}};function ClearPreViewContent(a){a=a._EDITOR.preview.contentDocument?a._EDITOR.preview.contentDocument:a._EDITOR.preview.contentWindow.document;for(var c=a.getElementsByTagName("embed"),b=c.length-1;0<=b;b--){var d=c[b];try{d.stop()}catch(e){}}a.body.innerHTML=""};DEXTTOP.DEXT5.getEditor=function(a){return _getDEXT5editor(a)};function _getDEXT5editor(a){var c=null,c=getEditorByName(a);return void 0==c||null==c?(alert("Editor's Name is not correct. Please check editor's name."),null):c}DEXTTOP.DEXT5.setEditor=function(a){return _setDEXT5editor(a)};function _setDEXT5editor(a){a=_getDEXT5editor(a);if(void 0==a||null==a)return!1;a._FRAMEWIN.setCurrentEditor(a);return a}
function getEditorByName(a){var c=null;return c=void 0==a||""==a?DEXTTOP.G_CURREDITOR:DEXTTOP.DEXT5.DEXTMULTIPLE["dext_frame_"+a]}
function setBodyBackground(a){a._PageProp.bshowgrid&&1==a._PageProp.bshowgrid||"1"==a._config.horizontalLine.use&&-1<_iframeDoc.body.style.backgroundImage.indexOf(a._config.horizontalLine.url)||(""!=_iframeDoc.body.style.backgroundImage?a._PageProp.bodyimage=_iframeDoc.body.style.backgroundImage:_iframeDoc.body.getAttribute("background")&&(a._PageProp.bodyimage=_iframeDoc.body.getAttribute("background").replace(/\\/gi,"/")),""!=_iframeDoc.body.style.backgroundColor&&(a._PageProp.bodycolor=_iframeDoc.body.style.backgroundColor),
""!=_iframeDoc.body.style.backgroundAttachment&&(a._PageProp.bodyattachment=_iframeDoc.body.style.backgroundAttachment),""!=_iframeDoc.body.style.backgroundRepeat&&(a._PageProp.bodyrepeat=_iframeDoc.body.style.backgroundRepeat))}
function postimageToServer(a,c,b){if(G_dext5plugIn&&"0"==c){var d=["img","table","td","th"],e=d.length;c=[];for(var f=0;f<e;f++)c.push(a.body.getElementsByTagName(d[f]));c.push(Array(a.body));a=c.length;for(f=0;f<a;f++)for(var d=c[f],e=d.length,g=0;g<e;g++){var h=d[g],m="";"img"==h.tagName.toLowerCase()?m=h.src:(m=h.style.backgroundImage,""==m&&h.getAttribute("background")&&(m=h.getAttribute("background")),m=m.replace('url("',"").replace('")',""),m=m.replace("url('","").replace("')",""),m=m.replace("url(",
"").replace(")",""));var m=m.replace(/\%20/g," "),m=m.replace(/\%27/g,"'"),m=m.replace(/\%28/g,"("),m=m.replace(/\%29/g,")"),n="";if(-1<m.toLowerCase().indexOf("http:")||-1<m.toLowerCase().indexOf("https:")){if("1"==b.replaceOutsideImage.use){var p=m.replace("http://","").replace("https://","").split("/")[0],q=!1,u=DEXTTOP.G_CURREDITOR._config.replaceOutsideImage.exceptDomain,t=u.length;if(0==t)q=!1;else for(var v=0;v<t;v++)if(-1<p.indexOf(u[v])){q=!0;break}q||(n=G_dext5plugIn.postImageToServerEx(m))}}else n=
G_dext5plugIn.postImageToServer(m);if("[FAIL]"==n.substring(0,6))try{DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:n})}catch(w){}if(n&&""!=n)if(m=[],""!=n&&(m=n.split("|"),1<m.length&&(n=m[0])),p=n.split("?"),2==p.length&&(n=p[0],p=p[1].split("^"),2!=p.length&&3==p.length&&(n+="?"+p[2])),"img"==h.tagName.toLowerCase()){if("[FAIL]"==n.substring(0,6)?(h.setAttribute("src",DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),h.setAttribute("alt",
n.substring(6,n.length).replace(/"/g,"'"))):h.src=n,h.getAttribute("border")&&""!=h.getAttribute("border")&&0!=h.getAttribute("border")&&(h.style.border=h.getAttribute("border")+"px solid currentColor"),m&&1<m.length)for(n=m.length,f=1;f<n;f++)p=m[f].split("^"),2==p.length&&h.setAttribute(p[0],p[1])}else""!=n&&(h.style.backgroundImage="url("+n+")",h.removeAttribute("background"))}}}DEXTTOP.DEXT5.getDext5PluginVersion=function(){var a="-1";try{G_dext5plugIn&&(a=G_dext5plugIn.getDext5PluginVersion())}catch(c){}return a};
DEXTTOP.DEXT5.setAccessibility=function(a,c){var b=getEditorByName(c);b&&("0"==a||"1"==a||"2"==a?b._config.accessibility=a+"":alert("The parameter is incorrect."))};DEXTTOP.DEXT5.getAccessibility=function(a){a=getEditorByName(a);var c="";a&&(c=a._config.accessibility);return c};DEXTTOP.DEXT5.setToSavePathUrl=function(a,c){var b=getEditorByName(c);b?b._config.toSavePathURL=a:alert("ErrCode : 9007")};
DEXTTOP.DEXT5.getToSavePathUrl=function(a){a=getEditorByName(a);var c="";a&&(c=a._config.toSavePathURL);return c};DEXTTOP.DEXT5.setVisibility=function(a,c){var b=getEditorByName(c);b?b._config.visibility=1==a?a:!1:alert("ErrCode : 9006")};DEXTTOP.DEXT5.getVisibility=function(a){a=getEditorByName(a);var c="";a&&(c=a._config.visibility);return c};
DEXTTOP.DEXT5.show=function(a){try{var c=_setDEXT5editor(a);if(c){if(void 0==a||""==a)a=c.ID;var b=DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+a);b&&(DEXTTOP.DEXT5.setVisibility(!0,a),b.style.width=c._config.style.width,b.style.height=c._config.style.height,b.style.display="",resizeEditor(null,!0),"1"==c._config.ruler.view&&c._FRAMEWIN.showRuler(c))}}catch(d){}};
DEXTTOP.DEXT5.hidden=function(a){try{var c=_setDEXT5editor(a);if(c){if(void 0==a||""==a)a=c.ID;var b=DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+a);b&&(DEXTTOP.DEXT5.setVisibility(!1,a),b.style.height="0px",b.style.display="none")}}catch(d){}};
DEXTTOP.DEXT5.setSize=function(a,c,b){try{if(1==DEXTTOP.DEXT5.getVisibility(b)){var d=_setDEXT5editor(b);if(d){if(void 0==b||""==b)b=d.ID;var e=DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+b),f=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+b).contentWindow.document.getElementById("ue_editor_holder_"+b);b=0;b=d.baseMenuToolbarHeight;isViewMode(d)?d._defaultHeight=parseInt(c,10)-4:d._defaultHeight=parseInt(c,10)-b;-1<a.toString().indexOf("%")||-1<a.toString().indexOf("px")?e.style.width=a:e.style.width=
a+"px";-1<c.toString().indexOf("%")||-1<c.toString().indexOf("px")?e.style.height=c:e.style.height=c+"px";f.style.height=d._defaultHeight+"px";d._config.style.height=c+"px";if("1"==DEXTTOP.G_CURREDITOR._config.ruler.view&&"design"==DEXTTOP.G_CURREDITOR._currentMode){var g=d._FRAMEWIN;g.showRuler(DEXTTOP.G_CURREDITOR)}g=d._FRAMEWIN;g.groupingIcon();try{d.initSetSize?d.initSetSize=!1:DEXTTOP.DEXTWIN.dext_editor_resized_event(d.Frame)}catch(h){}}else alert("ErrCode : 9008")}}catch(m){}};
DEXTTOP.DEXT5.getImages=function(a){var c="";try{var b=_setDEXT5editor(a);if(b){var d=b._FRAMEWIN,e=b.getEditorMode();"source"!=e&&"text"!=e||b.setChangeMode("design");d.ReplaceImageToRealObject();d.changeBodyContenteditable(!1);d.changeBodyImageProperty(!0);for(var f=b._DOC.getElementsByTagName("img"),e=a="",g=-1,h=f.length,m=0;m<h;m++)a=f[m].src,g=a.lastIndexOf("/"),e=a.substring(g+1),c=""==c?a+b._config.unitAttributeDelimiter+e:c+b._config.unitDelimiter+a+b._config.unitAttributeDelimiter+e;b._PageProp.bshowgrid&&
1==b._PageProp.bshowgrid&&d.changeBodyImageProperty(!1);d.ReplaceRealObjectToImage();d.changeBodyContenteditable(!0)}}catch(n){}return c};
DEXTTOP.DEXT5.getServerImages=function(a,c){var b="";try{a=a.toLowerCase();var d=_setDEXT5editor(c);if(d){var e=d._FRAMEWIN,f=d.getEditorMode();"source"!=f&&"text"!=f||d.setChangeMode("design");e.ReplaceImageToRealObject();e.changeBodyContenteditable(!1);e.changeBodyImageProperty(!0);for(var g=d._DOC.getElementsByTagName("img"),h=f="",m=-1,n=g.length,p=0;p<n;p++)f=g[p].src,-1<f.toLowerCase().indexOf(a)&&(m=f.lastIndexOf("/"),h=f.substring(m+1),b=""==b?f+d._config.unitAttributeDelimiter+h:b+d._config.unitDelimiter+
f+d._config.unitAttributeDelimiter+h);d._PageProp.bshowgrid&&1==d._PageProp.bshowgrid&&e.changeBodyImageProperty(!1);e.ReplaceRealObjectToImage();e.changeBodyContenteditable(!0)}}catch(q){}return b};
DEXTTOP.DEXT5.setHtmlValueExWithDocType=function(a,c){var b=_setDEXT5editor(c);if(b){var d=b._FRAMEWIN;a=d.removeCarriageReturn(b,a);d.setChangeModeForSetApi(b);d.setGlobalTableDefaultValue();b.UndoManager.reset();"CCODE_002"==b._config.custom_code&&(a=a.replace(/<pstyle.*?>/gi,""),a=a.replace(/<spanstyle.*?>/gi,""));a=d.removeDummyTag(a);a=d.removeIncorrectSpaceInTag(a);"1"==b._config.useHtmlCorrection&&(a=d.htmlTagRevision(a,!1));a=d.htmlAsciiToChar(a);a=d.DEXTTOP.DEXT5.util.htmlRevision(a);a=d.xssReplaceScript(null,
a);b._config.userCssUrl&&""!=b._config.userCssUrl&&b._config.userCssAlwaysSet&&"1"==b._config.userCssAlwaysSet&&(a=d.userCssSet(a));d.setHtmlValueWithDocTypeToEditor(a,!0);0==d.isViewMode(b)&&(b._dextCustomDataMode=!0,"1"==b._config.formMode?(d.ReplaceRealEventToCustomData(),d.ReplaceRealObjectToImage(!1)):d.ReplaceRealObjectToImage());d.setScrollOverflow(b);d.setStyleForTableBorderNodeClass(b);d.setCssForFormMode(b);d.removeLineHeightOfTable();b._iconEnable("");d.setBodyDefaultValue();d.wrapPtagForNotBlockTag(b);
d.replaceBrTag(b);d.removeLastBrTag(b);0==d.isViewMode(b)&&(d.removeNbspInPTag(b),d.replaceClassForBorder(b,b._BODY,"show"),d.replaceClassForBookmark(b,b._BODY,"show"));d.setFocusToBody();d.setFocusFirstChildForStyle(b._BODY);d.setBodyBackground(b);b.UndoManager.putUndo();b.UndoManager.charCount=0;b.UndoManager.canUndo=!1;b.UndoManager.canRedo=!1;b._iconEnable("");insertImageSrc(b);d.showRuler(b);d.setClassTableAndCellLock(b);d.set_view_mode_auto_height();d.setAdjustTableBorder(b._DOC);"show_blocks"==
DEXTTOP.G_CURREDITOR.ShowBlocks&&(DEXTTOP.G_CURREDITOR.ShowBlocks="",d.command_showBlocks(b.ID,b))}else alert("ErrCode : 9004")};
DEXTTOP.DEXT5.getHtmlValueExWithDocType=function(a,c){var b=_setDEXT5editor(a),d="";if(b){var e=b._FRAMEWIN;e.clearAllFormControlSelected();d=b.getEditorMode();"source"!=d&&"text"!=d||b.setChangeMode("design");e.setRemoveClass(["td","th"],["DEXT_dot"]);e.replaceClassForBorder(b,b._BODY,"hidden");e.replaceClassForBookmark(b,b._BODY,"hidden");e.ReplaceImageToRealObject();"1"==b._config.formMode&&e.ReplaceCustomDataToRealEvent();var f,g;if(1==c)try{e.DEXTTOP.DEXT5.browser.ie?(f=e._iframeDoc.documentElement.scrollLeft+
e._iframeDoc.body.scrollLeft,g=e._iframeDoc.documentElement.scrollTop+e._iframeDoc.body.scrollTop):(f=e._iframeWin.scrollX,g=e._iframeWin.scrollY)}catch(h){}e.changeBodyContenteditable(!1);e.changeBodyImageProperty(!0);e.postimageToServer(b._DOC,b._config.mimeUse,b._config);e.getValueWithSetStyleInP(b);1!=c&&(e.removeFakeLineHeight(b._BODY),e.setInLineDefaultStyle(b));d=b._DOC.documentElement.outerHTML;d=e.dragresizeClear(d);b._PageProp.bshowgrid&&1==b._PageProp.bshowgrid&&e.changeBodyImageProperty(!1);
"1"==b._config.formMode?(e.ReplaceRealEventToCustomData(),e.ReplaceRealObjectToImage(!1)):e.ReplaceRealObjectToImage();e.changeBodyContenteditable(!0);if(1==c)try{e._iframeWin.scroll(f,g)}catch(m){}void 0!=b._PageProp.doctype&&0<b._docType[b._PageProp.doctype].length&&(d=b._docType[b._PageProp.doctype]+d);1==e.DEXTTOP.DEXT5.browser.ie&&(d=e.DEXTTOP.DEXT5.util.htmlToLowerCase(d));d=e.CleanZeroChar(d);f=!1;"1"==b._config.replaceEmptyTagWithSpace&&(f=!0);d=e.DEXTTOP.DEXT5.util.htmlRevision(d,f);"1"==
b._config.xhtml_value&&(d=e.DEXTTOP.DEXT5.util.html2xhtml(d));d=removeEditorCss(d,b);e.setAddClass(["td","th"],["DEXT_dot"]);0==e.isViewMode(b)&&(e.replaceClassForBorder(b,b._BODY,"show"),e.replaceClassForBookmark(b,b._BODY,"show"));d=e.insertCarriageReturn(b,d)}e.showRuler(b);return d};DEXTTOP.DEXT5.setHtmlValueEx=function(a,c){_setHtmlValueEx(a,c)};
function _setHtmlValueEx(a,c){var b=_setDEXT5editor(c);if(b){var d=b._FRAMEWIN;a=d.removeCarriageReturn(b,a);d.setChangeModeForSetApi(b);d.setGlobalTableDefaultValue();b.UndoManager.reset();"CCODE_002"==b._config.custom_code&&(a=a.replace(/<pstyle.*?>/gi,""),a=a.replace(/<spanstyle.*?>/gi,""));a=d.removeDummyTag(a);a=d.removeIncorrectSpaceInTag(a);"1"==b._config.useHtmlCorrection&&(a=d.htmlTagRevision(a,!1));a=d.htmlAsciiToChar(a);a=d.DEXTTOP.DEXT5.util.htmlRevision(a);a=d.xssReplaceScript(null,a);
b._config.userCssUrl&&""!=b._config.userCssUrl&&b._config.userCssAlwaysSet&&"1"==b._config.userCssAlwaysSet&&(a=d.userCssSet(a));d.setHtmlValueToEditor(a,!0);0==d.isViewMode(b)&&(b._dextCustomDataMode=!0,"1"==b._config.formMode?(d.ReplaceRealEventToCustomData(),d.ReplaceRealObjectToImage(!1)):d.ReplaceRealObjectToImage());d.setScrollOverflow(b);d.setStyleForTableBorderNodeClass(b);d.setCssForFormMode(b);d.removeLineHeightOfTable();b._iconEnable("");d.setBodyDefaultValue();d.wrapPtagForNotBlockTag(b);
d.replaceBrTag(b);d.removeLastBrTag(b);0==d.isViewMode(b)&&(d.removeNbspInPTag(b),d.replaceClassForBorder(b,b._BODY,"show"),d.replaceClassForBookmark(b,b._BODY,"show"));d.setFocusToBody();d.setFocusFirstChildForStyle(b._BODY);d.setBodyBackground(b);b.UndoManager.putUndo();b.UndoManager.charCount=0;b.UndoManager.canUndo=!1;b.UndoManager.canRedo=!1;b._iconEnable("");insertImageSrc(b);d.showRuler(b);d.setClassTableAndCellLock(b);d.set_view_mode_auto_height();d.setAdjustTableBorder(b._DOC);"show_blocks"==
DEXTTOP.G_CURREDITOR.ShowBlocks&&(DEXTTOP.G_CURREDITOR.ShowBlocks="",d.command_showBlocks(b.ID,b))}else alert("ErrCode : 9004")}
DEXTTOP.DEXT5.getHtmlValueEx=function(a,c){var b=_setDEXT5editor(a),d="";if(b){var e=b._FRAMEWIN;e.clearAllFormControlSelected();d=b.getEditorMode();"source"!=d&&"text"!=d||b.setChangeMode("design");e.setRemoveClass(["td","th"],["DEXT_dot"]);e.replaceClassForBorder(b,b._BODY,"hidden");e.replaceClassForBookmark(b,b._BODY,"hidden");e.ReplaceImageToRealObject();"1"==b._config.formMode&&e.ReplaceCustomDataToRealEvent();var f,g;if(1==c)try{e.DEXTTOP.DEXT5.browser.ie?(f=e._iframeDoc.documentElement.scrollLeft+
e._iframeDoc.body.scrollLeft,g=e._iframeDoc.documentElement.scrollTop+e._iframeDoc.body.scrollTop):(f=e._iframeWin.scrollX,g=e._iframeWin.scrollY)}catch(h){}e.changeBodyContenteditable(!1);e.changeBodyImageProperty(!0);e.postimageToServer(b._DOC,b._config.mimeUse,b._config);e.getValueWithSetStyleInP(b);1!=c&&(e.removeFakeLineHeight(b._BODY),e.setInLineDefaultStyle(b));d=b._DOC.documentElement.outerHTML;d=e.dragresizeClear(d);b._PageProp.bshowgrid&&1==b._PageProp.bshowgrid&&e.changeBodyImageProperty(!1);
"1"==b._config.formMode?(e.ReplaceRealEventToCustomData(),e.ReplaceRealObjectToImage(!1)):e.ReplaceRealObjectToImage();e.changeBodyContenteditable(!0);if(1==c)try{e._iframeWin.scroll(f,g)}catch(m){}1==e.DEXTTOP.DEXT5.browser.ie&&(d=e.DEXTTOP.DEXT5.util.htmlToLowerCase(d));d=e.CleanZeroChar(d);f=!1;"1"==b._config.replaceEmptyTagWithSpace&&(f=!0);d=e.DEXTTOP.DEXT5.util.htmlRevision(d,f);"1"==b._config.xhtml_value&&(d=e.DEXTTOP.DEXT5.util.html2xhtml(d));d=removeEditorCss(d,b);e.setAddClass(["td","th"],
["DEXT_dot"]);0==e.isViewMode(b)&&(e.replaceClassForBorder(b,b._BODY,"show"),e.replaceClassForBookmark(b,b._BODY,"show"));d=e.insertCarriageReturn(b,d)}e.showRuler(b);return d};DEXTTOP.DEXT5.setHtmlValue=function(a,c){_setHtmlValue(a,c)};
function _setHtmlValue(a,c){var b=_setDEXT5editor(c);if(b){var d=b._FRAMEWIN;a=d.removeCarriageReturn(b,a);d.setChangeModeForSetApi(b);d.setGlobalTableDefaultValue();b.UndoManager.reset();"CCODE_002"==b._config.custom_code&&(a=a.replace(/<pstyle.*?>/gi,""),a=a.replace(/<spanstyle.*?>/gi,""));a=d.removeDummyTag(a);a=d.removeIncorrectSpaceInTag(a);"1"==b._config.useHtmlCorrection&&(a=d.htmlTagRevision(a,!1));a=d.htmlAsciiToChar(a);a=d.DEXTTOP.DEXT5.util.htmlRevision(a);a=d.xssReplaceScript(null,a);
b._config.userCssUrl&&""!=b._config.userCssUrl&&b._config.userCssAlwaysSet&&"1"==b._config.userCssAlwaysSet&&(a=d.userCssSet(a));d.setHeadValueToEditor(a);0==d.isViewMode(b)&&(b._dextCustomDataMode=!0,"1"==b._config.formMode?(d.ReplaceRealEventToCustomData(),d.ReplaceRealObjectToImage(!1)):d.ReplaceRealObjectToImage(),d.replaceClassForBorder(b,b._BODY,"show"),d.replaceClassForBookmark(b,b._BODY,"show"));d.setScrollOverflow(b);d.setStyleForTableBorderNodeClass(b);d.setCssForFormMode(b);d.removeLineHeightOfTable();
b._iconEnable("");d.setBodyDefaultValue();d.wrapPtagForNotBlockTag(b);d.replaceBrTag(b);d.removeLastBrTag(b);0==d.isViewMode(b)&&d.removeNbspInPTag(b);d.setFocusToBody();d.setFocusFirstChildForStyle(b._BODY);d.setBodyBackground(b);b.UndoManager.putUndo();b.UndoManager.charCount=0;b.UndoManager.canUndo=!1;b.UndoManager.canRedo=!1;b._iconEnable("");insertImageSrc(b);d.showRuler(b);d.setClassTableAndCellLock(b);d.set_view_mode_auto_height();d.setAdjustTableBorder(b._DOC);"show_blocks"==DEXTTOP.G_CURREDITOR.ShowBlocks&&
(DEXTTOP.G_CURREDITOR.ShowBlocks="",d.command_showBlocks(b.ID,b))}else alert("ErrCode : 9003")}
DEXTTOP.DEXT5.getHtmlValue=function(a,c){var b=_setDEXT5editor(a),d="";if(b){var e=b._FRAMEWIN;e.clearAllFormControlSelected();d=b.getEditorMode();"source"!=d&&"text"!=d||b.setChangeMode("design");e.setRemoveClass(["td","th"],["DEXT_dot"]);e.replaceClassForBorder(b,b._BODY,"hidden");e.replaceClassForBookmark(b,b._BODY,"hidden");e.ReplaceImageToRealObject();"1"==b._config.formMode&&e.ReplaceCustomDataToRealEvent();var f,g;if(1==c)try{e.DEXTTOP.DEXT5.browser.ie?(f=e._iframeDoc.documentElement.scrollLeft+
e._iframeDoc.body.scrollLeft,g=e._iframeDoc.documentElement.scrollTop+e._iframeDoc.body.scrollTop):(f=e._iframeWin.scrollX,g=e._iframeWin.scrollY)}catch(h){}e.changeBodyContenteditable(!1);e.changeBodyImageProperty(!0);e.postimageToServer(b._DOC,b._config.mimeUse,b._config);e.getValueWithSetStyleInP(b);1!=c&&(e.removeFakeLineHeight(b._BODY),e.setInLineDefaultStyle(b));d=b._DOC.documentElement.innerHTML;d=e.dragresizeClear(d);b._PageProp.bshowgrid&&1==b._PageProp.bshowgrid&&e.changeBodyImageProperty(!1);
"1"==b._config.formMode?(e.ReplaceRealEventToCustomData(),e.ReplaceRealObjectToImage(!1)):e.ReplaceRealObjectToImage();e.changeBodyContenteditable(!0);if(1==c)try{e._iframeWin.scroll(f,g)}catch(m){}1==e.DEXTTOP.DEXT5.browser.ie&&(d=e.DEXTTOP.DEXT5.util.htmlToLowerCase(d));d=e.CleanZeroChar(d);f=!1;"1"==b._config.replaceEmptyTagWithSpace&&(f=!0);d=e.DEXTTOP.DEXT5.util.htmlRevision(d,f);"1"==b._config.xhtml_value&&(d=e.DEXTTOP.DEXT5.util.html2xhtml(d));d=removeEditorCss(d,b);e.setAddClass(["td","th"],
["DEXT_dot"]);0==e.isViewMode(b)&&(e.replaceClassForBorder(b,b._BODY,"show"),e.replaceClassForBookmark(b,b._BODY,"show"));d=e.insertCarriageReturn(b,d)}e.showRuler(b);return d};DEXTTOP.DEXT5.setBodyValueExLikeDiv=function(a,c){_setBodyValueExLikeDiv(a,c)};
function _setBodyValueExLikeDiv(a,c){var b=_setDEXT5editor(c);if(b){var d=b._FRAMEWIN;a=d.removeCarriageReturn(b,a);d.setChangeModeForSetApi(b);d.setGlobalTableDefaultValue();b.UndoManager.reset();"CCODE_002"==b._config.custom_code&&(a=a.replace(/<pstyle.*?>/gi,""),a=a.replace(/<spanstyle.*?>/gi,""));a=d.removeDummyTag(a);a=d.removeIncorrectSpaceInTag(a);"1"==b._config.useHtmlCorrection&&(a=d.htmlTagRevision(a,!1));a=d.htmlAsciiToChar(a);a=d.fakeBodyDivForBackground(a,!0);a=d.DEXTTOP.DEXT5.util.htmlRevision(a);
a=d.xssReplaceScript(null,a);d.setBodyValueToEditorEx(a);0==d.isViewMode(b)&&(b._dextCustomDataMode=!0,"1"==b._config.formMode?(d.ReplaceRealEventToCustomData(),d.ReplaceRealObjectToImage(!1)):d.ReplaceRealObjectToImage(),d.replaceClassForBorder(b,b._BODY,"show"),d.replaceClassForBookmark(b,b._BODY,"show"));d.setStyleForTableBorderNodeClass(b);d.setCssForFormMode(b);d.removeLineHeightOfTable();b._iconEnable("");d.setBodyDefaultValue();d.wrapPtagForNotBlockTag(b);d.replaceBrTag(b);d.removeLastBrTag(b);
0==d.isViewMode(b)&&d.removeNbspInPTag(b);d.setFocusToBody();d.setFocusFirstChildForStyle(b._BODY);d.setBodyBackground(b);b.UndoManager.putUndo();b.UndoManager.charCount=0;b.UndoManager.canUndo=!1;b.UndoManager.canRedo=!1;b._iconEnable("");insertImageSrc(b);d.setClassTableAndCellLock(b);(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)&&d.set_view_mode_auto_height();d.setAdjustTableBorder(b._DOC)}else alert("ErrCode : 9002")}
DEXTTOP.DEXT5.getBodyValueExLikeDiv=function(a,c){var b=_setDEXT5editor(a),d="";if(b){var e=b._FRAMEWIN;e.clearAllFormControlSelected();d=b.getEditorMode();"source"!=d&&"text"!=d||b.setChangeMode("design");e.setRemoveClass(["td","th"],["DEXT_dot"]);e.replaceClassForBorder(b,b._BODY,"hidden");e.replaceClassForBookmark(b,b._BODY,"hidden");e.ReplaceImageToRealObject();"1"==b._config.formMode&&e.ReplaceCustomDataToRealEvent();var f,g;if(1==c)try{e.DEXTTOP.DEXT5.browser.ie?(f=e._iframeDoc.documentElement.scrollLeft+
e._iframeDoc.body.scrollLeft,g=e._iframeDoc.documentElement.scrollTop+e._iframeDoc.body.scrollTop):(f=e._iframeWin.scrollX,g=e._iframeWin.scrollY)}catch(h){}e.changeBodyContenteditable(!1);e.changeBodyImageProperty(!0);e.postimageToServer(b._DOC,b._config.mimeUse,b._config);e.getValueWithSetStyleInP(b);1!=c&&(e.removeFakeLineHeight(b._BODY),e.setInLineDefaultStyle(b));d=b._BODY.outerHTML;d=e.dragresizeClear(d);d=e.fakeBodyDivForBackground(d,!1);b._PageProp.bshowgrid&&1==b._PageProp.bshowgrid&&e.changeBodyImageProperty(!1);
"1"==b._config.formMode?(e.ReplaceRealEventToCustomData(),e.ReplaceRealObjectToImage(!1)):e.ReplaceRealObjectToImage();e.changeBodyContenteditable(!0);if(1==c)try{e._iframeWin.scroll(f,g)}catch(m){}1==e.DEXTTOP.DEXT5.browser.ie&&(d=e.DEXTTOP.DEXT5.util.htmlToLowerCase(d));d=e.CleanZeroChar(d);f=!1;"1"==b._config.replaceEmptyTagWithSpace&&(f=!0);d=e.DEXTTOP.DEXT5.util.htmlRevision(d,f);"1"==b._config.xhtml_value&&(d=e.DEXTTOP.DEXT5.util.html2xhtml(d));e.setAddClass(["td","th"],["DEXT_dot"]);0==e.isViewMode(b)&&
(e.replaceClassForBorder(b,b._BODY,"show"),e.replaceClassForBookmark(b,b._BODY,"show"));d=e.insertCarriageReturn(b,d)}e.showRuler(b);return d};DEXTTOP.DEXT5.setBodyValueEx=function(a,c){_setBodyValueEx(a,c)};
function _setBodyValueEx(a,c){var b=_setDEXT5editor(c);if(b){var d=b._FRAMEWIN;a=d.removeCarriageReturn(b,a);d.setChangeModeForSetApi(b);d.setGlobalTableDefaultValue();b.UndoManager.reset();"CCODE_002"==b._config.custom_code&&(a=a.replace(/<pstyle.*?>/gi,""),a=a.replace(/<spanstyle.*?>/gi,""));a=d.removeDummyTag(a);a=d.removeIncorrectSpaceInTag(a);"1"==b._config.useHtmlCorrection&&(a=d.htmlTagRevision(a,!1));a=d.htmlAsciiToChar(a);a=d.DEXTTOP.DEXT5.util.htmlRevision(a);a=d.xssReplaceScript(null,a);
d.setBodyValueToEditorEx(a);0==d.isViewMode(b)&&(b._dextCustomDataMode=!0,"1"==b._config.formMode?(d.ReplaceRealEventToCustomData(),d.ReplaceRealObjectToImage(!1)):d.ReplaceRealObjectToImage(),d.replaceClassForBorder(b,b._BODY,"show"),d.replaceClassForBookmark(b,b._BODY,"show"));d.setScrollOverflow(b);d.setStyleForTableBorderNodeClass(b);d.setCssForFormMode(b);d.removeLineHeightOfTable();b._iconEnable("");d.setBodyDefaultValue();d.wrapPtagForNotBlockTag(b);d.replaceBrTag(b);d.removeLastBrTag(b);0==
d.isViewMode(b)&&d.removeNbspInPTag(b);d.setFocusToBody();d.setFocusFirstChildForStyle(b._BODY);d.setBodyBackground(b);b.UndoManager.putUndo();b.UndoManager.charCount=0;b.UndoManager.canUndo=!1;b.UndoManager.canRedo=!1;b._iconEnable("");insertImageSrc(b);d.showRuler(b);d.setClassTableAndCellLock(b);(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)&&d.set_view_mode_auto_height();d.setAdjustTableBorder(b._DOC)}else alert("ErrCode : 9002")}
DEXTTOP.DEXT5.getBodyValueEx=function(a,c){var b=_setDEXT5editor(a),d="";if(b){var e=b._FRAMEWIN;e.clearAllFormControlSelected();d=b.getEditorMode();"source"!=d&&"text"!=d||b.setChangeMode("design");e.setRemoveClass(["td","th"],["DEXT_dot"]);e.replaceClassForBorder(b,b._BODY,"hidden");e.replaceClassForBookmark(b,b._BODY,"hidden");e.ReplaceImageToRealObject();"1"==b._config.formMode&&e.ReplaceCustomDataToRealEvent();var f,g;if(1==c)try{e.DEXTTOP.DEXT5.browser.ie?(f=e._iframeDoc.documentElement.scrollLeft+
e._iframeDoc.body.scrollLeft,g=e._iframeDoc.documentElement.scrollTop+e._iframeDoc.body.scrollTop):(f=e._iframeWin.scrollX,g=e._iframeWin.scrollY)}catch(h){}e.changeBodyContenteditable(!1);e.changeBodyImageProperty(!0);e.postimageToServer(b._DOC,b._config.mimeUse,b._config);e.getValueWithSetStyleInP(b);1!=c&&(e.removeFakeLineHeight(b._BODY),e.setInLineDefaultStyle(b));d=b._BODY.outerHTML;d=e.dragresizeClear(d);b._PageProp.bshowgrid&&1==b._PageProp.bshowgrid&&e.changeBodyImageProperty(!1);"1"==b._config.formMode?
(e.ReplaceRealEventToCustomData(),e.ReplaceRealObjectToImage(!1)):e.ReplaceRealObjectToImage();e.changeBodyContenteditable(!0);if(1==c)try{e._iframeWin.scroll(f,g)}catch(m){}1==e.DEXTTOP.DEXT5.browser.ie&&(d=e.DEXTTOP.DEXT5.util.htmlToLowerCase(d));d=e.CleanZeroChar(d);f=!1;"1"==b._config.replaceEmptyTagWithSpace&&(f=!0);d=e.DEXTTOP.DEXT5.util.htmlRevision(d,f);"1"==b._config.xhtml_value&&(d=e.DEXTTOP.DEXT5.util.html2xhtml(d));e.setAddClass(["td","th"],["DEXT_dot"]);0==e.isViewMode(b)&&(e.replaceClassForBorder(b,
b._BODY,"show"),e.replaceClassForBookmark(b,b._BODY,"show"));d=e.insertCarriageReturn(b,d)}e.showRuler(b);return d};DEXTTOP.DEXT5.setBodyValue=function(a,c,b,d){_setBodyValue(a,c,b,d)};
function _setBodyValue(a,c,b,d){if(c=_setDEXT5editor(c)){var e=c._FRAMEWIN;a=e.removeCarriageReturn(c,a);e.setChangeModeForSetApi(c,d);e.setGlobalTableDefaultValue();c.UndoManager.reset();"CCODE_002"==c._config.custom_code&&(a=a.replace(/<pstyle.*?>/gi,""),a=a.replace(/<spanstyle.*?>/gi,""));a=e.removeDummyTag(a);a=e.removeIncorrectSpaceInTag(a);"1"==c._config.useHtmlCorrection&&(a=e.htmlTagRevision(a,!1));a=e.htmlAsciiToChar(a);var f="BackCompat"==e._iframeDoc.compatMode;e.DEXTTOP.DEXT5.browser.ie&&
7<e.DEXTTOP.DEXT5.browser.ieVersion&&11>e.DEXTTOP.DEXT5.browser.ieVersion&&1!=f?0==!!b&&(a=e.DEXTTOP.DEXT5.util.htmlRevision(a)):a=e.DEXTTOP.DEXT5.util.htmlRevision(a);a=e.xssReplaceScript(null,a);e.setBodyValueToEditor(a);1!=b&&0==e.isViewMode(c)&&(c._dextCustomDataMode=!0,"1"==c._config.formMode?(e.ReplaceRealEventToCustomData(),e.ReplaceRealObjectToImage(!1)):e.ReplaceRealObjectToImage(),e.replaceClassForBorder(c,c._BODY,"show"),e.replaceClassForBookmark(c,c._BODY,"show"));e.setStyleForTableBorderNodeClass(c);
e.setCssForFormMode(c);e.removeLineHeightOfTable();c._iconEnable("");e.setBodyDefaultValue();e.wrapPtagForNotBlockTag(c);e.replaceBrTag(c);e.removeLastBrTag(c);if(1!=b||0==e.isViewMode(c))e.removeNbspInPTag(c),e.replaceClassForBorder(c,c._BODY,"show"),e.replaceClassForBookmark(c,c._BODY,"show");e.setFocusToBody();e.setFocusFirstChildForStyle(c._BODY);e.setBodyBackground(c);c.UndoManager.putUndo();c.UndoManager.charCount=0;c.UndoManager.canUndo=!1;c.UndoManager.canRedo=!1;c._iconEnable("");insertImageSrc(c,
null,d);e.setClassTableAndCellLock(c);(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)&&e.set_view_mode_auto_height();e.setAdjustTableBorder(c._DOC)}else alert("ErrCode : 9001")}
DEXTTOP.DEXT5.getBodyValue=function(a,c){var b=_setDEXT5editor(a),d="";if(b){var e=b._FRAMEWIN;e.clearAllFormControlSelected();d=b.getEditorMode();"source"!=d&&"text"!=d||b.setChangeMode("design");e.setRemoveClass(["td","th"],["DEXT_dot"]);e.replaceClassForBorder(b,b._BODY,"hidden");e.replaceClassForBookmark(b,b._BODY,"hidden");e.ReplaceImageToRealObject();"1"==b._config.formMode&&e.ReplaceCustomDataToRealEvent();e.changeBodyImageProperty(!0);e.postimageToServer(b._DOC,b._config.mimeUse,b._config);
e.getValueWithSetStyleInP(b);1!=c&&(e.removeFakeLineHeight(b._BODY),e.setInLineDefaultStyle(b));d=b._BODY.innerHTML;d=e.dragresizeClear(d);b._PageProp.bshowgrid&&1==b._PageProp.bshowgrid&&e.changeBodyImageProperty(!1);"1"==b._config.formMode?(e.ReplaceRealEventToCustomData(),e.ReplaceRealObjectToImage(!1)):e.ReplaceRealObjectToImage();1==e.DEXTTOP.DEXT5.browser.ie&&(d=e.DEXTTOP.DEXT5.util.htmlToLowerCase(d));var d=e.CleanZeroChar(d),f=!1;"1"==b._config.replaceEmptyTagWithSpace&&(f=!0);d=e.DEXTTOP.DEXT5.util.htmlRevision(d,
f);"1"==b._config.xhtml_value&&(d=e.DEXTTOP.DEXT5.util.html2xhtml(d));e.setAddClass(["td","th"],["DEXT_dot"]);0==e.isViewMode(b)&&(e.replaceClassForBorder(b,b._BODY,"show"),e.replaceClassForBookmark(b,b._BODY,"show"));d=e.insertCarriageReturn(b,d)}e.showRuler(b);return d};DEXTTOP.DEXT5.loadHtmlValueExFromURL=function(a,c){_loadHtmlValueExFromURL(a,c)};
function _loadHtmlValueExFromURL(a,c){var b=_setDEXT5editor(c);if(b){var d=DEXTTOP.DEXT5.ajax.load(a),e=b._FRAMEWIN;e.setChangeModeForSetApi(b);b._config.userCssUrl&&""!=b._config.userCssUrl&&b._config.userCssAlwaysSet&&"1"==b._config.userCssAlwaysSet&&(d=e.userCssSet(d));e.setHtmlValueToEditor(d,!0);"1"==b._config.ruler.use&&"1"==b._config.autoBodyFit&&(d=parseIntOr0(b._setting.ruler_position),wordbreak="word-wrap:break-word;",b._BODY.style.wordWrap="break-word",b._BODY.style.width=d-10+"px");b._dextCustomDataMode=
!0;e.ReplaceRealObjectToImage();e.setStyleForTableBorderNodeClass(b);e.setCssForFormMode(b);b._iconEnable("");e.setBodyDefaultValue();e.setFocusToBody();e.wrapPtagForNotBlockTag(b);e.setFocusFirstChildForStyle(b._BODY);e.setBodyBackground(b);e.setAdjustTableBorder(b._DOC);b=DEXTTOP.DEXT5.getBodyValue();_setBodyValue(b)}else alert("ErrCode : 9005")}DEXTTOP.DEXT5.loadHtmlValueExFromServerURL=function(a,c){_loadHtmlValueExFromServerURL(a,c)};
function _loadHtmlValueExFromServerURL(a,c){var b=_setDEXT5editor(c);if(b){0!=a.toLowerCase().indexOf("http:")&&0!=a.toLowerCase().indexOf("https:")&&(0<a.toLowerCase().indexOf("www.")?a=location.protocol+"//"+a:0==a.toLowerCase().indexOf("/")&&(a=location.protocol+"//"+location.host+a));var d=b._config.post_url+"?load_html_url="+encodeURI(a),e=DEXTTOP.DEXT5.ajax.load(d);-1>=e.indexOf("[OK]")?alert(e):(e=e.substring(4),d=b._FRAMEWIN,d.setChangeModeForSetApi(b),b._config.userCssUrl&&""!=b._config.userCssUrl&&
b._config.userCssAlwaysSet&&"1"==b._config.userCssAlwaysSet&&(e=d.userCssSet(e)),d.setHtmlValueToEditor(e,!0),"1"==b._config.ruler.use&&"1"==b._config.autoBodyFit&&(e=parseIntOr0(b._setting.ruler_position),wordbreak="word-wrap:break-word;",b._BODY.style.wordWrap="break-word",b._BODY.style.width=e-10+"px"),b._dextCustomDataMode=!0,d.ReplaceRealObjectToImage(),d.setStyleForTableBorderNodeClass(b),d.setCssForFormMode(b),b._iconEnable(""),d.setBodyDefaultValue(),d.setFocusToBody(),d.wrapPtagForNotBlockTag(b),
d.setFocusFirstChildForStyle(b._BODY),d.setBodyBackground(b),d.setAdjustTableBorder(b._DOC),b=DEXTTOP.DEXT5.getBodyValue(),_setBodyValue(b))}else alert("ErrCode : 9005")}
DEXTTOP.DEXT5.getBodyTextValue=function(a){var c="";a=_setDEXT5editor(a);var b=a._FRAMEWIN;a&&(c=a.getEditorMode(),"source"!=c&&"text"!=c||a.setChangeMode("design"),changeBodyImageProperty(!0),postimageToServer(a._DOC,a._config.mimeUse,a._config),c="textContent"in a._BODY?a._BODY.textContent:a._BODY.innerText,a._PageProp.bshowgrid&&1==a._PageProp.bshowgrid&&changeBodyImageProperty(!1),c=CleanZeroChar(c));b.showRuler(a);return c};
DEXTTOP.DEXT5.dext5EncodeMime=function(a,c){if(G_dext5plugIn){var b=DEXTTOP.G_CURREDITOR._config;if("1"==b.mimeUse){G_dext5plugIn.mimeCharset=b.mimeCharset;G_dext5plugIn.mimeConentEncodingType=b.mimeConentEncodingType;G_dext5plugIn.mimeRemoveHeader=b.mimeRemoveHeader;G_dext5plugIn.mimeLocalOnly=b.mimeLocalOnly;if("N546-S278-71W3-845Q"==b.productKey){var d=G_dext5plugIn.Dext5EncodeMime(a,c);return 0>d.indexOf("boundary")?"0":d}G_dext5plugIn.mimeSetListInit();var b=b.mimeFileTypeFilter.toString(2),
e=(2).toString(2),f=(4).toString(2),g=(8).toString(2);ReplaceImageToRealObject();changeBodyImageProperty(!0);if(b&1){for(var d=_iframeDoc.getElementsByTagName("IMG"),h=d.length,m=0;m<h;m++){var n=d[m].src;G_dext5plugIn.mimeAddEncodingFile(n,0)}for(var p=["table","td","body"],q=p.length,m=0;m<q;m++)for(var d=_iframeDoc.getElementsByTagName(p[m]),h=d.length,u=0;u<h;u++){var t=d[u].style.backgroundImage;""==t&&d[u].getAttribute("background")&&(t=d[u].getAttribute("background"));t=t.replace('url("',"").replace('")',
"");t=t.replace("url('","").replace("')","");t=t.replace("url(","").replace(")","");""!=t&&"none"!=t.toLowerCase()&&G_dext5plugIn.mimeAddEncodingFile(t,0)}}if(b&e)for(d=_iframeDoc.getElementsByTagName("LINK"),h=d.length,m=0;m<h;m++)n=d[m].href,0<n.length&&G_dext5plugIn.mimeAddEncodingFile(n,1);if(b&f)for(d=_iframeDoc.getElementsByTagName("SCRIPT"),h=d.length,m=0;m<h;m++)n=d[m].src,0<n.length&&G_dext5plugIn.mimeAddEncodingFile(n,1);if(b&g)try{d=_iframeDoc.getElementsByTagName("EMBED");h=d.length;for(m=
0;m<h;m++)n=d[m].src,0<n.length&&G_dext5plugIn.mimeAddEncodingFile(n,0);d=_iframeDoc.getElementsByTagName("OBJECT");h=d.length;for(m=0;m<h;m++)n=d[m].data,0<n.length&&G_dext5plugIn.mimeAddEncodingFile(n,0)}catch(v){}ReplaceRealObjectToImage();d=G_dext5plugIn.Dext5EncodeMime(a,c);return 0>d.indexOf("boundary")?"0":d}}return"0"};DEXTTOP.DEXT5.dext5DecodeMime=function(a){var c="0";G_dext5plugIn&&"1"==DEXTTOP.G_CURREDITOR._config.mimeUse&&(c=G_dext5plugIn.Dext5DecodeMime(a));return c};
DEXTTOP.DEXT5.dext5DecodeMimeEx=function(a,c){var b=_setDEXT5editor(c);if(b&&G_dext5plugIn&&"1"==DEXTTOP.G_CURREDITOR._config.mimeUse){var d=G_dext5plugIn.Dext5DecodeMime(a);if(0<d.length&&"0"!=d){var e=b._config.xss_use,f=b._config.xss_remove_tags,g=b._config.xss_remove_events;b._config.xss_use="";b._config.xss_remove_tags="";b._config.xss_remove_events="";_setHtmlValueEx(d,c);b._config.xss_use=e;b._config.xss_remove_tags=f;b._config.xss_remove_events=g}}};
DEXTTOP.DEXT5.isEmpty=function(a){var c=_setDEXT5editor(a);if(c){if(""!=c._config.defaultMessage)return!0;a=DEXTTOP.DEXT5.getBodyValue(a);a=a.replace(/ /gi,"");a=a.replace(/\t/g,"");a=a.replace(/\r?\n?\r?\n/g,"");a=a.replace(/&nbsp;/gi,"");a=a.replace(/<br \/>/gi,"");a=a.replace(/<br>/gi,"");a=a.replace(/<p *([^>?+])*><\/p>/gi,"");return 0<a.length?!1:!0}return!1};
DEXTTOP.DEXT5.isEmptyToString=function(a){var c=_setDEXT5editor(a);if(c){if(""!=c._config.defaultMessage)return!0;a=DEXTTOP.DEXT5.getBodyValue(a);a=a.replace(/ /gi,"");a=a.replace(/\t/g,"");a=a.replace(/\r?\n?\r?\n/g,"");a=a.replace(/&nbsp;/gi,"");a=a.replace(/<br \/>/gi,"");a=a.replace(/<br>/gi,"");a=a.replace(/<p *([^>?+])*><\/p>/gi,"");return 0<a.length?"false":"true"}return"false"};
DEXTTOP.DEXT5.setInsertHTML=function(a,c){if(void 0!=a&&""!=a)try{var b=_setDEXT5editor(c),d=b._FRAMEWIN;b&&(d.setFocusToBody(),setTimeout(function(){var c=d.getFirstRange().range;c.collapse(!1);0<b.UndoManager.charCount&&b.UndoManager.putUndo();d.ReplaceImageToRealObject();c.pasteHtml(a);c.collapse(!0);isViewMode(b)||(b._dextCustomDataMode=!0,d.ReplaceRealObjectToImage());b.UndoManager.putUndo();b.UndoManager.charCount=0;b._iconEnable("");d.setBodyDefaultValue();d.setFocusToBody()},1))}catch(e){}};
DEXTTOP.DEXT5.setInsertText=function(a,c){if(void 0!=a&&""!=a)try{var b=_setDEXT5editor(c),d=b._FRAMEWIN;if(b){d.dialogCancel();var e=d.getFirstRange().range;e.collapse(!1);e.pasteText(a);e.collapse(!0);b.UndoManager.putUndo()}}catch(f){}};DEXTTOP.DEXT5.setEditorBorder=function(a,c){try{var b=_setDEXT5editor(c);b&&b._FRAMEWIN.setEditorBorder(b,a)}catch(d){}};
DEXTTOP.DEXT5.setEditorMode=function(a,c){try{var b=!1,d=_setDEXT5editor(c);if(d){var e=d._FRAMEWIN,f=!1;if("edit"==a&&"edit"!=d._config.mode){d._BODY.contentEditable=!0;d._config.mode="edit";"0"==d._config.top_menu&&(e.document.getElementById("dext_menu_"+d.ID).style.display="");if(3>parseInt(d._config.tool_bar,10)){e.document.getElementById("dext_toolbar_"+d.ID).style.display="";if("1"==d._config.tool_bar||"0"==d._config.tool_bar)e.document.getElementById("dext_tab_tool2_"+d.ID).style.display="";
if("2"==d._config.tool_bar||"0"==d._config.tool_bar)e.document.getElementById("dext_tab_tool1_"+d.ID).style.display=""}"0"==d._config.status_bar&&(e.document.getElementById("dext_statusbar_"+d.ID).style.height="23px",e.document.getElementById("dext_statusbar_"+d.ID).style.display="",e.document.getElementById("div_resizebar_"+d.ID)&&(e.document.getElementById("div_resizebar_"+d.ID).style.display=""));f=!0}else if("view"==a&&"view"!=d._config.mode){e.hideRuler(d);d._BODY.contentEditable=!1;d._config.mode=
"view";"0"==d._config.top_menu&&(e.document.getElementById("dext_menu_"+d.ID).style.display="none");if(3>parseInt(d._config.tool_bar,10)){e.document.getElementById("dext_toolbar_"+d.ID).style.display="none";if("1"==d._config.tool_bar||"0"==d._config.tool_bar)e.document.getElementById("dext_tab_tool2_"+d.ID).style.display="none";if("2"==d._config.tool_bar||"0"==d._config.tool_bar)e.document.getElementById("dext_tab_tool1_"+d.ID).style.display="none"}"0"==d._config.status_bar&&(e.document.getElementById("dext_statusbar_"+
d.ID).style.height="1px",e.document.getElementById("dext_statusbar_"+d.ID).style.display="none",e.document.getElementById("div_resizebar_"+d.ID)&&(e.document.getElementById("div_resizebar_"+d.ID).style.display="none"));b=f=!0}if(f){e.resizeEditor(null,!1);var g=DEXTTOP.DEXT5.getHtmlValueEx(d.ID);DEXTTOP.DEXT5.setHtmlValueEx(g,d.ID,b);"view"==a?(0==DEXTTOP.DEXT5.browser.ie&&DEXTTOP.focus(),DEXTTOP.document.body.focus()):"1"==d._config.ruler.view&&e.showRuler(d)}}}catch(h){}};
DEXTTOP.DEXT5.doPrint=function(a,c,b){try{var d=_setDEXT5editor(b);if(d&&G_dext5plugIn){var e=d._config.printPreview;d._config.printPreview="1";d.setChangeMode("preview");setTimeout(function(){var b;b=d._EDITOR.preview.contentDocument?d._EDITOR.preview.contentDocument:d._EDITOR.preview.contentWindow.document;DEXTTOP.DEXT5.browser.ie&&(b=b.getElementById("dext5printpreview"))&&b.doPrintDirect(a,c,"");d.setChangeMode("design")},350);d._config.printPreview=e}}catch(f){}};
DEXTTOP.DEXT5.doPrintPreview=function(a,c,b){try{var d=_setDEXT5editor(b);if(d&&G_dext5plugIn){var e=d._config.printPreview;d._config.printPreview="1";d.setChangeMode("preview");setTimeout(function(){var b;b=d._EDITOR.preview.contentDocument?d._EDITOR.preview.contentDocument:d._EDITOR.preview.contentWindow.document;DEXTTOP.DEXT5.browser.ie&&(b=b.getElementById("dext5printpreview"))&&b.doPrintPreview(a,c,"");d.setChangeMode("design")},350);d._config.printPreview=e}}catch(f){}};
DEXTTOP.DEXT5.doSaveHTML=function(a,c,b,d){var e="";try{_setDEXT5editor(d)&&G_dext5plugIn&&(e=G_dext5plugIn.doSaveHTML(a,c,b,""))}catch(f){}return e};DEXTTOP.DEXT5.addUserCssUrl=function(a,c){try{var b=_setDEXT5editor(c),d=b._FRAMEWIN;if(b){var e=b._DOC.getElementsByTagName("head")[0];e&&(d.createDynamicCssLinkToHeadTag(b._DOC,e,a),d.setFocusToBody())}}catch(f){}};
DEXTTOP.DEXT5.clearUserCssUrl=function(a,c){try{var b=_setDEXT5editor(c),d=b._FRAMEWIN;if(b){var e=b._DOC.getElementsByTagName("head")[0];e&&(d.clearDynamicCssLinkToHeadTag(e,a),d.setFocusToBody())}}catch(f){}};DEXTTOP.DEXT5.setUserCssText=function(a,c){try{var b=_setDEXT5editor(c),d=b._FRAMEWIN;if(b){var e=b._DOC.getElementsByTagName("head")[0];e&&(d.addDynamicCssToHeadTag(b._DOC,e,a),d.setFocusToBody())}}catch(f){}};
DEXTTOP.DEXT5.clearUserCssText=function(a){try{var c=_setDEXT5editor(a),b=c._FRAMEWIN;if(c){var d=c._DOC.getElementsByTagName("head")[0];d&&(b.addDynamicCssToHeadTag(c._DOC,d,""),b.setFocusToBody())}}catch(e){}};DEXTTOP.DEXT5.addUserJsUrl=function(a,c){try{var b=_setDEXT5editor(c),d=b._FRAMEWIN;if(b){var e=b._DOC.getElementsByTagName("head")[0];e&&(d.createDynamicJsLinkToHeadTag(b._DOC,e,a),d.setFocusToBody())}}catch(f){}};
DEXTTOP.DEXT5.clearUserJsUrl=function(a){try{var c=_setDEXT5editor(a),b=c._FRAMEWIN;if(c){var d=c._DOC.getElementsByTagName("head")[0];d&&(b.clearDynamicJsLinkToHeadTag(d),b.setFocusToBody())}}catch(e){}};DEXTTOP.DEXT5.setUserJsText=function(a,c){try{var b=_setDEXT5editor(c),d=b._FRAMEWIN;if(b){var e=b._DOC.getElementsByTagName("head")[0];e&&(d.addDynamicJsToHeadTag(b._DOC,e,a),d.setFocusToBody())}}catch(f){}};
DEXTTOP.DEXT5.clearUserJsText=function(a){try{var c=_setDEXT5editor(a),b=c._FRAMEWIN;if(c){var d=c._DOC.getElementsByTagName("head")[0];d&&(b.addDynamicJsToHeadTag(c._DOC,d,""),b.setFocusToBody())}}catch(e){}};DEXTTOP.DEXT5.setNextTabElementId=function(a,c){try{var b=_setDEXT5editor(c);b&&(b._config.NextTabElementId=a)}catch(d){}};DEXTTOP.DEXT5.setFullScreen=function(a){try{var c=_setDEXT5editor(a);c&&c._FRAMEWIN.command_fullScreen(c.ID,c)}catch(b){}};
DEXTTOP.DEXT5.loadAutoSaveHtml=function(a){try{_setDEXT5editor(a)&&DEXTTOP.DEXT5.setHtmlValueExWithDocType(DEXTTOP.DEXTWIN.localStorage[a],a)}catch(c){}};DEXTTOP.DEXT5.saveCurrValueInMultiValue=function(a,c){try{var b=_setDEXT5editor(a);if(b){var d=getValueByMultiMode(),e=[];e.push(d);for(d=2;d<arguments.length;d++)e.push(arguments[d]);b.changeMultiValue[c]||(b.changeMultiValue.valueLength+=1);b.changeMultiValue[c]=e}}catch(f){}};
DEXTTOP.DEXT5.setNextValueInMultiValue=function(a,c){try{var b=_setDEXT5editor(a);if(b){if(b.changeMultiValue[c]){var d=b.changeMultiValue[c][0];setValueByMultiMode(d)}else d="<p><br></p>",DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&(d="<p>&nbsp</p>"),DEXTTOP.DEXT5.setBodyValue(d);return b.changeMultiValue[c]?b.changeMultiValue[c]:null}}catch(e){}};DEXTTOP.DEXT5.getMultiValue=function(a,c){try{var b=_setDEXT5editor(a);if(b)return b.changeMultiValue[c]}catch(d){}};
DEXTTOP.DEXT5.getMultiValueLength=function(a){try{var c=_setDEXT5editor(a);if(c)return c.changeMultiValue.valueLength}catch(b){}};function getValueByMultiMode(){switch(DEXTTOP.G_CURREDITOR._config.changeMultiValueMode){case "doctype":return DEXTTOP.DEXT5.getHtmlValueExWithDocType();case "htmlEx":return DEXTTOP.DEXT5.getHtmlValueEx();case "html":return DEXTTOP.DEXT5.getHtmlValue();case "bodyEx":return DEXTTOP.DEXT5.getBodyValueEx();case "body":return DEXTTOP.DEXT5.getBodyValue()}}
function setValueByMultiMode(a){switch(DEXTTOP.G_CURREDITOR._config.changeMultiValueMode){case "doctype":return DEXTTOP.DEXT5.setHtmlValueExWithDocType(a);case "htmlEx":return DEXTTOP.DEXT5.setHtmlValueEx(a);case "html":return DEXTTOP.DEXT5.setHtmlValue(a);case "bodyEx":return DEXTTOP.DEXT5.setBodyValueEx(a);case "body":return DEXTTOP.DEXT5.setBodyValue(a)}}
DEXTTOP.DEXT5.setUserFontFamily=function(a,c){if(void 0!=a&&null!=a&&""!=a){var b=_setDEXT5editor(c);if(b)try{if("\ub9d1\uc740\uace0\ub515"==a&&(a="\ub9d1\uc740 \uace0\ub515"),b._DOC.body.style.fontFamily=a,"1"==b._setting.show_font_real){var d=document.getElementById("ue_"+b.ID+"font_family");d&&(d.innerHTML="<span>"+a+"</span>",b._setting.font_family=a)}}catch(e){}}};
DEXTTOP.DEXT5.setUserFontSize=function(a,c){if(void 0!=a&&null!=a&&""!=a){var b=_setDEXT5editor(c);if(b)try{if(b._DOC.body.style.fontSize=a+"pt","1"==b._setting.show_font_real){var d=document.getElementById("ue_"+b.ID+"font_size");d&&(d.innerHTML="<span>"+a+"pt</span>",b._setting.font_size=a+"pt")}}catch(e){}}};DEXTTOP.DEXT5.setEditorChangeMode=function(a,c){var b=_setDEXT5editor(c);if(b)try{b.setChangeMode(a)}catch(d){}};
function removeLineHeightOfTable(){if("CCODE_001"==DEXTTOP.G_CURREDITOR._config.custom_code&&DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion)try{for(var a=_iframeDoc.body.getElementsByTagName("td"),c=a.length,b=0;b<c;b++)if(/^\s\s*$/.test(a[b].innerHTML)||""==a[b].innerHTML)a[b].style.lineHeight="0px"}catch(d){}}DEXTTOP.DEXT5.editorPrint=function(a){if(a=_setDEXT5editor(a))try{a._FRAMEWIN.command_print("",a)}catch(c){}};DEXTTOP.DEXT5.setFocusToEditor=function(a){if(a=_setDEXT5editor(a))try{a.setFocusToBody()}catch(c){}};
DEXTTOP.DEXT5.setRulerPosition=function(a,c){var b=_setDEXT5editor(c);if(b)try{b._setting.ruler_position=a,set_ruler_point_position(b),set_ruler_pointline_position(b)}catch(d){}};DEXTTOP.DEXT5.setClassStyle=function(a,c){try{var b=_setDEXT5editor(a);b&&b._FRAMEWIN.command_setClassStyle(b,c)}catch(d){}};DEXTTOP.DEXT5.removeClassStyle=function(a,c){try{var b=_setDEXT5editor(a);b&&b._FRAMEWIN.command_removeClassStyle(b,c)}catch(d){}};
function setInLineDefaultStyle(a){if("2"==a._config.setDefaultStyle.value)for(var c="span font li p h1 h2 h3 h4 h5 div".split(" "),b=c.length,d=0;d<b;d++)for(var e=a._DOC.getElementsByTagName(c[d]),f=e.length-1;0<=f;f--){if(""==e[f].style.fontFamily)try{e[f].style.fontFamily=getStyle(e[f],"fontFamily")}catch(g){}if(""==e[f].style.fontSize){for(var h=!1,m=1;5>=m;m++)if(null!=GetParentbyTagName(e[f],"h"+m)){h=!0;break}if(0==h)if("font"==c[d]){if(""==e[f].size){m=getStyle(e[f],"fontSize");try{isNaN(m)?
e[f].style.fontSize=m:e[f].size=m}catch(n){}}if(""==e[f].face)try{e[f].face=getStyle(e[f],"fontFamily")}catch(p){}}else try{e[f].style.fontSize=getStyle(e[f],"fontSize")}catch(q){}}if(""==e[f].style.lineHeight)try{e[f].style.lineHeight=getStyle(e[f],"lineHeight")}catch(u){}0!=c[d].indexOf("h")&&(""==e[f].style.marginTop&&(e[f].style.marginTop="0px"),""==e[f].style.marginBottom&&(e[f].style.marginBottom="0px"));h=a._config.setDefaultUserStyle.length;for(m=0;m<h;m++)if(""==e[f].style[a._config.setDefaultUserStyle[m]])try{e[f].style[a._config.setDefaultUserStyle[m]]=
getStyle(e[f],a._config.setDefaultUserStyle[m])}catch(t){}}}function removeDefaultStyleDiv(a){for(var c=a._DOC.getElementsByName("dext_div"),b=c.length;0<b;){var d=removeCRLFChar(_iframeDoc.body.innerHTML),e=removeCRLFChar(c[b-1].outerHTML),f=c[b-1].getElementsByTagName("style")[0],c=removeCRLFChar(c[b-1].innerHTML);f&&(c=c.replace(removeCRLFChar(f.outerHTML),""));d=d.replace(e,c);_iframeDoc.body.innerHTML=d;c=a._DOC.getElementsByName("dext_div");b=c.length}}
function getStyle(a,c){var b;a.currentStyle?b=a.currentStyle:_iframeWin.getComputedStyle&&(b=_iframeWin.getComputedStyle(a,""));return b?b.getProperty?b.getProperty(c):b[c]:""}DEXTTOP.DEXT5.inImage=function(a,c){if(void 0!=a&&""!=a)try{var b=_setDEXT5editor(c);b&&(b.setFocusToBody(),b._DOC.execCommand("InsertImage",!1,a))}catch(d){}};
DEXTTOP.DEXT5.setFontFormat=function(a,c){if(void 0!=a&&""!=a)try{var b=_setDEXT5editor(c);if(b){var d=b._FRAMEWIN;switch(a){case "bold":d.command_bold(b.ID,b);break;case "underline":d.command_underline(b.ID,b);break;case "italic":d.command_italic(b.ID,b);break;case "strike_through":d.command_strikeThrough(b.ID,b);break;case "superscript":d.command_superscript(b.ID,b);break;case "subscript":d.command_subscript(b.ID,b);break;case "remove_format":d.command_removeFormat(b.ID,b)}}}catch(e){}};
DEXTTOP.DEXT5.setFontColor=function(a,c){if(void 0!=a&&""!=a)try{var b=_setDEXT5editor(c);b&&b._FRAMEWIN.command_fontColor(b.ID,b._EDITOR.design,a)}catch(d){}};DEXTTOP.DEXT5.setFontBgColor=function(a,c){if(void 0!=a&&""!=a)try{var b=_setDEXT5editor(c);b&&b._FRAMEWIN.command_fontBgColor(b.ID,b._EDITOR.design,a)}catch(d){}};DEXTTOP.DEXT5.selectAll=function(a){try{var c=_setDEXT5editor(a);c&&c._FRAMEWIN.command_selectAll(c.ID,c)}catch(b){}};
DEXTTOP.DEXT5.removeCss=function(a){try{var c=_setDEXT5editor(a);c&&c._FRAMEWIN.command_removeCss(c.ID,c)}catch(b){}};DEXTTOP.DEXT5.setRulerPosition=function(a,c){if(void 0!=a&&""!=a)try{var b=_setDEXT5editor(c);if(b&&1==b._config.ruler.use){var d=parseIntOr0(a);b._setting.ruler_position=d;set_ruler_point_position(b);set_ruler_pointline_position(b)}}catch(e){}};DEXTTOP.DEXT5.setOriginalHtmlValue=function(a,c){_setOriginalHtmlValue(a,c)};
function _setOriginalHtmlValue(a,c){var b=_setDEXT5editor(c);if(b){var d=b._FRAMEWIN;1==d.isViewMode(b)&&(d.setGlobalTableDefaultValue(),FixFlashError2(_iframeDoc),_iframeDoc.open("text/html","replace"),isCustomDomain(document)&&(_iframeDoc.domain=document.domain),_iframeDoc.write(a),_iframeDoc.close(),b._load_editor_frame(!1))}}
DEXTTOP.DEXT5.getDeletedImageUrl=function(a){var c=_setDEXT5editor(a);if(c){a=[];var b=c.setImageArr,d=b.length,e=[],f=c.getEditorMode();"source"!=f&&"text"!=f||c.setChangeMode("design");ReplaceImageToRealObject();changeBodyContenteditable(!1);changeBodyImageProperty(!0);for(var g=c._DOC.getElementsByTagName("img"),h=g.length,f=0;f<h;f++)e.push(g[f].src);c._PageProp.bshowgrid&&1==c._PageProp.bshowgrid&&changeBodyImageProperty(!1);ReplaceRealObjectToImage();changeBodyContenteditable(!0);c=e.length;
for(f=0;f<d;f++){g=!0;for(h=0;h<c;h++)if(b[f]==e[h]){g=!1;break}1==g&&a.push(b[f])}return a}};DEXTTOP.DEXT5.showTopMenu=function(a,c){var b=_setDEXT5editor(c);if(b){var d=b._FRAMEWIN;0==d.isViewMode(b)&&("0"==a?(d.document.getElementById("dext_menu_"+b.ID).style.display="none",b._config.top_menu="1"):(d.document.getElementById("dext_menu_"+b.ID).style.display="",b._config.top_menu="0"),d.resizeEditor(b,!1))}};
DEXTTOP.DEXT5.showToolbar=function(a,c){var b=_setDEXT5editor(c);if(b){var d=b._FRAMEWIN;0==d.isViewMode(b)&&("0"==a?(d.document.getElementById("dext_toolbar_"+b.ID).style.display="none",b._config.tool_bar="3"):"1"==a?(d.document.getElementById("dext_tab_tool1_"+b.ID).style.display="",d.document.getElementById("dext_tab_tool2_"+b.ID).style.display="none",d.document.getElementById("dext_toolbar_"+b.ID).style.display="",b._config.tool_bar="2","1"==b._config.tool_bar_grouping&&(d.groupingIcon(b),d.setPositionGroupingDiv(1))):
"2"==a?(d.document.getElementById("dext_tab_tool1_"+b.ID).style.display="none",d.document.getElementById("dext_tab_tool2_"+b.ID).style.display="",d.document.getElementById("dext_toolbar_"+b.ID).style.display="",b._config.tool_bar="1","1"==b._config.tool_bar_grouping&&(d.groupingIcon(b),d.setPositionGroupingDiv(2))):(d.document.getElementById("dext_tab_tool1_"+b.ID).style.display="",d.document.getElementById("dext_tab_tool2_"+b.ID).style.display="",d.document.getElementById("dext_toolbar_"+b.ID).style.display=
"",b._config.tool_bar="0","1"==b._config.tool_bar_grouping&&(d.groupingIcon(b),d.setPositionGroupingDiv(1),d.setPositionGroupingDiv(2))),d.resizeEditor(b,!1))}};DEXTTOP.DEXT5.showStatusbar=function(a,c){var b=_setDEXT5editor(c);if(b){var d=b._FRAMEWIN;0==d.isViewMode(b)&&("0"==a?(d.document.getElementById("dext_statusbar_"+b.ID).style.display="none",b._config.status_bar="1"):(d.document.getElementById("dext_statusbar_"+b.ID).style.display="",b._config.status_bar="0"),d.resizeEditor(b,!1))}};
DEXTTOP.DEXT5.setHtmlContents=function(a,c){if(0!=a.length){var b=_setDEXT5editor(c);if(b){var d=a.toLowerCase(),e,f,g;e=d.indexOf("<!doctype");f=d.indexOf("<html");g=d.indexOf("<head");0>g&&(g=d.indexOf("<meta"));0>g&&(g=d.indexOf("<title"));d=d.indexOf("<body");-1<e&&e<f&&f<d?DEXTTOP.DEXT5.setHtmlValueExWithDocType(a,c):-1<f&&f<d?DEXTTOP.DEXT5.setHtmlValueEx(a,c):-1<g&&g<d?DEXTTOP.DEXT5.setHtmlValue(a,c):-1<d?DEXTTOP.DEXT5.setBodyValueEx(a,c):(e=b._config.wrapPtagToSource,b._config.wrapPtagToSource=
"1",DEXTTOP.DEXT5.setBodyValue(a,c),b._config.wrapPtagToSource=e)}}};DEXTTOP.DEXT5.isLoadedEditor=function(a){if(a=_setDEXT5editor(a))return a._config.isLoadedEditor};
DEXTTOP.DEXT5.setHeightForDisplay=function(a){if((a=_setDEXT5editor(a))&&"view"==a._config.mode)if("1"==a._config.view_mode_auto_height||"1"==a._config.view_mode_auto_width)if(DEXTTOP.DEXT5.isEmpty())DEXTTOP.DEXT5.setSize(a._config.style.width,a._config.style.height,a.ID);else{var c=DEXTTOP.DEXT5.getHtmlValueExWithDocType(a.ID);DEXTTOP.DEXT5.setHtmlValueExWithDocType(c,a.ID)}else DEXTTOP.DEXT5.setSize(a._config.style.width,a._config.style.height,a.ID)};
DEXTTOP.DEXT5.setFocusToObject=function(a,c){var b=_setDEXT5editor(c);if(b){var d=b._FRAMEWIN,e=null;"string"==typeof a?e=b._DOC.getElementById(a):"object"==typeof a&&(e=a);if(null!=e&&void 0!=e){if(DEXTTOP.DEXT5.browser.ie&&e.firstChild&&3!=e.firstChild.nodeType)for(e=e.firstChild;e;)if(1==e.nodeType&&e.firstChild&&3!=e.firstChild.nodeType)e=e.firstChild;else break;e&&(!e.tagName||"IMG"!=e.tagName&&"BR"!=e.tagName||(e=e.parentNode),d.setFocusToBody(),setTimeout(function(){try{if(!e.tagName||"TEXTAREA"!=
e.tagName&&"INPUT"!=e.tagName){d.doSetCaretPosition(e,!1);d._iframeWin.scroll(0,0);var a=d.getClientRect(e);d._iframeWin.scroll(a.left,a.top)}else e.focus()}catch(b){}},1))}}};DEXTTOP.DEXT5.setDext5DomMode=function(a,c){try{var b=_setDEXT5editor(c),d=b._FRAMEWIN;if(b)if(1==a){var e=b.getEditorMode();"source"!=e&&"text"!=e||b.setChangeMode("design");d.ReplaceImageToRealObject();d.changeBodyImageProperty(!0)}else b._PageProp.bshowgrid&&1==b._PageProp.bshowgrid&&d.changeBodyImageProperty(!1),d.ReplaceRealObjectToImage()}catch(f){}};
DEXTTOP.DEXT5.getDext5DocumentDom=function(a){var c=null;try{var b=_setDEXT5editor(a);b&&(c=b._DOC)}catch(d){}return c};DEXTTOP.DEXT5.getDext5Dom=function(a){var c=null;try{var b=_setDEXT5editor(a);b&&(c=b._DOC.documentElement)}catch(d){}return c};DEXTTOP.DEXT5.getDext5BodyDom=function(a){var c=null;try{var b=_setDEXT5editor(a);b&&(c=b._BODY)}catch(d){}return c};
DEXTTOP.DEXT5.getValueInTextMode=function(a){var c="";if(a=_setDEXT5editor(a))"text"!=a.getEditorMode()&&(DEXTTOP.DEXT5.ShowTextChangeAlert=!1,a.setChangeMode("text"),DEXTTOP.DEXT5.ShowTextChangeAlert=!0),c=a._EDITOR.text.value;return c};DEXTTOP.DEXT5.setValueInTextMode=function(a,c){var b=_setDEXT5editor(c);b&&("text"!=b.getEditorMode()&&(DEXTTOP.DEXT5.ShowTextChangeAlert=!1,b.setChangeMode("text"),DEXTTOP.DEXT5.ShowTextChangeAlert=!0),b._EDITOR.text.value=a,b._EDITOR.text.focus())};
DEXTTOP.DEXT5.getD5Dom=function(a){var c={},b=!1;try{var d=_setDEXT5editor(a);if(d){var e=d._BODY.getElementsByTagName("*"),f=e.length;c.document=d._DOC;c.body=d._BODY;c.all=d._DOC.all;for(a=0;a<f;a++){var g=e[a];if(g.id&&0<g.id.length){var h=g.id;if(null==c[h]||void 0==c[h])c[h]=g,b=!0}else if(g.name&&0<g.name.length){h=g.name;if(null==c[h]||void 0==c[h])c[h]=g;else{if(c[h]&&"undefined"==typeof c[h].length){var m=c[h];delete c[h];c[h]=[m]}c[h].push(g)}b=!0}}}}catch(n){}0==b&&(c=null);return c};
DEXTTOP.DEXT5.$=function(a,c){var b=null;try{var d=_setDEXT5editor(c);if(d){var e=d._DOC;if(void 0==a||""==a||"*"==a)b=e.getElementsByTagName("*");else{d="";0<a.length&&(d=a.substring(0,1));var f=a.indexOf("*=");if("#"==d)return a=a.replace("#",""),e.getElementById(a);if("."==d||-1<f){var g="";if("."==d)g=a.substring(1,a.length);else{var h=a.split("=");2==h.length&&"classname*"==h[0].toLowerCase()&&0<h[1].length&&(g=h[1])}g=g.toLowerCase();if(""==g)return b;for(var m=e.getElementsByTagName("*"),n=
m.length,p=0;p<n;p++){var q=m[p],u=q.className;void 0!=u&&(u=u.toLowerCase());"."==d&&g==u?(null==b&&(b=[]),b.push(q)):-1<f&&g.length<=u.length&&g==u.substring(0,g.length)&&(null==b&&(b=[]),b.push(q))}}else if(-1<a.indexOf(":")){var t=a.split(":");if(2==t.length&&"form"==t[0].toLowerCase()&&0<t[1].length){var v=t[1].toLowerCase(),f=["INPUT","SELECT","TEXTAREA","BUTTON"];if("all"==v)for(g=f.length,p=0;p<g;p++){if(m=e.getElementsByTagName(f[p]),n=m.length,0<n)for(null==b&&(b=[]),h=0;h<n;h++)b.push(m[h])}else{m=
e.getElementsByTagName("INPUT");n=m.length;for(p=0;p<n;p++)m[p]&&void 0!=m[p].type&&m[p].type==v&&(null==b&&(b=[]),b.push(m[p]));m=[];if("button"==v||"select"==v||"textarea"==v)m=e.getElementsByTagName(v.toUpperCase());n=m.length;for(p=0;p<n;p++)null==b&&(b=[]),b.push(m[p])}}}else-1<a.indexOf("=")?(t=a.split("="),2==t.length&&"name"==t[0].toLowerCase()&&0<t[1].length&&(b=e.getElementsByName(t[1]))):(a=a.toUpperCase(),b=e.getElementsByTagName(a))}}}catch(w){b=null}return b};
DEXTTOP.DEXT5.getElementById=function(a,c){var b=null;try{var d=_setDEXT5editor(c);d&&(b=d._DOC.getElementById(a))}catch(e){}return b};DEXTTOP.DEXT5.getElementsByName=function(a,c){var b=[];try{var d=_setDEXT5editor(c);d&&(b=d._DOC.getElementsByName(a))}catch(e){}return b};DEXTTOP.DEXT5.getElementsByTagName=function(a,c){var b=[];try{var d=_setDEXT5editor(c);if(d){var e=d._DOC;a.toUpperCase();b=e.getElementsByTagName(a)}}catch(f){}return b};
DEXTTOP.DEXT5.setElementInnerHTML=function(a,c,b){var d="";try{var e=_setDEXT5editor(b);if(e){var f=e._DOC.getElementById(a);f&&(f.innerHTML=c)}}catch(g){d="An error has occurred during the current function operation."}return d};DEXTTOP.DEXT5.setElementInnerText=function(a,c,b){var d="";try{var e=_setDEXT5editor(b);if(e){var f=e._DOC.getElementById(a);f&&(f.innerText=c)}}catch(g){d="An error has occurred during the current function operation."}return d};
DEXTTOP.DEXT5.setFormDataTextValue=function(a,c,b){var d="";try{var e=_setDEXT5editor(b);if(e){var f=e._DOC.getElementsByName(a);if(0<f.length){var g=f[0];g&&(g.value=c)}}}catch(h){d="An error has occurred during the current function operation."}return d};
DEXTTOP.DEXT5.addUserD5Event=function(a,c,b,d){var e="";if(null==a||void 0==a||0>=a.length)return"The parameter is incorrect : id [First parameter]";if(null==c||void 0==c||0>=c.length)return"The parameter is incorrect : eventName [Second parameter]";if("function"!==typeof b)return"The parameter is incorrect : function [Third parameter]";try{var f=_setDEXT5editor(d);if(f){var g=f._DOC.getElementById(a);g?DEXTTOP.DEXT5.util.addEvent(g,c,b):e="Not found id's object"}}catch(h){e="An error has occurred during the current function operation."}return e};
DEXTTOP.DEXT5.isDirty=function(a){var c=_setDEXT5editor(a);if(c)return a=c._BODY.innerHTML,a=a.replace(/\r?\n?\r?\n/g,""),a=DEXTTOP.DEXT5.util.nbspRemove(a),c=c._editingCheckedValue,c=c.replace(/\r?\n?\r?\n/g,""),c=DEXTTOP.DEXT5.util.nbspRemove(c),a==c?!1:!0;void 0!=c&&null!=c||alert("Editor's Name is not correct. Please check editor's name.")};DEXTTOP.DEXT5.setDirty=function(a){(a=_setDEXT5editor(a))?a._editingCheckedValue=a._BODY.innerHTML:void 0!=a&&null!=a||alert("Editor's Name is not correct. Please check editor's name.")};
DEXTTOP.DEXT5.getAccessibilityValidation=function(a){if(a=_setDEXT5editor(a)){var c=a._FRAMEWIN,b=a.getEditorMode();"source"!=b&&"text"!=b||a.setChangeMode("design");a=c.getViolationNodes(a);return 0<a.violateNodes.length||0<a.idSamNodes.length?!1:!0}void 0!=a&&null!=a||alert("Editor's Name is not correct. Please check editor's name.")};
DEXTTOP.DEXT5.setAccessibilityValidation=function(a){if(a=_setDEXT5editor(a)){var c=a.getEditorMode();"source"!=c&&"text"!=c||a.setChangeMode("design");DEXT5_EDITOR.prototype.dialog.show(a._config.webPath.page,a._config.pages.accessibility_validation)}else void 0!=a&&null!=a||alert("Editor's Name is not correct. Please check editor's name.")};
DEXTTOP.DEXT5.setEditorBodyEditable=function(a,c){var b=_setDEXT5editor(c);if(b)if(a)b._BODY.contentEditable=!0,b._config.editorBodyEditable=!0;else{var d=DEXTTOP.DEXT5.getHtmlValueEx(b.ID);DEXTTOP.DEXT5.setHtmlValueEx(d,b.ID);b._BODY.contentEditable=!1;b._config.editorBodyEditable=!1}else void 0!=b&&null!=b||alert("Editor's Name is not correct. Please check editor's name.")};
DEXTTOP.DEXT5.getEditorStyle=function(a,c,b){if(b=_setDEXT5editor(b))return b._FRAMEWIN.getStyle(a,c);void 0!=b&&null!=b||alert("Editor's Name is not correct. Please check editor's name.")};DEXTTOP.DEXT5.setAdjustTableBorderStyle=function(a){(a=_setDEXT5editor(a))&&a._FRAMEWIN.setAdjustTableBorder(a._DOC)};DEXTTOP.DEXT5.inputTextfield=function(a){try{var c=_setDEXT5editor(a);c&&DEXT5_EDITOR.prototype.dialog.show(c._config.webPath.page,c._config.pages.input_text)}catch(b){}};
DEXTTOP.DEXT5.inputRadio=function(a){try{var c=_setDEXT5editor(a);c&&DEXT5_EDITOR.prototype.dialog.show(c._config.webPath.page,c._config.pages.input_radio)}catch(b){}};DEXTTOP.DEXT5.inputCheckbox=function(a){try{var c=_setDEXT5editor(a);c&&DEXT5_EDITOR.prototype.dialog.show(c._config.webPath.page,c._config.pages.input_checkbox)}catch(b){}};DEXTTOP.DEXT5.inputButton=function(a){try{var c=_setDEXT5editor(a);c&&DEXT5_EDITOR.prototype.dialog.show(c._config.webPath.page,c._config.pages.input_button)}catch(b){}};
DEXTTOP.DEXT5.inputHiddenfield=function(a){try{var c=_setDEXT5editor(a);c&&DEXT5_EDITOR.prototype.dialog.show(c._config.webPath.page,c._config.pages.input_hidden)}catch(b){}};DEXTTOP.DEXT5.inputTextarea=function(a){try{var c=_setDEXT5editor(a);c&&DEXT5_EDITOR.prototype.dialog.show(c._config.webPath.page,c._config.pages.input_textarea)}catch(b){}};DEXTTOP.DEXT5.inputSelect=function(a){try{var c=_setDEXT5editor(a);c&&DEXT5_EDITOR.prototype.dialog.show(c._config.webPath.page,c._config.pages.input_select)}catch(b){}};
DEXTTOP.DEXT5.inputImagebutton=function(a){try{var c=_setDEXT5editor(a);c&&DEXT5_EDITOR.prototype.dialog.show(c._config.webPath.page,c._config.pages.input_image)}catch(b){}};
DEXTTOP.DEXT5.insertInput=function(a,c,b){try{var d=_setDEXT5editor(b),e=d._FRAMEWIN,f=d._DOC;if(d){e.restoreSelection();e.setFocusToBody();0<d.UndoManager.charCount&&d.UndoManager.putUndo();var g=getFirstRange().range,h;h=null==c?f.createElement("input"):c;b="";for(var m in a)switch(m.toLowerCase()){case "type":h.type=a[m];break;case "name":b=a[m];break;case "id":h.id=a[m];break;case "class":h.className=a[m];break;case "title":h.title=a[m];break;case "value":h.setAttribute(m,a[m]);break;case "size":""!=
a[m]&&(h.size=a[m]);break;case "maxlength":""!=a[m]&&(h.maxlength=a[m]);break;case "disabled":0!=a[m]&&(h.disabled=!0);break;case "readonly":0!=a[m]&&(h.readonly=!0);break;case "checked":0!=a[m]&&(h.checked=!0,h.setAttribute(m,a[m]));break;case "alt":""!=a[m]&&(h.alt=a[m]);break;case "style.width":""!=a[m]&&(h.style.width=a[m]);break;case "style.height":""!=a[m]&&(h.style.height=a[m]);break;case "style.text_align":""!=a[m]&&(h.style.textAlign=a[m])}if(null==c){g.deleteContents();if(DEXTTOP.DEXT5.browser.ie&&
8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie)""!=b&&h.setAttribute("name",b),g.insertNode(h),g.selectNode(h);else{var n=h.outerHTML;""!=b&&(n=n.replace(">",' name="'+b+'" >'));g.pasteHtml(n)}"hidden"==h.type&&(DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,ReplaceRealObjectToImage(!1));g.collapse(!1);rangy.getSelection(e).removeAllRanges();rangy.getSelection(e).addRange(g)}else DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?""!=b&&h.setAttribute("name",
b):(n=h.outerHTML,""!=b&&(n=n.replace(">",' name="'+b+'" >')),h.outerHTML=n);d.UndoManager.putUndo();d.UndoManager.charCount=0}}catch(p){}};
DEXTTOP.DEXT5.insertTextarea=function(a,c,b){try{var d=_setDEXT5editor(b),e=d._FRAMEWIN,f=d._DOC;if(d){e.restoreSelection();e.setFocusToBody();0<d.UndoManager.charCount&&d.UndoManager.putUndo();var g=getFirstRange().range,h;h=null==c?f.createElement("textarea"):c;var f=b="",m;for(m in a)switch(m.toLowerCase()){case "name":b=a[m];break;case "id":h.id=a[m];break;case "class":h.className=a[m];break;case "title":h.title=a[m];break;case "value":h.setAttribute(m,a[m]);f=a[m];break;case "rows":""!=a[m]&&
(h.rows=a[m]);break;case "cols":""!=a[m]&&(h.cols=a[m]);break;case "disabled":0!=a[m]&&(h.disabled=a[m]);break;case "readonly":0!=a[m]&&(h.readonly=a[m]);break;case "style.width":""!=a[m]&&(h.style.width=a[m]);break;case "style.height":""!=a[m]&&(h.style.height=a[m]);break;case "style.text_align":""!=a[m]&&(h.style.textAlign=a[m])}h.innerHTML=f;if(null==c){g.deleteContents();if(DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie)""!=b&&h.setAttribute("name",b),
g.insertNode(h),g.selectNode(h);else{var n=h.outerHTML;""!=b&&(n=n.replace(">",' name="'+b+'" >'));g.pasteHtml(n)}g.collapse(!1);rangy.getSelection(e).removeAllRanges();rangy.getSelection(e).addRange(g)}else DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?""!=b&&h.setAttribute("name",b):(n=h.outerHTML,""!=b&&(n=n.replace(">",' name="'+b+'" >')),h.outerHTML=n);d.UndoManager.putUndo();d.UndoManager.charCount=0}}catch(p){}};
DEXTTOP.DEXT5.insertSelect=function(a,c,b,d,e,f){try{var g=_setDEXT5editor(f),h=g._FRAMEWIN,m=g._DOC;if(g){h.restoreSelection();h.setFocusToBody();0<g.UndoManager.charCount&&g.UndoManager.putUndo();var n=getFirstRange().range,p;p=null==e?m.createElement("select"):e;f="";for(var q in a)switch(q.toLowerCase()){case "name":f=a[q];break;case "id":p.id=a[q];break;case "class":p.className=a[q];break;case "title":p.title=a[q];break;case "multiple":p.multiple=a[q];break;case "size":p.size=a[q];break;case "disabled":0!=
a[q]&&(p.disabled=a[q]);break;case "style.width":""!=a[q]&&(p.style.width=a[q]);break;case "style.height":""!=a[q]&&(p.style.height=a[q])}if(null!=e)for(var u=e.childNodes.length,t=0;t<u;t++)e.removeChild(e.childNodes[t]);u=c.length;for(t=0;t<u;t++){var v=m.createElement("option");v.innerHTML=c[t];v.setAttribute("value",b[t]);""!=d[t]&&(v.selected=d[t],v.setAttribute("selected",d[t]));p.appendChild(v)}n.deleteContents();if(DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie)""!=
f&&p.setAttribute("name",f),n.insertNode(p),n.selectNode(p);else{var w=p.outerHTML;""!=f&&(w=w.replace(">",' name="'+f+'" >'));n.pasteHtml(w)}n.collapse(!1);rangy.getSelection(h).removeAllRanges();rangy.getSelection(h).addRange(n);g.UndoManager.putUndo();g.UndoManager.charCount=0}}catch(x){}};
DEXTTOP.DEXT5.insertImg=function(a,c,b){try{var d=_setDEXT5editor(b),e=d._FRAMEWIN,f=d._DOC;if(d){e.restoreSelection();e.setFocusToBody();0<d.UndoManager.charCount&&d.UndoManager.putUndo();var g=getFirstRange().range,h;h=null==c?f.createElement("img"):c;c="";for(var m in a)switch(m.toLowerCase()){case "name":c=a[m];break;case "id":h.id=a[m];break;case "class":h.className=a[m];break;case "title":h.title=a[m];break;case "src":h.src=a[m];break;case "alt":""!=a[m]&&(h.alt=a[m]);break;case "style.width":""!=
a[m]&&(h.style.width=a[m]);break;case "style.height":""!=a[m]&&(h.style.height=a[m]);break;case "style.text_align":""!=a[m]&&(h.style.textAlign=a[m])}g.deleteContents();if(DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie)""!=c&&h.setAttribute("name",c),g.insertNode(h),g.selectNode(h);else{var n=h.outerHTML;""!=c&&(n=n.replace(">",' name="'+c+'" >'));g.pasteHtml(n)}g.collapse(!1);rangy.getSelection(e).removeAllRanges();rangy.getSelection(e).addRange(g);d.UndoManager.putUndo();
d.UndoManager.charCount=0}}catch(p){}};
DEXTTOP.DEXT5.insertDiv=function(a,c,b){try{var d=_setDEXT5editor(b),e=d._FRAMEWIN,f=d._DOC;if(d){e.restoreSelection();e.setFocusToBody();0<d.UndoManager.charCount&&d.UndoManager.putUndo();var g=getFirstRange().range,h;h=null==c?f.createElement("div"):c;c="";for(var m in a)switch(m.toLowerCase()){case "name":c=a[m];break;case "id":h.id=a[m];break;case "class":h.className=a[m];break;case "title":h.title=a[m];break;case "alt":""!=a[m]&&(h.alt=a[m]);break;case "style.width":""!=a[m]&&(h.style.width=
a[m]);break;case "style.height":""!=a[m]&&(h.style.height=a[m]);break;case "style.text_align":""!=a[m]&&(h.style.textAlign=a[m])}g.deleteContents();if(DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie)""!=c&&h.setAttribute("name",c),g.insertNode(h),g.selectNode(h);else{var n=h.outerHTML;""!=c&&(n=n.replace(">",' name="'+c+'" >'));g.pasteHtml(n)}g.collapse(!1);rangy.getSelection(e).removeAllRanges();rangy.getSelection(e).addRange(g);d.UndoManager.putUndo();d.UndoManager.charCount=
0}}catch(p){}};DEXTTOP.DEXT5.insertDynamicTable=function(a){try{var c=_setDEXT5editor(a),b=c._FRAMEWIN;if(c){b.restoreSelection();b.setFocusToBody();0<c.UndoManager.charCount&&c.UndoManager.putUndo();var d=getFirstRange().range,e=b.getMyElementNode(d.startContainer);if(e){var f=b.GetParentbyTagName(e,"table");f&&(f.className="DEXT_fiVe_EdiTor_DynGird",d.collapse(!1),rangy.getSelection(b).removeAllRanges(),rangy.getSelection(b).addRange(d),c.UndoManager.putUndo(),c.UndoManager.charCount=0)}}}catch(g){}};
DEXTTOP.DEXT5.deleteDynamicTable=function(a){try{var c=_setDEXT5editor(a),b=c._FRAMEWIN;if(c){b.restoreSelection();b.setFocusToBody();0<c.UndoManager.charCount&&c.UndoManager.putUndo();var d=getFirstRange().range,e=b.getMyElementNode(d.startContainer);if(e){var f=b.GetParentbyTagName(e,"table");f&&(f.className="",d.collapse(!1),rangy.getSelection(b).removeAllRanges(),rangy.getSelection(b).addRange(d),c.UndoManager.putUndo(),c.UndoManager.charCount=0)}}}catch(g){}};
DEXTTOP.DEXT5.changeImageData=function(a,c){try{var b=_setDEXT5editor(c),d=b._FRAMEWIN;if(b){d.restoreSelection();d.setFocusToBody();0<b.UndoManager.charCount&&b.UndoManager.putUndo();var e=getFirstRange().range;DEXTTOP.G_SELECTED_ELEMENT.src=a.src;DEXTTOP.G_SELECTED_ELEMENT.style.width=a.width+"px";DEXTTOP.G_SELECTED_ELEMENT.style.height=a.height+"px";e.collapse(!1);rangy.getSelection(d).removeAllRanges();rangy.getSelection(d).addRange(e);b.UndoManager.putUndo();b.UndoManager.charCount=0}}catch(f){}};
DEXTTOP.DEXT5.getSelectedCell=function(a){try{var c=_setDEXT5editor(a),b=c._FRAMEWIN;if(c){var d=b.GetTableSelectionCells(b.DEXTTOP.G_SELECTED_ELEMENT);if(0==d.length){restoreSelection();var e=getFirstRange().range;if(e){var f=b.GetTDTHCell(e.startContainer);f&&d.push(f)}}return d}}catch(g){}};function setContextMenu(a,c){DEXTTOP.DEXT5.util.cancelEvent(a);DEXT5_CONTEXT.show(a)}
var DEXT5_CONTEXT={_reverse:!1,_context_id:"",_context_iframe:null,_context_zIndex:0,_context_bg_zIndex:0,_context_document:null,_context_main:null,_context_sub:null,_context_bg:null,_context_bg_id:"",_width:"",_height:"0",_item_sub_list:{table_insert:["insert_row_up","insert_row_down","insert_column_left","insert_column_right"],table_select:["table_select_cell","table_select_row","table_select_column","table_select_all"],align_vertical:["valign_up","valign_center","valign_baseline","valign_bottom"],
cell_size:["table_same_width","table_same_height","table_same_widthheight"],insert_row:["insert_row_up","insert_row_down"],insert_column:["insert_column_left","insert_column_right"],table_tool:["convert_table_to_text"],calculation_formula:["horizontal_sum","vertical_sum","horizontal_avg","vertical_avg"]},_non_image_item:" table_select cell_size insert_row insert_column align_vertical table_insert table_select select_column select_row select_cell table_tool paste_to_image paste_to_image_detail".split(" "),
_create:function(a){if(a&&""!=a){var c=_setDEXT5editor(a);c&&(DEXTTOP.G_CURREDITOR=c)}(a=DEXTTOP.document.getElementById("dext_context_iframe"+a))&&a.parentNode.removeChild(a);this._context_id="dext_context_iframe"+DEXTTOP.G_CURREDITOR._config.editor_id;this._context_bg_id="dext_context_background"+DEXTTOP.G_CURREDITOR._config.editor_id;this._context_zIndex=G_MAIN_ZINDEX+2E3;this._context_bg_zIndex=G_MAIN_ZINDEX+1E3;a=DEXTTOP.DEXTDOC.getElementById(this._context_id);if(!a){try{a=DEXTTOP.document.createElement("iframe")}catch(b){a=
DEXTTOP.document.createElement("<iframe>")}a.id=this._context_id;a.style.margin="0px";a.style.padding="0px";a.style.zIndex=this._context_zIndex;a.style.position="absolute";a.scrolling="no";a.style.overflow="auto";a.style.overflowX="hidden";a.style.display="none";a.allowTransparency="true";a.frameBorder="0";DEXTTOP.document.body.appendChild(a);c="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";c=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+
encodeURIComponent(c)+"}())":"";a.src=c;var c="",c=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,d;d="<html><head>"+('<link rel="stylesheet" type="text/css" href="'+c+"editor_context.css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">');d+='<link rel="stylesheet" type="text/css" href="'+c+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">';d+="</head>";d+='<body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">';
d+='<div onselectstart="return false;" style="width:100%; height:100%" id="context_iframe_bg">';d+='<div class="DEXT_fiVe_ED_popup">';d+='<div id="div_main_context" class="DEXT_fiVe_EDP">';d+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';d+='<dl id="ul_context_main"></dl>';d+="</div>";d+="</div>";d+='<div class="DEXT_fiVe_EDP_s" id="div_sub_context" style="display:none; position:relative;">';d+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+
'">';d+='<dl id="ul_context_sub"></dl>';d+="</div>";d+="</div>";d+="</div>";d+="</div>";d+='<iframe style="HEIGHT: 100%; WIDTH: 100%; POSITION: absolute; LEFT: 0px; FILTER: alpha(opacity = 0); Z-INDEX: -1; DISPLAY: block; TOP: 0px" frameBorder="0" scrolling="no" tabkey="-1"></iframe>';d+="</body></html>";_context_document=a.contentWindow.document;getDocWindow(_context_document);_context_document.open("text/html","replace");_context_document.write(d);_context_document.close();this._context_iframe=
a;this._context_document=_context_document;this._context_main=_context_document.getElementById("ul_context_main");this._context_sub=_context_document.getElementById("ul_context_sub");var e=this;a=function(){return function(a){e.hide()}}();DEXTTOP.DEXT5.util.addEvent(this._context_document.getElementById("context_iframe_bg"),"click",a);DEXTTOP.DEXT5.util.addEvent(this._context_document.getElementById("context_iframe_bg"),"contextmenu",a);DEXTTOP.DEXT5.util.addEvent(_context_document,"dragover",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);
return!1});DEXTTOP.DEXT5.util.addEvent(_context_document,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1})}this._context_main.innerHTML="";this._context_sub.innerHTML=""},_setMenu:function(a){var c=a.tagName.toLowerCase(),b="default",d=getFirstRange(),e=d.range;setFocusTopWindow();var f=!1,g=DEXTTOP.G_CURREDITOR._config.tableNoActionClass,h=GetTableSelectionCells();0<h.length?(""!=g&&(f=GetParentbyTagName(h[0],"table"),f=checkContainClass(f,g)),b=1==h.length?"selectedSingleCell":"selectedMultiCell"):
e&&0<e.toString().length&&"select"!=c&&"textarea"!=c?"table"==c?(""!=g&&(f=checkContainClass(a,g)),b="focustable",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a)):b=(b=d.sel)&&b.docSelection&&"Control"==b.docSelection.type?"selectTable":"selectArea":"img"==c?(d=a.getAttribute("dext5customdata"),null!=d&&void 0!=d?(d=getDextCustomData(d),"iframe"==d.type?(b="focusiframe",DEXTTOP.G_SELECTED_ELEMENT=a):"flash"==d.type?(b="focusflash",DEXTTOP.G_SELECTED_ELEMENT=a):"media"==d.type?(b="focusmedia",
DEXTTOP.G_SELECTED_ELEMENT=a):"link_media"==d.type?(b="focuslinkmedia",DEXTTOP.G_SELECTED_ELEMENT=a):"hidden"==d.type&&(b="input_hidden",DEXTTOP.G_SELECTED_ELEMENT=a)):(b="focusImage",DEXTTOP.G_SELECTED_ELEMENT=a),setSelectoinElement(a)):"a"==c?(b=a.getAttribute("DEXT5InsertFile"),b=""==a.href&&a.name==a.id?"focusbookmark":""==b?"focusinsertfile":"focusa",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a)):"table"==c?(""!=g&&(f=checkContainClass(a,g)),b="focustable",DEXTTOP.G_SELECTED_ELEMENT=a,
setSelectoinElement(a)):"embed"==c?(b="focusEmbed",DEXTTOP.G_SELECTED_ELEMENT=a,setSelectoinElement(a)):"td"==c||"th"==c?(""!=g&&(f=GetParentbyTagName(a,"table"),f=checkContainClass(f,g)),b="focustd",DEXTTOP.DEXT5.browser.ie&&(d.sel.removeAllRanges(),setTimeout(function(){doSetCaretPosition(getMyFirstChildElementNode(a),0)},1))):"input"==c?(""==a.type||"text"==a.type||"password"==a.type?b="input_textfield":"radio"==a.type?b="input_radio":"checkbox"==a.type?b="input_checkbox":"button"==a.type||"reset"==
a.type||"submit"==a.type?b="input_button":"hidden"==a.type?b="input_hidden":"image"==a.type&&(b="input_image"),DEXTTOP.G_SELECTED_ELEMENT=a):"select"==c?(b="input_select",DEXTTOP.G_SELECTED_ELEMENT=a):"textarea"==c?(b="input_textarea",DEXTTOP.G_SELECTED_ELEMENT=a):b="default";g=[];d=[];switch(b){case "default":g="paste cut copy  table_paste  select_all  hyperlink_create".split(" ");checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&g.splice(1,0,"paste_to_image","paste_to_image_detail");
d=["cut","copy"];null==DEXTTOP.G_COPIEDCELLDATA&&d.push("table_paste");this._height="150px";this._width="200px";break;case "selectArea":g="paste cut copy  select_all  hyperlink_create".split(" ");checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&g.splice(1,0,"paste_to_image","paste_to_image_detail");d=[];this._height="130px";this._width="200px";break;case "selectTable":g="paste cut copy  select_all  table_indent table_outdent  table_property".split(" ");checkCanPasteToIamge()&&
"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&g.splice(1,0,"paste_to_image","paste_to_image_detail");d=[];this._height="130px";this._width="200px";break;case "selectedSingleCell":g="paste cut copy  table_copy intable_paste table_content_paste  delete_row delete_column  select_all  align_vertical  cell_property".split(" ");d=["cut","copy","paste"];null==DEXTTOP.G_COPIEDCELLDATA&&(d.push("table_content_paste"),d.push("intable_paste"));this._height="300px";this._width="400px";break;case "selectedMultiCell":g=
"paste cut copy  table_copy table_content_paste  select_all  merge_cell delete_row delete_column cell_size align_vertical  table_property cell_property".split(" ");d=["cut","copy","paste","table_content_paste"];this._height="500px";this._width="400px";break;case "focusImage":g="paste cut copy  select_all  image_property".split(" ");DEXTTOP.DEXTWIN.DEXT5PHOTO&&"IMG"==DEXTTOP.G_SELECTED_ELEMENT.tagName&&(d=DEXTTOP.G_SELECTED_ELEMENT.src,0>d.indexOf("file://")&&(4<d.length&&"http"==d.substring(0,4).toLowerCase()?
d.match(/:\/\/(.[^\/]+)/)[1]==DEXTTOP.window.location.href.match(/:\/\/(.[^\/]+)/)[1]&&g.push("photo_editor_property"):g.push("photo_editor_property")));d=["paste"];this._height="300px";this._width="200px";break;case "focusa":g="paste cut copy  select_all  hyperlink_property".split(" ");d=["paste","cut","copy"];this._height="300px";this._width="200px";break;case "focusbookmark":g="paste cut copy  select_all  bookmark".split(" ");d=["paste","cut","copy"];this._height="300px";this._width="200px";break;
case "focustable":g="paste cut copy  select_all  table_property".split(" ");d=["paste","cut","copy"];this._height="300px";this._width="200px";break;case "focusembed":g="paste cut copy  select_all  flash_property".split(" ");d=["paste","cut","copy"];this._height="300px";this._width="200px";break;case "focustd":g="table_selection  table_indent table_outdent  cut copy paste  table_copy intable_paste table_content_paste  insert_row_column insert_row insert_column table_row_clone  table_delete delete_row delete_column split_cell  table_select align_vertical  row_property column_property table_tool table_property cell_property calculation_formula".split(" ");
checkCanPasteToIamge()&&"1"!=DEXTTOP.G_CURREDITOR._config.pasteToImage&&g.splice(3,0,"paste_to_image","paste_to_image_detail");d=["cut","copy","table_copy"];null==DEXTTOP.G_COPIEDCELLDATA&&(d.push("table_content_paste"),d.push("intable_paste"));this._width="350px";this._height="500px";break;case "focusiframe":g="paste cut copy  select_all  iframe_property".split(" ");d=["paste"];this._height="300px";this._width="200px";break;case "focusflash":g="paste cut copy  select_all  flash_property".split(" ");
d=["paste"];this._height="300px";this._width="200px";break;case "focusmedia":g="paste cut copy  select_all  media_property".split(" ");d=["paste"];this._height="300px";this._width="200px";break;case "focuslinkmedia":g="paste cut copy  select_all ".split(" ");d=["paste","cut","copy"];this._height="130px";this._width="200px";break;case "input_textfield":g=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(g.push(""),g.push("input_textfield"));d=["paste","cut","copy"];
this._height="130px";this._width="200px";break;case "input_radio":g=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(g.push(""),g.push("input_radio"));d=["paste","cut","copy"];this._height="130px";this._width="200px";break;case "input_checkbox":g=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(g.push(""),g.push("input_checkbox"));d=["paste","cut","copy"];this._height="130px";this._width="200px";break;case "input_button":g=["paste",
"cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(g.push(""),g.push("input_button"));d=["paste","cut","copy"];this._height="130px";this._width="200px";break;case "input_select":g=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(g.push(""),g.push("input_select"));d=["paste","cut","copy"];this._height="130px";this._width="200px";break;case "input_textarea":g=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&
(g.push(""),g.push("input_textarea"));d=["paste","cut","copy"];this._height="130px";this._width="200px";break;case "input_image":g=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(g.push(""),g.push("input_imagebutton"));d=["paste","cut","copy"];this._height="130px";this._width="200px";break;case "input_hidden":g=["paste","cut","copy","","select_all"];"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(g.push(""),g.push("input_hiddenfield"));d=["paste","cut","copy"];this._height=
"130px";this._width="200px";break;case "focusinsertfile":g="paste cut copy  select_all  insert_file_property".split(" ");d=["paste","cut","copy"];this._height="300px";this._width="200px";break;default:this._height=this._width="1px"}"focustd"==b&&(b=GetParentbyTagName(a,"table"),0>=parseIntOr0(b.style.marginLeft)&&d.push("table_outdent"));f&&(d=addDisalbeItemForNoActionTable(d));this._height="0px";f=this._context_document.createElement("dt");f.innerHTML="context_main_menu";this._context_main.appendChild(f);
f=g.length;for(b=0;b<f;b++)this._addItem(g[b]);f=this._context_main.getElementsByTagName("dd");b=f.length;for(--b;0<=b;b--)0==b?"b_border"==f[b].className&&this._context_main.removeChild(f[b]):"b_border"==f[b].className&&"b_border"==f[b-1].className&&this._context_main.removeChild(f[b]);f=this._context_main.getElementsByTagName("dd");b=f.length;"b_border"==f[b-1].className&&this._context_main.removeChild(f[b-1]);this._height=parseInt(this._height,10)+2+"px";this._disableItem(d)},_disableItem:function(a){for(var c=
a.length,b=0;b<c;b++){var d=this._context_document.getElementById("context_"+a[b]);d&&(d.className="item_disabled")}},_addItem:function(a){for(var c=DEXTTOP.G_CURREDITOR.remove_item.concat(DEXTTOP.G_CURREDITOR.remove_context_item),b=c.length,d=0;d<b;d++)if(c[d]==a)return;var c=this._context_document.createElement("dd"),e=this,b=this._getImageUrl(a),d=this._getText(a),f=this._item_sub_list[a];if(""==d)c.className="b_border",this._height=parseInt(this._height,10)+1+"px";else{this._height=parseInt(this._height,
10)+24+"px";var g=this._context_document.createElement("div"),h=this._context_document.createElement("div"),m=this._context_document.createElement("div"),n=this._context_document.createElement("span");0<b.length&&(n.className=a,g.appendChild(n));"textContent"in h?h.textContent=d:h.innerText=d;g.className="s_left";h.className="s_right";c.appendChild(g);c.appendChild(h);f?(m.className="arrow",c.appendChild(m),b=function(a){return function(b){if("item_disabled"!=a.className){e._context_sub.innerHTML=
"";for(var c=f.length,d=0;d<c;d++){if(0==d){var g=e._context_document.createElement("dt");g.innerHTML="context_sub_menu";e._context_sub.appendChild(g)}e._addSubItem(f[d])}c=b.target?b.target:b.srcElement;d=getClientRect(c);0==d.top&&(d=getClientRect(c));e._context_document.getElementById("div_sub_context").style.display="";var g=getClientRect(e._context_document.getElementById("div_sub_context")),g=g.bottom-g.top,h=getClientRect(e._context_document.getElementById("div_main_context")),m=d.top;d.top+
g>h.bottom&&(m=d.top-(d.top+g-h.bottom));e._context_document.getElementById("div_sub_context").style.top=m+"px";1==e._reverse?(c=getClientRect(c.parentElement),d=getClientRect(e._context_document.getElementById("div_sub_context")),e._context_document.getElementById("div_sub_context").style.left=c.left-(d.right-d.left)+2+"px"):e._context_document.getElementById("div_sub_context").style.left="0px";c=getClientRect(e._context_document.getElementById("div_sub_context"));getClientRect(e._context_document.getElementById("div_main_context"));
d=getClientRect(e._context_iframe);d=d.bottom-d.top;c.bottom>d&&(c=c.bottom-d,c=parseIntOr0(e._context_iframe.style.height)+c+2,e._context_iframe.style.height=c+"px");a.className="on_mouseover";DEXTTOP.DEXT5.util.stopEvent(b)}}}(c),d=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(c),DEXTTOP.DEXT5.util.addEvent(c,"mouseover",b),DEXTTOP.DEXT5.util.addEvent(c,"mouseout",d)):(b=function(a){return function(b){e._context_document.getElementById("div_sub_context").style.display=
"none";"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(c),d=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(c),e=this,g=function(b){return function(c){"on_mouseover"==b.className&&(_dext_editor._dextCommands(_dext_editor.ID,a,e),e.hide())}}(c),DEXTTOP.DEXT5.util.addEvent(c,"mouseover",b),DEXTTOP.DEXT5.util.addEvent(c,"mouseout",d),DEXTTOP.DEXT5.util.addEvent(c,"click",g))}0<a.length&&(c.id=
"context_"+a);c.unselectable="on";this._context_main.appendChild(c);c=this._context_main.getElementsByTagName("dd");for(b=c.length-1;0<=b;b--)0==b?"b_border"==c[b].className&&this._context_main.removeChild(c[b]):"b_border"==c[b].className&&"b_border"==c[b-1].className&&this._context_main.removeChild(c[b])},_addSubItem:function(a){for(var c=DEXTTOP.G_CURREDITOR.remove_item.concat(DEXTTOP.G_CURREDITOR.remove_context_item),b=c.length,d=0;d<b;d++)if(c[d]==a)return;var c=this._context_document.createElement("dd"),
e=this,b=this._getImageUrl(a),d=this._getText(a);if(""==d)c.className="b_border";else{var f=this._context_document.createElement("div"),g=this._context_document.createElement("div"),h=this._context_document.createElement("span");0<b.length&&(h.className=a,f.appendChild(h));"textContent"in g?g.textContent=d:g.innerText=d;f.className="s_left";g.className="s_right";c.appendChild(f);c.appendChild(g);b=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(c);
d=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(c);e=this;f=function(b){return function(c){"on_mouseover"==b.className&&(_dext_editor._dextCommands(_dext_editor.ID,a),e.hide())}}(c);DEXTTOP.DEXT5.util.addEvent(c,"mouseover",b);DEXTTOP.DEXT5.util.addEvent(c,"mouseout",d);DEXTTOP.DEXT5.util.addEvent(c,"click",f);0<a.length&&(c.id="context_"+a);c.unselectable="on";this._context_sub.appendChild(c)}},_getImageUrl:function(a){for(var c=DEXTTOP.G_CURREDITOR._config.webPath.image+
DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif",b=this._non_image_item.length,d=0;d<b;d++)if(a==this._non_image_item[d]){c="";break}return c},_getText:function(a){var c="";""!=a&&(c=dext5_lang.context[a]);return c},show:function(a){null==this._context_iframe&&this._create();this._context_main.innerHTML="";this._context_sub.innerHTML="";var c=a.target?a.target:a.srcElement;if(null!=c){dext_src_init(DEXTTOP.G_CURREDITOR._EDITOR.design);restoreSelection();setFocusToBody();var b=c.tagName.toLowerCase(),
d=null;if("img"!=b&&"hr"!=b&&"a"!=b&&"input"!=b&&"textarea"!=b&&"select"!=b){if("table"!=b||"td"!=b||"th"!=b)d=GetTDTHCell(c);d&&(DEXTTOP.G_SELECTED_ELEMENT=d)}null==d?this._setMenu(c):this._setMenu(d);this._context_iframe.style.width=this._width;this._context_iframe.style.height=this._height;c=Math.round(a.clientX);b=Math.round(a.clientY);a={};a=getWindowScrollPos(DEXTTOP.window);var d=getClientRect(_iframeWin.parent.frameElement),e=getClientRect(_iframeWin.frameElement),f=0,g=0;if(null!=DEXTTOP.DEXT5.config.DialogWindow)for(var h=
_iframeWin.parent.parent;h!=DEXTTOP;)var m=getClientRect(h.frameElement),f=f+m.left,g=g+m.top,h=h.parent;this._context_iframe.style.left=c+a[0]+d.left+e.left+f+"px";this._context_iframe.style.top=b+a[1]+d.top+e.top+g+"px";this._reverse=!1;c=parseInt(this._context_iframe.style.left,10)+parseInt(this._width,10);b=parseInt(this._context_iframe.style.top,10)+parseInt(this._height,10);e=getWindowClientSize(DEXTTOP.window);d=a[0]+e[0]-20;a=a[1]+e[1]-10;c>=d?(e=c-d,e=parseInt(this._context_iframe.style.left,
10)-e,c-d<parseInt(this._width,10)/2&&(e-=parseInt(this._width,10)/2),this._context_iframe.style.left=e+"px","cssFloat"in this._context_document.getElementById("div_main_context").style?this._context_document.getElementById("div_main_context").style.cssFloat="right":this._context_document.getElementById("div_main_context").style.styleFloat="right",this._reverse=!0):"cssFloat"in this._context_document.getElementById("div_main_context").style?this._context_document.getElementById("div_main_context").style.cssFloat=
"left":this._context_document.getElementById("div_main_context").style.styleFloat="left";b>=a&&(a=b-a,a=parseInt(this._context_iframe.style.top,10)-a,this._context_iframe.style.top=a+"px");this._makeBackground();this._context_iframe.style.display=""}},hide:function(){this._context_document&&this._context_document.getElementById("div_sub_context")&&(this._context_document.getElementById("div_sub_context").style.display="none");this._context_iframe&&(this._context_iframe.style.display="none");this._context_bg&&
(this._context_bg.style.display="none");dialogCancel()},_makeBackground:function(){var a=this;if(this._context_bg=DEXTTOP.document.getElementById(a._context_bg_id))this._context_bg.style.display="";if(!this._context_bg){this._context_bg=DEXTTOP.document.createElement("div");this._context_bg.id=this._context_bg_id;this._context_bg.innerHTML='<div oncontextmenu="return false" style="filter:alpha(opacity=0); opacity:0.0; -moz-opacity:0.0;  -khtml-opacity: 0.0; background-color:#ffffff; z-index:'+this._context_bg_zIndex+
'; position:absolute; left:0px; top:0px;overflow:hidden; width:1px; height:1px; "></div>';DEXTTOP.document.body.appendChild(this._context_bg);var c=function(){return function(b){a.hide()}}(),b=function(){return function(b){b="CSS1Compat"==DEXTTOP.document.compatMode?DEXTTOP.document.documentElement.scrollHeight:DEXTTOP.document.body.scrollHeight;a._context_bg.firstChild.style.width=("CSS1Compat"==DEXTTOP.document.compatMode?DEXTTOP.document.documentElement.scrollWidth:DEXTTOP.document.body.scrollWidth)+
"px";a._context_bg.firstChild.style.height=b+"px"}}();DEXTTOP.DEXT5.util.addEvent(this._context_bg,"click",c);DEXTTOP.DEXT5.util.addEvent(this._context_bg,"contextmenu",c);DEXTTOP.DEXT5.util.addEvent(DEXTTOP.window,"resize",b);c="CSS1Compat"==DEXTTOP.document.compatMode?DEXTTOP.document.documentElement.scrollHeight:DEXTTOP.document.body.scrollHeight;this._context_bg.firstChild.style.width=("CSS1Compat"==DEXTTOP.document.compatMode?DEXTTOP.document.documentElement.scrollWidth:DEXTTOP.document.body.scrollWidth)-
10+"px";this._context_bg.firstChild.style.height=c-10+"px"}}};function setDoctypeProperty(a,c,b,d){var e=_iframeDoc.getElementsByTagName("head")[0].outerHTML,f=_iframeDoc.body.outerHTML;setGlobalTableDefaultValue();FixFlashError2(_iframeDoc);_iframeDoc.open("text/html","replace");_iframeDoc.write(a+"<html>"+e+f+"</html>");_iframeDoc.close();0<b.length&&(a=_iframeDoc.getElementsByTagName("html")[0],-1<b.indexOf("-")&&(b=b.split("-")[0]),a.setAttribute("lang",b),a.setAttribute("xml:lang",b),0<d.length&&a.setAttribute("xmlns",d));""==c&&(c="utf-8");d=_iframeDoc.getElementsByTagName("meta")[0];
d.setAttribute("http-equiv","Content-Type");d.setAttribute("content","text/html");d.setAttribute("charset",c);DEXTTOP.G_CURREDITOR._load_editor_frame(!1)}
function createEditorIframe(a,c,b,d,e,f,g,h,m,n,p){var q=document.createElement("iframe");c.appendChild(q);q.id=b;q.title=d;q.frameBorder=0;q.style.width="100%";q.style.height="100%";q.style.borderWidth="0px";if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)q.style.overflow="hidden",q.style.display="inline-block";c="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";c=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(c)+
"}())":"";q.src=c;c=getIframeDocument(q);""==p?p="1.2":-1<p.indexOf("%")&&(p=1*parseIntOr0(p,10)/100);b="";b=(""==e?"":e+"\n")+("<html><head><title>"+a.system_title+" Editor</title>");""!=a.imageBaseUrl&&(b+='<base href="'+a.imageBaseUrl+'" />');""!=a.ieCompatible&&(b+='<meta http-equiv="X-UA-Compatible" content="IE='+a.ieCompatible+'" />\n');e="";"1"==a.defaultImemode&&(e="-ms-image-mode: active; ime-mode: active;");var u=d="";"1"==a.autoBodyFit&&(d="word-wrap:break-word;",0<parseIntOr0(a.ruler.rulerInitPosition)&&
(u="width:"+(parseIntOr0(a.ruler.rulerInitPosition)-10)+"px;"));b+="<style type=text/css>";var t="10px;";"1"==a.horizontalLine.use&&(t="0px 10px 10px 10px;");"1"==a.setDefaultStyle.value||"2"==a.setDefaultStyle.value?(b+="#"+a.setDefaultStyle.body_id+" { cursor:text; margin:"+t+" font-family:"+m+"; font-size:"+n+";"+e+d+u+" }",b+="#"+a.setDefaultStyle.body_id+" p { line-height:"+p+"; margin-top:0px; margin-bottom:0px; }",b+="#"+a.setDefaultStyle.body_id+" li { line-height:"+p+"; margin-top:0px; margin-bottom:0px; }"):
(b+="body { cursor:text; margin:"+t+" font-family:"+m+"; font-size:"+n+";"+e+d+u+" }",b+="p { line-height:"+p+"; margin-top:0px; margin-bottom:0px; }",b+="li { line-height:"+p+"; margin-top:0px; margin-bottom:0px; }");b+="</style>";m="";m=DEXTTOP.DEXT5.isRelease?a.webPath.css:a.webPath.css_dev;b+='<link href="'+m+"editor_contents.css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" rel="stylesheet" type="text/css" />';if("1"==DEXTTOP.G_CURREDITOR._config.formMode||"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use)b+=
'<link href="'+m+"editor_form.css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" rel="stylesheet" type="text/css" />';b+="</head>";m="";switch(a.scrollOverflow){case "1":m='style="overflow-x:scroll;"';break;case "2":m='style="overflow-y:scroll;"';break;case "3":m='style="overflow-x:scroll;overflow-y:scroll;"';break;case "4":m='style="overflow-x:hidden;"';break;case "5":m='style="overflow-y:hidden;"';break;case "6":m='style="overflow-x:hidden;overflow-y:hidden;"'}b="1"==a.setDefaultStyle.value||"2"==a.setDefaultStyle.value?
b+('<body id="'+a.setDefaultStyle.body_id+'" '+m+">"):b+("<body "+m+">");b+="<p></p></body></html>";getDocWindow(c);c.open("text/html","replace");isCustomDomain(document)&&(c.domain=document.domain);c.write(b);c.close();g&&0<g.length&&(m=c.getElementsByTagName("html")[0],-1<g.indexOf("-")&&(g=g.split("-")[0]),m.setAttribute("lang",g),m.setAttribute("xml:lang",g),0<h.length&&m.setAttribute("xmlns",h));""==f&&(f="utf-8");h=c.getElementsByTagName("head")[0];g=c.createElement("meta");g.setAttribute("http-equiv",
"Content-Type");g.setAttribute("content","text/html");g.setAttribute("charset",f);h.appendChild(g);5<a.userCssUrl.length&&createDynamicCssLinkToHeadTag(c,h,a.userCssUrl);5<a.userJsUrl.length&&createDynamicJsLinkToHeadTag(c,h,a.userJsUrl);return q}
function setHtmlValueWithDocTypeToEditor(a,c){var b=DEXTTOP.G_CURREDITOR;a=addDefaultStyleToEditor(a,b);FixFlashError2(_iframeDoc);_iframeDoc.open("text/html","replace");_iframeDoc.write(a);_iframeDoc.close();DEXTTOP.G_CURREDITOR._load_editor_frame(!1);base64imageToLocalFile(_iframeDoc);"1"==b._config.horizontalLine.use?b._BODY.style.marginTop="0px":b._BODY.style.margin=""}
function setHtmlValueToEditor(a,c){var b=DEXTTOP.G_CURREDITOR,d=b._docType[b._PageProp.doctype];a=addDefaultStyleToEditor(a,b);FixFlashError2(_iframeDoc);_iframeDoc.open("text/html","replace");_iframeDoc.write(d+a);_iframeDoc.close();setBodyBackground(b);"1"==b._config.horizontalLine.use&&b._FRAMEWIN.showRuler(b);DEXTTOP.G_CURREDITOR._load_editor_frame(!1);"1"==b._config.horizontalLine.use?b._BODY.style.marginTop="0px":b._BODY.style.margin="";base64imageToLocalFile(_iframeDoc);"show_blocks"==b.ShowBlocks&&
(b.ShowBlocks="",command_showBlocks(a,c))}
function setHeadValueToEditor(a){var c=DEXTTOP.G_CURREDITOR,b=c._docType[c._PageProp.doctype],d=c._PageProp.lang,e=c._PageProp.xmlnsname;_iframeDoc.getElementsByTagName("head");var f=_iframeDoc.getElementsByTagName("body")[0],g;g=f.style.padding;f=f.style.margin;a=addDefaultStyleToEditor(a,c);FixFlashError2(_iframeDoc);_iframeDoc.open("text/html","replace");isCustomDomain(document)&&(_iframeDoc.domain=document.domain);_iframeDoc.write(b+"<html>"+a+"</html>");_iframeDoc.close();0<d.length&&(a=_iframeDoc.getElementsByTagName("html")[0],
-1<d.indexOf("-")&&(d=d.split("-")[0]),a.setAttribute("lang",d),a.setAttribute("xml:lang",d),0<e.length&&a.setAttribute("xmlns",e));0<g.length&&(_iframeDoc.body.style.padding=g);0<f.length&&(_iframeDoc.body.style.margin=f);c._load_editor_frame(!1);"1"==c._config.horizontalLine.use?c._BODY.style.marginTop="0px":c._BODY.style.margin="";base64imageToLocalFile(_iframeDoc)}
function setBodyValueToEditorEx(a){var c=DEXTTOP.G_CURREDITOR,b=c._PageProp.lang,d=c._PageProp.xmlnsname,e=_iframeDoc.getElementsByTagName("head")[0].outerHTML,f=_iframeDoc.getElementsByTagName("body")[0],g;g=f.style.padding;f=f.style.margin;FixFlashError2(_iframeDoc);_iframeDoc.open("text/html","replace");isCustomDomain(document)&&(_iframeDoc.domain=document.domain);_iframeDoc.write("<html>"+e+a+"</html>");_iframeDoc.close();0<b.length&&(a=_iframeDoc.getElementsByTagName("html")[0],-1<b.indexOf("-")&&
(b=b.split("-")[0]),a.setAttribute("lang",b),a.setAttribute("xml:lang",b),0<d.length&&a.setAttribute("xmlns",d));0<g.length&&(_iframeDoc.body.style.padding=g);0<f.length&&(_iframeDoc.body.style.margin=f);-1<e.indexOf("#"+c._config.setDefaultStyle.body_id)&&(_iframeDoc.body.id=c._config.setDefaultStyle.body_id);c._load_editor_frame(!1);base64imageToLocalFile(_iframeDoc)}
function setBodyValueToEditor(a){var c=DEXTTOP.G_CURREDITOR,b=c._docType[c._PageProp.doctype],d=c._PageProp.lang,e=c._PageProp.xmlnsname,f=_iframeDoc.getElementsByTagName("head")[0].outerHTML,g=_iframeDoc.getElementsByTagName("body")[0],h,m,n,p,q,u;h=g.style.padding;m=g.style.margin;n=g.style.backgroundImage;p=g.style.backgroundColor;q=g.style.backgroundAttachment;u=g.style.backgroundRepeat;FixFlashError2(_iframeDoc);var g=g.outerHTML,t=g.toLowerCase().indexOf("<body"),v=g.indexOf(">"),w="",w=-1<
t&&-1<v?g.substring(t,v+1):"<body>";_iframeDoc.open("text/html","replace");isCustomDomain(document)&&(_iframeDoc.domain=document.domain);_iframeDoc.write(b+"<html>"+f+w+a+"</body></html>");_iframeDoc.close();0<d.length&&(a=_iframeDoc.getElementsByTagName("html")[0],-1<d.indexOf("-")&&(d=d.split("-")[0]),a.setAttribute("lang",d),a.setAttribute("xml:lang",d),0<e.length&&a.setAttribute("xmlns",e));0<h.length&&(_iframeDoc.body.style.padding=h);0<m.length&&(_iframeDoc.body.style.margin=m);0<n.length&&
(_iframeDoc.body.style.backgroundImage=n);0<p.length&&(_iframeDoc.body.style.backgroundColor=p);0<q.length&&(_iframeDoc.body.style.backgroundAttachment=q);0<u.length&&(_iframeDoc.body.style.backgroundRepeat=u);try{c._load_editor_frame(!1)}catch(x){}base64imageToLocalFile(_iframeDoc)}
function setHtmlToPreview(){var a=DEXTTOP.G_CURREDITOR,c;c=a._EDITOR.preview.contentDocument?a._EDITOR.preview.contentDocument:a._EDITOR.preview.contentWindow.document;var b=a._docType[a._PageProp.doctype],d=a._PageProp.lang,e=a._PageProp.xmlnsname,f=_iframeDoc.getElementsByTagName("head")[0].outerHTML,g=_iframeDoc.body.outerHTML;changeBodyImageProperty(!0);if(DEXTTOP.DEXT5.browser.ie&&"1"==a._config.plugInUse&&"1"==a._config.printPreview){var h;h='<object id="dext5printpreview" classid="CLSID:2A28D4A1-467B-48C7-AF21-51F6D88456BD" width="0" height="0"><param name="saveFileType" value="">'+
('<param name="serverDomain" value="'+a._config.serverDomain+'">');h+='<param name="toSavePathUrl" value="'+a._config.toSavePathURL+'">';h+='<param name="saveFolderNameRule" value="'+a._config.saveFolderNameRule+'">';h+='<param name="saveFileNameRule" value="'+a._config.saveFileNameRule+'">';h+='<param name="productKey" value="'+a._config.productKey+'">';h+='<param name="licenseKeyUrl" value="'+a._config.plugin_root+'">';h+='<param name="postPageURL" value="'+a._config.post_url+'">';h+='<param name="accessibility" value="'+
a._config.accessibility+'">';h+='<param name="licenseKey" value="'+a._config.LicenseKey+'">';h+="</object>";g+=h}DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&(g=DEXTTOP.DEXT5.util.htmlRevision(g));a._PageProp.bshowgrid&&1==a._PageProp.bshowgrid&&changeBodyImageProperty(!1);FixFlashError();getDocWindow(c);c.open("text/html","replace");isCustomDomain(document)&&(c.domain=document.domain);c.write(b+"<html>"+f+g+"</html>");c.close();0<d.length&&(b=c.getElementsByTagName("html")[0],-1<
d.indexOf("-")&&(d=d.split("-")[0]),b.setAttribute("lang",d),b.setAttribute("xml:lang",d),0<e.length&&b.setAttribute("xmlns",e));replaceClassForBorder(a,c.body,"hidden");replaceClassForBookmark(a,c.body,"hidden");hiddenBlocks(c);if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)try{for(var m=c.getElementsByTagName("iframe"),n=m.length,e=0;e<n;e++){var p=m[e],q=c.createElement("div");q.style.height=p.height?p.height+"px":p.style.height+"px";q.style.width=p.width?p.width+"px":p.style.width+
"px";q.style.overflow="scroll";q.style.overflowX="hidden";q.style.WebkitOverflowScrolling="touch";setWrapperToElement(p,q)}}catch(u){}"spellcheck"in c.body&&(c.body.spellcheck=!1);"contentEditable"in c.body&&(c.body.contentEditable=!1);if(DEXTTOP.DEXT5.browser.ie)try{DEXTTOP.DEXT5.util.addEvent(a._EDITOR.preview.contentWindow,"unload",function(){FixFlashError()}),DEXTTOP.DEXT5.util.addEvent(_iframeWin,"unload",function(){FixFlashError2(_iframeDoc)})}catch(t){}setAdjustTableBorder(c)}
function setWrapperToElement(a,c){a.nextSibling?a.parentNode.insertBefore(c,a.nextSibling):a.parentNode.appendChild(c);c.appendChild(a)}
function changeBodyImageProperty(a){var c=DEXTTOP.G_CURREDITOR;a?(c._PageProp.bodyimage&&0<c._PageProp.bodyimage.length?_iframeDoc.body.style.backgroundImage=c._PageProp.bodyimage:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-image"):_iframeDoc.body.style.removeAttribute("backgroundImage"),c._PageProp.bodycolor&&0<c._PageProp.bodycolor.length?_iframeDoc.body.style.backgroundColor=c._PageProp.bodycolor:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-color"):
_iframeDoc.body.style.removeAttribute("backgroundColor"),c._PageProp.bodyattachment&&0<c._PageProp.bodyattachment.length?_iframeDoc.body.style.backgroundAttachment=c._PageProp.bodyattachment:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-attachment"):_iframeDoc.body.style.removeAttribute("backgroundAttachment"),c._PageProp.bodyrepeat&&0<c._PageProp.bodyrepeat.length?_iframeDoc.body.style.backgroundRepeat=c._PageProp.bodyrepeat:_iframeDoc.body.style.removeProperty?
_iframeDoc.body.style.removeProperty("background-repeat"):_iframeDoc.body.style.removeAttribute("backgroundRepeat")):(c._PageProp.gridimage&&0<c._PageProp.gridimage.length&&(_iframeDoc.body.style.backgroundImage=c._PageProp.gridimage),c._PageProp.gridattachment&&0<c._PageProp.gridattachment.length&&(_iframeDoc.body.style.backgroundAttachment=c._PageProp.gridattachment),c._PageProp.gridrepeat&&0<c._PageProp.gridrepeat.length&&(_iframeDoc.body.style.backgroundRepeat=c._PageProp.gridrepeat))}
function changeBodyContenteditable(a){a?DEXTTOP.G_CURREDITOR._config.editorBodyEditable&&(_iframeDoc.body.contentEditable=a):(_iframeDoc.body.removeAttribute("contentEditable"),_iframeDoc.body.style.removeProperty?(_iframeDoc.body.style.removeProperty("margin-left"),_iframeDoc.body.style.removeProperty("margin-top"),_iframeDoc.body.style.removeProperty("margin-right"),_iframeDoc.body.style.removeProperty("margin-bottom"),_iframeDoc.body.style.removeProperty("margin")):(_iframeDoc.body.style.removeAttribute("marginLeft"),
_iframeDoc.body.style.removeAttribute("marginTop"),_iframeDoc.body.style.removeAttribute("marginRight"),_iframeDoc.body.style.removeAttribute("marginBottom"),_iframeDoc.body.style.removeAttribute("margin")))}
function fakeBodyDivForBackground(a,c){a=a.replace(/(\r\n|\n|\r)/gm,"");if(c){var b=a.substr(0,4),d=a.substr(a.length-6,6);"<div"==b.toLowerCase()&&"</div>"==d.toLowerCase()&&(b=b.replace(b,"<body"),d=d.replace(d,"</body>"),a=a.substring(4,a.length-6),a=b+a+d)}else b=a.substr(0,5),d=a.substr(a.length-7,7),"<body"==b.toLowerCase()&&"</body>"==d.toLowerCase()&&(b=b.replace(b,"<div"),d=d.replace(d,"</div>"),a=a.substring(5,a.length-7),a=b+a+d);return a}
function createDynamicCssLinkToHeadTag(a,c,b){try{if(""!=b){var d=a.createElement("link");d.type="text/css";d.rel="stylesheet";d.href=b;c.appendChild(d)}}catch(e){}}function clearDynamicCssLinkToHeadTag(a,c){try{for(var b=a.getElementsByTagName("link"),d=b.length-1;0<d;d--)a.removeChild(b[d]);c&&0<b.length&&a.removeChild(b[0])}catch(e){}}
function addDynamicCssToHeadTag(a,c,b){try{for(var d=c.getElementsByTagName("style"),e=d.length-1;0<e;e--)c.removeChild(d[e]);if(""!=b){var f=a.createElement("style");f.type="text/css";f.styleSheet?(f.styleSheet.cssText=b,""==f.innerHTML&&(f.innerHTML=b)):f.appendChild(a.createTextNode(b));c.appendChild(f)}}catch(g){}}function createDynamicJsLinkToHeadTag(a,c,b){try{if(""!=b){var d=a.createElement("script");d.type="text/javascript";d.src=b;c.appendChild(d)}}catch(e){}}
function clearDynamicJsLinkToHeadTag(a){try{for(var c=a.getElementsByTagName("script"),b=c.length-1;0<=b;b--)a.removeChild(c[b])}catch(d){}}function addDynamicJsToHeadTag(a,c,b){try{for(var d=c.getElementsByTagName("script"),e=d.length-1;0<=e;e--){var f=d[e];f.src&&""!=f.src||c.removeChild(f)}if(""!=b){var g=a.createElement("script");g.type="text/javascript";g.appendChild(a.createTextNode(b));c.appendChild(g)}}catch(h){}}
function getValueWithSetStyleInP(a){if("CCODE_001"==a._config.custom_code)try{var c="",b="";""!=a._setting.font_family&&(b=a._setting.font_family);""!=a._setting.font_size&&(c=a._setting.font_size);if(""!=b||""!=c){var d=a._DOC.body.getElementsByTagName("p"),e=d.length;for(a=0;a<e;a++)""!=b&&""==d[a].style.fontFamily&&(d[a].style.fontFamily=b),""!=c&&""==d[a].style.fontSize&&(d[a].style.fontSize=c)}}catch(f){}}
function addDefaultStyleToEditor(a,c){if("0"==c._config.setDefaultStyle.value&&"1"==c._config.setDefaultStyle.dext_set_style){var b=["body","p","li"],d=[!1,!1,!1],e=b.length,f=a.toLowerCase(),g=f.toLowerCase().indexOf("<style"),h=f.toLowerCase().indexOf("</style>"),m="";if(-1<f.toLowerCase().indexOf("<head")&&-1<g&&-1<h){var n="",n=f.substring(g,h),p=n.indexOf(">"),f=n.substring(0,p+1),p=n.substring(p+1),n=c._setting.line_height;""==n?n="1.2":-1<n.indexOf("%")&&(n=1*parseIntOr0(n,10)/100);for(var q=
p.split("}"),u=q.length,t=0;t<u;t++)if(p=q[t].indexOf("{"),-1<p){for(var v=q[t].substring(0,p),w=0;w<e;w++)if(-1<v.indexOf(b[w])){d[w]=!0;var x=q[t].substring(p);"body"==b[w]?(0>x.indexOf("font-family")&&(q[t]=q[t]+"font-family:"+c._setting.font_family+"; "),0>x.indexOf("font-size")&&(q[t]=q[t]+"font-size:"+c._setting.font_size+"; "),0>x.indexOf("margin")&&(q[t]+="margin:10px; ")):(0>x.indexOf("line-height")&&(q[t]=q[t]+"line-height:"+n+"; "),0>x.indexOf("margin")?(q[t]+="margin-top:0px; ",q[t]+=
"margin-bottom:0px; "):-1<x.indexOf("margin-")&&(0>x.indexOf("margin-top")&&(q[t]+="margin-top:0px; "),0>x.indexOf("margin-bottom")&&(q[t]+="margin-bottom:0px; ")))}m+=q[t]+"}"}e=d.length;for(t=0;t<e;t++)0==d[t]&&(m="body"==b[t]?m+(b[t]+" { font-size:"+c._setting.font_size+"; font-family:"+c._setting.font_family+"; margin:10px; cursor:text; }"):m+(b[t]+" { line-height:"+n+"; margin-top:0px; margin-bottom:0px; }"));m=f+m;a=a.substring(0,g)+m.toLowerCase()+a.substring(h,a.length)}else-1<f.toLowerCase().indexOf("<head")&&
0>g&&(p=f.toLowerCase().indexOf("</head"),0<p&&(m=m+"<style type=text/css>"+("body { cursor:text; margin:10px; font-family:"+c._setting.font_family+"; font-size:"+c._setting.font_size+"; }"),m+="p { line-height:"+n+"; margin-top:0px; margin-bottom:0px; }",m+="li { line-height:"+n+"; margin-top:0px; margin-bottom:0px; }",m+="</style>",a=a.substring(0,p)+m+a.substring(p,a.length)))}return a}
function base64imageToLocalFile(a){if(G_dext5plugIn){a=a.body.getElementsByTagName("img");for(var c=a.length,b=0;b<c;b++){var d=a[b],e=d.src;if("data:"==e.substring(0,5)&&(e=e.split(","),2==e.length)){var f=getExtFromImageDataSrc(e[0]);try{var g=G_dext5plugIn.getLocalImageFromBase64Image(e[1],f);0<g.length&&(d.src=g)}catch(h){}}}}}
function setStyleForTableBorderNodeClass(a){try{if(0==checkIfIncluded("editor_contents.css")){var c="",c=DEXTTOP.DEXT5.isRelease?a._config.webPath.css:a._config.webPath.css_dev;DEXTTOP.DEXT5.addUserCssUrl(c+"editor_contents.css?ver="+DEXTTOP.DEXT5.ReleaseVer,a.ID)}}catch(b){}}
function setCssForFormMode(a){try{if(("1"==a._config.formMode||"1"==a._config.userTableLock.use)&&0==checkIfIncluded("editor_form.css")){var c="",c=DEXTTOP.DEXT5.isRelease?a._config.webPath.css:a._config.webPath.css_dev;DEXTTOP.DEXT5.addUserCssUrl(c+"editor_form.css?ver="+DEXTTOP.DEXT5.ReleaseVer,a.ID)}}catch(b){}};var g_findRepalceRange=null;
function command_find(a,c,b,d,e,f,g){dext_src_init(c);restoreSelection();setFocusToBody();if(0!=b.length)try{a=null;if(null==g_findRepalceRange){var h=getFirstRange().range;a=rangy.createRange(_iframeDoc);a.selectNodeContents(_iframeDoc.body);f?a.setStart(h.startContainer,h.startOffset):a.setEnd(h.startContainer,h.startOffset)}else a=g_findRepalceRange;d={caseSensitive:d,wholeWordsOnly:e,direction:f?"forward":"backward"};var m=a.findText(b,d);m?(a.select(),f?a.collapse(!1):a.collapse(!0),setAutoScrollToRange(a),
g_findRepalceRange=a):g?(a=f?moveCursorToTag(_iframeDoc.body,!0):moveCursorToTag(_iframeDoc.body,!1),(m=a.findText(b,d))?(a.select(),f?a.collapse(!1):a.collapse(!0),setAutoScrollToRange(a),g_findRepalceRange=a):alert(dext5_lang.find.msg.no_find)):alert(dext5_lang.find.msg.no_find)}catch(n){}}
function command_replace(a,c,b,d,e,f,g,h){dext_src_init(c);restoreSelection();setFocusToBody();if(0!=b.length)try{var m=null;if(null==g_findRepalceRange){var n=getFirstRange().range,m=rangy.createRange(_iframeDoc);m.selectNodeContents(_iframeDoc.body);m.setStart(n.startContainer,n.startOffset)}else m=g_findRepalceRange;var p={caseSensitive:e,wholeWordsOnly:f,direction:g?"forward":"backward"},q=!1,u=(n=getFirstRange().range)&&n.toString();!e&&n&&(b=b.toLowerCase(),u=u.toLowerCase());if(u==b)if(n.collapse(g),
m.setStart(n.startContainer,n.startOffset),q=m.findText(b,p)){m.select();m.deleteContents();var t=m.getDocument().createTextNode(d);m.insertNode(t);m.selectNode(t);m.select();g?m.collapse(!1):m.collapse(!0);command_find(a,c,b,e,f,g,h)}else g_findRepalceRange&&h&&(m=g?moveCursorToTag(_iframeDoc.body,!0):moveCursorToTag(_iframeDoc.body,!1),q=m.findText(b,p))&&(m.select(),m.deleteContents(),t=m.getDocument().createTextNode(d),m.insertNode(t),m.selectNode(t),m.select(),g?m.collapse(!1):m.collapse(!0),
command_find(a,c,b,e,f,g,h));else command_find(a,c,b,e,f,g,h)}catch(v){}}
function command_replaceAll(a,c,b,d,e,f,g,h){dext_src_init(c);restoreSelection();setFocusToBody();if(0!=b.length)try{g_findRepalceRange=null;range=rangy.createRange(_iframeDoc);range.selectNodeContents(_iframeDoc.body);a={caseSensitive:e,wholeWordsOnly:f,direction:g?"forward":"backward"};for(c=0;range.findText(b,a);){range.select();range.deleteContents();var m=range.getDocument().createTextNode(d);range.insertNode(m);range.selectNode(m);range.select();c+=1;g?range.collapse(!1):range.collapse(!0)}0<
c&&alert(c+dext5_lang.replace.replaceall_result)}catch(n){}}
function command_changeWordUpperLower(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();a=getFirstRange().range;try{if(a||(a=rangy.createRange(_iframeDoc),a.selectNodeContents(_iframeDoc.body)),a){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=getSelectionTextNodes(a),e=a.startContainer;e.firstNode&&(e=e.firstNode);var f=a.startOffset,g=a.endContainer;g.lasttNode&&(g=g.lasttNode);var h=a.endOffset,m=d.length;for(a=0;a<m;a++){var n=d[a];if(3==
n.nodeType){var p=n.nodeValue,q,u,t;q=u=t="";n==e&&n==g?(u=p.substring(0,f),q=p.substring(f,h),t=p.substring(h,p.length)):n==e&&0<f?(u=p.substring(0,f),q=p.substring(f,p.length)):n==g&&h<p.length?(q=p.substring(0,h),u=p.substring(h,p.length)):q=p;if("UPPER"==b)q=q.toUpperCase();else if("LOWER"==b)q=q.toLowerCase();else if("FIRSTUPPER"==b)q=q.replace(/\b([a-z])/g,function(a){return a.toUpperCase()});else return;p=n==e&&n==g?u+q+t:n==e&&0<f?u+q:q+u;n.nodeValue=p}}rangy.getSelection(_iframeWin).removeAllRanges();
moveCursorToTag(_iframeDoc.body,!0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}catch(v){}}function moveCursorToTag(a,c){if(null!=a&&void 0!=a){var b=rangy.createRange(_iframeDoc);b.selectNodeContents(a);try{c?b.collapse(!0):b.collapse(!1),rangy.getSelection(_iframeWin).setSingleRange(b)}catch(d){}return b}}function getNextNode(a){if(a.firstChild)return a.firstChild;for(;a;){if(a.nextSibling)return a.nextSibling;a=a.parentNode}}
function getNodesInRange(a){var c=a.startContainer,b=a.endContainer;a=a.commonAncestorContainer;var d=[],e;for(e=c.parentNode;e&&(d.push(e),e!=a);e=e.parentNode);d.reverse();for(e=c;e&&(d.push(e),e!=b);e=getNextNode(e));return d}
function getAllNodesInBody(a,c){var b=[];if(c){var d=a.getElementsByTagName("*");if(d)for(var e=d.length,f=0;f<e;f++){var g=d[f];g.tagName.toLowerCase();1==g.nodeType&&b.push(g)}}else for(g=a.childNodes[0];null!=g;)if(1==g.nodeType&&b.push(g),g.hasChildNodes())g=g.firstChild;else{for(;null==g.nextSibling&&g!=a;)g=g.parentNode;g=g.nextSibling}return b}function setAutoScrollToRange(a){try{var c=a.startContainer.parentNode;if(c){var b=getElementOffset(c);_iframeWin.scroll(b.left,b.top)}}catch(d){}}
function getNextSiblings(a,c){for(;a=a.nextSibling;)1!=a.nodeType&&3!=a.nodeType||c.push(a)}function firstElementChild(a){var c=a.firstElementChild;if(!c)for(c=a.firstChild;c&&1!==c.nodeType;)c=c.nextSibling;return c}
function getTextNodesBetween(a){function c(a){var q=a.nodeValue;a==d&&a==e&&a!==b?(q&&n.push(q.substring(f,g)),h=m=!0):a==d?(q&&n.push(q.substring(f)),h=!0):a==e?(q&&n.push(q.substring(0,g)),m=!0):3==a.nodeType&&q&&h&&!m&&!/^\s*$/.test(q)&&n.push(q);for(var q=0,u=a.childNodes.length;!m&&q<u;++q)c(a.childNodes[q])}var b=a.commonAncestorContainer,d=a.startContainer,e=a.endContainer,f=a.startOffset,g=a.endOffset,h=!1,m=!1,n=[];c(b);return n}
function getSelectionTextNodes(a){function c(a){var n=a.nodeValue;a==d&&a==e&&a!==b?(n&&h.push(a),f=g=!0):a==d?(n&&h.push(a),f=!0):a==e?(n&&h.push(a),g=!0):3==a.nodeType&&n&&f&&!g&&!/^\s*$/.test(n)&&h.push(a);for(var n=0,p=a.childNodes.length;!g&&n<p;++n)c(a.childNodes[n])}var b=a.commonAncestorContainer,d=a.startContainer,e=a.endContainer,f=!1,g=!1,h=[];c(b);return h};var _iframeDoc,_iframeWin,CURSOR_BEFORE_INTABLE=!1,G_Event=null;
function saveSelection(a){if(0!=DEXTTOP.DEXT5.browser.ie){a=document.getElementById("dext5_design_"+a);dext_src_init(a);a=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection;var c;try{a&&(a.createRange?c=a.createRange():a.getRangeAt?c=a.getRangeAt(0):a.anchorNode&&a.focusNode&&doc.createRange&&(c=_iframeDoc.createRange(),c.setStart(a.anchorNode,a.anchorOffset),c.setEnd(a.focusNode,a.focusOffset),c.collapsed!==a.isCollapsed&&(c.setStart(a.focusNode,a.focusOffset),c.setEnd(a.anchorNode,
a.anchorOffset))))}catch(b){}return c}}function restoreSelection(a){if(0!=DEXTTOP.DEXT5.browser.ie)try{_iframeDoc.body.focus();var c=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection,b=getEditrFromEvent(null);if(null==a||void 0==a)a=getEditrFromEvent(null)._LastRange;c&&a&&(a.select?a.select():c.removeAllRanges&&c.addRange&&(c.removeAllRanges(),c.addRange(a)),b._LastRange=null)}catch(d){}}
function createBookmark(){var a=document.getElementById("dext5_design_"+G_USE_EDITOR_ID);dext_src_init(a);var a=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection,c;try{a&&(a.createRange?c=a.createRange():a.getRangeAt?c=a.getRangeAt(0):a.anchorNode&&a.focusNode&&doc.createRange&&(c=_iframeDoc.createRange(),c.setStart(a.anchorNode,a.anchorOffset),c.setEnd(a.focusNode,a.focusOffset),c.collapsed!==a.isCollapsed&&(c.setStart(a.focusNode,a.focusOffset),c.setEnd(a.anchorNode,a.anchorOffset))))}catch(b){}return c}
function goToBookmark(a){if(0!=DEXTTOP.DEXT5.browser.ie)try{_iframeDoc.body.focus();var c=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection;c&&a&&(a.select?a.select():c.removeAllRanges&&c.addRange&&(c.removeAllRanges(),c.addRange(a)))}catch(b){}}
function CleanZeroChar(a){a=ReplaceAll(a,unescape("%uFEFF"),"");a=ReplaceAll(a,unescape("%u2060"),"");for(var c="span b strong i em strike u sup sub".split(" "),b=c.length,d=0;d<b;d++)a=setCleanTagOrValue(a,c[d],"");a=setCleanTagOrValue(a,"b","");for(d=0;d<b;d++)a=setCleanTagOrValue(a,c[d],"");a=setCleanTagOrValue(a,"strong","");for(d=0;d<b;d++)a=setCleanTagOrValue(a,c[d],"");a=setCleanTagOrValue(a,"i","");for(d=0;d<b;d++)a=setCleanTagOrValue(a,c[d],"");a=setCleanTagOrValue(a,"em","");for(d=0;d<b;d++)a=
setCleanTagOrValue(a,c[d],"");a=setCleanTagOrValue(a,"strike","");for(d=0;d<b;d++)a=setCleanTagOrValue(a,c[d],"");a=setCleanTagOrValue(a,"u","");for(d=0;d<b;d++)a=setCleanTagOrValue(a,c[d],"");a=setCleanTagOrValue(a,"sup","");for(d=0;d<b;d++)a=setCleanTagOrValue(a,c[d],"");a=setCleanTagOrValue(a,"sub","");for(d=0;d<b;d++)a=setCleanTagOrValue(a,c[d],"");return a}
function setCleanTagOrValue(a,c,b){for(;;){var d=new RegExp("span"==c?"<"+c+"[^>]*></"+c+">":"<"+c+"[^>]*>(?:\\s|<br>|<br />|  | |)</"+c+">","gim");a=a.replace(d,b);if(0==d.test(a))break}return a}
function dext_src_init_once(a,c){rangy.init();_iframeWin=rangy.dom.getIframeWindow(a);_iframeDoc=rangy.dom.getIframeDocument(a);createTableResizeBar(_iframeDoc);if("1"==c._config.dragResize&&!DEXTTOP.DEXT5.browser.mobile){var b=!1;if(0<c._config.dragResizeApplyBrowser.length)for(var d=c._config.dragResizeApplyBrowser.length,e=0;e<d;e++)switch(c._config.dragResizeApplyBrowser[e].toLowerCase()){case "ie":DEXTTOP.DEXT5.browser.ie&&(b=!0);break;case "firefox":DEXTTOP.DEXT5.browser.gecko&&(b=!0);break;
case "chrome":DEXTTOP.DEXT5.browser.chrome&&(b=!0);break;case "opera":DEXTTOP.DEXT5.browser.opera&&(b=!0);break;case "safari":DEXTTOP.DEXT5.browser.safari&&(b=!0)}else b=!0;if(b)try{c.dext_dragresize=new DextDragResize,c.dext_dragresize.apply(_iframeDoc)}catch(f){}}DEXTTOP.DEXT5.util.addEvent(document,"keyup",_dextiframe_Keyup,!1);DEXTTOP.DEXT5.util.addEvent(document,"keydown",_dextiframe_Keydown,!1);DEXTTOP.DEXT5.util.addEvent(window,"unload",function(){_dextiframe_Unload(c.ID)});DEXTTOP.DEXT5.util.addEvent(_iframeDoc,
"mousedown",_iframeDoc_MouseDown,!0);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mouseup",_iframeDoc_MouseUp,!0);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mouseup",_iframeDoc_MouseUpMenu);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"mousemove",_iframeDoc_MouseMove,!0);"1"!=c._config.contextMenuDisable&&DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"contextmenu",_iframeDoc_ContextMenu);DEXTTOP.DEXT5.util.addEvent(document,"contextmenu",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});DEXTTOP.DEXT5.util.addEvent(_iframeDoc,
"dblclick",_iframeDoc_DBClick);DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"click",_iframeBody_Click);DEXTTOP.DEXT5.util.addEvent(_iframeDoc.documentElement,"click",_iframeBody_Click);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keyup",_iframeDoc_Keyup);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keydown",_iframeDoc_Keydown);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keypress",_iframeDoc_Keypress);DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"paste",_iframeDoc_Paste);DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,
"beforepaste",_iframeDoc_BeforePaste);DEXTTOP.DEXT5.util.addEvent(document,"dragover",_iframeDoc_OnDropOver);"1"==c._config.dragAndDropAllow&&(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)||DEXTTOP.DEXT5.util.addEvent(_iframeWin,"dragover",_iframeDoc_OnDropOver);DEXTTOP.DEXT5.util.addEvent(_iframeWin,"scroll",_iframeDoc_Scroll);DEXTTOP.DEXT5.browser.ie?(DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,"beforedeactivate",_iframeDoc_BlurHandler),DEXTTOP.DEXT5.util.addEvent(_iframeDoc.body,
"focus",_iframeDoc_FocusHandler)):(DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"blur",_iframeDoc_BlurHandler),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"focus",_iframeDoc_FocusHandler));if("0"==c._config.dragAndDropAllow)DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1}),DEXTTOP.DEXT5.util.addEvent(document,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1});else if(DEXTTOP.DEXT5.browser.gecko)DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",insertDropImage),
DEXTTOP.DEXT5.util.addEvent(document,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1});else if(DEXTTOP.DEXT5.browser.ie&&9<DEXTTOP.DEXT5.browser.ieVersion||0==DEXTTOP.DEXT5.browser.ie)DEXTTOP.DEXT5.util.addEvent(document,"drop",insertDropImage),DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"drop",insertDropImage);"1"!=c._config.view_mode_auto_height&&"1"!=c._config.view_mode_auto_width||"view"!=c._config.mode||(b=function(a){return function(b){DEXTTOP.G_CURREDITOR=a;set_view_mode_auto_height()}}(c),
DEXTTOP.DEXT5.util.addEvent(_iframeWin,"load",b));try{_iframeDoc.execCommand("MultipleSelection",null,!0)}catch(g){}if("0"==DEXTTOP.G_CURREDITOR._config.autoUrlDetect)try{_iframeDoc.execCommand("AutoUrlDetect",!1,!1)}catch(h){}if(DEXTTOP.DEXT5.browser.gecko)try{_iframeDoc.execCommand("enableInlineTableEditing",!1,!1)}catch(m){}if(!isViewMode(c)){if("1"==c._config.defaultImemode&&(8>=DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks))try{var n=_iframeDoc.createElement("input");n.style.width=
"100px";n.style.height="30px";n.type="text";n.style.display="none";n.style.imeMode="active";_iframeDoc.body.appendChild(n);n.focus();_iframeDoc.body.removeChild(n)}catch(p){}""!=c._config.tabIndexObjId?0==DEXTTOP.DEXT5.browser.ie&&setTimeout(setBodyDefaultValue,0):(setTimeout(setBodyDefaultValue,0),setTimeout(setFocusToBody,0));setTimeout(function(){DEXTTOP.DEXT5.browser.ie?DEXTTOP.DEXT5.util.addEvent(document.body,"focus",_dextiframe_Focus):DEXTTOP.DEXT5.util.addEvent(window,"focus",_dextiframe_Focus)},
1E3)}}
function _dextiframe_Focus(a){if(DEXTTOP.DEXT5.browser.ie)try{var c=getEditrFromEvent(a);if(0==c._dextframeHasFocus&&(setFocusToBody(),DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)){var b=document.getElementsByTagName("A");0<b.length&&(b[0].className="")}c._dextframeHasFocus=!0}catch(d){}else setTimeout(function(){try{var b=getEditrFromEvent(a);if(0==b._dextframeHasFocus&&(setFocusToBody(),DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),
DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera)){var c=document.getElementsByTagName("A");0<c.length&&(c[0].className="")}b._dextframeHasFocus=!0}catch(d){}},0)}function _iframeDoc_BeforePaste(a){setDEXTWINDOC();isViewMode()?DEXTTOP.DEXT5.util.cancelEvent(a):!G_dext5plugIn&&DEXTTOP.DEXT5.browser.ie&&"paste"!=G_LAST_CMD&&(1==DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion&&(G_Event=a),setPasteBin())}
function setPasteBin(){try{if(DEXTTOP.DEXT5.browser.ie){DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID);var a=document.createElement("div");a.id="pasteDiv";a.innerHTML=unescape("%uFEFF");a.style.position="absolute";a.style.filter="alpha(opacity=0)";a.style.overflow="hidden";DEXTTOP.DEXT5.browser.gecko?(a.style.left="0px",a.style.top="0px"):(a.style.left="-1000px",a.style.top="-1000px");DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion?(a.style.width="999px",a.style.height=
"999px"):(a.style.width="0px",a.style.height="0px");a.contentEditable=!0;a.onpaste=fn_PasteIE;document.body.appendChild(a);0==DEXTTOP.G_CURREDITOR.initPaste?document.body.focus():DEXTTOP.G_CURREDITOR.initPaste=!1;a.focus();return!0}}catch(c){return!0}}
function setPasteBinForGecko(){if(DEXTTOP.DEXT5.browser.gecko){DEXTTOP.G_CURREDITOR._LastRange=saveSelection(DEXTTOP.G_CURREDITOR.ID);var a=document.createElement("iframe");a.id="pasteIframe";a.frameBorder=0;a.style.width="0px";a.style.height="0px";a.style.position="absolute";a.style.left="0px";a.style.top="0px";if(DEXTTOP.DEXT5.browser.mobile||DEXTTOP.DEXT5.browser.iOS)a.style.overflow="hidden",a.style.display="inline-block";var c="document.open();"+(isCustomDomain(document)?'document.domain="'+
document.domain+'";':"")+" document.close();",c=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(c)+"}())":"";a.src=c;document.body.appendChild(a);a=getIframeDocument(a);a.open("text/html","replace");isCustomDomain(document)&&(a.domain=document.domain);a.write('<body contenteditable="true">'+unescape("%uFEFF")+"</body>");a.close();a.body.contentEditable=!0;a.body.onpaste=fn_PasteIE;a.body.focus()}}
function _iframeDoc_Paste(a){setDEXTWINDOC();if(isViewMode())DEXTTOP.DEXT5.util.cancelEvent(a);else{if(DEXTTOP.DEXT5.browser.ie)return!0;if(null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)){var c=setInterval(function(){clearInterval(c);for(var a=!1,b=DEXTTOP.G_CURREDITOR._DOC.getElementsByTagName("img"),d=b.length,e=0;e<d;e++)-1<b[e].src.indexOf("webkit-fake-url")&&(a=!0,b[e].parentNode.removeChild(b[e]));
a&&alert(dext5_lang.msg.pasteFakeUrl)},10);return!0}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var b=!1,d="";a&&a.clipboardData&&a.clipboardData.getData&&(/Files|files/.test(a.clipboardData.types)&&a.clipboardData.getData("text/html")&&-1<a.clipboardData.getData("text/html").indexOf(">\x3c!--p.")?b=!1:/text\/html/.test(a.clipboardData.types)?(d=a.clipboardData.getData("text/html"),b=!0):/text\/plain/.test(a.clipboardData.types)&&(d=a.clipboardData.getData("text/plain"),
b=!0,d=d.replace(/</g,"&lt;"),d=d.replace(/>/g,"&gt;"),d=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,d)));d=dragresizeClear(d);if(b){if(0<d.length){d=SetCorrectOfficeHtml(d);d=htmlTagRevision(d,!0);d=repairPasteTextInCell(d);0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR._iconEnable(""));b=DEXTTOP.DEXT5.util.officeClean(d,!1);b=OfficePasteClean(b);b=DEXTTOP.DEXT5.util.emptyTagRemove(b);b=DEXTTOP.DEXT5.util.htmlRevision(b);b=
xssReplaceScript(null,b);try{var e=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(b);e&&(b=e)}catch(f){}-1<b.indexOf("dext5customdata")&&(b=checkExistCustomData(b));_iframeDoc.execCommand("inserthtml",!1,b);checkPasteImage(b);if(e=getFirstRange().range)rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(e);0>b.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1))}}else setPasteImageFromClipboard(a);
if(0==DEXTTOP.DEXT5.browser.gecko)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.DEXT5.util.cancelEvent(a);else return!0}}
function _iframeDoc_Keypress(a){setDEXTWINDOC();var c="which"in a?a.which:a.keyCode;try{var b=getEditrFromEvent(a),d=b._config;if("1"!=d.formMode&&"1"==d.userTableLock.use){var e=getFirstRange().range.startContainer;3==e.nodeType&&(e=e.parentNode);var f=GetTDTHCell(e),g;f&&(g=GetParentbyTagName(e,"table"));var e=!0,h=d.userTableLock.defaultTableLockMode;g&&g.getAttribute("lock_mode")&&""!=g.getAttribute("lock_mode")&&(h=g.getAttribute("lock_mode"));"1"==h&&(e=!1);if(f){if(e&&checkLockAttr(g)){if(b.lastElemForLock)setFocusForLock(b.lastElemForLock);
else{var m=findNoLockElem(g);m?setFocusForLock(m):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(event);DEXTTOP.DEXT5.util.cancelEvent(event);return}if(checkLockAttr(f,!e)){b.lastElemForLock?setFocusForLock(b.lastElemForLock):setFocusForLock(findNoLockCell(g));DEXTTOP.DEXT5.util.stopEvent(event);DEXTTOP.DEXT5.util.cancelEvent(event);return}}}if("1"==d.returnEvent.key_event){DEXTTOP.DEXT5.config.KeyEventCancel=!1;try{var n=getFirstRange().range.startContainer;3==n.nodeType&&(n=
n.parentNode);DEXTTOP.DEXTWIN.dext_key_event("keypress",a,n)}catch(p){}if(1==DEXTTOP.DEXT5.config.KeyEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(""!=d.enterTag){var b=!1,q,u,t;t=d.enterTag;if(13==c){if(!a.shiftKey)if("undefined"!=typeof _iframeWin.getSelection){if(u=_iframeWin.getSelection(),u.getRangeAt&&u.rangeCount){q=u.getRangeAt(0);q.deleteContents();var v=_iframeDoc.createElement(t);q.insertNode(v);q.setEndAfter(v);q.setStartAfter(v);q.collapse(!1);u.removeAllRanges();u.addRange(q);
if(11<=DEXTTOP.DEXT5.browser.ieVersion||0==DEXTTOP.DEXT5.browser.ie){var w=v.nextSibling;if(null==w||3==w.nodeType&&""==w.nodeValue)v=_iframeDoc.createElement(t),q.insertNode(v),q.setEndBefore(v),q.setStartBefore(v),q.collapse(!1),u.removeAllRanges(),u.addRange(q)}b=!0}}else"undefined"!=typeof _iframeDoc.selection&&(u=_iframeDoc.selection,u.createRange&&(q=u.createRange(),"div"==t?(t=getDefaultParagraphValue(!0),pasteHtmlAtCaretHuge(v.outerHTML)):t="<"+t+" />",q.pasteHTML(t),q.collapse(!1),q.select(),
b=!0));b&&DEXTTOP.DEXT5.util.cancelEvent(a)}}}catch(x){}}var bCtrlKey=!1,startBookmark,endBookmark;
function _iframeDoc_Keydown(a){setDEXTWINDOC();var c="which"in a?a.which:a.keyCode;if(!checkDefaultMessage(a))if(isViewMode())0==(9==c||38==c||40==c||37==c||39==c)&&0==("1"==DEXTTOP.G_CURREDITOR._config.viewModeAllowCopy&&a.ctrlKey&&67==c)&&DEXTTOP.DEXT5.util.cancelEvent(a);else{if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){var b=getFirstRange().range.startContainer;3==b.nodeType&&(b=b.parentNode);var d=GetTDTHCell(b),e;d&&(e=GetParentbyTagName(b,
"table"));var f=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;e&&e.getAttribute("lock_mode")&&""!=e.getAttribute("lock_mode")&&(f=e.getAttribute("lock_mode"));b=!0;"1"==f&&(b=!1);if(d){if(b&&checkLockAttr(e)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):(c=findNoLockElem(e))?setFocusForLock(c):(window.focus(),document.body.focus());DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(d,!b)){DEXTTOP.G_CURREDITOR.lastElemForLock?
setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):setFocusForLock(findNoLockCell(e));DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(8==c||46==c){var d=GetTableSelectionCells(),f=d.length,g=!1;for(e=0;e<f;e++)if(checkLockAttr(d[e]),!b){g=!0;break}if(g){DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}}}b=a.target?a.target:a.srcElement;e=b.tagName?b.tagName.toLowerCase():null;if("1"==DEXTTOP.G_CURREDITOR._config.returnEvent.key_event){DEXTTOP.DEXT5.config.KeyEventCancel=
!1;try{b=getFirstRange().range.startContainer,3==b.nodeType&&(b=b.parentNode),DEXTTOP.DEXTWIN.dext_key_event("keydown",a,b)}catch(h){}if(1==DEXTTOP.DEXT5.config.KeyEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(!e||"textarea"!=e&&"input"!=e&&"select"!=e)if("1"==DEXTTOP.G_CURREDITOR._config.disableKeydown&&8!=c&&46!=c)DEXTTOP.DEXT5.util.cancelEvent(a);else{if(0==a.ctrlKey&&112<=c&&123>=c)return DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),!1;a.ctrlKey&&(b=nextTabKeyAccess(a,
c))&&DEXTTOP.DEXT5.util.cancelEvent(a);if(b=setTableShortcut(a))return DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),!1;if(8==c&&(f=a.srcElement)){if(Mouse_Status==Mouse_IsControlSelecting&&1==f.nodeType&&"IMG"==f.tagName){DEXTTOP.DEXT5.util.cancelEvent(a);return}f=getFirstRange();e=f.range;if((b=f.sel)&&b.docSelection&&"Control"==b.docSelection.type){DEXTTOP.DEXT5.util.cancelEvent(a);return}e&&"BODY"==e.startContainer.nodeName&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo()}startBookmark=
endBookmark=void 0;bCtrlKey=a.ctrlKey;b=229;DEXTTOP.DEXT5.browser.gecko&&(b=0);0==a.ctrlKey&&0==a.altKey&&0==DEXTTOP.G_CURREDITOR.UndoManager.arrImageHTML.length&&(32<=c&&127>=c||c==b)?(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR._iconEnable("")):46==c||a.shiftKey||1==a.ctrlKey||1==a.ctrlKey&&67==c||ClearDraggingTableCellSelected();0==bCtrlKey&&9==c&&"1"!=DEXTTOP.G_CURREDITOR._config.EditorTabDisable&&(setTabkeyAction(),DEXTTOP.DEXT5.util.cancelEvent(a));
!DEXTTOP.DEXT5.browser.chrome||37!=c&&38!=c&&39!=c&&40!=c||setArrowKeyAction(37)&&DEXTTOP.DEXT5.util.cancelEvent(a);a.ctrlKey&&86==c&&0==DEXTTOP.G_CURREDITOR.UndoManager.arrImageHTML.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR._iconEnable(""));if(1==bCtrlKey&&13==c&&(e=getFirstRange().range,f=null,e&&e.startContainer&&(f=getMyElementNode(e.startContainer)),f&&(d=GetTDTHCell(f),null==d&&"tr"==f.tagName.toLowerCase()&&(e=f.cells.length,
0<e&&(d=f.cells[e-1])),d))){var m=GetParentbyTagName(d,"tr");if(e=GetParentbyTagName(d,"table")){var f=d.cellIndex,g=m.cells.length,m=m.rowIndex,n=e.rows.length;1<d.rowSpan&&(m+=d.rowSpan-1);1==n?0==f?insertPtagTableNear(!0,e):f==g-1&&insertPtagTableNear(!1,e):0==m&&0==f?insertPtagTableNear(!0,e):m==n-1&&f==g-1&&insertPtagTableNear(!1,e);DEXTTOP.DEXT5.util.cancelEvent(a)}}if(1==bCtrlKey)if(a.altKey&&191==c)DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"about");else if(a.altKey&&48==c){var p=
"- DEXT5 Editor Information -\n  Client Ver. "+DEXTTOP.DEXT5.ReleaseVer,p=p+("\n  Server Ver. "+DEXTTOP.DEXT5.ServerReleaseVer);if("ieplugin"==DEXTTOP.G_CURREDITOR._config.runtimes)try{p+="\n  Client Cab Ver. "+G_dext5plugIn.getDext5PluginVersion()}catch(q){}alert(p)}else if(a.altKey&&57==c)try{G_dext5plugIn.SetLogLevel(1)}catch(u){}else if(a.shiftKey&&67==c)DEXTTOP.DEXT5.util.cancelEvent(a),command_tableCopy(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR);else if(a.shiftKey&&86==c)DEXTTOP.DEXT5.util.cancelEvent(a),
command_intablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR);else if(a.shiftKey&&84==c)DEXTTOP.DEXT5.util.cancelEvent(a),command_tablePaste(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR);else if(86==c){"paste"==G_LAST_CMD&&(G_LAST_CMD=null);if(G_dext5plugIn){DEXTTOP.DEXT5.util.cancelEvent(a);d=G_dext5plugIn.getPasteHtml();d=d.replace(/layout-flow:.*?;/gi,"");100==G_dext5plugIn.getHTMLFormatFromType&&(d=d.replace(/\r?\n/g,"<BR />"));f=!1;if(G_dext5plugIn.getHTMLFormatFromType&&G_dext5plugIn.getPasteHtmlEx&&
6==G_dext5plugIn.getHTMLFormatFromType&&(f=!0,DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion&&(g=d.match(RegExp("<img[^>]*src=[\"']?([^>\"']+)[\"']?[^>]*>","gi")))))for(m=g.length,e=0;e<m;e++)if(-1<g[e].indexOf("file://")){f=!1;break}6==G_dext5plugIn.getHTMLFormatFromType&&DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion&&(e=G_dext5plugIn.getPasteHtmlEx(),e=checkCopyInCellFormInertnNet(e),""!=e&&(d=e,f=!1));if(checkCanPasteToIamge())if("1"==DEXTTOP.G_CURREDITOR._config.pasteToImage||
"2"==DEXTTOP.G_CURREDITOR._config.pasteToImage){e=G_dext5plugIn.ShowImageSaveDlgFromClipboard("");try{if("HTML"==e&&"1"==DEXTTOP.G_CURREDITOR._config.limitPasteHtmlLength.value){var t=DEXTTOP.G_CURREDITOR._config.limitPasteHtmlLength.length,v=G_dext5plugIn.getOriginalHtml("body");if(v.length>t){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1);setFocusToBody();return}}}catch(w){}if(""==e)return;""!=e&&"HTML"!=e&&(d=e)}else{if("0"==DEXTTOP.G_CURREDITOR._config.pasteToImage&&"1"==DEXTTOP.G_CURREDITOR._config.limitPasteHtmlLength.value&&
(t=DEXTTOP.G_CURREDITOR._config.limitPasteHtmlLength.length,v=G_dext5plugIn.getOriginalHtml("body"),v.length>t)){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1);setFocusToBody();return}}else try{if("1"==DEXTTOP.G_CURREDITOR._config.limitPasteHtmlLength.value&&(t=DEXTTOP.G_CURREDITOR._config.limitPasteHtmlLength.length,v=G_dext5plugIn.getOriginalHtml("body"),v.length>t)){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2);setFocusToBody();return}}catch(x){}t=!0;f&&(setPasteBin(),(t=document.execCommand("paste",
!1,null))?(t=!1,fn_PasteIE()):t=!0);if(t&&(t=!1,6==G_dext5plugIn.getHTMLFormatFromType&&(t=!0),v=document.createElement("div"),v.innerHTML=d,replaceSpanToDivContainAbsolute(v)&&(d=v.innerHTML),d=htmlTagRevision(d,!0,t),d=repairPasteTextInCell(d),0<d.length)){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR._iconEnable(""));f=getFirstRange();e=f.range;var y=DEXTTOP.DEXT5.util.officeClean(d,!0),y=OfficePasteClean(y),y=DEXTTOP.DEXT5.util.emptyTagRemove(y),
y=IEPasteRemoveEmptyNodes(y),y=DEXTTOP.DEXT5.util.htmlRevision(y),y=xssReplaceScript(null,y),y=getImageAutoFitForPasteHtml(y);try{(p=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(y))&&(y=p)}catch(z){}-1<y.indexOf("dext5customdata")&&(y=checkExistCustomData(y));setTimeout(function(){pasteHtmlAtCaretHuge(y)},0);checkPasteImage(y);0>y.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1));base64imageToLocalFile(_iframeDoc)}}DEXTTOP.DEXT5.browser.gecko&&
setPasteBinForGecko()}else{if(83==c){p=!1;t=DEXTTOP.G_CURREDITOR.remove_item;v=t.length;for(e=0;e<v;e++)if("save"==t[e]){p=!0;break}p||command_saveAs("",DEXTTOP.G_CURREDITOR);DEXTTOP.DEXT5.util.cancelEvent(a)}}else 13==c&&DEXTTOP.DEXT5.browser.ie&&setLineHeightForBgColor();DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion&&moveRulerPosition(a);if(1==bCtrlKey&&89==c)DEXTTOP.G_CURREDITOR.UndoManager.execRedo(),DEXTTOP.DEXT5.util.cancelEvent(a);else if(1==bCtrlKey&&90==c)0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&
(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0),DEXTTOP.G_CURREDITOR.UndoManager.execUndo(),DEXTTOP.DEXT5.util.cancelEvent(a);else if(0==bCtrlKey&&13==c)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,DEXTTOP.G_CURREDITOR._iconEnable("");else if(0==bCtrlKey&&46==c&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,setDeleteKeyAction()))return DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),
!0;if(0==bCtrlKey&&(46==c||8==c)&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0,removePTagNearTable(c)))return DEXTTOP.DEXT5.util.cancelEvent(a),DEXTTOP.DEXT5.util.stopEvent(a),!0;0==bCtrlKey&&(32<=c&&127>=c||c==b)&&(0==DEXTTOP.G_CURREDITOR.UndoManager.index&&0<DEXTTOP.G_CURREDITOR.UndoManager.arrImageHTML.length?(DEXTTOP.G_CURREDITOR.UndoManager.arrImageHTML.length=1,DEXTTOP.G_CURREDITOR.UndoManager.charCount=0):DEXTTOP.G_CURREDITOR.UndoManager.index<DEXTTOP.G_CURREDITOR.UndoManager.arrImageHTML.length&&
(DEXTTOP.G_CURREDITOR.UndoManager.arrImageHTML.length=DEXTTOP.G_CURREDITOR.UndoManager.index+1),DEXTTOP.G_CURREDITOR.UndoManager.charCount+=1,1==DEXTTOP.G_CURREDITOR.UndoManager.canRedo&&(DEXTTOP.G_CURREDITOR.UndoManager.canRedo=!1,DEXTTOP.G_CURREDITOR.UndoManager.canUndo=!0,DEXTTOP.G_CURREDITOR._iconEnable("")),DEXTTOP.G_CURREDITOR.UndoManager.charCount>=G_PutUndoCharCount&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0));!DEXTTOP.DEXT5.browser.ie||37!=c&&
38!=c&&39!=c&&40!=c||setTableArrowKeyDownAction(a);setTimeout(function(){bCtrlKey=!1},300)}}}
function removePTagNearTable(a){var c=!1;try{var b=getFirstRange().range;if(0<b.toString().length)return c;var d=null;b&&b.startContainer&&(d=getMyElementNode(b.startContainer));if(d&&1==d.nodeType){var e=d.innerHTML;if(""==e||"<br>"==e||"<br/>"==e||"<br />"==e)if(46==a?nearElem=d.nextSibling:8==a&&(nearElem=d.previousSibling),nearElem&&1==nearElem.nodeType&&"table"==nearElem.tagName.toLowerCase()||"blockquote"==nearElem.tagName.toLowerCase()){if(46==a)"table"==nearElem.tagName.toLowerCase()?doSetCaretPosition(nearElem.rows[0].cells[0],
0):doSetCaretPosition(nearElem,0);else if(8==a)if("table"==nearElem.tagName.toLowerCase()){var f=nearElem.rows.length;doSetCaretPosition(nearElem.rows[f-1].cells[nearElem.rows[f-1].cells.length-1],0)}else{var g=nearElem.childNodes[nearElem.childNodes.length-1];g||(g=nearElem);doSetCaretPosition(g,1)}d.innerHTML="";d.parentNode.removeChild(d);c=!0}}}catch(h){}return c}
function setPasteCellData(){var a=getFirstRange().range,c=null;if(a&&a.startContainer){if(c=DrageStartCell)if(c=GetTDTHCell(c)){if(null==DEXTTOP.G_COPIEDCELLDATA)return!1;for(var b=GetParentbyTagName(c,"tr"),a=GetParentbyTagName(c,"table"),c=c.cellIndex,b=b.rowIndex,d,e=DEXTTOP.G_COPIEDCELLDATA.length,f=0,g=0;g<e&&void 0!=a.rows[b+g];g++)for(var f=DEXTTOP.G_COPIEDCELLDATA[g].length,h=0;h<f&&!(f>a.rows[b+g].cells.length);h++)void 0!=a.rows[b+g].cells[c+h]&&(a.rows[b+g].cells[c+h].innerHTML=DEXTTOP.G_COPIEDCELLDATA[g][h],
d=a.rows[b+g].cells[c+h]);null!=d&&(doSetCaretPosition(d.childNodes[0],1),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&"&nbsp;"==d.innerHTML&&(d.innerHTML=""))}else{if(null==DEXTTOP.G_COPIEDTABLE)return!1;d=DEXTTOP.G_COPIEDTABLE.outerHTML;0==DEXTTOP.DEXT5.browser.gecko&&(d=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?d+"<p></p>":d+getDefaultParagraphValue(!0));pasteHtmlAtCaretHuge(d)}else{if(null==DEXTTOP.G_COPIEDTABLE)return!1;restoreSelection();setFocusToBody();
a=getFirstRange().range;getMyElementNode(a.startContainer);d=DEXTTOP.G_COPIEDTABLE.outerHTML;0==DEXTTOP.DEXT5.browser.gecko&&(d=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?d+"<p></p>":d+getDefaultParagraphValue(!0));pasteHtmlAtCaretHuge(d)}return!0}return!1}function getEnterTagString(a){var c="",c=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?"&nbsp;":"<br />",b="";"br"==a?b="<br />":"p"==a?b="<p>"+c+"</p>":"div"==a&&(b="<div>"+c+"</div>");return b}
function _iframeDoc_Keyup(a){setDEXTWINDOC();if(isViewMode())DEXTTOP.DEXT5.util.cancelEvent(a);else{var c="which"in a?a.which:a.keyCode;if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){var b=getFirstRange().range.startContainer;3==b.nodeType&&(b=b.parentNode);var d=GetTDTHCell(b),e;d&&(e=GetParentbyTagName(b,"table"));b=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;e&&e.getAttribute("lock_mode")&&""!=e.getAttribute("lock_mode")&&
(b=e.getAttribute("lock_mode"));var f=!0;"1"==b&&(f=!1);if(d){if(f&&checkLockAttr(e)){if(DEXTTOP.G_CURREDITOR.lastElemForLock)setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock);else{var g=findNoLockElem(e);g?setFocusForLock(g):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(d,!f)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):setFocusForLock(findNoLockCell(e));DEXTTOP.DEXT5.util.stopEvent(a);
DEXTTOP.DEXT5.util.cancelEvent(a);return}DEXTTOP.G_CURREDITOR.lastElemForLock=d}else checkLockElemInSelectionRange()}d=a.target?a.target:a.srcElement;e=d.tagName?d.tagName.toLowerCase():null;if("1"==DEXTTOP.G_CURREDITOR._config.returnEvent.key_event){DEXTTOP.DEXT5.config.KeyEventCancel=!1;try{d=getFirstRange().range.startContainer,3==d.nodeType&&(d=d.parentNode),DEXTTOP.DEXTWIN.dext_key_event("keyup",a,d)}catch(h){}if(1==DEXTTOP.DEXT5.config.KeyEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(e&&
("textarea"==e||"input"==e||"select"==e))return!1;if(8==c||46==c)if(""==_iframeDoc.body.innerHTML||"<br>"==_iframeDoc.body.innerHTML)_iframeDoc.body.innerHTML="",setBodyDefaultValue();if(a.ctrlKey||bCtrlKey){if(86==c&&G_dext5plugIn){DEXTTOP.DEXT5.util.cancelEvent(a);return}}else 46==c&&(_iframeDoc_MouseUpMenu(a),DEXTTOP.G_SELECTED_ELEMENT=null),13==c&&DEXTTOP.DEXT5.browser.ie&&setLineHeightForBgColor();DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion&&moveRulerPosition(a);if(46==c||8==
c||37==c||38==c||39==c||40==c||36==c||35==c||33==c||34==c){DEXTTOP.G_CURREDITOR._iconEnable("");try{g=getFirstRange().range,c=null,g&&g.startContainer&&(c=getMyElementNode(g.startContainer),setMenuIconRealable(c))}catch(m){}DEXTTOP.DEXT5.browser.ie&&setTableArrowKeyUpAction(a)}try{c=null,(g=getFirstRange().range)&&0==g.toString().length&&g.startContainer&&(c=getMyElementNode(g.startContainer)),_iframeDoc_MouseUpMenu(a,c)}catch(n){}}}
function fn_PasteIE(){setTimeout(function(){var a=null;if(DEXTTOP.DEXT5.browser.ie)a=document.getElementById("pasteDiv");else try{var c=document.getElementById("pasteIframe");c&&(a=getIframeDocument(c).body)}catch(b){a=null}if(a){isMsHtmlorHugeHtml(a);a.blur();c=a.innerHTML;"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(c=c.replace(/--\x3e\s</gi,"--\x3e<"));c=dragresizeClear(c);restoreSelection(DEXTTOP.G_CURREDITOR._LastRange);var d=a.getElementsByTagName("img"),e=d.length,f=!1;if(0==e&&1==c.length&&
1==DEXTTOP.DEXT5.browser.ie&&12<=DEXTTOP.DEXT5.browser.ieVersion&&null!=G_Event)for(var g=0;g<G_Event.clipboardData.items.length;g++)if("file"==G_Event.clipboardData.items[g].kind&&"image/png"==G_Event.clipboardData.items[g].type){var f=!0,h=G_Event.clipboardData.items[g].getAsFile();G_Event=null;var m=new FileReader;m.onloadend=function(){var b=document.createElement("img");b.src=m.result;a.appendChild(b);var c=m.result;if("data:"==c.substring(0,5)&&(c=c.split(","),2==c.length)){var d=getExtFromImageDataSrc(c[0]);
postBase64ImageToServer(c[1],d,b);checkPasteImage(a.innerHTML);pasteHtmlAtCaretHuge(a.innerHTML)}};m.readAsDataURL(h)}else G_Event=null;if(1==f)return null;checkPasteImage(c);h=!1;for(g=0;g<e;g++){var f=d[g],n=f.src;"data:"==n.substring(0,5)&&(n=n.split(","),2==n.length&&(h=getExtFromImageDataSrc(n[0]),postBase64ImageToServer(n[1],h,f),h=!0))}h&&(c=a.innerHTML);c=removeDummyfontTagInTable(c);a.innerHTML=c;g=a.innerHTML;d=RegExp("<li.*?(mso-list).*?>","gi");if(DEXTTOP.DEXT5.browser.ie&&11<=DEXTTOP.DEXT5.browser.ieVersion&&
d.test(g)){d=a.getElementsByTagName("ol");e=d.length;f=a.getElementsByTagName("ul");h=f.length;for(g=0;g<e;g++)n=d[g].getElementsByTagName("li")[0],""==n.style.fontFamily&&(n.style.fontFamily="\ub9d1\uc740 \uace0\ub515"),""==n.firstChild.style.fontFamily&&(n.firstChild.style.fontFamily="\ub9d1\uc740 \uace0\ub515");for(g=0;g<h;g++)n=f[g].getElementsByTagName("li")[0],""==n.style.fontFamily&&(n.style.fontFamily="\ub9d1\uc740 \uace0\ub515"),""==n.firstChild.style.fontFamily&&(n.firstChild.style.fontFamily=
"\ub9d1\uc740 \uace0\ub515")}g=replaceSpanToDivContainAbsolute(a);n=!1;d="";e=a.childNodes.length;for(f=0;f<e;f++)h=a.childNodes[f],1==h.nodeType&&"FONT"==h.tagName?(n="",""!=h.color&&(n+="color:"+h.color+";"),""!=h.face&&(n+="font-family:"+h.face+";"),""!=h.style.cssText&&(n+=h.style.cssText),0<n.length&&(n=" style='"+n+"'"),d+="<span"+n+">"+h.innerHTML+"</span>",n=!0):3==h.nodeType?d+=h.nodeValue:8==h.nodeType?"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(d+=h.text):d+=h.outerHTML;if(1==n||
g)c=d;if(DEXTTOP.DEXT5.browser.ie)document.body.removeChild(a);else try{document.body.removeChild(document.getElementById("pasteIframe"))}catch(p){}setFocusToBody();g=!1;G_dext5plugIn&&6==G_dext5plugIn.getHTMLFormatFromType&&(g=!0);c=htmlTagRevision(c,!0,g);c=ReplaceAll(c,unescape("%uFEFF"),"");c=ReplaceAll(c,unescape("%u2060"),"");if(0<c.length&&(c=SetCorrectOfficeHtml(c),g=!1,G_dext5plugIn&&(g=!0),c=DEXTTOP.DEXT5.util.officeClean(c,g),c=DEXTTOP.DEXT5.util.emptyTagRemove(c),c=IEPasteRemoveEmptyNodes(c),
c=DEXTTOP.DEXT5.util.htmlRevision(c),c=xssReplaceScript(null,c),DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.gecko)){c=OfficePasteClean(c);try{var q=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(c);q&&(c=q)}catch(u){}-1<c.indexOf("dext5customdata")&&(c=checkExistCustomData(c));pasteHtmlAtCaretHuge(c);0>c.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1));setAdjustTableBorder(DEXTTOP.G_CURREDITOR._DOC)}}},
0)}
function IEPasteRemoveEmptyNodes(a){function c(a){function b(a){for(var c=a.childNodes,d=[],e=0,f=c.length;e<f;++e)a=c[e],a.TEXT_NODE==a.nodeType?d.push(a.data):a.ELEMENT_NODE==a.nodeType&&d.push(b(a));return d.join("").replace(/\s+/g," ")}"string"==typeof a&&(a=_iframeDoc.getElementById(a));return"string"==typeof a.textContent?a.textContent:"string"==typeof a.innerText?a.innerText:b(a)}if(DEXTTOP.DEXT5.browser.ie&&"1"==DEXTTOP.G_CURREDITOR._config.pasteRemoveEmptyTag)try{var b=_iframeDoc.createElement("div");b.innerHTML=
a;for(var d,e=b.getElementsByTagName("*"),f,g=newline=!1,h=/^\s*$/,m,n,p=0;p<e.length;p++)if(d=e[p],m=new RegExp("\\b"+d.tagName+"\\b","i"),!m.test("base basefont body br col hr html img input isindex link meta param title")&&m.test("span div b strong i em strike u sup sub")&&h.test(c(d))){f=d.getElementsByTagName("*");for(var q=0,u=f.length;q<u;q++)if(n=new RegExp("\\b"+f[q].tagName+"\\b","i"),n.test("base basefont body br col hr html img input isindex link meta param title")){g=!0;break}-1<d.innerHTML.indexOf("&nbsp;")&&
(newline=!0);g||newline||(d.parentNode.removeChild(d),--p);newline=g=!1}a=b.innerHTML}catch(t){}return a}
function pasteHtmlAtCaretHuge(a){if(0!=a.length){var c,b,d=getFirstRange();c=d.sel;b=d.range;if(c.getRangeAt&&c.rangeCount){var e=getBlockContainer(b.startContainer),f,g,h,m;if(e){var n=_iframeDoc.createElement("div");n.innerHTML=a;g=_iframeDoc.createDocumentFragment();for(var p=!1;m=n.firstChild;)if(g.appendChild(m),0==p&&1==m.nodeType&&(m=m.tagName.toLowerCase(),"p"==m||"table"==m||"div"==m||"hr"==m||"input"==m||"select"==m||"button"==m||"textarea"==m||"ol"==m||"ul"==m))p=!0;n=e.tagName.toLowerCase();
"div"==n&&(p=!1);if(p){b.deleteContents();try{f=extractBlockContentsFromCaret(!0);h=extractBlockContentsFromCaret(!1);var p="",q=f.childNodes.length,u,t;u=t;q=f.childNodes.length;d=getFirstRange();c=d.sel;b=d.range;b.selectNode(e);b.deleteContents();if(0<q){var v=f.childNodes[0];if(1!=q||3!=v.nodeType||0!=v.nodeValue.length)u=_iframeDoc.createElement(n),u.appendChild(f),setCopyAllObjectAtributes(e,u,!1),b.insertNode(u),b.setStartAfter(u),q=h?h.childNodes.length:0,0==q&&doSetCaretPosition(u,1),b.collapse(!0)}var w;
if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie)w=_iframeDoc.createElement("span"),w.innerHTML=DEXTTOP.DEXT5.browser.gecko?"<br>":"&nbsp;",b.insertNode(w),b.setStartAfter(w),b.collapse(!0);q=h?h.childNodes.length:0;0<q&&(v=h.childNodes[0],1!=q||3!=v.nodeType||0!=v.nodeValue.length)&&(t=_iframeDoc.createElement(n),t.appendChild(h),setCopyAllObjectAtributes(e,t,!1),b.insertNode(t),rangy.getSelection(_iframeWin).removeAllRanges(),b.selectNode(t),b.setEndBefore(t),c.addRange(b),b.collapse(!0));
var p="",x=g.childNodes.length;c=!1;for(d=0;d<x;d++){var y=g.childNodes[d];1==y.nodeType&&checkBlockTag(y.tagName)?(1==c&&(p+="</p>",c=!1),p+=y.outerHTML):1==y.nodeType&&0==checkBlockTag(y.tagName)?(0==c&&(p+="<p>",c=!0),p+=y.outerHTML):3==y.nodeType&&0<y.nodeValue.length?(0==c&&(p+="<p>",c=!0),p+=y.nodeValue):8==y.nodeType&&"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(p+=y.text);d==x-1&&1==c&&(p+="</p>",c=!1)}if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie)rangy.getSelection(_iframeWin).removeAllRanges(),
b.selectNode(w),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b);pasteHtmlAtCaretMini(p);if(DEXTTOP.DEXT5.browser.gecko||DEXTTOP.DEXT5.browser.ie)w.removeNode?w.removeNode():w.outerHTML="";else if(!(_iframeWin.getSelection||9<=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks)){var z=e.lastChild;z&&"table"==z.tagName.toLowerCase()&&doSetCaretPosition(z.cells[0],1)}}catch(C){pasteHtmlAtCaretMini(a)}}else pasteHtmlAtCaretMini(a)}else pasteHtmlAtCaretMini(a)}}}
function pasteHtmlAtCaretMini(a){if(0!=a.length){var c,b,d=getFirstRange();c=d.sel;b=d.range;if(_iframeWin.getSelection||9<=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks){if(c.getRangeAt&&c.rangeCount||9<=DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks){b.deleteContents(!0);try{if(""==_iframeDoc.body.innerHTML){var e=_iframeDoc.createElement("div");e.innerHTML=a;for(var f=e.childNodes,e="",g=!0,h=f.length,m=0;m<h;m++){var n=f[m];if(!n||1!=n.nodeType||"P"!=n.tagName&&
"TABLE"!=n.tagName&&"DIV"!=n.tagName&&"HR"!=n.tagName&&"OL"!=n.tagName&&"UL"!=n.tagName)if(3==n.nodeType){var p=n.nodeValue,p=p.replace(/&/g,"&amp;"),p=p.replace(/</g,"&lt;"),p=p.replace(/>/g,"&gt;"),p=p.replace(/\r\n/g,"<br />"),p=p.replace(/\r?\n/g,"<br />"),p=p.replace(/\n/g,"<br />");0==g?e+=p:(e=e+"<p>"+p,g=!1)}else 8!=n.nodeType?0==g?e+=n.outerHTML:(e=e+"<p>"+n.outerHTML,g=!1):"0"==DEXTTOP.G_CURREDITOR._config.removeComment&&(e+=n.text);else 0==g&&(e+="</p>",g=!0),e+=n.outerHTML,g=!0}0==g&&
(e+="</p>");0<e.length&&(a=e)}}catch(q){}d=_iframeDoc.createElement("div");d.innerHTML=a;if((a=getMyElementNode(b.startContainer))&&1==a.nodeType&&"BODY"==a.tagName){f=d.childNodes;e="";g=!0;h=f.length;for(m=0;m<h;m++)!(n=f[m])||1!=n.nodeType||"P"!=n.tagName&&"TABLE"!=n.tagName&&"DIV"!=n.tagName&&"HR"!=n.tagName&&"OL"!=n.tagName&&"UL"!=n.tagName?3==n.nodeType?(p=n.nodeValue,p=p.replace(/&/g,"&amp;"),p=p.replace(/</g,"&lt;"),p=p.replace(/>/g,"&gt;"),p=p.replace(/\r\n/g,"<br />"),p=p.replace(/\r?\n/g,
"<br />"),p=p.replace(/\n/g,"<br />"),0==g?e+=p:(e=e+"<p>"+p,g=!1)):8!=n.nodeType&&(0==g?e+=n.outerHTML:(e=e+"<p>"+n.outerHTML,g=!1)):(0==g&&(e+="</p>",g=!0),e+=n.outerHTML,g=!0);0==g&&(e+="</p>");0<e.length&&(a=e)}a=_iframeDoc.createDocumentFragment();for(var u;n=d.firstChild;)u=a.appendChild(n);b.insertNode(a);if(u)if(3==u.nodeType){b.selectNodeContents(u);b=b.cloneRange();try{b.setEnd(b.endContainer,b.endOffset),b.collapse(!1)}catch(t){b.setStartBefore(u),b.collapse(!0)}c.removeAllRanges();c.addRange(b)}else if(!u||
1!=u.nodeType||0!=u.outerHTML.indexOf("<table")&&0!=u.outerHTML.indexOf("<TABLE")){b.selectNodeContents(u);b=b.cloneRange();try{"IMG"==u.tagName||"HR"==u.tagName?(b.setStartAfter(u),b.collapse(!0)):(DEXTTOP.DEXT5.browser.gecko||8<DEXTTOP.DEXT5.browser.ieVersion?(b.setEnd(b.endContainer,b.endOffset),b.collapse(!1)):(b.setStartAfter(u),b.collapse(!0)),"OL"!=u.tagName&&"UL"!=u.tagName||setTimeout(function(){doSetCaretPosition(b.endContainer.lastChild.lastChild,1)},0))}catch(v){b.setStartBefore(u),b.collapse(!0)}c.removeAllRanges();
c.addRange(b)}else if(c=u.getElementsByTagName("td"))if(c=c[c.length-1].childNodes[0],0==c.length)doSetCaretPosition(cell,1);else{for(;0!=c.childNodes.length&&"BR"!=c.childNodes[0].tagName;)c=c.childNodes[0];doSetCaretPosition(c,0)}}}else(c=_iframeDoc.selection)&&"Control"!=c.type&&(u=c.createRange(),u.collapse(!0),c.createRange().pasteHTML(a),b=c.createRange(),b.setEndPoint("StartToStart",u));DEXTTOP.G_CURREDITOR.UndoManager.putUndo()}}
function getBlockContainer(a){for(;a;){if(1==a.nodeType&&/^(P|H[1-6]|DIV)$/i.test(a.nodeName))return a;a=a.parentNode}}
function extractBlockContentsFromCaret(a){var c=getFirstRange(),b=c.range;if(c.sel.rangeCount)if(a){if(a=getBlockContainer(b.startContainer))return c=b.cloneRange(),c.selectNodeContents(a),c.setEnd(b.startContainer,b.startOffset),c.extractContents()}else if(a=getBlockContainer(b.endContainer))return c=b.cloneRange(),c.selectNodeContents(a),c.setStart(b.endContainer,b.endOffset),c.extractContents()}
function insertNodeAtCaret(a){var c=DEXTTOP.G_CURREDITOR._DOC.createElement("span");c.id=a;c.innerHTML="&nbsp;";if(a=getFirstRange().range)a.collapse(!1),a.insertNode(c)}
function replacePasteHTML(){if(null!=startBookmark&&null!=endBookmark)try{var a=getFirstRange().range;a.setStart(startBookmark.startContainer,startBookmark.startOffset);a.setEnd(endBookmark.startContainer,endBookmark.startOffset);var c=a.toHtml();if(0<c.length){var c=SetCorrectOfficeHtml(c),b=DEXTTOP.DEXT5.util.officeClean(c,!1),b=DEXTTOP.DEXT5.util.htmlRevision(b),b=xssReplaceScript(null,b);a&&(a.deleteContents(),a.pasteHtml(b))}}catch(d){}}
function dext_src_init(a){_iframeWin=rangy.dom.getIframeWindow(a);_iframeDoc=rangy.dom.getIframeDocument(a)}
function setBodyDefaultValue(){try{if(!(0<getFirstRange().range.toString().length)){var a=_iframeDoc.body.childNodes.length,c=_iframeDoc.body.childNodes,b=null,d=null;if(0==a)b=_iframeDoc.createElement("p"),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?b.innerHTML="&nbsp;":(d=_iframeDoc.createElement("br"),b.appendChild(d)),_iframeDoc.body.appendChild(b),doSetCaretPosition(b,0);else if(3===c[0].nodeType){var e=c[0].nodeValue;null!=e&&void 0!=e&&(e=e.replace(/\r\n/g,""),e=e.replace(/\r/g,
""),e=e.replace(/\n/g,""),e=e.replace(/\t/g,""),e=e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,""),0<e.length&&(b=_iframeDoc.createElement("p"),b.innerHTML=e,_iframeDoc.body.appendChild(b),_iframeDoc.body.replaceChild(b,c[0]),doSetCaretPosition(b,0)))}else if(1==a&&1===c[0].nodeType)if(b=c[0],"p"==b.nodeName.toLowerCase())""!=b.innerHTML&&" "!=b.innerHTML&&"&nbsp;"!=b.innerHTML||DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion||(d=_iframeDoc.createElement("br"),b.appendChild(d)),doSetCaretPosition(b,
0);else{if("br"==b.nodeName.toLowerCase()){var f=_iframeDoc.createElement("p");_iframeDoc.body.appendChild(f);f.appendChild(b);doSetCaretPosition(f,0)}}else 2<=a&&setFocusToBody()}}catch(g){}}function setFocusToBody(){try{DEXTTOP.DEXT5.browser.ie?(_iframeWin.focus(),_iframeDoc.focus(),_iframeDoc.body.focus()):setTimeout(function(){_iframeWin.focus();_iframeDoc.body.focus()},0)}catch(a){}}
function _iframeDoc_ContextMenu(a){setDEXTWINDOC();var c=getEditrFromEvent(a);DEXTTOP.G_CURREDITOR=c;if(isViewMode())"1"==c._config.viewModeBrowserMenu&&DEXTTOP.DEXT5.util.cancelEvent(a);else{var b=a?a:_iframeWin.event;currElem=b.target?b.target:b.srcElement;if("1"!=c._config.formMode&&"1"==c._config.userTableLock.use){var d=GetTDTHCell(currElem),e;d&&(e=GetParentbyTagName(currElem,"table"));var f=c._config.userTableLock.defaultTableLockMode;e&&e.getAttribute("lock_mode")&&""!=e.getAttribute("lock_mode")&&
(f=e.getAttribute("lock_mode"));var g=!0;"1"==f&&(g=!1);if(d){if(checkLockAttr(e)){c.lastElemForLock?setFocusForLock(c.lastElemForLock):(c=findNoLockElem(e))?setFocusForLock(c):(window.focus(),document.body.focus());DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(d,!g)){c.lastElemForLock?setFocusForLock(c.lastElemForLock):setFocusForLock(findNoLockCell(e));DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}c.lastElemForLock=d}}if("1"==
c._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{DEXTTOP.DEXTWIN.dext_mouse_event("contextmenu",b,currElem)}catch(h){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(b);return}}c=GetParentbyTagName(currElem,"table");null==c?(ClearDraggingTableCellSelected(),ActiveCurrTable=null):(DEXTTOP.G_SELECTED_ELEMENT=currElem,ActiveCurrTable=c);IsMousePointOnBorder(a)||setContextMenu(a);DEXTTOP.DEXT5.util.cancelEvent(a)}}
function _iframeDoc_BlurHandler(a){a=getEditrFromEvent(a);a._LastRange||a._RangeBlurBug||(a._LastRange=saveSelection(a.ID))}function _iframeDoc_FocusHandler(a){if(a.target?a.target:a.srcElement)a=getEditrFromEvent(a),setCurrentEditor(a),a._LastRange&&restoreSelection(a._LastRange)}
function setCurrentEditor(a){var c=a._EDITOR.design;a._DOC=c.contentDocument?c.contentDocument:c.contentWindow.document;a._BODY=a._DOC.body;DEXTTOP.G_CURREDITOR=a;G_USE_EDITOR_ID=a.ID;LayerFrame=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+DEXTTOP.G_CURREDITOR.ID);dext_src_init(c)}
function InsertFontElement(a,c){var b=getFirstRange(),d=b.range;if(d){d.collapse(!1);var e=null,e=GetParentbyTagName(d.startContainer,"span");!e||e.innerHTML!=unescape("%u2060")&&e.innerHTML!=unescape("%uFEFF")&&""!=e.innerText&&"\n"!=e.innerHTML&&"<br>"!=e.innerHTML&&"<br />"!=e.innerHTML&&"<br>"!=e.innerHTML?(e=_iframeDoc.createElement("span"),0==DEXTTOP.DEXT5.browser.gecko&&(e.innerHTML=DEXTTOP.DEXT5.browser.ie?unescape("%u2060"):unescape("%uFEFF")),e.style[a]=c,d.insertNode(e)):(e.style[a]=c,
e.innerHTML=DEXTTOP.DEXT5.browser.ie?unescape("%u2060"):unescape("%uFEFF"));d.selectNodeContents(e);rangy.getSelection(_iframeWin).removeAllRanges();b.sel.addRange(d);doSetCaretPosition(e,1)}}function execCommand(a,c,b){c.document=_iframeDoc;rangy.execCommand(a,c,b)}
function getFirstRange(){retValue={};try{var a=rangy.getSelection(_iframeWin);retValue.sel=a;if(0==a.rangeCount){var c=rangy.createRange(_iframeDoc),a=rangy.getSelection(_iframeWin);a.setSingleRange(c);retValue.sel=a;retValue.range=c}else retValue.range=a.getRangeAt(0)}catch(b){try{c=rangy.createRange(_iframeDoc),a=rangy.getSelection(_iframeWin),a.setSingleRange(c),retValue.sel=a,retValue.range=c}catch(d){}}return retValue}
function setRestoreCaretPos(a){var c=getFirstRange().range;c&&(0==a&&c.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(c))}
function DoExecuteCommand(a,c,b,d){try{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var e="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode,f=DEXTTOP.DEXT5.browser.quirks;if(0==c.toString().length){var g=GetTableSelectionCells();if(0==g.length)_iframeDoc.execCommand(b,!1,null),setMenuIconRealable(getMyElementNode(c.startContainer));
else{for(var h=0;h<g.length;h++)a.removeAllRanges(),c.selectNode(g[h]),a.addRange(c),""==DEXTTOP.DEXT5.util.replaceAll(g[h].innerHTML," ","")||g[h].innerHTML==getCellDefValue()||"<p><br></p>"==g[h].innerHTML.toLowerCase()||"<p><br/></p>"==g[h].innerHTML.toLowerCase()||"<p><br /></p>"==g[h].innerHTML.toLowerCase()?DEXTTOP.G_CURREDITOR._formatPainterList&&"1"==DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying&&(DEXTTOP.DEXT5.browser.ie&&(g[h].innerHTML="<p>&nbsp;</p>"),"underline"==b||"strikeThrough"==
b?_iframeDoc.execCommand(b,!1,null):(d.ignoreWhiteSpace=!0,rangy.queryCommandValue(b,d),execCommand(b,d,c))):(DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||1==e||1==f)&&("<p></p>"==g[h].innerHTML.toLowerCase()?g[h].innerHTML="<p>&nbsp;</p>":"<span></span>"==g[h].innerHTML.toLowerCase()&&(g[h].innerHTML="<span>&nbsp;</span>")),"underline"==b||"strikeThrough"==b?_iframeDoc.execCommand(b,!1,null):(d.ignoreWhiteSpace=!0,rangy.queryCommandValue(b,d),execCommand(b,d,c)));a.removeAllRanges();
doSetCaretPosition(DrageEndCell.lastChild,1);DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||1==e||1==f)&&(DEXTTOP.G_CURREDITOR._LastRange=null);var m=getFirstRange().range,n=getMyChildElementNode(m.startContainer);n&&m.selectNode(n);_iframeDoc_MouseUpMenu(null,DrageEndCell)}}else"underline"==b||"strikeThrough"==b?_iframeDoc.execCommand(b,!1,null):(d.ignoreWhiteSpace=!0,rangy.queryCommandValue(b,d),execCommand(b,d,c),a.addRange(c)),setMenuIconRealable(getMyElementNode(c.startContainer));
if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(p){}}function getCommandIconState(a){"strikeThrough"==a&&(a="strike_through");return-1<document.getElementById("dext_span_"+DEXTTOP.G_CURREDITOR.ID+a).className.indexOf("uebutton_span_enter")?!0:!1}
function DoExecuteCommandFormatting(a,c,b){try{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d=a.range;if(0==d.toString().length){var e=GetTableSelectionCells();if(0==e.length)if(b)DEXTTOP.DEXT5.browser.ie&&(c="<"+c+">"),_iframeDoc.execCommand("formatBlock",!1,c);else if(DEXTTOP.DEXT5.browser.ie){var f=GetParentbyTagName(d.startContainer,
"h1");null==f&&(f=GetParentbyTagName(d.startContainer,"h2"));null==f&&(f=GetParentbyTagName(d.startContainer,"h3"));null==f&&(f=GetParentbyTagName(d.startContainer,"h4"));null==f&&(f=GetParentbyTagName(d.startContainer,"h5"));null==f&&(f=GetParentbyTagName(d.startContainer,"h6"));if(f){var g=f,h=_iframeDoc.createElement(c);h.innerHTML=g.innerHTML;_iframeDoc.body.appendChild(h);g.parentNode.replaceChild(h,g);doSetCaretPosition(h,0)}}else _iframeDoc.execCommand("formatBlock",!1,c);else{var m=e.length,
n=0;for(a=0;a<m;a++){for(var p=getFormattingNode(e[a],c,b,!0),q=0;q<p;q++)g=p[q],h=_iframeDoc.createElement(c),h.innerHTML=1==g.nodeType?g.innerHTML:g.nodeValue,_iframeDoc.body.appendChild(h),g.parentNode.replaceChild(h,g);0==p.length&&b&&(h=_iframeDoc.createElement(c),h.innerHTML=""==e[a].innerHTML?DEXTTOP.DEXT5.browser.ie?"&nbsp;":"<br />":e[a].innerHTML,e[a].innerHTML="",e[a].appendChild(h))}}}else for(p=getFormattingNode(d,c,b),n=p.length,q=0;q<n;q++)if(g=p[q],h=_iframeDoc.createElement(c),!b||
"td"!=g.tagName.toLowerCase()&&"th"!=g.tagName.toLowerCase()||!DEXTTOP.DEXT5.browser.ie||""!=g.innerHTML&&"&nbsp;"!=g.innerHTML&&g.innerHTML!=g.innerText){if(DEXTTOP.DEXT5.browser.ie&&b&&1==g.nodeType){var u=g.tagName.toLowerCase();if("h1"!=u&&"h2"!=u&&"h3"!=u&&"h4"!=u&&"h5"!=u&&"h6"!=u&&GetTDTHCell(g))continue}h.innerHTML=g.innerHTML;_iframeDoc.body.appendChild(h);g.parentNode.replaceChild(h,g)}else h.innerHTML=g.innerHTML,""==h.innerHTML&&(h.innerHTML="&nbsp;"),g.innerHTML="",g.appendChild(h);if(null==
DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(t){}}
function getFormattingNode(a,c,b,d){c=[];var e=null;if(d){if(e=a.childNodes,0==e.length)return e}else e=getNodesInRange(a);a=!1;for(var f=e.length,g=0;g<f;g++){var h=e[g];if(1==h.nodeType){var m=h.tagName.toLowerCase();"html"!=m&&"body"!=m&&(a=!0,b?("h1"==m||"h2"==m||"h3"==m||"h4"==m||"h5"==m||"h6"==m||"p"==m||"pre"==m||DEXTTOP.DEXT5.browser.ie&&1!=d&&("td"==m||"th"==m))&&c.push(h):"h1"!=m&&"h2"!=m&&"h3"!=m&&"h4"!=m&&"h5"!=m&&"h6"!=m||c.push(h))}else d&&3==h.nodeType&&b&&(a=!0,c.push(h))}if(0==a)for(e=
getAllNodesInBody(_iframeDoc.body,!0),f=e.length,g=0;g<f;g++)h=e[g],1==h.nodeType?(m=h.tagName.toLowerCase(),b?("h1"==m||"h2"==m||"h3"==m||"h4"==m||"h5"==m||"h6"==m||"p"==m||"pre"==m||DEXTTOP.DEXT5.browser.ie&&1!=d&&("td"==m||"th"==m))&&c.push(h):"h1"!=m&&"h2"!=m&&"h3"!=m&&"h4"!=m&&"h5"!=m&&"h6"!=m||c.push(h)):d&&3==h.nodeType&&b&&c.push(h);return c}
function DoExecuteCommand2(a,c,b,d){try{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if(0==c.toString().length||0!=c.endOffset){var e=GetTableSelectionCells();-1<b.indexOf("justify")&&7==DEXTTOP.DEXT5.browser.ieVersion&&null!=ActiveCurrTable&&0==d&&(d=!1,"0"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjust&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust=
"1",d=!0),setAdjustTableWidthHeight(ActiveCurrTable),d&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="0"));if(0==e.length)"justifyLeft"!=b||DEXTTOP.DEXT5.browser.ie||_iframeDoc.execCommand("justifyFull",!1,null),-1<b.indexOf("justify")?c.commonAncestorContainer&&"BODY"!=c.commonAncestorContainer.tagName&&_iframeDoc.execCommand(b,!1,null):_iframeDoc.execCommand(b,!1,null),-1<b.indexOf("justify")&&executeTextAlign(c,b),setMenuIconRealable(getMyElementNode(c.startContainer));else{var f=e.length;d=[];
for(var g=0;g<f;g++){var h=e[g].innerHTML,h=ReplaceAll(h,unescape("\r\n"),""),h=ReplaceAll(h,unescape("\r"),""),h=ReplaceAll(h,unescape("\n"),""),h=ReplaceAll(h,unescape("%20%20"),"");e[g].innerHTML=h;a.removeAllRanges();c.selectNodeContents(e[g]);a.addRange(c);"removeFormat"==b&&d.push(e[g].bgColor);_iframeDoc.execCommand(b,!1,null);if(-1<b.indexOf("justify")){for(var m=e[g].getElementsByTagName("p"),n=m.length,p=e[g].getElementsByTagName("div"),q=p.length,u="",u="justifyFull"==b?"justify":b.substring(7),
t=null,v=0;v<n;v++)t=m[v],t.style.textAlign!=u&&(t.style.textAlign=u);for(v=0;v<q;v++)t=p[v],t.style.textAlign!=u&&(t.style.textAlign=u)}}a.removeAllRanges();if("removeFormat"==b)for(f=e.length,a=0;a<f;a++){var w=e[a];w.bgColor=d[a];w.style.backgroundColor=ColorCellBackColor}doSetCaretPosition(DrageEndCell.childNodes[0],1);var x=getFirstRange().range,y=getMyChildElementNode(x.startContainer);x.selectNode(y);setMenuIconRealable(y);_iframeDoc_MouseUpMenu(null,DrageEndCell)}}else _iframeDoc.execCommand(b,
!1,null),-1<b.indexOf("justify")&&executeTextAlign(c,b);if(DEXTTOP.DEXT5.browser.chrome||DEXTTOP.DEXT5.browser.opera||DEXTTOP.DEXT5.browser.safari)if(x=getFirstRange().range,e=null,x&&x.startContainer&&(e=getMyElementNode(x.startContainer)),e){var z=GetParentbyTagName(e,"td");if(z){for(var C=z.getElementsByTagName("li"),g=C.length-1;0<=g;g--)if("OL"!=C[g].parentNode.tagName&&"UL"!=C[g].parentNode.tagName){h=_iframeDoc.createElement("div");h.innerHTML=C[g].innerHTML;var D=h.firstChild;C[g].parentNode.replaceChild(D,
C[g]);doSetCaretPosition(D,1)}if("<p></p>"==z.innerHTML||""==z.innerHTML)z.innerHTML=getCellDefValue()}}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(E){}}
function DoExecuteCommand3(a,c,b,d,e){try{(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if(0==c.toString().length){var f=GetTableSelectionCells();if(0==f.length)"fontcolor"==b&&(b="color"),"fontbgcolor"==b&&(b="backgroundColor"),"lineheight"==b&&(b="lineHeight"),InsertFontElement(b,e);else{var g=f.length;e=[];
var h="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode,m=DEXTTOP.DEXT5.browser.quirks;if(DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||1==h||1==m))for(var n=0;n<g;n++){var p=f[n];"<p></p>"==p.innerHTML.toLowerCase()?p.innerHTML="<p>&nbsp;</p>":"<span></span>"==p.innerHTML.toLowerCase()?p.innerHTML="<span>&nbsp;</span>":""==p.innerHTML.toLowerCase()&&(p.innerHTML="&nbsp;")}for(n=0;n<g;n++)a.removeAllRanges(),c.selectNode(f[n]),a.addRange(c),rangy.queryCommandValue(b,d),"fontbgcolor"==
b&&e.push(f[n].bgColor),execCommand(b,d),rangy.getSelection(_iframeWin).removeAllRanges();a.removeAllRanges();if("fontbgcolor"==b)for(g=f.length,a=0;a<g;a++){var q=f[a];q.bgColor=e[a];q.style.backgroundColor=ColorCellBackColor}doSetCaretPosition(DrageEndCell.childNodes[0],1);!DEXTTOP.DEXT5.browser.ie||8!=DEXTTOP.DEXT5.browser.ieVersion&&1!=h&&1!=m||(DEXTTOP.G_CURREDITOR._LastRange=null)}}else{d.ignoreWhiteSpace=!0;rangy.queryCommandValue(b,d);f=null;g="";try{if("fontbgcolor"==b){var u=c.commonAncestorContainer.parentNode;
u&&1==u.nodeType&&(f=GetTDTHCell(u));f&&(g=f.style.backgroundColor)}}catch(t){f=null}if(!c.commonAncestorContainer.tagName||"BODY"!=c.commonAncestorContainer.tagName&&"DIV"!=c.commonAncestorContainer.tagName)execCommand(b,d,c);else try{var v=c.getNodes(),w=v.length;if(500<w){h=[];for(n=0;n<w;n++)if(3==v[n].nodeType){var x=v[n].parentNode;1==x.nodeType&&"BODY"!=x.tagName&&h.push(x)}for(n=0;n<h.length;n++)"fontcolor"==b?h[n].style.color=e:"fontbgcolor"==b?h[n].style.backgroundColor=e:"lineheight"==
b?h[n].style.lineHeight=e:"fontSize"==b?h[n].style.fontSize=e:"fontFamily"==b&&(h[n].style.fontFamily=e)}else execCommand(b,d,c)}catch(y){execCommand(b,d,c)}f&&(f.style.backgroundColor=g);DEXTTOP.DEXT5.browser.ie&&(9>DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)||a.removeAllRanges();a.addRange(c)}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(z){}}function getSelectionTable(a){if(DEXTTOP.DEXT5.browser.ie&&!(11<DEXTTOP.DEXT5.browser.ieVersion)){a=getFirstRange().range;var c,b,d=a.collapsed,e;try{if(!d){c=_iframeDoc.createElement("span");c.style.display="none";c.innerHTML="&nbsp;";b=a.cloneRange();b.collapse();b.insertNode(c);var f;c&&(f=c.previousSibling);f&&1==f.nodeType&&"table"==f.tagName.toLowerCase()&&(e=f)}}catch(g){}c&&c.parentNode.removeChild(c);return e}}
function setBlockTag(a,c,b,d){for(var e="p li dt dd h1 h2 h3 h4 h5 h6 pre table hr blockquote address iframe".split(" "),f=["body","td","th","div"],g="b big i small tt abbr acronym cite code dfn em kbd strong samp var a bdo br img map object q script span sub sup button input label select textarea".split(" "),h=a.length,m=0;m<h;m++)if(a[m]){var n=a[m].tagName;n&&(n=n.toLowerCase());if(3!=a[m].nodeType||/\S/.test(a[m].nodeValue))if(3==a[m].nodeType||-1<g.indexOf(n)){for(var p=a[m];;){if(-1<e.indexOf(p.parentNode.tagName.toLowerCase())){-1<
c.indexOf(p.parentNode.tagName.toLowerCase())&&("lineHeight"==b?"span"==p.parentNode.tagName.toLowerCase()?""!=p.parentNode.style.lineHeight&&(p.parentNode.style.lineHeight=d):p.parentNode.style.lineHeight=d:"align"==b&&(""!=p.parentNode.style.layoutGridMode&&(p.parentNode.style.layoutGridMode="none"),p.parentNode.style.textAlign=d));p=null;break}else if(-1<f.indexOf(p.parentNode.tagName.toLowerCase()))break;p=p.parentNode}if(p){for(var n=[p],q=p.previousSibling;;){try{if(null==q||-1<e.indexOf(q.tagName.toLowerCase())||
"div"==q.tagName.toLowerCase())break}catch(u){}n.unshift(q);q=q.previousSibling}for(p=p.nextSibling;;){try{if(null==p||-1<e.indexOf(p.tagName.toLowerCase())||"div"==p.tagName.toLowerCase())break}catch(t){}n.push(p);p=p.nextSibling}p=_iframeDoc.createElement("p");"lineHeight"==b?p.style.lineHeight=d:"align"==b&&(p.style.textAlign=d);n[0].parentNode.insertBefore(p,n[0]);for(var q=n.length,v=0;v<q;v++)p.appendChild(n[v])}}}}
function GetParentbyTagName(a,c,b){null==a&&1==b&&(b=getFirstRange().range)&&b.startContainer&&(a=getMyElementNode(b.startContainer),a=GetTDTHCell(a),DEXTTOP.G_SELECTED_ELEMENT=a);for(;null!=a&&(!a.tagName||a.tagName.toLowerCase()!=c);)a=a.parentNode;return a}
function _iframeDoc_DBClick(a){setDEXTWINDOC();if(!isViewMode()){var c=a?a:event;a=c.target?c.target:c.srcElement;if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){var b=GetTDTHCell(a),d;b&&(d=GetParentbyTagName(a,"table"));var e=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;d&&d.getAttribute("lock_mode")&&""!=d.getAttribute("lock_mode")&&(e=d.getAttribute("lock_mode"));var f=!0;"1"==e&&(f=!1);if(b){if(f&&checkLockAttr(d)){DEXTTOP.G_CURREDITOR.lastElemForLock?
setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):(a=findNoLockElem(d))?setFocusForLock(a):(window.focus(),document.body.focus());DEXTTOP.DEXT5.util.stopEvent(c);DEXTTOP.DEXT5.util.cancelEvent(c);return}if(checkLockAttr(b,!f)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):setFocusForLock(findNoLockCell(d));DEXTTOP.DEXT5.util.stopEvent(c);DEXTTOP.DEXT5.util.cancelEvent(c);return}}}if("1"==DEXTTOP.G_CURREDITOR._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=
!1;try{DEXTTOP.DEXTWIN.dext_mouse_event("dblclick",c,a)}catch(g){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(c);return}}switch(a.tagName.toLowerCase()){case "img":DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.resizeHandleClear();DEXTTOP.G_SELECTED_ELEMENT=a;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){c=!0;try{c=DEXTTOP.DEXTWIN.dext_editor_img_event(a,DEXTTOP.G_CURREDITOR.ID)}catch(h){}null!=c&&void 0!=c&&0==c&&(c=!1);if(!c)break}setSelectoinElement(a);
c=a.getAttribute("dext5customdata");if(null!=c&&void 0!=c)if(d=getDextCustomData(c),"iframe"==d.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.iframe);else if("flash"==d.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.flash);else if("media"==d.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.media);
else if("link_media"==d.type)DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.insert_link_media);else{if("hidden"==d.type&&"1"==DEXTTOP.G_CURREDITOR._config.formMode){c=!0;a={};a.type=d.type;a.id=d.id;a.name=d.name;a.value=d.value;a.className=d.className;a.title=d.title;try{c=DEXTTOP.DEXTWIN.dext_editor_input_event(a,DEXTTOP.G_CURREDITOR.ID)}catch(m){}null!=c&&void 0!=c&&0==c&&(c=!1);if(!c)break;DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.input_hidden)}}else""==DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick||a.className!=DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick&&a.alt!=DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick?G_dext5plugIn&&-1!=a.src.search("file:///")?showSetImageProperty(a):DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.image):command_custom(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,
DEXTTOP.G_CURREDITOR._config.customEventCmd.image.ondbclick,a);break;case "flash":DEXTTOP.G_SELECTED_ELEMENT=a;setSelectoinElement(a);DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.flash);break;case "media":DEXTTOP.G_SELECTED_ELEMENT=a;setSelectoinElement(a);DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.media);break;case "hr":DEXTTOP.G_SELECTED_ELEMENT=a;setSelectoinElement(a);
DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.horizontal_line);break;case "a":DEXTTOP.G_SELECTED_ELEMENT=a;setSelectoinElement(a);c=a.getAttribute("DEXT5InsertFile");""==a.href&&a.name==a.id?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.bookmark):""==c?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.insert_file):
DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.hyperlink);break;case "iframe":DEXTTOP.G_SELECTED_ELEMENT=a;setSelectoinElement(a);DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.iframe);break;case "table":DEXTTOP.G_SELECTED_ELEMENT=a;if("1"==DEXTTOP.G_CURREDITOR._config.formMode||"1"!=DEXTTOP.G_CURREDITOR._config.userTableLock.use)(a=getFirstRange().sel)&&a.docSelection&&
"Control"==a.docSelection.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,DEXTTOP.G_SELECTED_ELEMENT):(a._ranges.length=a.rangeCount=a.nativeSelection.rangeCount,a.rangeCount&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,DEXTTOP.G_SELECTED_ELEMENT));break;case "input":DEXTTOP.G_SELECTED_ELEMENT=a;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){c=
!0;try{c=DEXTTOP.DEXTWIN.dext_editor_input_event(a,DEXTTOP.G_CURREDITOR.ID)}catch(n){}null!=c&&void 0!=c&&0==c&&(c=!1);if(!c)break}"1"==DEXTTOP.G_CURREDITOR._config.formMode&&(""==a.type||"text"==a.type||"password"==a.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_text):"radio"==a.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_radio):"checkbox"==a.type?
DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_checkbox):"button"==a.type||"reset"==a.type||"submit"==a.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_button):"hidden"==a.type?DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_hidden):"image"==a.type&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,
DEXTTOP.G_CURREDITOR._config.pages.input_image));break;case "select":DEXTTOP.G_SELECTED_ELEMENT=a;if("1"==DEXTTOP.G_CURREDITOR._config.formMode){c=!0;try{c=DEXTTOP.DEXTWIN.dext_editor_select_event(a,DEXTTOP.G_CURREDITOR.ID)}catch(p){}null!=c&&void 0!=c&&0==c&&(c=!1);if(!c)break}"1"==DEXTTOP.G_CURREDITOR._config.formMode&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_select);break;case "textarea":DEXTTOP.G_SELECTED_ELEMENT=a;if("1"==
DEXTTOP.G_CURREDITOR._config.formMode){c=!0;try{c=DEXTTOP.DEXTWIN.dext_editor_textarea_event(a,DEXTTOP.G_CURREDITOR.ID)}catch(q){}null!=c&&void 0!=c&&0==c&&(c=!1);if(!c)break}"1"==DEXTTOP.G_CURREDITOR._config.formMode&&DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.input_textarea)}}}
function setSelectoinElement(a){var c=getFirstRange().range;if(c)if(""==c.toString()){var b=getFirstRange().sel;b.removeAllRanges();c.selectNode(a);b.addRange(c)}else rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(c)}
function _iframeBody_Click(a){setDEXTWINDOC();if(!isViewMode()){var c=DEXTTOP.G_CURREDITOR.ID,b=getEditrFromEvent(a);c!=b.ID&&(DEXTTOP.G_CURREDITOR=b);if(!checkDefaultMessage(a)){var d,e;try{e=a?a:event,e.srcElement?d=e.srcElement:e.target&&(d=e.target)}catch(f){setFocusToBody();return}if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){var c=GetTDTHCell(d),g;c&&(g=GetParentbyTagName(d,"table"));var h=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;
g&&g.getAttribute("lock_mode")&&""!=g.getAttribute("lock_mode")&&(h=g.getAttribute("lock_mode"));var m=!0;"1"==h&&(m=!1);if(c){if(m&&checkLockAttr(g)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):(a=findNoLockElem(g))?setFocusForLock(a):(window.focus(),document.body.focus());DEXTTOP.DEXT5.util.stopEvent(e);DEXTTOP.DEXT5.util.cancelEvent(e);return}if(checkLockAttr(c,!m)){DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):
setFocusForLock(findNoLockCell(g));DEXTTOP.DEXT5.util.stopEvent(e);DEXTTOP.DEXT5.util.cancelEvent(e);return}b.lastElemForLock=c}}if("1"==b._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{DEXTTOP.DEXTWIN.dext_mouse_event("click",e,d)}catch(n){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(e);return}}if((e=d.tagName?d.tagName.toLowerCase():null)&&("textarea"==e||"input"==e||"select"==e))return!1;setFocusToBody();if(DEXTTOP.DEXT5.browser.ie&&
7==DEXTTOP.DEXT5.browser.ieVersion)try{var p=getFirstRange().range;p&&p.startContainer&&(d=getMyElementNode(p.startContainer));if(void 0==d)return}catch(q){return}e=d.tagName.toLowerCase();try{"html"==e||"body"==e?(e=!1,500>a.clientX&&10>a.clientY&&(e=!0),repairBodyFirstLastTag(e),DEXTTOP.DEXT5.browser.ie&&0==DEXTTOP.DEXT5.browser.quirks&&(p=getFirstRange().range)&&0==p.toString().length&&_iframeDoc.body.createTextRange&&(p=_iframeDoc.body.createTextRange(),p.moveToPoint(a.clientX,a.clientY),p.select()),
setFocusToBody(),(p=getFirstRange().range)&&p.startContainer==p.endContainer&&1==p.collapsed&&(d=getMyElementNode(p.startContainer)),setMenuIconRealable(d)):setTimeout(function(){var a=getFirstRange().range;a&&a.startContainer==a.endContainer&&1==a.collapsed&&(d=getMyElementNode(a.startContainer));setMenuIconRealable(d)},0)}catch(u){}}}}
function createCollapsedRangeFromPoint(a,c){var b=_iframeDoc,d,e=null;if("undefined"!=typeof b.body.createTextRange)e=b.body.createTextRange(),e.moveToPoint(a,c);else if("undefined"!=typeof b.caretPositionFromPoint)d=b.caretPositionFromPoint(a,c),e=b.createRange(),e.setStart(d.offsetNode,d.offset),e.collapse(!0);else if("undefined"!=typeof b.caretRangeFromPoint)b.caretRangeFromPoint(a,c);else return e}
function insertPtagTableNear(a,c){var b=getFirstRange().range;if(b&&c){b.selectNode(c);a?(b.setStartBefore(c),b.collapse(!0)):(b.setEndAfter(c),b.collapse(!1));var d=_iframeDoc.createElement("p");DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion||(d.innerHTML=getDefaultParagraphValue(!1));b.insertNode(d);doSetCaretPosition(d,0)}}
function moveCaret(a){var c;if(_iframeWin.getSelection){if(c=_iframeWin.getSelection(),0<c.rangeCount){var b=c.focusNode;c.collapse(b,Math.min(b.length,c.focusOffset+a))}}else(c=_iframeDoc.selection)&&"Control"!=c.type&&(c=c.createRange(),c.move("character",a),c.select())}
function setMenuIconRealable(a){if(null!=a&&void 0!=a){if("body"==a.tagName.toLowerCase()){var c=getSelectionTable(DEXTTOP.G_CURREDITOR);c&&(a=c)}var b=getElementInParentTag(a,G_FORMATTING),d=getElementInParentStyleProperty(a,"lineHeight"),e=getElementInParentStyleProperty(a,"fontSize"),f=getElementInParentStyleProperty(a,"fontFamily"),c=getElementInParentStyleProperty(a,"letterSpacing");""==c&&(c=dext5_lang.icon.letter_spacing);if("0"==DEXTTOP.G_CURREDITOR._setting.show_font_real)if(e==DEXTTOP.G_CURREDITOR._setting.font_size&&
(e=dext5_lang.icon.font_size),f==DEXTTOP.G_CURREDITOR._setting.font_family&&(f=dext5_lang.icon.font_family),""==e&&(e=dext5_lang.icon.font_size),""==f&&(f=dext5_lang.icon.font_family),""==d)d=dext5_lang.icon.line_height;else{if(-1<d.indexOf(".")||0>d.indexOf("%"))d=dext5_lang.icon.line_height}else{var g,h,m;if(""==e||""==f||""==d)m=getFontStyle(a),g=m.fontFamily,h=m.fontSize,m=m.lineHeight;""==e&&(e=""!=h&&void 0!=h?h:dext5_lang.icon.font_size);""==f&&(f=""!=g?g:dext5_lang.icon.font_family);if(""==
d)d=m&&""!=m&&"normal"!=m?m:dext5_lang.icon.line_height;else if(-1<d.indexOf(".")||0>d.indexOf("%"))d=dext5_lang.icon.line_height;DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&0>d.indexOf("%")&&0>d.indexOf("px")&&0>d.indexOf("pt")&&0>d.indexOf("em")&&(g=DEXTTOP.G_CURREDITOR._setting.line_height,h=parseInt(g,10)/100+.01,d==h&&(d=g))}""==b&&(b=dext5_lang.icon.formatting);if(g=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"formatting"))g.innerHTML="<span>"+b+"</span>";if(b=document.getElementById("ue_"+
DEXTTOP.G_CURREDITOR.ID+"line_height"))b.innerHTML="<span>"+d+"</span>";if(d=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"font_size")){try{if(-1<e.indexOf(".")){b="";-1<e.indexOf("px")||-1<e.indexOf("pt")||-1<e.indexOf("em")?b=e.substring(e.length-2):-1<e.indexOf("%")&&(b=e.substring(e.length-1));var n=parseFloat(e),n=Math.round(n),e=n+b}}catch(p){}d.innerHTML="<span>"+e+"</span>"}if(n=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"font_family"))n.innerHTML="<span>"+f+"</span>";
if(f=document.getElementById("ue_"+DEXTTOP.G_CURREDITOR.ID+"letter_spacing"))f.innerHTML="<span>"+c+"</span>";c=[];""!=getElementInParentTag(a,["b","strong"])&&c.push("bold");""!=getElementInParentTag(a,["em","i"])&&c.push("italic");""!=getElementInParentTag(a,["u"])&&c.push("underline");""!=getElementInParentTag(a,["strike"])&&c.push("strike_through");""!=getElementInParentTag(a,["sup"])&&c.push("superscript");""!=getElementInParentTag(a,["sub"])&&c.push("subscript");""!=getElementInParentTag(a,
["ol"])&&c.push("list_number");""!=getElementInParentTag(a,["ul"])&&c.push("list_bullets");if("table"==a.tagName.toLowerCase()){if(f=a.getAttribute("align"),null==f||""==f)f="justify"}else f=getStyle(a,"textAlign"),""==f&&(f=getElementInParentProperty(a,"align"));"left"==f&&c.push("align_left");"center"==f&&c.push("align_center");"right"==f&&c.push("align_right");"justify"==f&&c.push("align_full");f=getElementInParentProperty(a,"dir").toLowerCase();"rtl"==f&&c.push("dirrtl");"ltr"==f&&c.push("dirltr");
try{null==DrageEndCell&&(_iframeDoc.queryCommandState("bold")?c.push("bold"):removeArrayItemByValue(c,"bold"))}catch(q){removeArrayItemByValue(c,"bold")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("italic")?c.push("italic"):removeArrayItemByValue(c,"italic"))}catch(u){removeArrayItemByValue(c,"italic")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("underline")?c.push("underline"):removeArrayItemByValue(c,"underline"))}catch(t){removeArrayItemByValue(c,"underline")}try{null==DrageEndCell&&
(_iframeDoc.queryCommandState("strikeThrough")?c.push("strike_through"):removeArrayItemByValue(c,"strike_through"))}catch(v){removeArrayItemByValue(c,"strike_through")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("superscript")?c.push("superscript"):removeArrayItemByValue(c,"superscript"))}catch(w){removeArrayItemByValue(c,"superscript")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("subscript")?c.push("subscript"):removeArrayItemByValue(c,"subscript"))}catch(x){removeArrayItemByValue(c,
"subscript")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("insertOrderedList")?c.push("list_number"):removeArrayItemByValue(c,"list_number"))}catch(y){removeArrayItemByValue(c,"list_number")}try{null==DrageEndCell&&(_iframeDoc.queryCommandState("insertUnOrderedList")?c.push("list_bullets"):removeArrayItemByValue(c,"list_bullets"))}catch(z){removeArrayItemByValue(c,"list_bullets")}"full_size"==DEXTTOP.G_CURREDITOR.FrameStatus?c.push("full_screen"):removeArrayItemByValue(c,"full_screen");"show_blocks"==
DEXTTOP.G_CURREDITOR.ShowBlocks?c.push("show_blocks"):removeArrayItemByValue(c,"show_blocks");f=GetTDTHCell(a);checkLockAttr(f,!0)?c.push("cell_lock"):removeArrayItemByValue(c,"cell_lock");a=GetParentbyTagName(a,"table");checkLockAttr(a,!0)?c.push("table_lock"):removeArrayItemByValue(c,"table_lock");DEXTTOP.G_CURREDITOR._iconSelected(c)}}Array.prototype.indexOf||(Array.prototype.indexOf=function(a,c){c=c||0;for(var b=this.length;c<b;){if(this[c]===a)return c;++c}return-1});
function removeArrayItemByValue(a){for(var c,b=arguments,d=b.length,e;1<d&&a.length;)for(c=b[--d];-1!==(e=a.indexOf(c));)a.splice(e,1)}function dialogCancel(){var a=getEditrFromEvent(null);(a._LastRange||void 0!=a._LastRange)&&restoreSelection(a._LastRange);setFocusToBody()}
function RepaireTagInTag(a,c){for(var b=_iframeDoc.body.getElementsByTagName(c),d=b.length,e=null,f=0;f<d;f++){var e=b[f],g=GetParentbyTagName(e,a);g&&(g.removeChild(e),e=getFirstRange().range)&&(e.selectNode(g),e.setStartBefore(g),e.collapse(!0),g=_iframeDoc.createElement("hr"),e.insertNode(g),e.selectNode(g),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges())}}function doSetCaretPosition(a,c){try{var b=!0;0<c&&(b=!1);moveCursorToTag(a,b);setFocusToBody()}catch(d){}}
function setFocusTopWindow(){try{DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXTWIN.focus(),DEXTTOP.DEXTDOC.body.focus()}catch(a){}}function setDextCustomData(a,c){c.keyid=getNextNumber();a.setAttribute("dext5customdata",c.keyid);DEXTTOP.G_CURREDITOR._dextCustomData.push(c);return c.keyid}function getDextCustomData(a){for(var c=DEXTTOP.G_CURREDITOR._dextCustomData.length,b=0;b<c;b++)if(DEXTTOP.G_CURREDITOR._dextCustomData[b].keyid==a)return DEXTTOP.G_CURREDITOR._dextCustomData[b];return null}
function removeDextCustomData(a){for(var c=DEXTTOP.G_CURREDITOR._dextCustomData.length,b=0;b<c;b++)DEXTTOP.G_CURREDITOR._dextCustomData[b].keyid===a&&DEXTTOP.G_CURREDITOR._dextCustomData.splice(b,1)}function removeAllDextCustomData(){DEXTTOP.G_CURREDITOR._dextCustomData=[]}var getNextNumber=function(){var a=0;return function(){return++a+""}}();
function isSameCustomData(a){for(var c=DEXTTOP.G_CURREDITOR._dextCustomData.length,b=0;b<c;b++)if(DEXTTOP.G_CURREDITOR._dextCustomData[b].keyid===a)return DEXTTOP.G_CURREDITOR._dextCustomData[b];return null}
function ReplaceImageToRealObject(a){xssReplaceScript(_iframeDoc);if(1!=DEXTTOP.G_CURREDITOR._dextCustomDataMode){DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0;ClearDraggingTableAllTable();a=_iframeDoc.getElementsByTagName("img");for(var c=a.length-1;0<=c;c--){var b=a[c],d=b.getAttribute("dext5customdata");if(null!=d&&void 0!=d)if(d=getDextCustomData(d),"iframe"==d.type||"iframe"==d.type2){var e=_iframeDoc.createElement("iframe");e.width=0==parseIntOr0(b.style.width)?b.width+"":b.style.width+"";e.height=
0==parseIntOr0(b.style.height)?parseIntOr0(b.height)+"":parseIntOr0(b.style.height)+"";if(-1<d.src.indexOf("dext5player/media_player")){var f=d.src.lastIndexOf("&"),f=d.src.substring(0,f),f=f+("&size="+parseIntOr0(e.width)+"^"+parseIntOr0(e.height));e.src=f}else e.src=d.src;e.id=d.id;e.name=d.name;e.title=d.title;e.className=d.className;null!=b.align&&void 0!=b.align&&(d.align=b.align);e.align=d.align;e.scrolling=d.scrolling;e.frameBorder=d.frameBorder?1:0;d.caption&&""!=d.caption&&e.setAttribute("DEXT_fiVe_Media_Caption",
d.caption);if("undefined"!=typeof d.attributes)for(var f="src id name title width height align scrolling frameBorder class".split(" "),g=d.attributes.length,h=0;h<g;h++){var m=d.attributes[h];m.specified&&0>f.indexOf(m.name.toLowerCase())&&("style"==m.name.toLowerCase()?e.style.cssText=m.value:e.setAttribute(m.name,m.value))}b.parentNode.replaceChild(e,b)}else"flash"==d.type||"flash"==d.type2?(e=_iframeDoc.createElement("div"),f="",f+="<embed src='"+d.src+"'",""!=d.hspace&&(f+=" hspace='"+d.hspace+
"px'"),""!=d.vspace&&(f+=" vspace='"+d.vspace+"px'"),""!=d.scale&&(f+=" scale='"+d.scale+"'"),""!=d.allowScriptAccess&&(f+=" allowScriptAccess='"+d.allowScriptAccess+"'"),""!=d.quality&&(f+=" quality='"+d.quality+"'"),""!=d.align&&(f+=" align='"+d.align+"'"),f=0==d.menu?f+" menu='false'":f+" menu='true'",f=0==d.play?f+" play='false'":f+" play='true'",f=0==d.loop?f+" loop='false'":f+" loop='true'",f=0==d.allowFullScreen?f+" allowFullScreen='false'":f+" allowFullScreen='true'",d.flashvars&&""!=d.flashvars&&
(f+=" flashvars='"+d.flashvars+"'"),d.caption&&""!=d.caption&&(f+=" DEXT_fiVe_Media_Caption='"+d.caption+"'"),0>d.src.indexOf("dext5player/")&&(f+=' wmode="transparent"'),f+=" pluginspage='http://www.macromedia.com/go/getflashplayer' type='application/x-shockwave-flash' />",e.innerHTML=f,d=e.firstChild,d.style.marginLeft=b.style.marginLeft,d.style.marginRight=b.style.marginRight,d.style.marginTop=b.style.marginTop,d.style.marginBottom=b.style.marginBottom,d.style.width=0==parseIntOr0(b.style.width)?
b.width+"":b.style.width+"",d.style.height=0==parseIntOr0(b.style.height)?parseIntOr0(b.height)+"px":parseIntOr0(b.style.height)+"px",b.parentNode.replaceChild(d,b)):"media"==d.type?(e=_iframeDoc.createElement("div"),g="",g+="<embed style='width:"+d.width+"px; height:"+d.height+"px;' ",g+=" type='application/x-mplayer2'",g+=" pluginspage='http://www.microsoft.com/windows/windowsmedia/download/' ",g+=" src='"+d.src+"'",f=1==d.autoStart?"1":"0",g+=" AutoStart='"+f+"'",f=1==d.playCount?"-1":"1",g+=" PlayCount='"+
f+"'",f=1==d.showTracker?"1":"0",g+=" ShowTracker='"+f+"'",f=1==d.showStatusBar?"1":"0",g+=" ShowStatusBar='"+f+"'",f=1==d.showControls?"1":"0",g+=" ShowControls='"+f+"'",f=1==d.showAudioControls?"1":"0",g+=" ShowAudioControls='"+f+"'",f=1==d.showDisplay?"1":"0",g+=" ShowDisplay='"+f+"'",f=1==d.showPositionControls?"1":"0",g+=" ShowPositionControls='"+f+"'",g+=" />",e.innerHTML=g,d=e.firstChild,d.style.width=0==parseIntOr0(b.style.width)?b.width+"":b.style.width+"",d.style.height=0==parseIntOr0(b.style.height)?
parseIntOr0(b.height)+"px":parseIntOr0(b.style.height)+"px",b.parentNode.replaceChild(d,b),e.innerHTML=""):"hidden"==d.type&&(e=_iframeDoc.createElement("input"),e.type=d.type,e.id=d.id,e.name=d.name,e.value=d.value,e.className=d.className,e.title=d.title,b.parentNode.replaceChild(e,b))}}}
function ReplaceRealObjectToImage(a){xssReplaceScript(_iframeDoc);if(0!=DEXTTOP.G_CURREDITOR._dextCustomDataMode){DEXTTOP.G_CURREDITOR._dextCustomDataMode=!1;ClearDraggingTableCellSelected();0!=a&&removeAllDextCustomData();var c=_iframeDoc.getElementsByTagName("iframe");for(a=c.length-1;0<=a;a--){var b=c[a],d={},e=getLinkMediaType(b.src);d.type=""==e?"iframe":e;d.type2="iframe";d.src=b.getAttribute("src");try{b.src=""}catch(f){}d.id=b.id;d.name=b.name;d.title=b.title;d.className=b.className;d.width=
0==parseIntOr0(b.style.width)?b.width+"":b.style.width+"";d.height=0==parseIntOr0(b.style.height)?parseIntOr0(b.height)+"":parseIntOr0(b.style.height)+"";d.align=b.align;d.scrolling=b.scrolling;d.frameBorder="1"==b.frameBorder?!0:!1;b.getAttribute("DEXT_fiVe_Media_Caption")&&(d.caption=b.getAttribute("DEXT_fiVe_Media_Caption"));d.attributes=b.attributes;d=makeImageElementForObject(d);b.parentNode.replaceChild(d,b)}c=_iframeDoc.getElementsByTagName("embed");for(a=c.length-1;0<=a;a--){b=c[a];d=b.getAttribute("type");
if(void 0==d||null==d)d="";if(b.getAttribute("wmode")||-1<d.indexOf("x-shockwave-flash")||-1<b.src.indexOf("dext5player/")){d={};e=getLinkMediaType(b.src);d.type=""==e?"flash":e;d.type2="flash";d.src=b.getAttribute("src");try{b.src=""}catch(g){}d.width=0==parseIntOr0(b.style.width)?b.width+"":b.style.width+"";d.height=0==parseIntOr0(b.style.height)?parseIntOr0(b.height)+"":parseIntOr0(b.style.height)+"";d.hspace=null==b.getAttribute("hspace")?"":b.getAttribute("hspace").replace("px","");d.vspace=
null==b.getAttribute("vspace")?"":b.getAttribute("vspace").replace("px","");d.scale=null==b.getAttribute("scale")?"":b.getAttribute("scale");d.allowScriptAccess=null==b.getAttribute("allowScriptAccess")?"":b.getAttribute("allowscriptaccess");d.quality=null==b.getAttribute("quality")?"":b.getAttribute("quality");d.align=null==b.getAttribute("align")?"":b.getAttribute("align");d.margin_left=b.style.marginLeft;d.margin_right=b.style.marginRight;d.margin_top=b.style.marginTop;d.margin_bottom=b.style.marginBottom;
null==b.getAttribute("menu")?d.menu=!0:d.menu=b.getAttribute("menu");null==b.getAttribute("play")?d.play=!0:d.play=b.getAttribute("play");null==b.getAttribute("loop")?d.loop=!0:d.loop=b.getAttribute("loop");null==b.getAttribute("allowFullScreen")?d.allowFullScreen=!0:d.allowFullScreen=b.getAttribute("allowFullScreen");null==b.getAttribute("DEXT_fiVe_Media_Caption")?d.caption="":d.caption=b.getAttribute("DEXT_fiVe_Media_Caption");b.getAttribute("flashvars")&&(d.flashvars=b.getAttribute("flashvars"));
d=makeImageElementForObject(d);b.parentNode.replaceChild(d,b)}else if(b.getAttribute("AutoStart")){d={type:"media"};d.src=b.getAttribute("src");try{b.src=""}catch(h){}d.width=0==parseIntOr0(b.style.width)?b.width+"":b.style.width+"";d.height=0==parseIntOr0(b.style.height)?parseIntOr0(b.height)+"":parseIntOr0(b.style.height)+"";1==b.getAttribute("AutoStart")?d.autoStart=!0:d.autoStart=!1;-1==b.getAttribute("PlayCount")?d.playCount=!0:d.playCount=!1;1==b.getAttribute("ShowTracker")?d.showTracker=!0:
d.showTracker=!1;1==b.getAttribute("ShowStatusBar")?d.showStatusBar=!0:d.showStatusBar=!1;1==b.getAttribute("ShowControls")?d.showControls=!0:d.showControls=!1;1==b.getAttribute("ShowAudioControls")?d.showAudioControls=!0:d.showAudioControls=!1;1==b.getAttribute("ShowDisplay")?d.showDisplay=!0:d.showDisplay=!1;1==b.getAttribute("ShowPositionControls")?d.showPositionControls=!0:d.showPositionControls=!1;d=makeImageElementForObject(d);b.parentNode.replaceChild(d,b)}}e=_iframeDoc.getElementsByTagName("input");
for(a=e.length-1;0<=a;a--)c=e[a],"hidden"==c.type&&(d={type:"hidden"},d.id=c.id,d.name=c.name,d.value=c.value,d.className=c.className,d.title=c.title,d=makeImageElementForObject(d),c.parentNode.replaceChild(d,c))}}
function FixFlashError(){var a=DEXTTOP.G_CURREDITOR,c;if(c=a._EDITOR.preview.contentDocument?a._EDITOR.preview.contentDocument:a._EDITOR.preview.contentWindow.document){for(var b=c.getElementsByTagName("iframe"),a=b.length-1;0<=a;a--){var d=b[a];try{d.src="",d.parentNode.removeChild(d)}catch(e){}}c=c.getElementsByTagName("embed");for(a=c.length-1;0<=a;a--){b=c[a];try{b.src="",b.parentNode.removeChild(b)}catch(f){}}}}
function FixFlashError2(a){if(a){for(var c=a.getElementsByTagName("iframe"),b=c.length-1;0<=b;b--){var d=c[b];try{d.src="",d.parentNode.removeChild(d)}catch(e){}}a=a.getElementsByTagName("embed");for(b=a.length-1;0<=b;b--){c=a[b];try{c.src="",c.parentNode.removeChild(c)}catch(f){}}}}
function makeImageElementForObject(a){var c="";"iframe"==a.type?c=-1<a.src.indexOf("dext5player/media_player")?"dialog/custom_insert_image.jpg":"dialog/objectiframe.jpg":"flash"==a.type?c=-1<a.src.indexOf("dext5player/")?"dialog/custom_insert_image.jpg":"dialog/objectflash.jpg":"media"==a.type?c="dialog/objectmedia.jpg":"youtube"==a.type?c="dialog/youtube.jpg":"daum"==a.type?c="dialog/daum.jpg":"naver"==a.type?c="dialog/naver.jpg":"link_media"==a.type?c="dialog/link_media.jpg":"hidden"==a.type&&(c=
"dialog/hidden.jpg");var b=_iframeDoc.createElement("img");b.src=DEXTTOP.G_CURREDITOR._config.webPath.image+c;c={};if("iframe"==a.type||"iframe"==a.type2)c.type=a.type,c.type2=a.type2,c.src=a.src?a.src:"",c.id=a.id?a.id:"",c.name=a.name?a.name:"",c.title=a.title?a.title:"",c.className=a.className?a.className:"",c.width=a.width?a.width:"",c.height=a.height?a.height:"",c.align=a.align?a.align:"",c.scrolling=a.scrolling?a.scrolling:"",c.frameBorder=a.frameBorder?a.frameBorder:"",c.attributes=a.attributes?
a.attributes:"",c.caption=a.caption?a.caption:"",-1<a.width.indexOf("px")||-1<a.width.indexOf("%")||-1<a.width.indexOf("pt")?b.style.width=a.width:""!=a.width&&(b.style.width=a.width+"px"),-1<a.height.indexOf("px")||-1<a.height.indexOf("%")||-1<a.height.indexOf("pt")?b.style.height=a.height:b.style.height=a.height+"px",b.align=a.align;else if("flash"==a.type||"flash"==a.type2){c.type=a.type;c.type2=a.type2;c.src=a.src;c.width=a.width;c.height=a.height;c.hspace=a.hspace?a.hspace:"";c.vspace=a.vspace?
a.vspace:"";c.margin_left=a.margin_left;c.margin_right=a.margin_right;c.margin_top=a.margin_top;c.margin_bottom=a.margin_bottom;c.scale=a.scale;c.allowScriptAccess=a.allowScriptAccess;c.quality=a.quality;c.align="";c.menu=a.menu;c.play=a.play;c.loop=a.loop;c.allowFullScreen=a.allowFullScreen;c.flashvars=a.flashvars;c.caption=a.caption;-1<a.width.indexOf("px")||-1<a.width.indexOf("%")||-1<a.width.indexOf("pt")?b.style.width=a.width:b.style.width=a.width+"px";-1<a.height.indexOf("px")||-1<a.height.indexOf("%")||
-1<a.height.indexOf("pt")?b.style.height=a.height:b.style.height=a.height+"px";a.hspace&&(b.hspace=a.hspace);a.vspace&&(b.vspace=a.vspace);a.margin_left&&(-1<a.margin_left.indexOf("px")||-1<a.margin_left.indexOf("%")||-1<a.margin_left.indexOf("pt")?b.style.marginLeft=a.margin_left:b.style.marginLeft=a.margin_left+"px");a.margin_right&&(-1<a.margin_right.indexOf("px")||-1<a.margin_right.indexOf("%")||-1<a.margin_right.indexOf("pt")?b.style.marginRight=a.margin_right:b.style.marginRight=a.margin_right+
"px");a.margin_top&&(-1<a.margin_top.indexOf("px")||-1<a.margin_top.indexOf("%")||-1<a.margin_top.indexOf("pt")?b.style.marginTop=a.margin_top:b.style.marginTop=a.margin_top+"px");a.margin_bottom&&(-1<a.margin_bottom.indexOf("px")||-1<a.margin_bottom.indexOf("%")||-1<a.margin_bottom.indexOf("pt")?b.style.marginBottom=a.margin_bottom:b.style.marginBottom=a.margin_bottom+"px");b.align="";for(var d="absbottom absmiddle absmiddle bottom left middle right texttop top".split(" "),e=d.length,f=0;f<e;f++)if(a.align==
d[f]){b.align=a.align;c.align=a.align;break}}else"media"==a.type?(c.type=a.type,c.src=a.src,c.width=a.width,c.height=a.height,c.autoStart=a.autoStart,c.playCount=a.playCount,c.showTracker=a.showTracker,c.showStatusBar=a.showStatusBar,c.showControls=a.showControls,c.showAudioControls=a.showAudioControls,c.showDisplay=a.showDisplay,c.showPositionControls=a.showPositionControls,-1<a.width.indexOf("px")||-1<a.width.indexOf("%")||-1<a.width.indexOf("pt")?b.style.width=a.width:b.style.width=a.width+"px",
-1<a.height.indexOf("px")||-1<a.height.indexOf("%")||-1<a.height.indexOf("pt")?b.style.height=a.height:b.style.height=a.height+"px"):"hidden"==a.type&&(c.type=a.type,c.id=a.id,c.name=a.name,c.value=a.value,c.className=a.className,c.title=a.title);setDextCustomData(b,c);return b}var dragPopup=null,currentScrollPos;
function startDrag(a){a||(a=DEXTTOP.window.event);offsetX=a.clientX;offsetY=a.clientY;dragPopup.style.left||(dragPopup.style.left="0px");dragPopup.style.top||(dragPopup.style.top="0px");var c=dragPopup.getElementsByTagName("div")[1],b=!1;c&&(c=getClientRect(c),b=point_in_rectagnle(offsetX,offsetY,c.left,c.top,c.right,c.bottom));0==b&&(coordX=parseInt(dragPopup.style.left),coordY=parseInt(dragPopup.style.top),drag=!0,DEXTTOP.DEXT5.util.addEvent(DEXTTOP.document,"mousemove",dragDiv),DEXTTOP.DEXT5.util.addEvent(DEXTTOP.document,
"mouseup",stopDrag),11<=DEXTTOP.DEXT5.browser.ieVersion&&dragPopup.getElementsByTagName("iframe")[0].focus());DEXTTOP.DEXT5.util.cancelEvent(a)}
function dragDiv(a){if(drag){a||(a=DEXTTOP.window.event);var c=dragPopup.getElementsByTagName("iframe")[0],b=dragPopup.getElementsByTagName("div")[2],d=dragPopup.getElementsByTagName("iframe")[1];b.style.width="100%";b.style.height="100%";c&&b&&d&&(c.style.zIndex="-1");c=getWindowClientSize(DEXTTOP.window);b=[dragPopup.offsetWidth||0,dragPopup.offsetHeight||0];currentScrollPos=getWindowScrollPos(DEXTTOP.window);var d=coordX+a.clientX-offsetX,e=coordY+a.clientY-offsetY;0>=d-currentScrollPos[0]&&(d=
currentScrollPos[0]);0>=e-currentScrollPos[1]&&(e=currentScrollPos[1]);d+b[0]>=c[0]+currentScrollPos[0]&&(d=c[0]-b[0]+currentScrollPos[0]);e+b[1]>=c[1]+currentScrollPos[1]&&(e=c[1]-b[1]+currentScrollPos[1]);dragPopup.style.left=d+"px";dragPopup.style.top=e+"px";DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a)}}
function stopDrag(a){drag=!1;dragPopup.style.cursor="";a=dragPopup.getElementsByTagName("iframe")[0];var c=dragPopup.getElementsByTagName("div")[2],b=dragPopup.getElementsByTagName("iframe")[1];a&&c&&b&&(a.style.zIndex="1");DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.document,"mousemove",dragDiv);DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.document,"mouseup",stopDrag)}
function makeDragPopup(a){drag=!1;DEXTTOP.DEXT5.util.addEvent(a,"mousedown",startDrag);DEXTTOP.DEXT5.util.addEvent(a,"mouseover",function(){a.style.cursor="move"});DEXTTOP.DEXT5.util.addEvent(a,"mouseout",function(){a.style.cursor="pointer"});DEXTTOP.DEXT5.util.addEvent(DEXTTOP.window,"scroll",function(a){drag&&DEXTTOP.window.scroll(currentScrollPos[0],currentScrollPos[1])});dragPopup=a}var originScrollSize=null,originfull={},relativePos=!1,originStylebackup=[];
function isRelativePosition(a){for(;null!=a&&(!a.tagName||"body"!=a.tagName.toLowerCase());)if(a=a.parentNode,"relative"==a.style.position)return!0;return!1}
function setBackupHiddenStyle(a,c){originStylebackup=[];for(var b=a;null!=b&&(!b.tagName||"body"!=b.tagName.toLowerCase());){if(b!=a){var d;(d=c.getComputedStyle?c.getComputedStyle(b,""):b.currentStyle)&&d.overflow&&"hidden"==d.overflow&&(originStylebackup.push(b),b.style.setProperty?b.style.setProperty("overflow","visible",null):b.style.setAttribute("overflow","visible"))}b=b.parentNode}}
function setRestorreHiddenStyle(){for(var a=originStylebackup.length,c=0;c<a;c++){var b=originStylebackup[c];b.style.setProperty?b.style.setProperty("overflow","hidden",null):b.style.setAttribute("overflow","hidden")}originStylebackup=[]}
function resizeDextWin(){var a=window.frameElement;a.style.width="100%";a.style.height="100%";if(relativePos){var c=getClientRect(a);a.style.left=parseIntOr0(a.style.left)+-1*c.left+"px";a.style.top=parseIntOr0(a.style.top)+-1*c.top+"px"}else 1==DEXTTOP.DEXT5.browser.ie&&1==DEXTTOP.DEXT5.browser.quirks?(a.style.left=originScrollSize[0]+"px",a.style.top=originScrollSize[1]+"px"):(a.style.left="0px",a.style.top="0px");var c=document.getElementById("ue_editor_holder_"+DEXTTOP.G_CURREDITOR.ID),b=getWindowClientSize(DEXTTOP.DEXTWIN);
a.style.width=b[0]+"px";a.style.height=b[1]+"px";var a=document.getElementById("dext_topstatusbar_"+DEXTTOP.G_CURREDITOR.ID),d=document.getElementById("dext_menu_"+DEXTTOP.G_CURREDITOR.ID),e=document.getElementById("dext_toolbar_"+DEXTTOP.G_CURREDITOR.ID),f=document.getElementById("dext_statusbar_"+DEXTTOP.G_CURREDITOR.ID),g,h,m,n;a&&(g=getClientRect(a));d&&(h=getClientRect(d));e&&(m=getClientRect(e));f&&(n=getClientRect(f));a=0;h&&(a+=h.bottom-h.top);m&&(a+=m.bottom-m.top);a=g?a+(g.bottom-g.top):
a+1;a=n?a+(n.bottom-n.top):a+1;DEXTTOP.G_CURREDITOR.baseMenuToolbarHeight=a;c.style.height=b[1]-DEXTTOP.G_CURREDITOR.baseMenuToolbarHeight+"px"}
function getCustomParam(a){var c={},b=document.createElement("div");b.innerHTML=a;a=b.getElementsByTagName("embed")[0];var d=b.getElementsByTagName("iframe")[0];null!=a?(c.src=a.getAttribute("src")?a.getAttribute("src"):"",d="300",a.getAttribute("width")?d=a.getAttribute("width"):a.style.width&&""!=a.style.width&&(d=a.style.width),c.width=d,d="300",a.getAttribute("height")?d=a.getAttribute("height"):a.style.height&&""!=a.style.height&&(d=a.style.height),c.height=d,c.hspace=a.getAttribute("hspace")?
a.getAttribute("hspace"):"",c.vspace=a.getAttribute("vspace")?a.getAttribute("vspace"):"",c.margin_left=a.style.marginLeft,c.margin_right=a.style.marginRight,c.margin_top=a.style.marginTop,c.margin_bottom=a.style.marginBottom,c.scale=a.getAttribute("scale")?a.getAttribute("scale"):"",c.allowScriptAccess=a.getAttribute("allowScriptAccess")?a.getAttribute("allowScriptAccess"):"",c.quality=a.getAttribute("quality")?a.getAttribute("quality"):"",c.align=a.getAttribute("align")?a.getAttribute("align"):
"",c.menu=a.getAttribute("menu")?a.getAttribute("menu"):!1,c.play=a.getAttribute("play")?a.getAttribute("play"):!1,c.loop=a.getAttribute("loop")?a.getAttribute("loop"):!1,c.allowFullScreen=a.getAttribute("allowFullScreen")?a.getAttribute("allowFullScreen"):!0,a.getAttribute("flashvars")&&(c.flashvars=a.getAttribute("flashvars")),a=getLinkMediaType(c.src),c.type=""==a?"flash":a,c.type2="flash"):null!=d&&(c.src=d.getAttribute("src")?d.getAttribute("src"):"",c.id=d.getAttribute("id")?d.getAttribute("id"):
"",c.name=d.getAttribute("name")?d.getAttribute("name"):"",c.title=d.getAttribute("title")?d.getAttribute("title"):"",c.width=d.getAttribute("width")?parseIntOr0(d.getAttribute("width"))+"":"300",c.height=d.getAttribute("height")?parseIntOr0(d.getAttribute("height"))+"":"300",c.align=d.getAttribute("align")?d.getAttribute("align"):"",c.scrolling=d.getAttribute("scrolling")?d.getAttribute("scrolling"):"no",d.getAttribute("frameBorder")&&("yes"==d.getAttribute("frameBorder").toLowerCase()||"1"==d.getAttribute("frameBorder")?
c.frameBorder=!0:("no"==d.getAttribute("frameBorder")||d.getAttribute("frameBorder"),c.frameBorder=!1)),a=getLinkMediaType(c.src),c.type=""==a?"iframe":a,c.type2="iframe");b.innerHTML="";return c}
function getLinkMediaType(a){var c="";-1!=a.search("youtube.com/embed/")?c="link_media":-1!=a.search("videofarm.daum.net/")?c="link_media":-1!=a.search("naver.com/flash/")?c="link_media":-1!=a.search("channel.pandora.tv/")||-1!=a.search("flvr.pandora.tv/")?c="link_media":-1!=a.search("mgoon.com/Video")?c="link_media":-1!=a.search("dext5player/media_player")&&(c="iframe");return c}
function showSetImageProperty(a){if(null==a){setFocusTopWindow();var c;c="";try{c=G_dext5plugIn.getDext5PluginVersion()}catch(b){}c=""==c||"3,6,0,23">c?G_dext5plugIn.showImageProperty("","","","","","","","","","","",""):G_dext5plugIn.showImagePropertyEx("","","","","","","","","","","","","","","","");""!=c?(dialogCancel(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),insertNodeLikePasteHtml(c),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0):dialogCancel()}else{var d=null,d=a.parentNode,e=a.getAttribute("src"),f=a.style.width,g=a.style.height,h=a.border,m=a.align,n=a.vspace,p=a.hspace,q=a.style.marginTop,u=a.style.marginRight,t=a.style.marginBottom,v=a.style.marginLeft,w=a.id,x=a.className,y=a.title,z=a.alt,C="",D="",E="";if(""==f||null==f)f=a.width;if(""==g||null==g)g=a.height;try{d&&"a"==d.tagName.toLowerCase()?(D=d.getAttribute("href"),C=d.title,E=d.target):d=null}catch(F){d=null}setFocusTopWindow();c="";try{c=G_dext5plugIn.getDext5PluginVersion()}catch(H){}""==
c||"3,6,0,23">DEXTTOP.DEXT5.cabVersion?c=G_dext5plugIn.showImageProperty(e,f,g,h,m,n,p,y,z,C,D,E):(""==q.toString()&&(""==n.toString()?q="":q=n),""==t.toString()&&(""==n.toString()?t="":t=n),""==u.toString()&&(""==p.toString()?u="":u=p),""==v.toString()&&(""==p.toString()?v="":v=p),c=G_dext5plugIn.showImagePropertyEx(e,f,g,h,m,q,u,t,v,w,x,y,z,C,D,E));""!=c?(dialogCancel(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),e=getFirstRange().range,d?e.selectNode(d):
e.selectNode(a),e.deleteContents(),e.collapse(!0),e.pasteHtml(c),e.collapse(!1),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0):dialogCancel()}}
function insertNodeLikePasteHtml(a){if(""!=a&&null!=a){dialogCancel();var c=getFirstRange().range;if(c){c.deleteContents();var b=_iframeDoc.createElement("span");b.innerHTML=a;a=b.childNodes.length;for(var d=0;d<a;d++){var e=b.childNodes[d].cloneNode(!0),f=e.src,g=G_dext5plugIn.getImageWidthHeight(f);if(0<g.length){var h=e.style.width.replace("px","");""==h&&(h=e.width);var m=e.style.height.replace("px","");""==m&&(m=e.height);h+"^"+m==g&&(f=f+"?"+g,e=SetImageAutoFitSize(e,f))}try{c.insertNode(e),
c.selectNode(e)}catch(n){c.pasteHtml(e.outerHTML)}c.collapse(!1)}setFocusToBody()}}}function getEditrFromEvent(a){var c=null;try{if(null!=a){var b=a.target?a.target:a.srcElement;if(b){a=null;a=9!=b.nodeType?b.ownerDocument:b;try{a=a.defaultView?a.defaultView:a.parentWindow,c=DEXTTOP.DEXT5.DEXTMULTIPLE[a.parent.frameElement.id]}catch(d){c=DEXTTOP.G_CURREDITOR}}else c=DEXTTOP.G_CURREDITOR}else c=DEXTTOP.G_CURREDITOR}catch(e){c=DEXTTOP.G_CURREDITOR}return c}
function setPasteImageFromClipboard(a){if(!DEXTTOP.DEXT5.browser.gecko)try{if(0==DEXTTOP.DEXT5.browser.ie)for(var c=a.clipboardData.items,b=c.length,d=0;d<b;++d){if("file"==c[d].kind&&-1!==c[d].type.indexOf("image/")){var e=c[d].getAsFile();_iframeWin.URL=_iframeWin.URL||_iframeWin.webkitURL;_iframeWin.URL.createObjectURL(e);var f=new FileReader;f.onload=function(a){var b=a.target.result.split(",");2==b.length&&(checkPasteImage('<img src="'+a.target.result+'" />'),a=getExtFromImageDataSrc(b[0]),postBase64ImageToServer(b[1],
a))};f.readAsDataURL(e)}}else if(11<=DEXTTOP.DEXT5.browser.ieVersion)for(var c=_iframeWin.clipboardData,g=c.files,h=g.length,d=0;d<h;d++){var m=g[d],n=URL.createObjectURL(m);a.msConvertURL(m,"base64",n);f=new FileReader;f.onload=function(a){a=a.target.result.split(",");if(2==a.length){var b=getExtFromImageDataSrc(a[0]);postBase64ImageToServer(a[1],b)}};f.readAsDataURL(m)}}catch(p){}}
function postBase64ImageToServer(a,c,b){if(G_dext5plugIn)try{var d=G_dext5plugIn.getLocalImageFromBase64Image(a,c);if(0<d.length){var e=_iframeDoc.createElement("img");e.src=d;e.alt="";var f=getFirstRange().range;f.deleteContents();f.collapse(!0);f.pasteHtml(e.outerHTML);f.collapse(!1)}}catch(g){}else if("1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64){if(void 0==b||null==b)e=_iframeDoc.createElement("img"),e.src="data:image/"+c+";base64,"+a,e.alt="",f=getFirstRange().range,f.deleteContents(),
f.collapse(!0),f.pasteHtml(e.outerHTML),f.collapse(!1)}else if(d=null,d="CCODE_001"==DEXTTOP.G_CURREDITOR._config.custom_code?"hello":DEXTTOP.DEXT5.ajax.postData(DEXTTOP.G_CURREDITOR._config.post_url,"dext=test"),null!=d)e="",a=a.replace(/[+]/g,"%2B"),e+="imagedata="+a,"1"==DEXTTOP.G_CURREDITOR._config.security.encryptParam?(e+="&savefileext="+DEXTTOP.DEXT5.util.makeEncryptParam(c),e+="&serverdomain="+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.serverDomain),e+="&tosavepathurl="+
DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.toSavePathURL),e+="&savafoldernamerule="+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.saveFolderNameRule),e+="&savafilenamerule="+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.saveFileNameRule),e+="&proxy_url="+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.proxy_url),e+="&image_convert_format="+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.image_convert_format),
e+="&image_convert_width="+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.image_convert_width),e+="&image_convert_height="+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.image_convert_height),e+="&uploadtype="+DEXTTOP.DEXT5.util.makeEncryptParam("image"),e+="&pe=1"):(e=e+("&savefileext="+c)+("&serverdomain="+DEXTTOP.G_CURREDITOR._config.serverDomain),e+="&tosavepathurl="+DEXTTOP.G_CURREDITOR._config.toSavePathURL,e+="&savafoldernamerule="+DEXTTOP.G_CURREDITOR._config.saveFolderNameRule,
e+="&savafilenamerule="+DEXTTOP.G_CURREDITOR._config.saveFileNameRule,e+="&proxy_url="+DEXTTOP.G_CURREDITOR._config.proxy_url,e+="&image_convert_format="+DEXTTOP.G_CURREDITOR._config.image_convert_format,e+="&image_convert_width="+DEXTTOP.G_CURREDITOR._config.image_convert_width,e+="&image_convert_height="+DEXTTOP.G_CURREDITOR._config.image_convert_height,e+="&uploadtype=image"),e+="&"+DEXTTOP.G_CURREDITOR._config.userFieldID+"="+DEXTTOP.G_CURREDITOR._config.userFieldValue,d=DEXTTOP.DEXT5.ajax.postData(DEXTTOP.G_CURREDITOR._config.post_url,
e),void 0==b||null==b?(e=_iframeDoc.createElement("img"),e=SetImageAutoFitSize(e,d),f=getFirstRange().range,f.deleteContents(),f.collapse(!0),f.pasteHtml(e.outerHTML),f.collapse(!1)):b=SetImageAutoFitSize(b,d);else{var h=document.createElement("form");h.method="post";h.target="upload_frame";a='<input type="hidden" id="imagedata" name="imagedata" value="'+a+'" />';"1"==DEXTTOP.G_CURREDITOR._config.security.encryptParam?(a=a+'<input type="hidden" id="pe" name="pe" value="1" />'+('<input type="hidden" id="savefileext" name="savefileext" value="'+
DEXTTOP.DEXT5.util.makeEncryptParam(c)+'" />'),a+='<input type="hidden" id="serverdomain" name="serverdomain" value="'+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.serverDomain)+'" />',a+='<input type="hidden" id="tosavepathurl" name="tosavepathurl" value="'+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.toSavePathURL)+'" />',a+='<input type="hidden" id="savafoldernamerule" name="savafoldernamerule" value="'+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.saveFolderNameRule)+
'" />',a+='<input type="hidden" id="savafilenamerule" name="savafilenamerule" value="'+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.saveFileNameRule)+'" />',a+='<input type="hidden" id="proxy_url" name="proxy_url" value="'+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.proxy_url)+'" />',a+='<input type="hidden" id="image_convert_format" name="image_convert_format" value="'+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.image_convert_format)+
'" />',a+='<input type="hidden" id="image_convert_width" name="image_convert_width" value="'+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.image_convert_width)+'" />',a+='<input type="hidden" id="image_convert_height" name="image_convert_height" value="'+DEXTTOP.DEXT5.util.makeEncryptParam(DEXTTOP.G_CURREDITOR._config.image_convert_height)+'" />'):(a+='<input type="hidden" id="savefileext" name="savefileext" value="'+c+'" />',a+='<input type="hidden" id="serverdomain" name="serverdomain" value="'+
DEXTTOP.G_CURREDITOR._config.serverDomain+'" />',a+='<input type="hidden" id="tosavepathurl" name="tosavepathurl" value="'+DEXTTOP.G_CURREDITOR._config.toSavePathURL+'" />',a+='<input type="hidden" id="savafoldernamerule" name="savafoldernamerule" value="'+DEXTTOP.G_CURREDITOR._config.saveFolderNameRule+'" />',a+='<input type="hidden" id="savafilenamerule" name="savafilenamerule" value="'+DEXTTOP.G_CURREDITOR._config.saveFileNameRule+'" />',a+='<input type="hidden" id="proxy_url" name="proxy_url" value="'+
DEXTTOP.G_CURREDITOR._config.proxy_url+'" />',a+='<input type="hidden" id="image_convert_format" name="image_convert_format" value="'+DEXTTOP.G_CURREDITOR._config.image_convert_format+'" />',a+='<input type="hidden" id="image_convert_width" name="image_convert_width" value="'+DEXTTOP.G_CURREDITOR._config.image_convert_width+'" />',a+='<input type="hidden" id="image_convert_height" name="image_convert_height" value="'+DEXTTOP.G_CURREDITOR._config.image_convert_height+'" />');a+='<input type="hidden" id="uploadtype" name="uploadtype" value="image" />';
a+='<input type="hidden" id="'+DEXTTOP.G_CURREDITOR._config.userFieldID+'" name="'+DEXTTOP.G_CURREDITOR._config.userFieldID+'" value="'+DEXTTOP.G_CURREDITOR._config.userFieldValue+'" />';a+='<iframe id="upload_frame" name="upload_frame" frameborder="0" style="width:0px; height:0px;"></iframe>';h.innerHTML=a;document.body.appendChild(h);h.action=DEXTTOP.G_CURREDITOR._config.post_url;h.submit();var m=document.getElementById("upload_frame");DEXTTOP.DEXT5.util.addEvent(m,"load",function(){var a,c;try{a=
m.contentDocument?m.contentDocument.body:m.contentWindow.document.body}catch(d){a=m.document.body}c="textContent"in a?a.textContent:a.innerText;document.body.removeChild(h);void 0==b||null==b?(a=_iframeDoc.createElement("img"),a=SetImageAutoFitSize(a,c),c=getFirstRange().range,c.deleteContents(),c.collapse(!0),c.pasteHtml(a.outerHTML),c.collapse(!1)):b=SetImageAutoFitSize(b,c)},!0)}}
function SetImageAutoFitSize(a,c){var b=0,d=0,e="",e=c;if("CCODE_001"==DEXTTOP.G_CURREDITOR._config.custom_code){var f=e.split("|");a.setAttribute("src",f[2]);a.setAttribute("filemimeinfo",e);insertImageSrc(DEXTTOP.G_CURREDITOR,f[2])}else{f=c.split("|");1<f.length&&(c=f[0]);var g=c.split("?");2==g.length&&(e=g[0],g=g[1].split("^"),2==g.length?(b=g[0],d=g[1]):3==g.length&&(b=g[0],d=g[1],e+="?"+g[2]));if("1"==DEXTTOP.G_CURREDITOR._config.image_auto_fit&&b>DEXTTOP.G_CURREDITOR._defaultWidth)g=DEXTTOP.G_CURREDITOR._defaultWidth/
b,b=DEXTTOP.G_CURREDITOR._defaultWidth,d=parseInt(g*d);else if("2"==DEXTTOP.G_CURREDITOR._config.image_auto_fit){var g=b,h=d;if(g>DEXTTOP.G_CURREDITOR._defaultWidth||h>DEXTTOP.G_CURREDITOR._defaultHeight){var b=DEXTTOP.G_CURREDITOR._defaultWidth,d=DEXTTOP.G_CURREDITOR._defaultHeight,m=d/b,n=h/g;n>m?h>d?b=Math.round(g*d/h):(b=g,d=h):n<m?g>b?d=Math.round(h*b/g):(b=g,d=h):(b=g,d=h)}}a.src=e;0<b&&0<d&&(a.style.width=b+"px",a.style.height=d+"px",a.removeAttribute("width"),a.removeAttribute("height"));
"0"==DEXTTOP.G_CURREDITOR._config.allowImgSize&&(a.style.width="",a.style.height="");if(f&&1<f.length)for(g=f.length,h=1;h<g;h++)b=f[h].split("^"),2==b.length&&a.setAttribute(b[0],b[1]);insertImageSrc(DEXTTOP.G_CURREDITOR,e)}return a}
function SetCorrectOfficeHtml(a){var c="",b=a;if(-1<a.indexOf("<meta name=ProgId content=Word.Document>"))c="DOC",a=GetMsWordHtml(a);else if(-1<a.indexOf("<meta name=ProgId content=Excel.Sheet>"))c="XLS",a=GetMsExcelHtml(a);else if(-1<a.indexOf("<meta name=ProgId content=PowerPoint.Slide>"))c="PPT",a=GetMsPptHtml(a);else if(-1<a.indexOf('<meta name=Generator content="Jungum Global">'))c="GUL",a=GetJungumHtml(a);else if(isHwpPasteAction(a))c="HWP",a=GetHanHwpHtml(a);else if(-1<a.indexOf(' xmlns:m="http://schemas.microsoft.com/office/'))c=
"PPT",a=GetMsPptHtml2(a);else if(!DEXTTOP.DEXT5.browser.ie){var b=a.indexOf("\x3c!--StartFragment--\x3e"),d=a.lastIndexOf("\x3c!--EndFragment--\x3e");-1<b&&-1<d&&(b=a.substr(b+20),d=b.lastIndexOf("\x3c!--EndFragment--\x3e"),-1<d&&(a=b=b.substring(0,d)))}a=ReplaceAll(a,"<![if !supportEmptyParas]>","");a=ReplaceAll(a,"<![endif]>","");a=ReplaceAll(a,"\x3c!--[if !supportEmptyParas]--\x3e","");a=ReplaceAll(a,"\x3c!--[if !supportLists]--\x3e","");a=ReplaceAll(a,"\x3c!--[endif]--\x3e","");a=ReplaceAll(a,
"\x3c!--StartFragment--\x3e","");a=ReplaceAll(a,"\x3c!--EndFragment--\x3e","");try{var e=document.createElement("div");e.innerHTML=a;for(var f=e.getElementsByTagName("table"),g=f.length,d=0;d<g;d++){var h=b=0;null!=f[d].getAttribute("width")&&""!=f[d].getAttribute("width")&&0>f[d].getAttribute("width").indexOf("%")&&(b=parseInt(f[d].getAttribute("width"),10),f[d].removeAttribute("width"));null!=f[d].getAttribute("height")&&""!=f[d].getAttribute("height")&&(h=parseInt(f[d].getAttribute("height"),10),
f[d].removeAttribute("height"));""==f[d].style.width&&0!=b&&(f[d].style.width=b+"px");""==f[d].style.height&&0!=h&&(f[d].style.height=h+"px")}if("HWP"==c)for(var m=e.getElementsByTagName("span"),n=m.length,d=0;d<n;d++){var p=m[d];if("#ffffff"==colorToHex(p.style.backgroundColor)||"#ffffff"==p.style.backgroundColor)p.style.backgroundColor=""}a=e.innerHTML}catch(q){}return a}function isHwpPasteAction(a){return-1<a.indexOf(">\x3c!--p.")||-1<a.indexOf("\x3c!--[if !supportEmptyParas]--\x3e")?!0:!1}
function GetJungumHtml(a){var c=a.indexOf("<body>"),b=a.indexOf("</body>"),d=!1;-1<c&&-1<b&&(strTemp=a.substr(c+6),b=strTemp.indexOf("</body>"),-1<b&&(a=strTemp=strTemp.substring(0,b),d=!0));if(d){c=document.createElement("div");c.innerHTML=a;a=c.getElementsByTagName("table");for(var b=a.length,e,f,d=0;d<b;d++)""!=a[d].getAttribute("width")&&(e=parseInt(a[d].getAttribute("width"),10)),""!=a[d].getAttribute("height")&&(f=parseInt(a[d].getAttribute("height"),10)),e&&(a[d].style.width=e+"px"),f&&(a[d].style.height=
f+"px");a=c.innerHTML}return a}
function GetMsWordHtml(a){var c=a,b=!1,d="\x3c!--StartFragment--\x3e",e="\x3c!--EndFragment--\x3e",f=a.indexOf(d),g=a.indexOf(e);-1<f&&-1<g&&(c=a.substr(f+d.length),g=c.indexOf(e),-1<g&&(a=c=c.substring(0,g),b=!0));if(b){b=!1;a=c;d="\x3c!--[if gte vml 1]>";e="<![if !vml]>";try{for(;;){var f=a.indexOf(d),g=a.indexOf(e),h=a.length;if(h>f||h>g){a=ReplaceAll(a,d,"");a=ReplaceAll(a,e,"");break}if(-1<f&&-1<g)if(f>g){var m,c=a.substring(0,f);m=a.substr(f);c=ReplaceAll(c,e,"");a=c+m}else c=a.substring(0,
f),m=a.substr(g+e.length),a=c+m,b=!0;else break}}catch(n){}}b&&(a=ReplaceAll(a,"><![endif]></span>"," /></span>"),a=ReplaceAll(a,"<![endif]></span>","</span>"),a=ReplaceAll(a,"</span><![endif]>","</span>"),a=ReplaceAll(a,"<![endif]>",""));a=ReplaceAll(a,"<v:rect ","<div ");a=ReplaceAll(a,"</v:rect>","</div>");a=ReplaceAll(a,"<v:shadow ","<hr ");a=ReplaceAll(a,"<v:shape ","<span ");a=ReplaceAll(a,"</v:shape>","</span>");a=ReplaceAll(a,"<v:imagedata","<img border=0");a=ReplaceAll(a,"<![if !supportLists]>",
"");return a=ReplaceAll(a,"<![endif]>","")}
function GetMsExcelHtml(a){var c=a,b,c=a.indexOf("@page"),d=a.indexOf("</head>");-1<c&&-1<d&&(c=a.substr(c+5),d=c.indexOf("</head>"),-1<d&&(b=c.substring(0,d),b=GetStyleMap(b)));var c=a,d=!1,e,f="</body>",g=a.indexOf("<table"),h=a.indexOf(f);-1<g&&-1<h&&(c=a.substr(g),h=c.indexOf(f),-1<h&&(c=c.substring(0,h),d=!0));if(d){d=!1;a=c;e="\x3c!--[if gte vml 1]>";f="<![if !vml]>";try{for(;;){var g=a.indexOf(e),h=a.indexOf(f),m=a.length;if(m>g||m>h){a=ReplaceAll(a,e,"");a=ReplaceAll(a,f,"");break}if(-1<g&&
-1<h)if(g>h){var n,c=a.substring(0,g);n=a.substr(g);c=ReplaceAll(c,f,"");a=c+n}else c=a.substring(0,g),n=a.substr(h+f.length),a=c+n,d=!0;else break}}catch(p){}}d&&(a=ReplaceAll(a,"></span><![endif]>"," /></span>"),a=ReplaceAll(a,"</span><![endif]>","</span>"),a=ReplaceAll(a,"<![endif]>",""));a=ReplaceAll(a,"<v:rect ","<div ");a=ReplaceAll(a,"</v:rect>","</div>");a=ReplaceAll(a,"<v:shadow ","<hr ");a=ReplaceAll(a,"<v:shape ","<span ");a=ReplaceAll(a,"</v:shape>","</span>");a=ReplaceAll(a,"<v:imagedata",
"<img border=0");a=ReplaceAll(a,"\x3c!--StartFragment--\x3e","");a=ReplaceAll(a,"\x3c!--EndFragment--\x3e","");m=a.indexOf("<col ");-1<m&&(a=a.substring(0,m)+"\n<colgroup>\n"+a.substring(m,a.length+1));m=a.indexOf("<tr ");-1<m&&(a=a.substring(0,m)+"\n<tbody>\n"+a.substring(m,a.length+1),m=a.lastIndexOf("</table>"),-1<m&&(a=a.substring(0,m)+"\n</tbody>\n"+a.substring(m,a.length+1)));for(var q in b)m=b[q],"."==q.substring(0,1)&&(n="class="+q.substr(1)+" ",c="class="+q.substr(1)+">",m=ReplaceAll(m,"hairline ",
"dotted "),d=m=ReplaceAll(m," hairline;"," dotted;"),d=" "+m,a=ReplaceAll(a,n,d),d=m+">",a=ReplaceAll(a,c,d));a=ReplaceAll(a,"\r","");return a=ReplaceAll(a,"\n","")}function GetMsPptHtml(a){var c=a,c=a.indexOf("\x3c!--StartFragment--\x3e"),b=a.indexOf("\x3c!--EndFragment--\x3e");-1<c&&-1<b&&(c=a.substr(c+20),b=c.indexOf("\x3c!--EndFragment--\x3e"),-1<b&&(a=c=c.substring(0,b)));return a}
function GetMsPptHtml2(a){var c=a,b,c=a.indexOf("\x3c!--tr"),d=a.indexOf("</head>");-1<c&&-1<d&&(c=a.substr(c+6),d=c.indexOf("</head>"),-1<d&&(b=c.substring(0,d),b=GetStyleMap(b)));c=a.indexOf("\x3c!--StartFragment--\x3e");d=a.indexOf("\x3c!--EndFragment--\x3e");-1<c&&-1<d&&(c=a.substr(c+20),d=c.indexOf("\x3c!--EndFragment--\x3e"),-1<d&&(a=c=c.substring(0,d)));for(var e in b)if(c=b[e],"."==e.substring(0,1)){var d="class="+e.substr(1)+" ",f="class="+e.substr(1)+">",c=ReplaceAll(c,"hairline ","dotted "),
g=c=ReplaceAll(c," hairline;"," dotted;"),g=" "+c;a=ReplaceAll(a,d,g);g=c+">";a=ReplaceAll(a,f,g)}a=ReplaceAll(a,"\r","");return a=ReplaceAll(a,"\n","")}
function GetHanHwpHtml(a){var c=a,b=!1,d="\x3c!--StartFragment--\x3e",e="\x3c!--EndFragment--\x3e",f=a.indexOf(d),g=a.indexOf(e);-1<f&&-1<g&&(c=a.substr(f+d.length),g=c.indexOf(e),-1<g&&(c=c.substring(0,g),b=!0));if(b){b=!1;a=c;d="\x3c!--[if gte vml 1]>";e="<![if !vml]>";try{for(;;){var f=a.indexOf(d),g=a.indexOf(e),h=a.length;if(h>f||h>g){a=ReplaceAll(a,d,"");a=ReplaceAll(a,e,"");break}if(-1<f&&-1<g)if(f>g){var m,c=a.substring(0,f);m=a.substr(f);c=ReplaceAll(c,e,"");a=c+m}else c=a.substring(0,f),
m=a.substr(g+e.length),a=c+m,b=!0;else break}}catch(n){}}b&&(a=ReplaceAll(a,"/><![endif]>"," />"),a=ReplaceAll(a,"</span><![endif]>","</span>"),a=ReplaceAll(a,"<![endif]>",""));a=ReplaceAll(a,"<![if !supportEmptyParas]>&nbsp;<![endif]>","");a=ReplaceAll(a,"<![endif]>","");return a=ReplaceAll(a,"background:#ffffff;","")}
function GetStyleMap(a){var c={};a=a.split("}");for(var b="",d=a.length,e=0;e<d;e++){var f=a[e].split("{"),g=f.length;if(2==g)for(var h=0;h<g-1;h++){var m=f[h],n=f[h+1],m=m.replace(/\r\n/g,""),m=m.replace(/\r/g,""),m=m.replace(/\n/g,""),m=m.replace(/\t/g,""),n=n.replace(/\r\n/g,""),n=n.replace(/\r/g,""),n=n.replace(/\n/g,""),n=n.replace(/\t/g,"");""==b&&"td"==m&&(b=n=ReplaceAll(n,'"',"'"));0<m.length&&(n=ReplaceAll(n,'"',"'"),"."==m.substring(0,1)&&0<b.length?c[m]='style="'+b+n+'"':c[m]='style="'+
n+'"')}}return c}function ReplaceAll(a,c,b){a&&""!=a&&(a=a.split(c).join(b));return a}function getExtFromImageDataSrc(a){var c="";a=a.replace("data:","").split(";");0<a.length&&(a=a[0].split("/"),2==a.length&&(c=a[1]));return c}function htmlAsciiToChar(a){return a=a.replace(/&#39;/g,"'")}
function xssReplaceScript(a,c){var b="";try{var b=c=removeGarbageTag(c),d=DEXTTOP.G_CURREDITOR._config.xss_use,e=DEXTTOP.G_CURREDITOR._config.xss_remove_tags,f=DEXTTOP.G_CURREDITOR._config.xss_remove_events;if("1"!=d&&""==e&&""==f||null==a&&""==c)return b;if(a){var g=getAllNodesInBody(a,!0);DEXTTOP.DEXT5.util.removeTags(a,e);DEXTTOP.DEXT5.util.removeEvents(a,f,g);if("1"==d)for(var h=g.length,m=0;m<h;m++)g[m].src&&xssCheckPattern(g[m].src)&&g[m].src!=_config.userJsUrl&&(g[m].src=""),g[m].href&&xssCheckPattern(g[m].href)&&
(g[m].href=""),g[m].style.backgroundImage&&xssCheckPattern(g[m].style.backgroundImage)&&(g[m].style.backgroundImage="")}g="";"1"==d&&(g="script,vbscript");void 0==c||""==c?a&&(c=a.body.innerHTML,c=DEXTTOP.DEXT5.util.replaceForXSS(c,g,e,f),""!=c&&DEXTTOP.DEXT5.setBodyValue(c,DEXTTOP.G_CURREDITOR._config.editor_id,!0)):(c=DEXTTOP.DEXT5.util.replaceForXSS(c,g,e,f),""!=c&&(b=c))}catch(n){}return b}
function removeGarbageTag(a){try{var c=RegExp("<\\?xml[^>]*/>","gim");1==c.test(a)&&(a=a.replace(c,""));c=RegExp("</ustyle[^>]*>","gim");1==c.test(a)&&(a=a.replace(c,""));c=RegExp("<ustyle[^>]*>","gim");1==c.test(a)&&(a=a.replace(c,""))}catch(b){}return a}function xssCheckPattern(a){return-1<a.indexOf("javascript")||-1<a.indexOf("vbscript")||-1<a.indexOf(".js")?-1<a.indexOf(".jsp")?!1:!0:!1}function checkCellBRValue(){var a=!1;"<p><br /></p>"==getCellDefValue()&&(a=!0);return a}
function checkCellDefValue(a){var c=!1,b=getCellDefValue();a=a.toLowerCase();a=ReplaceAll(a," ","");a=ReplaceAll(a,"<br>","<br />");a=ReplaceAll(a,"<br/>","<br />");b==a&&(c=!0);return c}function getCellDefValue(){return DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?"<p>&nbsp;</p>":"<p><br /></p>"}function setCellDefValue(a){DEXTTOP.DEXT5.browser.ie&&a&&(""==a.innerHTML||"<p></p>"==a.innerHTML)&&(a.innerHTML=getCellDefValue())}
function setTableAllCellDefValue(a){if(DEXTTOP.DEXT5.browser.ie&&(a=GetParentbyTagName(a,"table")))for(var c=a.rows.length,b=0,d=currCell=null,e=0;e<c;e++)for(var d=a.rows[e],b=d.cells.length,f=0;f<b;f++)if(currCell=d.cells[f],""==currCell.innerHTML||"<p></p>"==currCell.innerHTML)currCell.innerHTML=getCellDefValue()}
function createTableCellDefValue(a){if(a&&DEXTTOP.DEXT5.browser.ie){var c=GetParentbyTagName(a,"table");if(c)for(var b=c.rows.length,d=0;d<b;d++)for(var e=c.rows[d],f=e.cells.length,g=0;g<f;g++){var h=e.cells[g];h!=a&&""==h.innerHTML&&(h.innerHTML=getCellDefValue())}3==a.childNodes[0].nodeType?a.innerHTML="":""==a.innerHTML&&(a.innerHTML=getCellDefValue())}return""}
function removeCellDefValue(a,c){var b="";if(a)if(1==c)var d=b=a.innerHTML,b=b.replace(/<p *([^>?+])*>(\s+)*(&nbsp;+)*(\s+)*<\/p>/i,""),d=d.replace(/<p *([^>?+])*>(<br *\/*>+)*<\/p>/i,""),b=1==checkCellDefValue(a.innerHTML)||""==a.innerHTML||""==b||""==d?"":a.innerHTML;else{var e=GetParentbyTagName(a,"table");if(e)for(var f=e.rows.length,d=0;d<f;d++)for(var g=e.rows[d],h=g.cells.length,m=0;m<h;m++){var n=g.cells[m];n==a||"<p></p>"!=n.innerHTML&&""!=n.innerHTML||(n.innerHTML=getCellDefValue())}if(0<
a.childNodes.length)for(e=a.childNodes.length,d=0;d<e&&1!=a.childNodes[d].nodeType;d++);200>a.innerHTML.length&&(1==checkCellDefValue(a.innerHTML)?(0==checkCellBRValue()&&(a.innerHTML="<p></p>"),doSetCaretPosition(a.childNodes[0],0),b=!0):b=!1)}return b}
function setTabkeyAction(){var a=getFirstRange().range;if("1"==DEXTTOP.G_CURREDITOR._config.disableTabletap)pasteHtmlAtCaretMini("&nbsp;&nbsp;&nbsp;&nbsp;"),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;else try{var c=null;a&&a.startContainer&&(c=getMyElementNode(a.startContainer));if(c){var b=GetTDTHCell(c);if(null==b&&"tr"==c.tagName.toLowerCase()){var d=c.cells.length;0<d&&(b=c.cells[d-1])}if(b){var e=GetParentbyTagName(b,"tr");if(e){var f=b.cellIndex,
g=e.rowIndex;if(e.cells.length>f+1){var h=e.cells[f+1];h&&(h.focus(),removeCellDefValue(h,!1),doSetCaretPosition(h.childNodes[0],0))}else{var m=GetParentbyTagName(e,"table");if(m&&(g=e.rowIndex,m.rows.length>g+1)){var n=m.rows[g+1];n&&(h=n.cells[0])&&(h.focus(),removeCellDefValue(h,!1),doSetCaretPosition(h.childNodes[0],0))}}}}else 0==GetTableSelectionCells().length&&(pasteHtmlAtCaretMini("&nbsp;&nbsp;&nbsp;&nbsp;"),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0)}}catch(p){}}
function setTableArrowKeyDownAction(a){CURSOR_BEFORE_INTABLE=!1;a="which"in a?a.which:a.keyCode;var c=getFirstRange().range;try{var b=null;c&&(b=getMyElementNode(c.startContainer));if(b){var d=GetTDTHCell(b);if(null==d&&"tr"==b.tagName.toLowerCase()){var e=b.cells.length;0<e&&(d=b.cells[e-1])}if(d){CURSOR_BEFORE_INTABLE=!0;var f=GetParentbyTagName(d,"tr");if(f){var g=f.cells[d.cellIndex],h=getTopOrBottomBoundNextCell(d,a);if(null!=h.nextCell){var m=GetParentbyTagName(f,"table");if(m){var n=m.rows[h.rowIndex];
if(n){var p=n.cells[h.cellIndex];p&&200>p.innerHTML.length&&(""==ReplaceAll(p.innerHTML," ","")||1==checkCellDefValue(p.innerHTML))&&0==checkCellBRValue()&&(p.innerHTML="<p></p>")}else setCellDefValue(g)}}else setCellDefValue(g)}}}}catch(q){}}
function setTableArrowKeyUpAction(a){a=getFirstRange().range;try{var c=null;a&&(c=getMyElementNode(a.startContainer));if(c){var b=GetTDTHCell(c);if(null==b&&"tr"==c.tagName.toLowerCase()){var d=c.cells.length;0<d&&(b=c.cells[d-1])}if(b){var e=GetParentbyTagName(b,"tr");if(e){var f=e.cells[b.cellIndex];setTableAllCellDefValue(f);200>f.innerHTML.length&&(""==ReplaceAll(f.innerHTML," ","")||1==checkCellDefValue(f.innerHTML))&&(0==checkCellBRValue()&&(f.innerHTML="<p></p>"),doSetCaretPosition(f.childNodes[0],
0))}}else if(CURSOR_BEFORE_INTABLE&&"body"==c.tagName.toLowerCase()){var g=_iframeDoc.createElement("p");g.innerHTML=getDefaultParagraphValue(!1);a.insertNode(g);doSetCaretPosition(g,0)}}}catch(h){}}
function getTopOrBottomBoundNextCell(a,c){var b={rowIndex:-1,cellIndex:-1,nextCell:null},d;switch(c){case 38:d=1;break;case 39:d=2;break;case 40:d=3;break;case 37:d=4;break;default:return b}try{var e=GetParentbyTagName(a,"tr");if(e){var f=GetParentbyTagName(a,"table");if(f){var g=f.rows.length,h=e.rowIndex,m=a.cellIndex,n=e.cells.length;if(1==d){if(0==h)return b;for(var p=h-1;0<=p;p--)for(var q=f.rows[p],u=q.cells.length,t=getClientRect(a),v=0;v<u;v++){var w=q.cells[v],x=getClientRect(w);if(t.top==
x.bottom&&(t.left==x.left||t.left>x.left&&t.left<x.right)){var y=GetParentbyTagName(w,"tr");if(y)return b.rowIndex=y.rowIndex,b.cellIndex=w.cellIndex,b.nextCell=w,b}}}else if(2==d){if(m!=n-1?(b.rowIndex=h,b.cellIndex=m+1):(b.rowIndex=e.rowIndex+1,b.cellIndex=0),f&&(q=f.rows[b.rowIndex]))if(w=q.cells[b.cellIndex])return b.nextCell=w,b}else if(3==d){if(g==h)return b;for(p=h+1;p<g;p++)for(q=f.rows[p],u=q.cells.length,t=getClientRect(a),v=0;v<u;v++)if(w=q.cells[v],x=getClientRect(w),t.bottom==x.top&&
(t.left==x.left||t.left>x.left&&t.left<x.right)&&(y=GetParentbyTagName(w,"tr")))return b.rowIndex=y.rowIndex,b.cellIndex=w.cellIndex,b.nextCell=w,b}else if(4==d)if(0!=m){if(b.rowIndex=h,b.cellIndex=m-1,f&&(q=f.rows[b.rowIndex]))if(w=q.cells[b.cellIndex])return b.nextCell=w,b}else if(b.rowIndex=h-1,f&&(q=f.rows[b.rowIndex]))return b.cellIndex=q.cells.length-1,b.nextCell=q.cells[q.cells.length-1],b}}}catch(z){}return b}function setArrowKeyAction(a){return!1}
function setDeleteKeyAction(a){a=!1;try{for(var c=GetTableSelectionCells(),b=c.length,d=0;d<b;d++)c[d].innerHTML=getCellDefValue();0<b&&(ClearDraggingTableCellSelected(),removeCellDefValue(c[0],!1),removeCellDefValue(c[b-1],!1),doSetCaretPosition(c[0].childNodes[0],0),DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&"&nbsp;"==c[0].innerHTML&&(c[0].innerHTML=""),a=!0)}catch(e){}return a}
function getCopyCellData(a){DEXTTOP.G_COPIEDTABLE=null;DEXTTOP.G_COPIEDCELLDATA=null;a=!1;if(null!=ActiveLastTable){var c=CellSelectedCopy(ActiveLastTable);1==c.selected&&(DEXTTOP.G_COPIEDTABLE=c.Table,DEXTTOP.G_COPIEDCELLDATA=c.cellValue,a=!0)}return a}function dextWriteLog(a,c){void 0==c&&(c=!1);if(0==DEXTTOP.DEXT5.isRelease)try{c?parent.parent.document.getElementById("txtTestValue").value+=a:parent.parent.document.getElementById("txtTestValue").value=a}catch(b){}}
function _dextiframe_Unload(a){try{if(null!=DEXTTOP.DEXT5.config.DialogWindow){var c=DEXTTOP.window.document.getElementById("dext_dialog");c&&c.parentNode.removeChild(c);var b=DEXTTOP.window.document.getElementById("dext_context_iframe"+a);b&&b.parentNode.removeChild(b);var d=DEXTTOP.window.document.getElementById("dext_context_background"+a);d&&d.parentNode.removeChild(d)}}catch(e){}}
function _dextiframe_Keyup(a){var c="which"in a?a.which:a.keyCode,b=a.target?a.target:a.srcElement,d=null,d=9!=b.nodeType?b.ownerDocument:b;if((b=d.activeElement)&&b.tagName&&"body"!=b.tagName.toLowerCase()&&"html"!=b.tagName.toLowerCase()){var e=b.parentNode,d=b.tagName.toLowerCase(),e=e.tagName.toLowerCase();if(!("span"!=e&&"li"!=e||"a"!=d&&"button"!=d))if(13==c){if(c=b.id.split(":")[0],d=b.id.split(":")[1],e=isMenuItemEnable(c,d))DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,d),DEXTTOP.DEXT5.util.cancelEvent(a),
DEXTTOP.DEXT5.util.stopEvent(a)}else if(9==c)c=b.id.split(":")[0],d=b.id.split(":")[1],e=isMenuItemEnable(c,d),e||(a=moveNextMenu(c,d))&&a.focus();else if(39==c){if(c=b.id.split(":")[0],d=b.id.split(":")[1],b=moveNextMenu(c,d))for(c=b.id.split(":")[0],d=b.id.split(":")[1];;)if(e=isMenuItemEnable(c,d)){b.focus();break}else if(b=moveNextMenu(c,d))c=b.id.split(":")[0],d=b.id.split(":")[1];else break}else if(37==c&&(c=b.id.split(":")[0],d=b.id.split(":")[1],b=movePrevMenu(c,d)))for(c=b.id.split(":")[0],
d=b.id.split(":")[1];;)if(e=isMenuItemEnable(c,d)){b.focus();break}else if(b=movePrevMenu(c,d))c=b.id.split(":")[0],d=b.id.split(":")[1];else break}}function _dextiframe_Keydown(a){var c="which"in a?a.which:a.keyCode;try{var b=DEXTTOP.G_CURREDITOR.getEditorMode();if(8==c&&"design"==b){DEXTTOP.DEXT5.util.cancelEvent(a);return}}catch(d){}a.ctrlKey&&nextTabKeyAccess(a,c)&&DEXTTOP.DEXT5.util.cancelEvent(a)}
function nextTabKeyAccess(a,c){var b=!1;try{var d=null;switch(c){case 48:var e=DEXTTOP.DEXTDOC.getElementById(DEXTTOP.G_CURREDITOR._config.nextTabElementId);e?e.focus():setFocusTopWindow();var f=getEditrFromEvent(a);f&&(f._dextframeHasFocus=!1);b=!0;break;case 49:d=getFirstCmdElementInBar("dext_tab_menu_"+DEXTTOP.G_CURREDITOR.ID);b=!0;break;case 50:d=getFirstCmdElementInBar("dext_tab_tool1_"+DEXTTOP.G_CURREDITOR.ID);b=!0;break;case 51:d=getFirstCmdElementInBar("dext_tab_tool2_"+DEXTTOP.G_CURREDITOR.ID);
b=!0;break;case 52:setFocusToBody();b=!0;break;case 53:d=getFirstCmdElementInBar("dext_tab_status_"+DEXTTOP.G_CURREDITOR.ID);b=!0;break;case 123:DEXTTOP.G_CURREDITOR._dextCommands(DEXTTOP.G_CURREDITOR.ID,"shortcut");b=!0;break;case 66:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"bold"),b=!0;break;case 73:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"italic"),b=!0;break;case 85:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"underline"),b=!0;break;case 68:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,
"strike_through"),b=!0;break;case 76:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"align_left"),b=!0;break;case 69:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"align_center"),b=!0;break;case 72:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"align_right"),b=!0;break;case 75:if(f=getEditrFromEvent(a))f._dextCommands(f.ID,"hyperlink_property"),b=!0;break;case 222:if(f=getEditrFromEvent(a))a.shiftKey?f._dextCommands(f.ID,"superscript"):f._dextCommands(f.ID,"subscript"),b=!0;break;case 221:(f=getEditrFromEvent(a))&&
a.shiftKey&&(f._dextCommands(f.ID,"table_indent"),b=!0);break;case 219:(f=getEditrFromEvent(a))&&a.shiftKey&&(f._dextCommands(f.ID,"table_outdent"),b=!0)}if(d){var g=d.id.split(":")[0],h=d.id.split(":")[1];if(isMenuItemEnable(g,h)){if(DEXTTOP.DEXT5.browser.chrome)try{window.focus()}catch(m){}d.focus()}else{var n=moveNextMenu(g,h);if(n){if(DEXTTOP.DEXT5.browser.chrome)try{window.focus()}catch(p){}n.focus()}}}}catch(q){}return b}
function isMenuItemEnable(a,c){var b=!0,d=document.getElementById("dext_span_"+a+c);d&&(d=DEXTTOP.DEXT5.util.getClass(d))&&-1<d.indexOf("_off")&&(b=!1);return b}
function moveNextMenu(a,c){var b=null,d=document.getElementById("dext_span_"+a+c);if(d&&d.nextSibling){var d=d.nextSibling,e="";d.tagName&&(e=d.tagName.toLowerCase());"span"==e&&1==d.childNodes.length&&(d=d.nextSibling);if("span"==e&&1<d.childNodes.length&&(b=d.childNodes[1],d=b.id.split(":")[1],!isMenuItemEnable(a,d)))return moveNextMenu(a,d)}return b}
function movePrevMenu(a,c){var b=null,d=document.getElementById("dext_span_"+a+c);if(d&&d.previousSibling){var d=d.previousSibling,e=d.tagName.toLowerCase();"span"==e&&1==d.childNodes.length&&(d=d.previousSibling);if("span"==e&&1<d.childNodes.length&&(b=d.childNodes[1],d=b.id.split(":")[1],!isMenuItemEnable(a,d)))return movePrevMenu(a,d)}return b}
function getFirstCmdElementInBar(a){var c=null;try{var b=document.getElementById(a),d=b.childNodes.length;for(a=0;a<d;a++){var e=b.childNodes[a];if(1===e.nodeType&&0<e.childNodes.length){for(var f=e.childNodes.length,g=0;g<f;g++){var h=e.childNodes[g];if(1===h.nodeType&&("a"==h.tagName.toLowerCase()||"button"==h.tagName.toLowerCase())){c=h;break}}if(c)break}}}catch(m){c=null}return c}
function getImageAutoFitForPasteHtml(a){var c=document.createElement("div");c.innerHTML=a;a=c.getElementsByTagName("img");for(var b=null,d=a.length,e=0;e<d;e++){var b=a[e],f=b.src,g=G_dext5plugIn.getImageWidthHeight(f);if(0<g.length){var h=b.style.width.replace("px","");""==h&&(h=b.width);var m=b.style.height.replace("px","");""==m&&(m=b.height);h+"^"+m==g&&(f=f+"?"+g,SetImageAutoFitSize(b,f))}}return a=c.innerHTML}function removeHistory(a){}
function set_view_mode_auto_height(){try{setTimeout(function(){if(("1"==DEXTTOP.G_CURREDITOR._config.view_mode_auto_height||"1"==DEXTTOP.G_CURREDITOR._config.view_mode_auto_width)&&"view"==DEXTTOP.G_CURREDITOR._config.mode){var a=_iframeDoc.body,b=_iframeDoc.documentElement,d=DEXTTOP.G_CURREDITOR._config.style.height,e=DEXTTOP.G_CURREDITOR._config.style.width,f=0;if(0>d.indexOf("%"))f=parseInt(d,10);else if("1"==DEXTTOP.G_CURREDITOR._config.view_mode_auto_height)return;var g=0;if(0>e.indexOf("%"))g=
parseInt(e,10);else if("1"==DEXTTOP.G_CURREDITOR._config.view_mode_auto_width)return;var h=0,m=0;"1"==DEXTTOP.G_CURREDITOR._config.view_mode_auto_height?(h=Math.max(a.scrollHeight,a.offsetHeight,b.clientHeight,b.scrollHeight,b.offsetHeight),h>=f&&(h+=30)):(h=f,-1<d.indexOf("%")&&(h=d));"1"==DEXTTOP.G_CURREDITOR._config.view_mode_auto_width?(m=Math.max(a.scrollWidth,a.offsetWidth,b.clientWidth,b.scrollWidth,b.offsetWidth),m>=g&&(m+=10)):(m=g,-1<e.indexOf("%")&&(m=e));DEXTTOP.DEXT5.setSize(m,h)}},250)}catch(a){}}
function getFontStyle(a){var c,b={fontFamily:"",fontSize:"",lineHeight:""};a.currentStyle?c=a.currentStyle:window.getComputedStyle&&(c=window.getComputedStyle(a,""));var d=c.fontFamily;0<d.length&&(d=d.replace(/"/gi,""),d=d.replace(/'/gi,""),d=d.split(",")[0]);b.fontFamily=d;var e,d="pt";try{-1<DEXTTOP.G_CURREDITOR._dextFontSize._fontSize[DEXTTOP.G_CURREDITOR.ID][0].indexOf("px")&&(d="px")}catch(f){}if(-1<c.fontSize.indexOf("px"))"pt"==d?(e=.75*parseFloat(c.fontSize),e=Math.round(e)+"pt"):"px"==d&&
(e=c.fontSize);else if(-1<c.fontSize.indexOf("pt"))"pt"==d?e=c.fontSize:"px"==d&&(e=parseFloat(c.fontSize)*(4/3),e=Math.round(e)+"px");else if(-1<c.fontSize.indexOf("em"))if("pt"==d)if(-1<c.lineHeight.indexOf("px")){var g=.75*parseFloat(c.lineHeight);e=g*parseFloat(c.fontSize);e=Math.round(e)+"pt"}else-1<c.lineHeight.indexOf("pt")&&(e=parseFloat(c.lineHeight)*parseFloat(c.fontSize),e=Math.round(e)+"pt");else"px"==d&&(-1<c.lineHeight.indexOf("px")?(e=parseFloat(c.lineHeight)*parseFloat(c.fontSize),
e=Math.round(e)+"px"):-1<c.lineHeight.indexOf("pt")&&(g=parseFloat(c.lineHeight)*(4/3),e=g*parseFloat(c.fontSize),e=Math.round(e)+"px"));else e="";b.fontSize=e;if(-1<c.lineHeight.indexOf("px")){var h;"pt"==d?(h=parseFloat(e),g=.75*parseFloat(c.lineHeight)):"px"==d&&(h=parseFloat(e),g=parseFloat(c.lineHeight));c=Math.round(g)/Math.round(h);c=Math.round(10*c)/10;c=parseInt(100*c,10)+"%"}else if(-1<c.lineHeight.indexOf("pt")){var m;"pt"==d?(h=parseFloat(e),m=parseFloat(c.lineHeight)):"px"==d&&(h=.75*
parseFloat(e),m=.75*parseFloat(c.lineHeight));c=Math.round(m)/Math.round(h);c=Math.round(10*c)/10;c=parseInt(100*c,10)+"%"}else c=-1<c.lineHeight.indexOf("normal")||-1<c.lineHeight.indexOf("inherit")?c.lineHeight:100*parseFloat(c.lineHeight)+"%";a=a.tagName.toLowerCase();if("h1"==a||"h2"==a||"h3"==a||"h4"==a||"h5"==a||"h6"==a||""==e)c="";b.lineHeight=c;return b}
function setAutoSave(a){try{var c=a._setting.auto_save.toString().split(",");a._setting.auto_save_fn&&DEXTTOP.DEXTWIN.clearInterval(a._setting.auto_save_fn);"1"==c[0]?(DEXTTOP.DEXTWIN.localStorage["dext_"+a.ID+"_auto_save"]=c[1],a._setting.auto_save_fn=DEXTTOP.DEXTWIN.setInterval(function(){var b="",c=a.getEditorMode();if("design"==c)b=DEXTTOP.DEXT5.getHtmlValueExWithDocType(a.ID,!0);else if("source"==c){c=a._EDITOR.source.value;c=c.replace(/\t/g,"");if("1"==a._config.sourceViewtype||"2"==a._config.sourceViewtype)c=
removeCRLFChar(c);c=DEXTTOP.DEXT5.util.htmlRevision(c);c=xssReplaceScript(null,c);"1"==DEXTTOP.G_CURREDITOR._config.paste_image_base64&&(c=DEXTTOP.DEXT5.util.ImageSrcConvert(c,!1,DEXTTOP.G_CURREDITOR.ID));var b=a._docType[a._PageProp.doctype],f=a._PageProp.lang,g=a._PageProp.xmlnsname,h=_iframeDoc.getElementsByTagName("head")[0].outerHTML;_iframeDoc.getElementsByTagName("body");var m="<html";0<f.length&&(-1<f.indexOf("-")&&(f=f.split("-")[0]),m+=' lang="'+f+'" xml:lang="'+f+'"');0<g.length&&(m+=' xmlns="'+
g+'"');b=b+(m+">")+h+"<body>"+c+"<body></html>"}else"preview"==c?(c=a._EDITOR.preview.contentDocument?a._EDITOR.preview.contentDocument:a._EDITOR.preview.contentWindow.document,b=a._docType[a._PageProp.doctype],b+=c.documentElement.outerHTML):"text"==c&&(b=a._EDITOR.text.value);DEXTTOP.DEXTWIN.localStorage["dext_"+a.ID]=b;(b=document.getElementById("dext_span_"+a.ID+"load_auto_save"))&&(c=DEXTTOP.DEXT5.util.getClass(b))&&-1<c.indexOf("_off")&&DEXTTOP.DEXT5.util.setClass(b,"uebutton_span_on")},6E4*
c[1])):"2"==c[0]&&(DEXTTOP.DEXTWIN.localStorage.removeItem("dext_"+a.ID+"_auto_save"),DEXTTOP.DEXTWIN.localStorage.removeItem("dext_"+a.ID),a._iconEnable(""))}catch(b){}}function getAutoSaveHtml(a){var c=void 0;try{c=DEXTTOP.DEXTWIN.localStorage["dext_"+a]}catch(b){}return c}function getAutoSave(a){try{var c=DEXTTOP.DEXTWIN.localStorage["dext_"+a.ID+"_auto_save"];return c?"1,"+c:"2"}catch(b){return"0"}}function _iframeDoc_Scroll(a){setDEXTWINDOC();moveRulerPosition(a)}
function moveRulerPosition(a){if(1==DEXTTOP.G_CURREDITOR._config.ruler.use){var c=getEditrFromEvent(a);if(null==c||void 0==c)c=DEXTTOP.G_CURREDITOR;if((a=getEditorFrameDoc(c).getElementById("dext_tab_tool3_"+c.ID))&&"none"!=a.style.display){var b=a.style.backgroundPosition,d=a.style.backgroundPosition.indexOf("px"),b=parseInt(b.substring(0,d),10),d=c._DOC.documentElement.scrollLeft||c._BODY.scrollLeft||0;b!=d&&(a.style.backgroundPosition="-"+d+"px top",set_ruler_point_position(c));setTimeout(function(){set_ruler_pointline_position(c)},
0)}}}function set_ruler_point_position(a){if("1"==a._config.ruler.viewPointer){var c=getEditorFrameDoc(a).getElementById("dext_ruler_point_"+a.ID),b=parseIntOr0(c.style.width),b=parseIntOr0(a._setting.ruler_position)-b/2,b=b-(a._DOC.documentElement.scrollLeft||a._BODY.scrollLeft||0);c.style.marginLeft=b+"px";"1"==a._config.autoBodyFit&&(c=parseIntOr0(a._setting.ruler_position),b=parseIntOr0(a._BODY.style.width),0<c&&c!=b&&(a._BODY.style.width=c-10+"px"))}}
function set_ruler_pointline_position(a){if("1"==a._config.ruler.viewGuideLine){var c=getEditorFrameDoc(a),b=c.getElementById("dext_ruler_point_"+a.ID),b=parseIntOr0(b.style.width),d=parseIntOr0(a._setting.ruler_position)-b/2,d=d-(a._DOC.documentElement.scrollLeft||a._BODY.scrollLeft||0),e=c.getElementById("ue_editor_holder_"+a.ID),c=c.getElementById("dext_ruler_pointline_"+a.ID);c.style.top=e.offsetTop+"px";c.style.left=d+b/2+"px";c.style.height=e.style.height;"1"==a._config.autoBodyFit&&(c=parseIntOr0(a._setting.ruler_position),
b=parseIntOr0(a._BODY.style.width),0<c&&c!=b&&(a._BODY.style.width=c-10+"px"))}}function changeSpanPageBreakProperty(a){a=a.getElementsByTagName("span");for(var c=a.length,b=0;b<c;b++){var d=a[b];"always"==d.style.pageBreakAfter&&(d.getElementsByTagName("span")[0].innerText="",d.style.borderStyle="none",d.style.borderWidth="0px")}}
function restoreSpanPageBreakProperty(a){a=a.getElementsByTagName("span");for(var c=a.length,b=0;b<c;b++){var d=a[b];"always"==d.style.pageBreakAfter&&(d.getElementsByTagName("span")[0].innerText="\ud398\uc774\uc9c0 \ubd84\ud560",d.style.borderColor="red",d.style.borderStyle="dashed",d.style.borderWidth="1px")}}
function setLineHeightForBgColor(){if(DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion)try{var a=getFirstRange().range,c=getMyElementNode(a.startContainer);if("SPAN"==c.tagName&&(""!=c.style.color||""!=c.style.backgroundColor)){for(var b,a=c;"BODY"!=a.parentNode.tagName;)if("P"==a.parentNode.tagName){b=a;break}else a=a.parentNode;currLineHeight=getFontStyle(c).lineHeight;var d=DEXTTOP.G_CURREDITOR._setting.line_height,a=!1;if(""==currLineHeight)a=!0;else{var e=currLineHeight.indexOf("%");
if(-1<e){var f=parseInt(currLineHeight,10);currLineHeight=f/=100}e=d.indexOf("%");-1<e&&(f=parseInt(d,10),d=f/100);currLineHeight==d&&(a=!0)}currLineHeight==d&&(a=!0);var g;1==a&&(g=1*currLineHeight+.01);g&&b&&"SPAN"==b.tagName&&a&&(b.style.lineHeight=g,b!=c&&(c.style.lineHeight=currLineHeight))}}catch(h){}}function isMsHtmlorHugeHtml(a){var c=!0;return 11>DEXTTOP.DEXT5.browser.ieVersion?c:c=RegExp('mso-[^:]+:[^;">]+;',"gi").test(a.innerHTML)}
function setEditorBorder(a,c){var b="",d="";borderYN=void 0==c?"1"==a._config.editorborder?!0:!1:c;a._config.editorborder=1==borderYN?"1":"0";borderYN?(b="_xxx",d=""):(b="",d="_xxx");var e=a._config.style.skinName,f=document.getElementById("dext_menu_"+a.ID);null!=f&&(borderYN?(f.style.borderTopWidth="1px",f.style.borderLeftWidth="1px",f.style.borderRightWidth="1px"):(f.style.borderTopWidth="0px",f.style.borderLeftWidth="0px",f.style.borderRightWidth="0px"));f=getElementsByClass("ue_table_"+e+b,document);
0<f.length&&(f[0].className="ue_table_"+e+d,getElementsByClass("ue_tg_"+e+b,document)[0].className="ue_tg_"+e+d,getElementsByClass("ue_editor_"+e+"_lr"+b,document)[0].className="ue_editor_"+e+"_lr"+d)}function getDefaultParagraphValue(a){var c="";return c=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?a?"<p>&nbsp;</p>":"&nbsp;":a?"<p><br /></p>":"<br />"}
function repairBodyFirstLastTag(a){try{var c=_iframeDoc.body.childNodes,b=c.length,d=!1,e,f;if(0==b.length)d=!0;else{f=c[0];e=c[b-1];if(1==a&&1==f.nodeType&&"table"==f.tagName.toLowerCase()||"blockquote"==f.tagName.toLowerCase()){insertPtagTableNear(!0,f);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;return}if(1!=e.nodeType||"p"!=e.tagName.toLowerCase())d=!0;if(1==e.nodeType&&"p"==e.tagName.toLowerCase()){var g=e.childNodes,h=g.length;""==e.innerText&&0<h&&
1==g[h-1].nodeType&&("img"==g[h-1].tagName.toLowerCase()||"table"==g[h-1].tagName.toLowerCase())&&(d=!0)}}if(d){var m=_iframeDoc.createElement("p");DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion||(m.innerHTML=getDefaultParagraphValue(!1));_iframeDoc.body.appendChild(m)}}catch(n){}}
function OfficePasteClean(a){try{a=ReplaceAll(a,unescape("%uFEFF"),"");a=ReplaceAll(a,unescape("%u2060"),"");a=a.replace(/\r\n/g,"");a=a.replace(/\r/g,"");a=removeDummyTag(a);var c=RegExp("<span *([^>?+])*>(\\n)</span>","gi"),b="";try{var d=a.match(c);if(d)for(var e=d.length,c=0;c<e;c++)var f=d[c],g=/>\n</.exec(f),h=g[0].replace(RegExp("\\n","gi")," "),f=f.replace(g,h),b=a.replace(d[c],f)}catch(m){}""!=b&&(a=b);a=a.replace(/>\n+</g,"><");a=a.replace(/\t/g,"");a=a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,
"");a=a.replace(/<font/gi,"<span");a=a.replace(/<\/font/gi,"</span");if(DEXTTOP.DEXT5.browser.ie){a=ReplaceAll(a,unescape("%u3000"),"");b="<font[^>]*>(?:\\s|&nbsp;|  |)</font>";a=a.replace(new RegExp(b,"gim"),"");var n=new RegExp("<span[^>]*>(?:|&nbsp;|  |)</span>","gim")}else a=ReplaceAll(a,"\u3000","<p><br></p>"),n=new RegExp("<span[^>]*>(?:|&nbsp;|  |)</span>","gim");a=a.replace(n,"");var p=document.createElement("div");p.innerHTML=a;for(var q=p.getElementsByTagName("span"),u=q.length,n=0;n<u;n++)if(null!=
q[n].getAttribute("face")&&void 0!=q[n].getAttribute("face")&&""!=q[n].getAttribute("face")&&(""==q[n].style.fontFamily&&(q[n].style.fontFamily=q[n].getAttribute("face")),removeAttribute(q[n],"face")),null!=q[n].getAttribute("color")&&void 0!=q[n].getAttribute("color")&&""!=q[n].getAttribute("color")&&(""==q[n].style.color&&(q[n].style.color=q[n].getAttribute("color")),removeAttribute(q[n],"color")),null!=q[n].getAttribute("size")&&void 0!=q[n].getAttribute("size")&&""!=q[n].getAttribute("size")){var t;
switch(q[n].getAttribute("size")){case "1":t="7pt";break;case "2":t="9pt";break;case "3":t="12pt";break;case "4":t="14pt";break;case "5":t="18pt";break;case "6":t="24pt";break;case "7":t="36pt";break;default:t=""}""!=t&&""==q[n].style.fontSize&&(q[n].style.fontSize=t);removeAttribute(q[n],"size")}if("1"==DEXTTOP.G_CURREDITOR._config.useCorrectInOutdent){var v=p.innerHTML,w=p.getElementsByTagName("p"),x=w.length;try{for(n=0;n<x;n++){var y=w[n].style.textIndent,z,C;y&&0<y.length&&(z=parseFloat(y),C=
y.replace(z,"").toLowerCase());var D=w[n].style.marginLeft,E,F;D&&0<D.length&&(E=parseFloat(D),F=D.replace(E,"").toLowerCase());if(z&&E){if(C==F)var H=z+E;else"pt"==C?z=4*z/3:"cm"==C&&(z*=37.795275593333),"pt"==F?E=4*E/3:"cm"==F&&(E*=37.795275593333),H=z+E;0>H&&(w[n].style.textIndent="",w[n].style.marginLeft="")}else z?0>z&&(w[n].style.textIndent=""):E&&0>E&&(w[n].style.marginLeft="")}}catch(A){p.innerHTML=v}}a=p.innerHTML;a=officePasteCleanForTable(a)}catch(I){}return a}
function removeAttributeForPasteTable(a){for(var c=["height","style"],b=c.length,d=0;d<b;d++)removeAttribute(a,c[d])}
function makeRangeSelectionMarkInDesign(){try{var a=getFirstRange().range,c=getFirstRange().sel;if(a&&0<a.toString().length){if(a.startContainer==a.endContainer&&3==a.startContainer.nodeType){var b=a.startOffset,d=a.endOffset,e=a.cloneRange(),f=_iframeDoc.createElement("span");f.setAttribute("class","dextmark");f.innerText="dextmark";a.collapse(!0);a.insertNode(f);a.selectNode(f);a.setStartAfter(f);a.setEndAfter(f);a.setStart(f.nextSibling,d-b);a.setEnd(f.nextSibling,d-b);var g=_iframeDoc.createElement("span");
g.setAttribute("class","dextmark");g.innerText="dextmark"}else e=a.cloneRange(),f=_iframeDoc.createElement("span"),f.setAttribute("class","dextmark"),f.innerText="dextmark",a.collapse(!0),a.insertNode(f),c.removeAllRanges(),c.addRange(e),a=getFirstRange().range,g=_iframeDoc.createElement("span"),g.setAttribute("class","dextmark"),g.innerText="dextmark",a.collapse(!1);a.insertNode(g)}}catch(h){}}
function setRangeSelectionMarkInDesign(){try{if(!(DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion)){var a='<span class="dextmark">dextmark</span>',c=_iframeDoc.body.innerHTML.match(/<span ([^>]+)>dextmark<\/span>/i);null!=c&&(a=c[0]);var b,d;b=d=-1;b=_iframeDoc.body.innerText.indexOf(unescape("%uFEFF"));-1<b&&(d=_iframeDoc.body.innerText.indexOf(unescape("%uFEFF"),b+1));if(-1==b||-1==d){_iframeDoc.body.innerHTML=ReplaceAll(_iframeDoc.body.innerHTML,unescape("%uFEFF"),"");return}_iframeDoc.body.innerHTML=
ReplaceAll(_iframeDoc.body.innerHTML,unescape("%uFEFF"),a)}var e=getElementsByClass("dextmark",_iframeDoc,"span"),f=e.length;if(2==f){var g=e[0],h=e[1],m=getFirstRange().range;getFirstRange();m.setStartAfter(g);m.setEndBefore(h);var n=!0;rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(m)}for(a=f-1;0<=a;a--){var p=e[a];p.parentNode.removeChild(p)}e=getElementsByClass("dextmark",_iframeDoc,"span");f=e.length;for(a=f-1;0<=a;a--)p=e[a],p.parentNode.removeChild(p);
if(n&&(11<=DEXTTOP.DEXT5.browser.ieVersion||0==DEXTTOP.DEXT5.browser.ie)){var q=getClientRect(m.startContainer);_iframeWin.scroll(q.left,q.top)}}catch(u){}}
function makeRangeSelectionMarkInSource(a){try{var c,b;if(DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion){var d='<span class="dextmark">dextmark</span>',e=a.value.match(/<span class=(.+?)>dextmark<\/span>/i);null!=e&&(d=e[0]);c=b=d}else c=b=unescape("%uFEFF");if(document.selection){a.focus();var f=document.selection.createRange(),g=f.text;if(0!=g.length){var h=g.indexOf("<"),m=g.indexOf(">");-1<m&&(h>m||-1==h)&&f.moveStart("character",m+1);h=m=-1;h=g.lastIndexOf("<");m=g.lastIndexOf(">");
-1<h&&(h>m||-1==m)&&f.moveEnd("character",-(g.length-h));var n=f.duplicate();preCheckSpecialCharTextAreaOld(n)||(f=checkSpecialCharTextAreaOldIE(f),g=f.text,f.text=c+g+b)}}else if(a.selectionStart||"0"==a.selectionStart){var p=a.selectionStart,q=a.selectionEnd;if(p!=q){var u=a.value.substring(0,p),t=a.value.substring(p,q),v=a.value.substring(q,a.value.length),h=t.indexOf("<"),m=t.indexOf(">");-1<m&&(h>m||-1==h)&&(p+=m+1);h=m=-1;h=t.lastIndexOf("<");m=t.lastIndexOf(">");-1<h&&(h>m||-1==m)&&(q-=t.length-
h);if(!preCheckSpecialCharTextArea(a)){var u=a.value.substring(0,p),t=a.value.substring(p,q),v=a.value.substring(q,a.value.length),w=checkSpecialCharTextArea(u,t);0<w&&(p-=w);w=0;w=checkSpecialCharTextArea(t,v);0<w&&(q-=w);u=a.value.substring(0,p);t=a.value.substring(p,q);v=a.value.substring(q,a.value.length);a.value=u+c+t+b+v}}}}catch(x){}}
function preCheckSpecialCharTextArea(a){var c=["&nbsp;","&lt;","&gt;","&quot;","&amp;"],b=!1,d=a.selectionStart,e=a.selectionEnd,f=a.value.substring(0,d),d=a.value.substring(d,e);a=a.value.substring(e,a.value.length);e=f.lastIndexOf("<");f=f.lastIndexOf(">");if(e>=f)return!0;f=a.lastIndexOf(">");a=a.lastIndexOf("<");if(f<a&&-1<f)return!0;d=d.toLowerCase();if(-1==d.indexOf("&")&&-1==d.indexOf(";")&&4>=d.length)for(f=0;f<c.length;f++)if(-1<c[f].indexOf(d)){b=!0;break}return b}
function preCheckSpecialCharTextAreaOld(a){var c=["&nbsp;","&lt;","&gt;","&quot;","&amp;"],b=!1,d=a.duplicate(),e=a.text,e=ReplaceAll(e,unescape("\r"),""),e=e.toLowerCase();a.moveEnd("character",-e.length);for(var f=1;1E4>=f;f++){a.moveStart("character",-f);var g=a.text;if(-1<g.lastIndexOf(">"))break;if(-1<g.lastIndexOf("<"))return d.duplicate(),!0}a=d.duplicate();a.moveStart("character",e.length);for(f=1;1E4>=f;f++){a.moveEnd("character",f);g=a.text;if(-1<g.lastIndexOf("<"))break;if(-1<g.lastIndexOf(">"))return d.duplicate(),
!0}if(-1==e.indexOf("&")&&-1==e.indexOf(";")&&4>=e.length)for(a=c.length,f=0;f<a;f++)if(-1<c[f].indexOf(e)){b=!0;break}d.duplicate();return b}function checkSpecialCharTextArea(a,c){var b=["&nbsp;","&lt;","&gt;","&quot;","&amp;"],d=0;a=a.toLowerCase();c=c.toLowerCase();var e=a.split("&");if(1>=e.length)return d;var f=c.split(";");if(1>=f.length)return d;for(var g=!1,h="",h="&"+e[e.length-1]+f[0]+";",f=0;f<b.length;f++)if(b[f]==h){g=!0;break}g&&(d=e[e.length-1].length+1);return d}
function checkSpecialCharTextAreaOldIE(a){var c=a.duplicate(),b=a.text,b=ReplaceAll(b,unescape("\r"),"");a.moveStart("character",-7);a.moveEnd("character",-b.length);var d=a.text;a=c.duplicate();a.moveStart("character",b.length);a.moveEnd("character",7);var e=a.text;a=c.duplicate();c=checkSpecialCharTextArea(d,b);0<c&&a.moveStart("character",-c);c=checkSpecialCharTextArea(b,e);0<c&&a.moveEnd("character",-c);return a}
function setRangeSelectionMarkInSource(a){try{var c=a.value,b='<span class="dextmark">dextmark</span>',d=c.match(/<span ([^>]+)>dextmark<\/span>/i);null!=d&&(b=d[0]);var c=ReplaceAll(c,unescape("\r"),""),e,f;e=f=0;var g=c.indexOf(b);if(-1!=g){e=g;var c=c.replace(b,""),h=c.indexOf(b,e);-1!=h&&(f=h,c=c.replace(b,""),1<c.split(/^\s/g).length&&(c=c.replace(/^\s/g,""),--e),a.value=c,setTimeout(function(){a.focus();if("setSelectionRange"in a)a.setSelectionRange(e,f),a.focus(),a.setSelectionRange(e,f);else{var b=
a.createTextRange();b.collapse(!0);b.moveEnd("character",f);b.moveStart("character",e);a.focus();b.select()}if(DEXTTOP.DEXT5.browser.chrome||11<=DEXTTOP.DEXT5.browser.ieVersion){window.focus();document.body.focus();a.focus();var b=a.scrollHeight,c=parseIntOr0(a.style.fontSize),c=0==c?12*1.2:1.2*c;a.scrollTop=Math.floor(e/(a.value.length/(b/c)))*c}},0))}}catch(m){}}
function repairHtmlTableOrImageForGecko(){try{if(DEXTTOP.DEXT5.browser.gecko){for(var a=_iframeDoc.body.getElementsByTagName("IMG"),c=a.length,b=0;b<c;b++){var d=a[b],e=d.src;if("data:"==e.substring(0,5)){var f=e.split(",");if(2==f.length){var g=getExtFromImageDataSrc(f[0]);postBase64ImageToServer(f[1],g,d)}}}for(var h=_iframeDoc.body.getElementsByTagName("TABLE"),b=0;b<h.length;b++){var m=h[b];m.style.borderCollapse="collapse";m.style.fontFamily=DEXTTOP.G_CURREDITOR._setting.font_family;m.style.fontSize=
DEXTTOP.G_CURREDITOR._setting.font_size;m.setAttribute("cellSpacing","0");m.setAttribute("cellPadding","1");if("2"==DEXTTOP.G_CURREDITOR._config.showLineForBorderNone)for(var n=m.rows.length,p=0;p<n;p++)for(var q=m.rows[p].cells.length,a=0;a<q;a++)showBorderForNoneClass(m.rows[p].cells[a],"dext_table_border_t"),showBorderForNoneClass(m.rows[p].cells[a],"dext_table_border_l"),showBorderForNoneClass(m.rows[p].cells[a],"dext_table_border_r"),showBorderForNoneClass(m.rows[p].cells[a],"dext_table_border_b");
else for(var u=m.rows.length,a=0;a<u;a++){var t=m.rows[a];removeAttribute(t,"width");removeAttribute(t,"height");removeAttribute(t,"style");for(var v=t.cells.length,p=0;p<v;p++){var w=t.cells[p];w.style.border="1px solid #000000";"\u3000"==w.innerHTML&&(w.innerHTML="<p><br /></p>");removeAttribute(w,"class");0==parseIntOr0(w.style.height)&&0==parseIntOr0(w.height)&&(w.style.height="20px")}}}}}catch(x){}}
function setRemoveClass(a,c){if(checkIfIncluded("editor_layout.css")){for(var b=DEXTTOP.G_CURREDITOR.remove_item.length,d=0;d<b;d++)if("layout"==DEXTTOP.G_CURREDITOR.remove_item[d])return;for(var b=c.length,e=!1,f=_iframeDoc.body.innerHTML,d=0;d<b;d++)if(-1<f.indexOf(c[d])){e=!0;break}if(e)for(e=a.length,d=0;d<e;d++)for(var f=_iframeDoc.getElementsByTagName(a[d]),g=f.length,h=0;h<g;h++)for(var m=0;m<b;m++){var n=new RegExp("(\\s|^)"+c[m]+"(\\s|$)");n.test(f[h].className)&&(f[h].className=DEXTTOP.DEXT5.util.trim(f[h].className.replace(n,
" ")));""==DEXTTOP.DEXT5.util.trim(f[h].className)&&f[h].removeAttribute("class")}}}
function setAddClass(a,c){if(checkIfIncluded("editor_layout.css")){for(var b=DEXTTOP.G_CURREDITOR.remove_item.length,d=0;d<b;d++)if("layout"==DEXTTOP.G_CURREDITOR.remove_item[d])return;b=a.length;for(d=0;d<b;d++)for(var e=_iframeDoc.getElementsByTagName(a[d]),f=e.length,g=0;g<f;g++)for(var h=c.length,m=0;m<h;m++)(new RegExp("(\\s|^)"+c[m]+"(\\s|$)")).test(e[g].className)||(e[g].className+=" "+c[m],e[g].className=DEXTTOP.DEXT5.util.trim(e[g].className))}}
function checkIfIncluded(a,c){var b;b=void 0==c?_iframeDoc.getElementsByTagName("link"):c.getElementsByTagName("link");for(var d=0;d<b.length;d++)if(-1<b[d].href.indexOf(a))return!0;return!1}
function getDirectionNode(a,c,b,d){a=[];b=GetTDTHCell(b);c=GetTableSelectionCells();if(null==b&&0==c.length){c=",body,";var e=d.length;for(b=0;b<e;b++)null!=d[b]&&null!=d[b].parentNode&&void 0!=d[b].parentNode.tagName&&-1<c.indexOf(","+d[b].parentNode.tagName.toLowerCase()+",")&&-1<",a,abbr,acronym,address,applet,area,b,baseFont,bdo,big,blink,blockQuote,body,button,caption,center,cite,code,col,colGroup,dd,del,dfn,dir,div,dl,dt,em,embed,fieldSet,font,form,H1,H2,H3,H4,H5,H6,head,hr,html,i,iframe,img,input:button,input:checkbox,input:file,input:image,input:password,input:radio,input:range,input:reset,input:search,input:submit,input:text,ins,isIndex,kbd,keygen,label,legend,li,link,listing,map,marquee,menu,meta,nobr,noFrames,noScript,object,ol,optGroup,option,p,plainText,pre,q,rt,ruby,s,samp,select,small,span,strike,strong,style,sub,sup,table,tBody,td,textArea,tFoot,th,tHead,title,tr,tt,u,ul,var,xmp,".indexOf(","+d[b].tagName.toLowerCase()+
",")&&a.push(d[b])}else if(null!=b&&0==c.length)for(c=",th,td,",e=d.length,b=0;b<e;b++)null!=d[b]&&null!=d[b].parentNode&&void 0!=d[b].parentNode.tagName&&-1<c.indexOf(","+d[b].parentNode.tagName.toLowerCase()+",")&&(null==d[b].firstChild?a.push(d[b].parentNode):-1<",a,abbr,acronym,address,applet,area,b,baseFont,bdo,big,blink,blockQuote,body,button,caption,center,cite,code,col,colGroup,dd,del,dfn,dir,div,dl,dt,em,embed,fieldSet,font,form,H1,H2,H3,H4,H5,H6,head,hr,html,i,iframe,img,input:button,input:checkbox,input:file,input:image,input:password,input:radio,input:range,input:reset,input:search,input:submit,input:text,ins,isIndex,kbd,keygen,label,legend,li,link,listing,map,marquee,menu,meta,nobr,noFrames,noScript,object,ol,optGroup,option,p,plainText,pre,q,rt,ruby,s,samp,select,small,span,strike,strong,style,sub,sup,table,tBody,td,textArea,tFoot,th,tHead,title,tr,tt,u,ul,var,xmp,".indexOf(","+
d[b].tagName.toLowerCase()+",")?a.push(d[b]):void 0==d[b].firstChild.tagName?a.push(d[b].parentNode):a.push(d[b]));else if(null!=b&&0<c.length)for(b=0;b<c.length;b++){d=c[b].getElementsByTagName("*");for(idx2=0;idx2<d.length;idx2++)d[idx2].dir="";a.push(c[b])}return a}
function CheckCommand(a,c){if("bold"==a){var b=c.getElementsByTagName("b"),d=c.getElementsByTagName("strong");return 0<b.length+d.length?!0:!1}return"italic"==a?(b=c.getElementsByTagName("em"),d=c.getElementsByTagName("i"),0<b.length+d.length?!0:!1):"underline"==a?0<c.getElementsByTagName("u").length?!0:!1:"strike_through"==a?0<c.getElementsByTagName("strike").length?!0:!1:"superscript"==a?0<c.getElementsByTagName("sup").length?!0:!1:"subscript"==a?0<c.getElementsByTagName("sub").length?!0:!1:"list_number"==
a?0<c.getElementsByTagName("ol").length?!0:!1:"list_bullets"==a?0<c.getElementsByTagName("ul").length?!0:!1:!1}
function officePasteCleanForTable(a){var c=document.createElement("div");c.innerHTML=a;a=c.getElementsByTagName("table");for(var b=a.length,d=0;d<b;d++){null==a[d].getAttribute("cellpadding")||a[d].getAttribute("cellpadding");var e="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode;if(DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&!e&&"1"==DEXTTOP.G_CURREDITOR._config.removeColgroup){var e=a[d].getElementsByTagName("colgroup"),f=e.length;if(0<f){e=!1;try{for(var g=a[d].getElementsByTagName("td"),
h=g.length,f=0;f<h;f++)if(g[f].getAttribute("width")&&""!=g[f].getAttribute("width")||""!=g[f].style.width){e=!0;break}}catch(m){e=!0}if(e)for(e=a[d].getElementsByTagName("colgroup"),f=e.length,--f;0<=f;f--)try{a[d].removeChild(e[f])}catch(n){}}}for(var p=a[d].rows.length,f=0;f<p;f++){var q=a[d].rows[f];removeAttributeForPasteTable(q);var u=q.cells.length;if(0==u)q.innerHTML="";else for(e=0;e<u;e++){var t=q.cells[e];1==t.childNodes.length?""!=t.childNodes[0].innerHTML&&"&nbsp;"!=t.childNodes[0].innerHTML||
0!=t.innerHTML.indexOf("<p")||(t.innerHTML=getCellDefValue()):0!=t.childNodes.length||""!=t.innerHTML&&"&nbsp;"!=t.innerHTML||(t.innerHTML=getCellDefValue())}}if(DEXTTOP.DEXT5.browser.gecko)for(""==a[d].style.borderCollapse&&(a[d].style.borderCollapse="collapse"),p=a[d].rows.length,f=0;f<p;f++)for(q=a[d].rows[f],removeAttribute(q,"width"),removeAttribute(q,"height"),removeAttribute(q,"style"),u=q.cells.length,e=0;e<u;e++)t=q.cells[e],""==t.style.borderTop&&(t.style.borderTop="1px solid #000000"),
""==t.style.borderRight&&(t.style.borderRight="1px solid #000000"),""==t.style.borderBottom&&(t.style.borderBottom="1px solid #000000"),""==t.style.borderLeft&&(t.style.borderLeft="1px solid #000000"),"\u3000"==t.innerHTML&&(t.innerHTML="<p><br /></p>"),0==parseIntOr0(t.style.height)&&0==parseIntOr0(t.height)&&(t.style.height="20px");if("2"==DEXTTOP.G_CURREDITOR._config.showLineForBorderNone)for(f=a[d].rows.length,e=0;e<f;e++)for(p=a[d].rows[e].cells.length,q=0;q<p;q++)showBorderForNoneClass(a[d].rows[e].cells[q],
"dext_table_border_t"),showBorderForNoneClass(a[d].rows[e].cells[q],"dext_table_border_l"),showBorderForNoneClass(a[d].rows[e].cells[q],"dext_table_border_r"),showBorderForNoneClass(a[d].rows[e].cells[q],"dext_table_border_b")}return a=c.innerHTML}
function checkExistCustomData(a){var c=_iframeDoc.createElement("div");c.innerHTML=a;a=c.getElementsByTagName("img");for(var b=!1,d=a.length-1;0<=d;d--){var e=a[d].getAttribute("dext5customdata");null!=e&&void 0!=e&&(e=getDextCustomData(e),null==e||void 0==e)&&(b=a[d].parentNode,b.removeChild(a[d]),""==b.innerHTML&&(b.innerHTML="&nbsp;"),b=!0)}b&&alert(dext5_lang.msg.checkCustomData);""==c.innerHTML&&(c.innerHTML="&nbsp");return c.innerHTML}
function getEditorFrameDoc(a){setDEXTWINDOC();a=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+a.ID);return getIframeDocument(a)}
function getMyFirstChildElementNode(a){try{if(3==a.nodeType)return a.parentNode;for(;null!=a.childNodes&&0<a.childNodes.length;){a=a.firstChild;if(3==a.nodeType)return a.parentNode;if("P"==a.tagName&&""==a.innerHTML)return a;if("BR"==a.tagName||"IMG"==a.tagName)return a.parentNode;if("TABLE"==a.tagName)return getMyFirstChildElementNode(a.getElementsByTagName("td")[0]);if("OL"==a.tagName||"UL"==a.tagName)return getMyFirstChildElementNode(a.getElementsByTagName("li")[0])}return 1==a.nodeType&&a.parentNode&&
"BODY"!=a.parentNode.tagName?a:null}catch(c){return null}}
function setFocusFirstChildForStyle(a){var c=getMyFirstChildElementNode(a);if(null==c)setFocusToBody();else if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){for(var c=a.childNodes,b=c.length,d=!0,e=0;e<b;e++)if(1==c[e].nodeType&&"p"==c[e].tagName.toLowerCase()){doSetCaretPosition(c[e],0);setMenuIconRealable(c[e]);d=!1;break}if(d){c=a.lastChild;if(3==c.nodeType||"table"==c.tagName.toLowerCase())c=_iframeDoc.createElement("p"),DEXTTOP.DEXT5.browser.ie&&
11>DEXTTOP.DEXT5.browser.ieVersion?c.innerHTML="&nbsp;":(b=_iframeDoc.createElement("br"),c.appendChild(b)),a.appendChild(c);doSetCaretPosition(c,0);setMenuIconRealable(c)}}else"TEXTAREA"==c.tagName?setFocusToBody():(doSetCaretPosition(c,0),setMenuIconRealable(c))}
function repairPasteTextInCell(a){if(0==DEXTTOP.DEXT5.browser.ie||6!=G_dext5plugIn.getHTMLFormatFromType)return a;var c=a,b=a.substring(0,6);if("<TABLE"==b||"<table"==b){if(getFirstRange(),b=document.createElement("div"),b.innerHTML=a,1==b.childNodes.length&&1==b.childNodes[0].nodeType&&"TABLE"==b.childNodes[0].tagName){a=b.getElementsByTagName("td");if(1==a.length){var c=a[0].innerHTML,d=a[0].childNodes,e=a[0].getElementsByTagName("p");1==e.length&&d[0]&&1==d[0].nodeType&&"P"==d[0].tagName&&(c=d[0].innerHTML)}0==
a.length&&(a=b.getElementsByTagName("th"),1==a.length&&(c=a[0].innerHTML,d=a[0].childNodes,e=a[0].getElementsByTagName("p"),1==e.length&&d[0]&&1==d[0].nodeType&&"P"==d[0].tagName&&(c=d[0].innerHTML)))}}else b=a.toLowerCase(),-1<b.indexOf("starthtml")&&-1<b.indexOf("startfragment")&&-1<b.indexOf("<body ")&&-1<b.indexOf("</body")&&(b="<BODY",-1==a.indexOf(b)&&(b="<body"),c="</BODY>",-1==a.indexOf(c)&&(c="</body>"),a=a.substring(a.indexOf(b)),a=a.substring(a.indexOf(">")+1),c=a=a.substring(0,a.indexOf(c)));
return c}
function htmlTagRevision(a,c,b){var d=a;if(""!=d&&(DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.gecko))try{if("ieplugin"!=DEXTTOP.G_CURREDITOR._config.runtimes){var e=RegExp("<[^>]+style=(.*?)>","gi"),f="",g=!1;try{var h=d.match(e);if(h){for(var m=h.length,e=0;e<m;e++)d=d.replace(h[e],"_DEXT_T_S{"+e+"}_");for(e=0;e<m;e++){var n=h[e];-1<n.indexOf("-font-family")&&(n=n.replace("-font-family","-font-dext-family"));var p=!1;0>n.indexOf("font-family")&&(p=!0);-1<n.indexOf("-font-dext-family")&&(n=n.replace("-font-dext-family",
"-font-family"));p&&(n=n.replace(/mso-fareast-font-family/gi,"font-family"));d=d.replace("_DEXT_T_S{"+e+"}_",n)}}}catch(q){g=!0}g&&(d=a)}c&&(d=DEXT5_EDITOR.HTMLParser.RemoveOfficeTag(d,b));var f=d.toLowerCase(),u=realValue2=d,t=f.lastIndexOf("<body"),v=f.indexOf("</body");if(-1<t&&-1<v)try{var w=u.substring(v),x=u.substring(t).indexOf(">"),y=u.substring(0,t+x+1),d=u.substring(t+x+1,v)}catch(z){t=v=-1,d=realValue2}d=DEXT5_EDITOR.HTMLParser.HTMLtoXML(d,b);-1<t&&-1<v&&(d=y+d+w)}catch(C){return a}else if("1"==
DEXTTOP.G_CURREDITOR._config.removeComment)for(c=d.indexOf("\x3c!--"),a=d.indexOf("--\x3e");-1<c&&-1<a;)c=d.substring(0,c),d=d.substring(a+3),d=c+d,c=d.indexOf("\x3c!--"),a=d.indexOf("--\x3e");else d=d.replace(/--\x3e\s</gi,"--\x3e<");return d}function findParentNode(a,c){var b=c.parentNode;if("HTML"==b.tagName||"BODY"==b.tagName)return!1;for(;"BODY"!=b.tagName;){if(b==a)return!0;b=b.parentNode}return!1}
function executeTextAlign(a,c){var b=null,b=DEXTTOP.DEXT5.browser.ie?getElementsFromSelection():getNodesInRange(a),d=GetTDTHCell(a.startContainer);if(null!=d)for(var e=b,f=e.length,b=[],g=0;g<f;g++)1==findParentNode(d,e[g])&&b.push(e[g]);d=b.length;e=chkAlign="";e=null;for(g=0;g<d;g++)if(e=b[g].nodeName.toLowerCase(),"p"==e||"div"==e)chkAlign="justifyFull"==c?"justify":c.substring(7).toLowerCase(),e=b[g],e.style.textAlign!=chkAlign&&(e.style.textAlign=chkAlign)}
function removeNbspInPTag(a){try{var c="BackCompat"==a._DOC.compatMode;if(DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&11>DEXTTOP.DEXT5.browser.ieVersion&&1!=c){var b=a._BODY.childNodes,d=b.length;for(a=0;a<d;a++){var e=b[a];1==e.nodeType&&"P"==e.tagName&&"&nbsp;"==e.innerHTML&&(e.innerHTML="")}}}catch(f){}}function _iframeDoc_OnDropOver(a){setDEXTWINDOC();var c=a?a:_iframeWin.event;currElem=c.target?c.target:c.srcElement;DEXTTOP.DEXT5.util.cancelEvent(a)}
function getElementsFromSelection(){function a(a){return a.parentElement?a.parentElement():a.commonAncestorContainer}function c(a,b){var c=null;a.compareEndPoints?c={method:"compareEndPoints",StartToStart:"StartToStart",StartToEnd:"StartToEnd",EndToEnd:"EndToEnd",EndToStart:"EndToStart"}:a.compareBoundaryPoints&&(c={method:"compareBoundaryPoints",StartToStart:0,StartToEnd:1,EndToEnd:2,EndToStart:3});return c&&!(1==b[c.method](c.StartToStart,a)&&1==b[c.method](c.EndToEnd,a)&&1==b[c.method](c.StartToEnd,
a)&&1==b[c.method](c.EndToStart,a)||-1==b[c.method](c.StartToStart,a)&&-1==b[c.method](c.EndToEnd,a)&&-1==b[c.method](c.StartToEnd,a)&&-1==b[c.method](c.EndToStart,a))}function b(a){var b=null;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion?_iframeDoc.body.createTextRange?(b=_iframeDoc.body.createTextRange(),b.moveToElementText(a)):_iframeDoc.createRange&&(b=_iframeDoc.createRange(),b.selectNodeContents(a)):_iframeDoc.createRange?(b=_iframeDoc.createRange(),b.selectNodeContents(a)):_iframeDoc.body.createTextRange&&
(b=_iframeDoc.body.createTextRange(),b.moveToElementText(a));return b}var d=null,e=[],f,g;if(g=function(){var a=null;_iframeWin.getSelection?(a=_iframeWin.getSelection())&&a.rangeCount&&a.getRangeAt&&(a=a.getRangeAt(0)):_iframeDoc.selection&&(a=_iframeDoc.selection.createRange());return a}())if(f=a(g)){for(;1!=f.nodeType;)f=f.parentNode;if("body"!=f.nodeName.toLowerCase()){d=f;do d=d.parentNode,e[e.length]=d;while("body"!=d.nodeName.toLowerCase())}for(var d=f.all||f.getElementsByTagName("*"),h=0;h<
d.length;h++)e[e.length]=d[h];d=[f];for(f=0;f<e.length;f++)(h=b(e[f]))&&c(g,h)&&(d[d.length]=e[f])}return d}function checkCopyInCellFormInertnNet(a){var c="";if(DEXTTOP.DEXT5.browser.ie&&/body[^>]*>(\s+)*<div *([^>])*>/i.test(a)){var b=a.indexOf("\x3c!--StartFragment--\x3e"),d=a.lastIndexOf("\x3c!--EndFragment--\x3e");-1<b&&-1<d&&(a=a.substr(b+20),d=a.lastIndexOf("\x3c!--EndFragment--\x3e"),-1<d&&(c=a=a.substring(0,d)))}return c}
function setGlobalTableDefaultValue(){try{ActiveLastTable=ActiveCurrTable=DrageEndCell=DrageStartCell=null}catch(a){}}
function replaceBrTag(a){try{var c=a._DOC,b=a._BODY,d=b.childNodes;for(i=d.length-1;0<=i;i--){var e=d[i];if(1==e.nodeType&&"BR"==e.tagName&&(null==e.previousSibling||e.previousSibling&&3!=e.previousSibling.nodeType)){var f=c.createElement("p");b.insertBefore(f,e);DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion?(f.innerHTML="&nbsp;",b.removeChild(e)):f.appendChild(e)}}}catch(g){}}
function showImageEditor(){if(G_dext5plugIn){setFocusTopWindow();var a=G_dext5plugIn.setScreenCapture(1);""!=a?(dialogCancel(),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),insertNodeLikePasteHtml(a),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0):dialogCancel()}}function checkCanPasteToIamge(){var a=!1;try{G_dext5plugIn&&1==G_dext5plugIn.canPasteImageFromClipBoard()&&(a=!0)}catch(c){a=!1}return a}
function wrapPtagForNotBlockTag(a){if("1"==a._config.wrapPtagToSource)try{for(var c=a._BODY.innerHTML,b=a._BODY.childNodes,d=[],e=b.length-1;0<=e;e--){if(b[e].tagName&&checkBlockTag(b[e].tagName)){if(0<d.length){for(var f=_iframeDoc.createElement("p"),g=d.length-1;0<=g;g--)f.appendChild(d[g]),b[e].nextSibling?_iframeDoc.body.insertBefore(f,b[e].nextSibling):_iframeDoc.body.appendChild(f);d=[]}}else 8!=b[e].nodeType&&d.push(b[e]);if(0==e&&0<d.length){f=_iframeDoc.createElement("p");for(g=d.length-
1;0<=g;g--)f.appendChild(d[g]),_iframeDoc.body.insertBefore(f,_iframeDoc.body.firstChild);d=[]}}}catch(h){a._BODY.innerHTML=c}}function checkBlockTag(a){if(void 0!=a&&""!=a){var c=!1,b="p div table ol ul hr h1 h2 h3 h4 h5 h6 dl blockquote iframe pre c:if c:choose c:foreach c:set script style center".split(" "),d=b.length;a=a.toLowerCase();for(var e=0;e<d;e++)if(b[e]==a){c=!0;break}return c}}
function checkExistClassName(a,c){for(var b=a.split(" "),d=b.length,e=!1,f=0;f<d;f++)if(b[f]==c){e=!0;break}return e}function setClassName(a,c){for(var b=c,d=a.className,e=!1,f=d.split(" "),g=f.length,h=0;h<g;h++)if(f[h]==c){e=!0;break}0==e&&(""!=d&&(b=" "+b),a.className=d+b)}function removeClassName(a,c){var b=c,d=a.className;0<d.indexOf(b)&&(b=" "+b);d=d.replace(b,"");""==d?a.getAttribute("class")?a.removeAttribute("class"):a.removeAttribute("className"):a.className=d}
function showBorderForNoneClass(a,c){if("0"!=DEXTTOP.G_CURREDITOR._config.showLineForBorderNone){var b="";switch(c){case "dext_table_border_b":b="Bottom";break;case "dext_table_border_t":b="Top";break;case "dext_table_border_l":b="Left";break;case "dext_table_border_r":b="Right"}var d=checkExistClassName(a.className,c);""==a.style["border"+b+"Width"]&&""==a.style["border"+b+"Style"]?d||setClassName(a,c):-1<a.style["border"+b+"Width"].indexOf("0")&&0==parseIntOr0(a.style["border"+b+"Width"])||"none"==
a.style["border"+b+"Style"]?d||setClassName(a,c):d&&removeClassName(a,c)}}
function setBorderTableAndAllCell(a,c){for(var b=a.rows.length,d=0;d<b;d++)for(var e=a.rows[d],f=e.cells.length,g=0;g<f;g++){var h=e.cells[g];0==g&&(""!=c.outsideLeft&&(h.style.borderLeft=c.outsideLeft,showBorderForNoneClass(h,"dext_table_border_l")),g!=f-1&&""!=c.insideCol&&(h.style.borderRight=c.insideCol,showBorderForNoneClass(h,"dext_table_border_r")),""!=c.insideRow&&(0==d&&d!=b-1&&(h.style.borderBottom=c.insideRow,showBorderForNoneClass(h,"dext_table_border_b")),0<d&&d==b-1&&(h.style.borderTop=
c.insideRow,showBorderForNoneClass(h,"dext_table_border_t")),0<d&&d!=b-1&&(h.style.borderTop=c.insideRow,showBorderForNoneClass(h,"dext_table_border_t"),h.style.borderBottom=c.insideRow,showBorderForNoneClass(h,"dext_table_border_b"))));g==f-1&&(""!=c.outsideRight&&(h.style.borderRight=c.outsideRight,showBorderForNoneClass(h,"dext_table_border_r")),0!=g&&""!=c.insideCol&&(h.style.borderLeft=c.insideCol,showBorderForNoneClass(h,"dext_table_border_l")),""!=c.insideRow&&(0==d&&d!=b-1&&(h.style.borderBottom=
c.insideRow,showBorderForNoneClass(h,"dext_table_border_b")),0<d&&d==b-1&&(h.style.borderTop=c.insideRow,showBorderForNoneClass(h,"dext_table_border_t")),0<d&&d!=b-1&&(h.style.borderTop=c.insideRow,showBorderForNoneClass(h,"dext_table_border_t"),h.style.borderBottom=c.insideRow,showBorderForNoneClass(h,"dext_table_border_b"))));0<g&&g!=f-1&&""!=c.insideCol&&(h.style.borderLeft=c.insideCol,showBorderForNoneClass(h,"dext_table_border_l"),h.style.borderRight=c.insideCol,showBorderForNoneClass(h,"dext_table_border_r"));
0==d&&(""!=c.outsideTop&&(h.style.borderTop=c.outsideTop,showBorderForNoneClass(h,"dext_table_border_t")),d!=b-1&&""!=c.insideRow&&(h.style.borderBottom=c.insideRow,showBorderForNoneClass(h,"dext_table_border_b")));d==b-1&&(""!=c.outsideBottom&&(h.style.borderBottom=c.outsideBottom,showBorderForNoneClass(h,"dext_table_border_b")),0!=d&&""!=c.insideRow&&(h.style.borderTop=c.insideRow,showBorderForNoneClass(h,"dext_table_border_t")));0<d&&d!=b-1&&0<g&&g!=f-1&&(""!=c.insideRow&&(h.style.borderTop=c.insideRow,
showBorderForNoneClass(h,"dext_table_border_t"),h.style.borderBottom=c.insideRow,showBorderForNoneClass(h,"dext_table_border_b")),""!=c.insideCol&&(h.style.borderLeft=c.insideCol,showBorderForNoneClass(h,"dext_table_border_l"),h.style.borderRight=c.insideCol,showBorderForNoneClass(h,"dext_table_border_r")))}}
function replaceClassForBorder(a,c,b){if("0"!=a._config.showLineForBorderNone){a=["dext_table_border_t","dext_table_border_r","dext_table_border_b","dext_table_border_l"];for(var d=0;d<a.length;d++){var e=[];"hidden"==b?e=getElementsByClass(a[d],c):"show"==b&&(e=getElementsByClass("_"+a[d],c));for(var f=e.length,g=0;g<f;g++){var h=e[g].className;"hidden"==b?h=h.replace(a[d],"_"+a[d]):"show"==b&&(h=h.replace("_"+a[d],a[d]));e[g].className=h}}}}
function attachFileImage(a,c){var b="url("+DEXTTOP.G_CURREDITOR._config.webPath.image+"icon/",b=-1<c.file_ext.indexOf("doc")?b+"word.png":-1<c.file_ext.indexOf("ppt")?b+"ppt.png":-1<c.file_ext.indexOf("xls")?b+"excel.png":-1<c.file_ext.indexOf("hwp")?b+"hwp.png":-1<c.file_ext.indexOf("pdf")?b+"pdf.png":-1<c.file_ext.indexOf("txt")?b+"txt.png":b+"file.png";a.style.paddingLeft="22px";a.style.paddingTop="3px";a.style.paddingBottom="3px";a.style.background=b+")";a.style.backgroundRepeat="no-repeat";a.style.backgroundPosition=
"0% 50%";a.style.lineHeight="1.4"}function replaceClassForBookmark(a,c,b){a=a._contentsClass;for(var d=a.length,e=0;e<d;e++){var f=[];"hidden"==b?f=getElementsByClass(a[e],c):"show"==b&&(f=getElementsByClass("_"+a[e],c));for(var g=f.length,h=0;h<g;h++){var m=f[h].className;"hidden"==b?m=m.replace(a[e],"_"+a[e]):"show"==b&&(m=m.replace("_"+a[e],a[e]));f[h].className=m}}}
function removeIncorrectSpaceInTag(a){if("1"==DEXTTOP.G_CURREDITOR._config.removeSpaceInTagname){if(void 0!=a&&""!=a)try{var c=a,b=RegExp("<(\\s+)[a-z|/]","gi"),d=c.match(b);if(d)for(var e=d.length,f=0;f<e;f++)var g=d[f],h=/\s+/.exec(g),m=h[0].replace(RegExp("\\s","gi"),""),g=g.replace(h,m),c=c.replace(d[f],g);b=RegExp("<\\/(\\s+)[a-z]","gi");if(d=c.match(b))for(e=d.length,f=0;f<e;f++)g=d[f],h=/\s+/.exec(g),m=h[0].replace(RegExp("\\s","gi"),""),g=g.replace(h,m),c=c.replace(d[f],g);return c}catch(n){return a}}else return a}
function removeDummyfontTagInTable(a){var c=a;try{var b=RegExp("<font ([^>]+)>\\s</font>","gi");a=a.replace(b,"<font $1>&nbsp;</font>");b=RegExp("<font ([^>]+)>\\s+</font>","gi");return a=a.replace(b,"<font $1></font>")}catch(d){return c}}
function setChangeModeForSetApi(a,c){if(1!=c&&"design"!=a._currentMode){var b="design";ClearDraggingTableCellSelected();Mouse_Status=Mouse_IsPlain;g_findRepalceRange=ActiveCurrTable=DrageStartCell=null;a._iconSelected();for(var d=null,e=["top_design","top_source","top_preview","top_text"],f=0,g=e.length;f<g;f++)d=document.getElementById("ue_"+a.ID+e[f]),null!=d&&((0>b.indexOf("top_")?"top_"+b:b)==e[f]?d.className="on":d.className="");for(var h=e=null,d=["design","source","preview","text"],b=b.replace("top_",
""),f=0,g=d.length;f<g;f++)e=document.getElementById("ue_"+a.ID+d[f]),h=document.getElementById("dext5_"+d[f]+"_"+a.ID),null!=e&&(b==d[f]?(e.className=a._config.style.skinName,e.getElementsByTagName("A")[0].className="color_on",e.style.backgroundImage="url("+a._config.webPath.image+"skin/"+a._config.style.skinName+"/ue_btn_bg.gif)",h.style.height="100%",h.style.width="100%",DEXTTOP.DEXT5.browser.gecko||(h.style.display="",h.style.overflow=""),a._LastRange=null,setFocusToBody()):(e.className="",e.getElementsByTagName("A")[0].className=
"",e.style.backgroundImage="",h.style.width="0px",h.style.height="0px",DEXTTOP.DEXT5.browser.gecko||(h.style.display="none",h.style.overflow="hidden"),h.blur()),e=document.getElementById("ue_diabled_div_"+a.ID),"BackCompat"==document.compatMode&&(e.style.height=document.getElementById("ue_toolbar_"+a.ID).scrollHeight+"px"),document.getElementById("ue_toolbar_"+a.ID).style.position="relative",e.style.width="design"==b?"0px":document.getElementById("ue_toolbar_"+a.ID).scrollWidth+"px");switch(a._currentMode){case "source":switch(b){case "design":ReplaceRealObjectToImage(),
setAddClass(["td","th"],["DEXT_dot"])}break;case "preview":switch(b){case "design":FixFlashError(),ReplaceRealObjectToImage(),setAddClass(["td","th"],["DEXT_dot"])}}a._currentMode=b;-1<b.indexOf("design")&&setFocusFirstChildForStyle(a._BODY)}}
function insertImageSrc(a,c,b){if(1!=b)if(c)0>c.indexOf("file:/")&&0>c.indexOf(DEXTTOP.DEXT5.rootPath+"images")&&a.setImageArr.push(c);else{a.setImageArr=[];c=a._DOC.getElementsByTagName("img");b=c.length;for(var d=0;d<b;d++)""==c[d].style.marginRight.toString()&&""==c[d].style.marginLeft.toString()&&""!=c[d].hspace.toString()&&(c[d].style.marginLeft=c[d].hspace+"px",c[d].style.marginRight=c[d].hspace+"px",c[d].removeAttribute("hspace")),""==c[d].style.marginTop.toString()&&""==c[d].style.marginBottom.toString()&&
""!=c[d].vspace.toString&&(c[d].style.marginTop=c[d].vspace+"px",c[d].style.marginBottom=c[d].vspace+"px",c[d].removeAttribute("vspace")),0>c[d].src.indexOf("file:/")&&0>c[d].src.indexOf(DEXTTOP.DEXT5.rootPath+"images")&&a.setImageArr.push(c[d].src)}}function checkPasteImage(a){if("1"==DEXTTOP.G_CURREDITOR._config.eventForPasteImage){var c=_iframeDoc.createElement("div");c.innerHTML=a;a=c.getElementsByTagName("img");if(0<a.length)try{DEXTTOP.DEXTWIN.dext_paste_image_event(a)}catch(b){}}}
function replaceSpanToDivContainAbsolute(a){var c=a.innerHTML,b=!1;try{for(var d=a.getElementsByTagName("table"),e=d.length-1;0<=e;e--){var f=GetParentbyTagName(d[e],"span");if(f&&"absolute"==f.style.position){var g=document.createElement("div");setCopyAllObjectAtributes(f,g,!0);f.parentNode.insertBefore(g,f);f.parentNode.removeChild(f);b=!0}}}catch(h){a.innerHTML=c}return b}
function insertCarriageReturn(a,c){"1"==a._config.insertCarriageReturn&&(c=c.replace(/<\/style>/gi,"</style>\r\n"),c=c.replace(/<\/p>/gi,"</p>\r\n"),c=c.replace(/<br>/gi,"<br>\r\n"),c=c.replace(/<br \/>/gi,"<br />\r\n"),c=c.replace(/<br\/>/gi,"<br/>\r\n"),c=c.replace(/<\/span><\/span>/gi,"</span></span\r\n>"),c=c.replace(/<\/tr>/gi,"</tr>\r\n"),c=c.replace(/<\/td>/gi,"</td>\r\n"),c=c.replace(/<\/th>/gi,"</th>\r\n"));return c}
function removeCarriageReturn(a,c){"1"==a._config.insertCarriageReturn&&(c=c.replace(/<\/style>\r\n/gi,"</style>"),c=c.replace(/<\/p>\r\n/gi,"</p>"),c=c.replace(/<br>\r\n/gi,"<br>"),c=c.replace(/<br \/>\r\n/gi,"<br />"),c=c.replace(/<br\/>\r\n/gi,"<br/>"),c=c.replace(/<\/style>\s/gi,"</style>"),c=c.replace(/<\/p>\s/gi,"</p>"),c=c.replace(/<br>\s/gi,"<br>"),c=c.replace(/<br \/>\s/gi,"<br />"),c=c.replace(/<br\/>\s/gi,"<br/>"),c=c.replace(/<\/tr>\r\n/gi,"</tr>"),c=c.replace(/<\/tr>\s/gi,"</tr>"),c=
c.replace(/<\/td>\r\n/gi,"</td>"),c=c.replace(/<\/td>\s/gi,"</td>"),c=c.replace(/<\/th>\r\n/gi,"</th>"),c=c.replace(/<\/th>\s/gi,"</th>"));return c}function removeStripTags(a,c){var b=c&&0!=c.length?"<\\/?(?!("+c.join("|")+"))\\b[^>]*>":"</?[^>]*>";return a.replace(new RegExp(b,"gi"),"")}function unhtmlSpecialChars(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;/g,"&")}
function htmlSpecialChars(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;")}var StringBuffer=function(){this.buffer=[]};StringBuffer.prototype.append=function(a){this.buffer[this.buffer.length]=a};StringBuffer.prototype.toString=function(){return this.buffer.join("")};
function addLineBreaker(a,c){if("br"===a.toLowerCase())return"<p>"+c.replace(/\r?\n/g,"<BR />")+"</p>";c=c.replace(/\r?\n/g,"\n");for(var b=new StringBuffer,d=c.split("\n"),e=d.length,f="",g=0;g<e;g++){f=DEXTTOP.DEXT5.util.trim(d[g]);if(g===e-1&&""===f)break;null!==f&&""!==f?(b.append("<P>"),b.append(d[g]),b.append("</P>")):DEXTTOP.DEXT5.browser.ie&&10>=DEXTTOP.DEXT5.browser.ieVersion?b.append("<P>&nbsp;</P>"):b.append("<P><BR></P>")}return b.toString()}
function checkContainClass(a,c){var b=!1;if(""!=c&&a.className&&""!=a.className)for(var d=a.className.split(" "),e=d.length,f=0;f<e;f++)if(d[f]==c){b=!0;break}return b}
function addDisalbeItemForNoActionTable(a){return a=a.concat("table_selection table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight table_group table_group_detail insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column convert_table_to_text cell_border cell_bg_color table_indent table_outdent table_tool insert_row insert_column table_select align_vertical table_copy cell_size".split(" "))}
function insertDropImage(a){var c=a.dataTransfer.files;if(0<c.length){var b=getEditrFromEvent(a);dext_src_init(b._EDITOR.design);restoreSelection();setFocusToBody();if(DEXTTOP.DEXT5.browser.ie){var d=b._BODY.lastChild;if(1!=d.nodeType||"P"!=d.tagName)d=b._DOC.createElement("p"),b._BODY.appendChild(d);doSetCaretPosition(d,1)}a.stopPropagation();a.preventDefault();handleFiles(c[0],b)}}
function handleFiles(a,c){for(var b=c._config.allowImageFileType.concat([]),d=!1,e=a.name.substring(a.name.lastIndexOf(".")+1).toLowerCase(),f=0;f<b.length;f++)if(b[f]==e){d=!0;break}1==d&&("txt"==e?(b=new FileReader,b.onload=function(a){a=htmlSpecialChars(a.target.result);a=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,a);DEXTTOP.DEXT5.browser.ie?pasteHtmlAtCaretHuge(a):c._DOC.execCommand("inserthtml",!1,a)},b.readAsText(a)):(b=new FileReader,b.onload=function(a){a=a.target.result;if("data:"==
a.substring(0,5)&&(a=a.split(","),2==a.length)){var b=getExtFromImageDataSrc(a[0]);postBase64ImageToServer(a[1],b)}},b.readAsDataURL(a)))}
function setScrollOverflow(a){switch(a._config.scrollOverflow){case "0":a._BODY.style.overflowX="";a._BODY.style.overflowY="";break;case "1":a._BODY.style.overflowX="scroll";break;case "2":a._BODY.style.overflowY="scroll";break;case "3":a._BODY.style.overflowX="scroll";a._BODY.style.overflowY="scroll";break;case "4":a._BODY.style.overflowX="hidden";break;case "5":a._BODY.style.overflowY="hidden";break;case "6":a._BODY.style.overflowX="hidden",a._BODY.style.overflowY="hidden"}}
function removeEditorCss(a,c){var b=a,d;try{var e=["editor_layout.css","editor_contents.css","editor_showblocks.css","editor_form.css"],f=e.length,g=a.match(new RegExp(/<link [^<>]*>/gi)),h=g.length;if(g)for(var m=0;m<f;m++)for(var n=0;n<h;n++)-1<g[n].indexOf(e[m])&&(a=a.replace(g[n],""));d=a}catch(p){d=b}return d}function createEvent(a,c,b){var d=document.createElement("script");d.setAttribute("for",a);d.event=c;d.appendChild(document.createTextNode(b));document.body.appendChild(d)}
function PL_Event_BeforeOpenHtmlConvert(a,c){try{DEXTTOP.DEXTWIN.dext5EventBeforeOpenHtmlConvert(a,c)}catch(b){}}
function file_open_plugin(){if("1"==DEXTTOP.G_CURREDITOR._config.openDocument.beforeOpenEvent)try{11<=DEXTTOP.DEXT5.browser.ieVersion?createEvent(G_dext5plugIn.id,"DEXT5_Event_BeforeOpenHtmlConvert(strFileFormat, strFileFullPath)","PL_Event_BeforeOpenHtmlConvert(strFileFormat, strFileFullPath)"):G_dext5plugIn.attachEvent("DEXT5_Event_BeforeOpenHtmlConvert",PL_Event_BeforeOpenHtmlConvert)}catch(a){}var c=G_dext5plugIn.openDocumentDialog();if(c){var b=!0;0==DEXTTOP.DEXT5.isEmpty()&&0==confirm(dext5_lang.msg.newDocument)&&
(b=!1);b&&(b=c.substring(0,3).toLowerCase(),c=c.substring(3),"txt"==b&&(c=htmlSpecialChars(c),c=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,c)),"doc"==b||"ppt"==b||"xls"==b?setBodyValueToEditor(c):DEXTTOP.DEXT5.setHtmlContents(c))}}
function removeLastBrTag(a){if("1"==a._config.removeLastBrTag)try{var c=a._DOC.getElementsByTagName("p"),b=c.length;for(a=0;a<b;a++){var d=c[a].lastChild;if(1==d.nodeType&&"BR"==d.tagName){var e=d.previousSibling;!e||1==e.nodeType&&"BR"==e.tagName||d.parentNode.removeChild(d)}}}catch(f){}}
function changeRealTagToReplaceString(a){var c=a;if(a){var b=a.match(RegExp("<textarea *([^>?+])*>*([^>?+])*</textarea>","gi"));if(b){DEXTTOP.G_CURREDITOR.sTextareaArr=b;for(var d=b.length,e=0;e<d;e++)c=a.replace(b[e],"{_dext5_textarea_"+e+"}")}}return c}function changeReplaceStringToRealTag(a){var c=a;if(a){for(var b=DEXTTOP.G_CURREDITOR.sTextareaArr,d=b.length,e=0;e<d;e++)c=a.replace("{_dext5_textarea_"+e+"}",b[e]);DEXTTOP.G_CURREDITOR.sTextareaArr=[]}return c}
function getViolationNodes(a){dext_src_init(a._EDITOR.design);var c=[];if(""==a._config.accessibilityValidationItems)c=["table","frame","iframe","img","a"];else for(var b=a._config.accessibilityValidationItems.split(","),d=b.length,e=0;e<d;e++)if("duplicate_id"!=b[e].toLowerCase()){var f=b[e].split("_")[0];0>c.indexOf(f)&&c.push(f)}d=c.length;b=[];for(e=0;e<d;e++)for(var f="iframe"==c[e]?_iframeDoc.body.getElementsByTagName("img"):_iframeDoc.body.getElementsByTagName(c[e]),g=f.length,h=0;h<g;h++){var m=
f[h].getAttribute("dext5webaccskip");if(null==m||void 0==m)if("table"==c[e])-1<a._config.accessibilityValidationItems.indexOf("table_caption")&&-1<a._config.accessibilityValidationItems.indexOf("table_summary")||""==a._config.accessibilityValidationItems?null!=f[h].caption&&""!=f[h].caption.innerHTML&&""!=f[h].summary||b.push(f[h]):-1<a._config.accessibilityValidationItems.indexOf("table_caption")?null!=f[h].caption&&""!=f[h].caption.innerHTML||b.push(f[h]):-1<a._config.accessibilityValidationItems.indexOf("table_summary")&&
""==f[h].summary&&b.push(f[h]);else if(-1<"frame,a".indexOf(c[e]))"a"==c[e]?null!=f[h].href&&""!=f[h].href&&""==f[h].title&&b.push(f[h]):""==f[h].title&&b.push(f[h]);else if("iframe"==c[e]){if(m=f[h].getAttribute("dext5customdata"),null!=m&&void 0!=m&&(elemData=getDextCustomData(m),"iframe"==elemData.type||"iframe"==elemData.type2))void 0!=elemData.title&&""!=elemData.title||b.push(f[h])}else"img"==c[e]&&(m=f[h].getAttribute("dext5customdata"),void 0==m||null==m)&&(void 0!=f[h].alt&&""!=f[h].alt||
b.push(f[h]))}c=[];if(-1<a._config.accessibilityValidationItems.indexOf("duplicate_id")||""==a._config.accessibilityValidationItems)for(a=_iframeDoc.body.getElementsByTagName("*"),d=a.length,f=[],e=0;e<d;e++)!a[e].getAttribute("id")||-1<f.indexOf(a[e].getAttribute("id"))||(g=getElementsById(a[e].getAttribute("id"),_iframeDoc))&&1<g.length&&(c.push(g),f.push(a[e].getAttribute("id")));return{violateNodes:b,idSamNodes:c}}
function setAdjustTableBorder(a){if(DEXTTOP.DEXT5.browser.ie&&(11>DEXTTOP.DEXT5.browser.ieVersion&&7<DEXTTOP.DEXT5.browser.ieVersion||DEXTTOP.DEXT5.browser.quirks)&&0<a.getElementsByTagName("table").length){var c=DEXTTOP.G_CURREDITOR._config.webPath.css;DEXTTOP.DEXT5.isRelease||(c=DEXTTOP.G_CURREDITOR._config.webPath.css_dev);var b=a.getElementsByTagName("head")[0];createDynamicCssLinkToHeadTag(a,b,c+"editor_adjust_table.css?ver="+DEXTTOP.DEXT5.ReleaseVer);setTimeout(function(){for(var b=a.getElementsByTagName("link"),
c=null,f=b.length-1;0<=f;f--)-1<b[f].href.indexOf("editor_adjust_table.css")&&(c=b[f],c.parentNode.removeChild(c))},0)}}function hiddenBlocks(a){a=a.getElementsByTagName("link");for(var c=null,b=a.length-1;0<=b;b--)-1<a[b].href.indexOf("editor_showblocks.css")&&(c=a[b],c.parentNode.removeChild(c))}function removeDummyTag(a){a=DEXTTOP.DEXT5.util.replaceAll(a,"<![if !mso]>","");return a=DEXTTOP.DEXT5.util.replaceAll(a,"<![if !mso & !vml]>","")}
function dragresizeClear(a){"1"==DEXTTOP.G_CURREDITOR._config.dragResize&&-1<a.indexOf("DEXT_fiVe_drag_resize_Element")&&(a=a.replace(RegExp("<span[^>]+class=.*?DEXT_fiVe_drag_resize_Element.*?>(<img[^>]*>).*?</div></span>","gi"),"$1"),a=a.replace(RegExp("<span[^>]+class=.*?DEXT_fiVe_drag_resize_Element.*?>(<img[^>]*>).*?</span>","gi"),"$1"));return a}
function ReplaceCustomDataToRealEvent(){for(var a=_iframeDoc.getElementsByTagName("input"),c=a.length-1;0<=c;c--){var b=a[c],d=b.getAttribute("dext5customdata");if(null!=d&&void 0!=d){var e=getDextCustomData(d);if("event"==e.type){var d=e.eventName,e=e.eventFunction,d=d.split("\x0B"),e=e.split("\x0B"),f=d.length;for(i=0;i<f;i++)b.setAttribute(d[i],e[i])}b.removeAttribute("dext5customdata")}}a=_iframeDoc.getElementsByTagName("textarea");for(c=a.length-1;0<=c;c--)if(b=a[c],d=b.getAttribute("dext5customdata"),
null!=d&&void 0!=d){e=getDextCustomData(d);if("event"==e.type)for(d=e.eventName,e=e.eventFunction,d=d.split("\x0B"),e=e.split("\x0B"),f=d.length,i=0;i<f;i++)b.setAttribute(d[i],e[i]);b.removeAttribute("dext5customdata")}a=_iframeDoc.getElementsByTagName("select");for(c=a.length-1;0<=c;c--)if(b=a[c],d=b.getAttribute("dext5customdata"),null!=d&&void 0!=d){e=getDextCustomData(d);if("event"==e.type)for(d=e.eventName,e=e.eventFunction,d=d.split("\x0B"),e=e.split("\x0B"),f=d.length,i=0;i<f;i++)b.setAttribute(d[i],
e[i]);b.removeAttribute("dext5customdata")}}
function ReplaceRealEventToCustomData(){for(var a=_iframeDoc.getElementsByTagName("input"),c=a.length-1;0<=c;c--){for(var b=a[c],d=DEXTTOP.G_CURREDITOR._config.eventList.length,e="",f="",g=!1,h=0;h<d;h++)b.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h])&&(g&&(e+="\x0B",f+="\x0B"),g=!0,e+=DEXTTOP.G_CURREDITOR._config.eventList[h],f+=b.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h]));""!=e&&(d={type:"event"},d.eventName=e,d.eventFunction=f,setDextCustomData(b,d))}a=_iframeDoc.getElementsByTagName("textarea");
for(c=a.length-1;0<=c;c--){b=a[c];d=DEXTTOP.G_CURREDITOR._config.eventList.length;f=e="";g=!1;for(h=0;h<d;h++)b.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h])&&(g&&(e+="\x0B",f+="\x0B"),g=!0,e+=DEXTTOP.G_CURREDITOR._config.eventList[h],f+=b.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h]));""!=e&&(d={type:"event"},d.eventName=e,d.eventFunction=f,setDextCustomData(b,d))}a=_iframeDoc.getElementsByTagName("select");for(c=a.length-1;0<=c;c--){b=a[c];d=DEXTTOP.G_CURREDITOR._config.eventList.length;
f=e="";g=!1;for(h=0;h<d;h++)b.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h])&&(g&&(e+="\x0B",f+="\x0B"),g=!0,e+=DEXTTOP.G_CURREDITOR._config.eventList[h],f+=b.getAttribute(DEXTTOP.G_CURREDITOR._config.eventList[h]));""!=e&&(d={type:"event"},d.eventName=e,d.eventFunction=f,setDextCustomData(b,d))}}
function checkLockAttr(a,c){for(var b=!1,d=[],d="1"==DEXTTOP.G_CURREDITOR._config.formMode?DEXTTOP.G_CURREDITOR._config.adminTableLock.checkLockName:DEXTTOP.G_CURREDITOR._config.userTableLock.lockName,e=d.length;null!=a;){for(var f=0;f<e;f++)if(void 0!=a.getAttribute(d[f])){b=!0;break}if(c)break;else a=!a.tagName||"TD"!=a.tagName&&"TH"!=a.tagName?a.tagName&&"TABLE"==a.tagName?GetTDTHCell(a):null:GetParentbyTagName(a,"table")}return b}
function removeLockAttr(a){var c=DEXTTOP.G_CURREDITOR._config.adminTableLock.checkLockName,b=c.length;if(a)for(var d=0;d<b;d++)a.removeAttribute(c[d])}
function setClassTableAndCellLock(a){if("0"!=a._config.formMode||"0"!=a._config.userTableLock.use){""==a._config.tableNoResizeClass&&(a._config.tableNoResizeClass="dext_no_resize");""==a._config.tableNoActionClass&&(a._config.tableNoActionClass="dext_no_action");for(var c=a._config.tableNoResizeClass,b=a._config.tableNoActionClass,d=a._DOC.getElementsByTagName("table"),e=d.length,f=0;f<e;f++)if(checkLockAttr(d[f],!0))if("1"==a._config.formMode)setClassName(d[f],"DEXT_five_table_lock");else{if("1"==
a._config.userTableLock.use){var g=a._config.userTableLock.defaultShowLockIcon;d[f].getAttribute("show_icon")&&""!=d[f].getAttribute("show_icon")&&(g=d[f].getAttribute("show_icon"));"1"==g?setClassName(d[f],"DEXT_five_table_lock"):removeClassName(d[f],"DEXT_five_table_lock");setClassName(d[f],c);setClassName(d[f],b)}}else"1"==a._config.userTableLock.use&&(g=a._config.userTableLock.defaultTableLockMode,d[f].getAttribute("lock_mode")&&""!=d[f].getAttribute("lock_mode")&&(g=d[f].getAttribute("lock_mode")),
"2"==g?checkLockAttr(d[f])&&(setClassName(d[f],c),setClassName(d[f],b)):(removeClassName(d[f],c),removeClassName(d[f],b)));c=a._DOC.getElementsByTagName("td");b=c.length;for(f=0;f<b;f++)checkLockAttr(c[f],!0)&&("1"==a._config.formMode?setClassName(c[f],"DEXT_five_cell_lock"):(d=a._config.userTableLock.defaultShowLockIcon,e=GetParentbyTagName(c[f],"table"),e.getAttribute("show_icon")&&""!=e.getAttribute("show_icon")&&(d=e.getAttribute("show_icon")),"1"==a._config.userTableLock.use&&("1"==d?setClassName(c[f],
"DEXT_five_cell_lock"):removeClassName(c[f],"DEXT_five_cell_lock"))))}}function findNoLockCell(a){var c=null;if(a){var b=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;a.getAttribute("lock_mode")&&""!=a.getAttribute("lock_mode")&&(b=a.getAttribute("lock_mode"));var d=!0;"1"==b&&(d=!1);a=a.getElementsByTagName("td");for(var b=a.length,e=0;e<b;e++)if(0==checkLockAttr(a[e],!d)){c=a[e];break}}return c}
function setFocusForLock(a){try{a&&("TD"==a.tagName||"TH"==a.tagName?"P"==a.firstChild.tagName?(doSetCaretPosition(a.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")):(doSetCaretPosition(a,0),DEXTTOP.G_CURREDITOR._iconEnable("")):(doSetCaretPosition(a,0),DEXTTOP.G_CURREDITOR._iconEnable("")))}catch(c){}}
function findNoLockElem(a){var c=null;if(a){var b=a.previousSibling;b&&1==b.nodeType&&!checkLockAttr(b)&&(c=b);null==c&&(a=a.nextSibling)&&1==a.nodeType&&!checkLockAttr(a)&&(c=a)}return c}
function checkLockElemInSelectionRange(){try{var a=getFirstRange(),c=a.range;if(0<c.toString().length){var b=[[],[]];b[0]=getNodesInRange(c);if(null!=c.startContainer.previousSibling&&"HEAD"==c.startContainer.previousSibling.tagName&&null==c.endContainer.nextSibling){var d=_iframeDoc.getElementsByTagName("table"),e=_iframeDoc.getElementsByTagName("td");b[0]=d;b[1]=e}for(var f=b.length-1;0<=f;f--)for(var g=b[f].length-1;0<=g;g--){var h;h="TD"==b[f][g].tagName||"TABLE"==b[f][g].tagName;if(b[f][g].tagName&&
h&&checkLockAttr(b[f][g],!0)){a.sel.removeAllRanges();DEXTTOP.G_CURREDITOR.lastElemForLock?setFocusForLock(DEXTTOP.G_CURREDITOR.lastElemForLock):(window.focus(),document.body.focus());break}}}}catch(m){}}function IsExistTableLock(a){var c=!1,b=a._DOC;a=b.getElementsByTagName("table");var d=b.getElementsByTagName("td"),b=b.getElementsByTagName("th");a=[a,d,b];d=a.length;for(b=0;b<d;b++){for(var e=a[b].length,f=0;f<e;f++)if(checkLockAttr(a[b][f],!0)){c=!0;break}if(c)break}return c}
function setDEXTWINDOC(){null!=DEXTTOP.DEXT5.config.DialogWindow&&(setDEXTWINwindow(),setDEXTDOCdocument())}function groupingIcon(a){"1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&("0"!=DEXTTOP.G_CURREDITOR._config.tool_bar&&"2"!=DEXTTOP.G_CURREDITOR._config.tool_bar||makeGrouping(1,a),"0"!=DEXTTOP.G_CURREDITOR._config.tool_bar&&"1"!=DEXTTOP.G_CURREDITOR._config.tool_bar||makeGrouping(2,a))}
function makeGrouping(a,c){c&&(DEXTTOP.G_CURREDITOR=c);for(var b=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("dext_tab_tool"+a+"_"+DEXTTOP.G_CURREDITOR.ID),d=DEXTTOP.G_CURREDITOR.Toolbar_group[a-1].length,d=d-1;0<=d;d--)b.appendChild(DEXTTOP.G_CURREDITOR.Toolbar_group[a-1][d]);DEXTTOP.G_CURREDITOR.Toolbar_group[a-1]=[];DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("ul_tool_bar_grouping_list"+a).innerHTML="";for(var e=b.childNodes,f=e.length,b=[],d=0;d<f;d++)1==e[d].nodeType&&(-1<
e[d].className.indexOf("uebutton")||-1<e[d].className.indexOf("ue_SM"))&&b.push(e[d]);d=b.length;e=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("ue_editor_main_"+DEXTTOP.G_CURREDITOR.ID);e=getClientRect(e);for(--d;0<=d;d--)if(getClientRect(b[d]).right>=e.right-18)-1<b[d].id.indexOf("detail_table_insert")?(DEXTTOP.G_CURREDITOR.Toolbar_group[a-1].push(b[d]),DEXTTOP.G_CURREDITOR.Toolbar_group[a-1].push(b[d-1]),--d):-1<b[d].id.indexOf("detail_list_")||-1<b[d].id.indexOf("_group_detail")?(DEXTTOP.G_CURREDITOR.Toolbar_group[a-
1].push(b[d]),DEXTTOP.G_CURREDITOR.Toolbar_group[a-1].push(b[d-1]),--d):DEXTTOP.G_CURREDITOR.Toolbar_group[a-1].push(b[d]);else break;d=DEXTTOP.G_CURREDITOR.Toolbar_group[a-1].length;b=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("dext_span_"+DEXTTOP.G_CURREDITOR.ID+"tool_bar_grouping"+a);if(0==d)b.style.display="none";else{for(--d;0<=d;d--)e=DEXTTOP.G_CURREDITOR._FRAMEWIN.document.createElement("li"),-1<DEXTTOP.G_CURREDITOR.Toolbar_group[a-1][d].id.indexOf("list_")?(e.appendChild(DEXTTOP.G_CURREDITOR.Toolbar_group[a-
1][d]),e.appendChild(DEXTTOP.G_CURREDITOR.Toolbar_group[a-1][d-1]),--d):e.appendChild(DEXTTOP.G_CURREDITOR.Toolbar_group[a-1][d]),DEXTTOP.G_CURREDITOR._FRAMEWIN.document.getElementById("ul_tool_bar_grouping_list"+a).appendChild(e);b.style.display=""}}
function setPositionGroupingDiv(a){var c=document.getElementById("dext_div_tool_bar_grouping_box"+a),b=document.getElementById("dext_span_"+DEXTTOP.G_CURREDITOR.ID+"tool_bar_grouping"+a),b=getClientRect(b);a=getClientRect(document.getElementById("ul_tool_bar_grouping_list"+a));c.style.left=b.right-(a.right-a.left)-2+"px";c.style.top=b.bottom+"px"}
function showGroupingBackground(){var a=document.getElementById("dext_grouping_background");a||(a=document.createElement("div"),a.setAttribute("id","dext_grouping_background"),a.style.zIndex=G_MAIN_ZINDEX+800,document.body.appendChild(a),DEXTTOP.DEXT5.util.addEvent(a,"click",function(){hideGroupingBox()}),a.onmousedown=function(){return!1},a.unselectable="on");DEXT5_EDITOR.prototype.dialog.set_full_size(a);a.style.display="block"}
function hideGroupingBox(){dialogCancel();var a=document.getElementById("dext_div_tool_bar_grouping_box1");a&&(a.style.display="none");if(a=document.getElementById("dext_div_tool_bar_grouping_box2"))a.style.display="none";if(a=document.getElementById("dext_grouping_background"))a.style.display="none"}
function isGroupingIcon(a,c,b){var d=!1;"1"==DEXTTOP.G_CURREDITOR._config.tool_bar_grouping&&(a=b?b:document.getElementById("ue_"+a+c),(a=GetParentbyTagName(a,"ul"))&&-1<a.id.indexOf("ul_tool_bar_grouping")&&(d=!0));return d}
function userCssSet(a){var c="",b='<link href="'+DEXTTOP.G_CURREDITOR._config.userCssUrl+'" rel="stylesheet" type="text/css">';try{if(-1==a.indexOf(b)){var d=a.indexOf("</head>");if(-1==d)var e=a.indexOf("<body"),c=-1==e?"<head>"+b+"</head><body>"+a+"</body>":a.substring(0,e)+"<head>"+b+"</head>"+a.substring(e);else c=a.substring(0,d)+b+a.substring(d)}}catch(f){}return c}
function loadDirectEditHtmlUrl(a){if(""!=a.directEditHtmlUrl){var c=DEXTTOP.G_CURREDITOR._EDITOR.design,b=DEXTTOP.G_CURREDITOR._setting.encoding,d=DEXTTOP.G_CURREDITOR._setting.lang,e=DEXTTOP.G_CURREDITOR._setting.xmlnsname,f=DEXTTOP.G_CURREDITOR._setting.font_family,g=DEXTTOP.G_CURREDITOR._setting.font_size,h=DEXTTOP.G_CURREDITOR._setting.line_height;DEXTTOP.DEXT5.util.addEvent(c,"load",function(){var m=c.contentWindow,n=getIframeDocument(c),m=m.document.documentElement.getElementsByTagName("head")[0];
if(null==m||void 0==m)m=n.createElement("head"),n.insertBefore(m,n.body);if(""!=a.imageBaseUrl){for(var p=m.getElementsByTagName("base"),q=p.length,u=0;u<q;u++)if(p[u].href&&-1<p[u].href.indexOf(a.imageBaseUrl)){sameCheck=!0;break}u=n.createElement("base");u.href=a.imageBaseUrl;m.appendChild(u)}if(""!=a.ieCompatible){p=m.getElementsByTagName("meta");q=p.length;for(u=0;u<q;u++)if(p[u].getAttribute("content")&&-1<p[u].getAttribute("content").indexOf("IE="+a.ieCompatible)){sameCheck=!0;break}u=n.createElement("meta");
u.setAttribute("http-equiv","X-UA-Compatible");u.setAttribute("content","IE="+a.ieCompatible);m.appendChild(u)}for(var p=m.getElementsByTagName("style"),q=p.length,t=!1,u=0;u<q;u++){var v=p[u].innerHTML;if("1"==a.setDefaultStyle.value||"2"==a.setDefaultStyle.value){if(-1<v.indexOf("#"+a.setDefaultStyle.body_id)){t=!0;break}}else if(0>v.indexOf("#"+a.setDefaultStyle.body_id)&&-1<v.indexOf("body {")&&-1<v.indexOf("p {")&&-1<v.indexOf("li {")){t=!0;break}}t||(u="","1"==a.defaultImemode&&(u="-ms-image-mode: active; ime-mode: active;"),
q=p="","1"==a.autoBodyFit&&(p="word-wrap:break-word;",0<parseIntOr0(a.ruler.rulerInitPosition)&&(q="width:"+(parseIntOr0(a.ruler.rulerInitPosition)-10)+"px;")),t="",v="10px;","1"==a.horizontalLine.use&&(v="0px 10px 10px 10px;"),"1"==a.setDefaultStyle.value||"2"==a.setDefaultStyle.value?(n.body.id=a.setDefaultStyle.body_id,t+="#"+a.setDefaultStyle.body_id+" { cursor:text; margin:"+v+" font-family:"+f+"; font-size:"+g+";"+u+p+q+" }",t+="#"+a.setDefaultStyle.body_id+" p { line-height:"+h+"; margin-top:0px; margin-bottom:0px; }",
t+="#"+a.setDefaultStyle.body_id+" li { line-height:"+h+"; margin-top:0px; margin-bottom:0px; }"):(t+="body { cursor:text; margin:"+v+" font-family:"+f+"; font-size:"+g+";"+u+p+q+" }",t+="p { line-height:"+h+"; margin-top:0px; margin-bottom:0px; }",t+="li { line-height:"+h+"; margin-top:0px; margin-bottom:0px; }"),addDynamicCssToHeadTag(n,m,t));switch(a.scrollOverflow){case "1":n.body.style.overflowX="scroll";break;case "2":n.body.style.overflowY="scroll";break;case "3":n.body.style.overflowX="scroll";
n.body.style.overflowY="scroll";break;case "4":n.body.style.overflowX="hidden";break;case "5":n.body.style.overflowY="hidden";break;case "6":n.body.style.overflowX="hidden",n.body.style.overflowY="hidden"}u="";u=DEXTTOP.DEXT5.isRelease?a.webPath.css:a.webPath.css_dev;createDynamicCssLinkToHeadTag(n,m,u+"editor_contents.css?ver="+DEXTTOP.DEXT5.ReleaseVer);"1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"!=DEXTTOP.G_CURREDITOR._config.userTableLock.use||createDynamicCssLinkToHeadTag(n,m,u+"editor_form.css?ver="+
DEXTTOP.DEXT5.ReleaseVer);d&&0<d.length&&(u=n.getElementsByTagName("html")[0])&&(p=d,-1<p.indexOf("-")&&(p=p.split("-")[0]),u.setAttribute("lang",p),u.setAttribute("xml:lang",p),0<e.length&&u.setAttribute("xmlns",e));""==b&&(b="utf-8");u=n.createElement("meta");u.setAttribute("http-equiv","Content-Type");u.setAttribute("content","text/html");u.setAttribute("charset",b);m.appendChild(u);5<a.userCssUrl.length&&createDynamicCssLinkToHeadTag(n,m,a.userCssUrl);5<a.userJsUrl.length&&createDynamicJsLinkToHeadTag(n,
m,a.userJsUrl);DEXT5_EDITOR.prototype._load_editor_frame(!1);0==isViewMode(DEXTTOP.G_CURREDITOR)&&(DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,"1"==a.formMode?(ReplaceRealEventToCustomData(),ReplaceRealObjectToImage(!1)):ReplaceRealObjectToImage());setScrollOverflow(DEXTTOP.G_CURREDITOR);setStyleForTableBorderNodeClass(DEXTTOP.G_CURREDITOR);setCssForFormMode(DEXTTOP.G_CURREDITOR);removeLineHeightOfTable();DEXTTOP.G_CURREDITOR._iconEnable("");setBodyDefaultValue();wrapPtagForNotBlockTag(DEXTTOP.G_CURREDITOR);
replaceBrTag(DEXTTOP.G_CURREDITOR);removeLastBrTag(DEXTTOP.G_CURREDITOR);0==isViewMode(DEXTTOP.G_CURREDITOR)&&(removeNbspInPTag(DEXTTOP.G_CURREDITOR),replaceClassForBorder(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._BODY,"show"),replaceClassForBookmark(DEXTTOP.G_CURREDITOR,DEXTTOP.G_CURREDITOR._BODY,"show"));setFocusToBody();setFocusFirstChildForStyle(DEXTTOP.G_CURREDITOR._BODY);setBodyBackground(DEXTTOP.G_CURREDITOR);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0;DEXTTOP.G_CURREDITOR.UndoManager.canUndo=!1;DEXTTOP.G_CURREDITOR.UndoManager.canRedo=!1;DEXTTOP.G_CURREDITOR._iconEnable("");insertImageSrc(DEXTTOP.G_CURREDITOR);showRuler(DEXTTOP.G_CURREDITOR);setClassTableAndCellLock(DEXTTOP.G_CURREDITOR);set_view_mode_auto_height();setAdjustTableBorder(DEXTTOP.G_CURREDITOR._DOC);"show_blocks"==DEXTTOP.G_CURREDITOR.ShowBlocks&&(DEXTTOP.G_CURREDITOR.ShowBlocks="",command_showBlocks(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR))});c.src=a.directEditHtmlUrl}}
function showProcessingBackground(){var a=document.getElementById("dext_Processing_background"),c=document.getElementById("dext_Processing_text");a||(a=document.createElement("div"),a.setAttribute("id","dext_Processing_background"),a.style.zIndex=G_MAIN_ZINDEX+900,a.style.verticalAlign="middle",c=document.createElement("div"),c.setAttribute("id","dext_Processing_text"),c.style.zIndex=parseIntOr0(a.style.zIndex)+100,c.innerHTML="<b>Processing...</b>",document.body.appendChild(a),document.body.appendChild(c));
DEXT5_EDITOR.prototype.dialog.set_full_size(a);a.style.display="block";c.style.display="block"}function hideProcessingBackground(){var a=document.getElementById("dext_Processing_background"),c=document.getElementById("dext_Processing_text");a&&(a.style.display="none",c.style.display="none")};function command_bold(a,c){dext_src_init(c._EDITOR.design);var b={document:_iframeDoc,styleWithCss:!1,tagName:"strong"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"bold",b)}function command_italic(a,c){dext_src_init(c._EDITOR.design);var b={document:_iframeDoc,styleWithCss:!1,tagName:"i"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"italic",b)}
function command_formatting(a,c,b){dext_src_init(c);b.toLowerCase();restoreSelection();setFocusToBody();a=getFirstRange();""==b?DoExecuteCommandFormatting(a,"p",!1):DoExecuteCommandFormatting(a,b,!0)}function command_underline(a,c){dext_src_init(c._EDITOR.design);var b={document:_iframeDoc,styleWithCss:!1,tagName:"u"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"underline",b)}
function command_strikeThrough(a,c){dext_src_init(c._EDITOR.design);var b={document:_iframeDoc,styleWithCss:!1,tagName:"strike"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"strikeThrough",b)}function command_superscript(a,c){dext_src_init(c._EDITOR.design);var b={document:_iframeDoc,styleWithCss:!1,tagName:"sup"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"superscript",b)}
function command_subscript(a,c){dext_src_init(c._EDITOR.design);var b={document:_iframeDoc,styleWithCss:!1,tagName:"sub"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"subscript",b)}function command_selectAll(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();_iframeDoc.execCommand("selectAll",!1,null)}
function command_align(a,c,b,d){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange();var e=a.range;if(c=getSelectionTable(c)){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();"justify"==b?c.removeAttribute("align"):c.setAttribute("align",b);var f=_iframeDoc.body.createControlRange();f.add(c);f.select();setMenuIconRealable(c);DEXTTOP.G_CURREDITOR._iconEnable("focusTable",c);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0}else if(void 0==e)"left"==b?b="justifyLeft":"right"==b?b="justifyRight":"center"==b?b="justifyCenter":"justify"==b&&(b="justifyFull"),DoExecuteCommand2(a.sel,e,b,d);else{0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();c="p li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" ");var g=c.length,h,m,n=GetTableSelectionCells();if(0==n.length){if(null!=e.startContainer.previousSibling&&"HEAD"==e.startContainer.previousSibling.tagName&&null==e.endContainer.nextSibling){for(d=
0;d<g;d++)for(h=_iframeDoc.body.getElementsByTagName(c[d]),m=h.length,a=0;a<m;a++)""!=h[a].style.layoutGridMode&&(h[a].style.layoutGridMode="none"),h[a].style.textAlign=b;g=_iframeDoc.body.getElementsByTagName("table");h=g.length;for(d=0;d<h;d++){m=g[d].rows;var p=m.length;for(a=0;a<p;a++)for(var n=m[a].cells,e=n.length,q=0;q<e;q++)setBlockTag(n[q].childNodes,c,"align",b)}setBlockTag(_iframeDoc.body.childNodes,c,"align",b);h=_iframeDoc.body.getElementsByTagName("div");m=h.length;for(a=0;a<m;a++)setBlockTag(h[a].childNodes,
c,"align",b)}else{h=getNodesInRange(e);m=h.length;0==e.toString().length&&0==e.getNodes().length&&e.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(n=0;n<m;n++)if(1==h[n].nodeType&&(d=h[n].tagName.toLowerCase(),-1<c.indexOf(d))){for(d=0;d<g;d++)for(q=h[n].getElementsByTagName(c[d]),p=q.length,a=0;a<p;a++)""!=q[a].style.layoutGridMode&&(q[a].style.layoutGridMode="none"),q[a].style.textAlign=b;""!=h[n].style.layoutGridMode&&(h[n].style.layoutGridMode="none");h[n].style.textAlign=b}0==e.toString().length&&
1==e.getNodes().length&&(f=e.getNodes()[0],h.push(e.getNodes()[0]));setBlockTag(h,c,"align",b)}(b=_iframeDoc.getElementById("_dextPosition"))?(doSetCaretPosition(b,1),b.parentNode.removeChild(b)):f&&(b=getFirstRange().range,getFirstRange().sel.removeAllRanges(),b.selectNode(f),getFirstRange().sel.addRange(b));a=getFirstRange();e=a.range;setMenuIconRealable(getMyElementNode(e.startContainer))}else{7==DEXTTOP.DEXT5.browser.ieVersion&&null!=ActiveCurrTable&&0==d&&(f=!1,"0"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjust&&
(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="1",f=!0),setAdjustTableWidthHeight(ActiveCurrTable),f&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="0"));e=n.length;for(d=0;d<e;d++){for(a=0;a<g;a++)for(h=n[d].getElementsByTagName(c[a]),m=h.length,q=0;q<m;q++)""!=h[q].style.layoutGridMode&&(h[q].style.layoutGridMode="none"),h[q].style.textAlign=b;setBlockTag(n[d].childNodes,c,"align",b);h=n[d].getElementsByTagName("div");m=h.length;for(a=0;a<m;a++)setBlockTag(h[a].childNodes,c,"align",b)}doSetCaretPosition(DrageEndCell.childNodes[0],
1);b=getFirstRange().range;f=getMyChildElementNode(b.startContainer);b.selectNode(f);setMenuIconRealable(f);_iframeDoc_MouseUpMenu(null,DrageEndCell)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}function command_justifyLeft(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange();DoExecuteCommand2(a.sel,a.range,"justifyLeft",b)}
function command_justifyCenter(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange();DoExecuteCommand2(a.sel,a.range,"justifyCenter",b)}function command_justifyRight(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange();DoExecuteCommand2(a.sel,a.range,"justifyRight",b)}
function command_justifyFull(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange();DoExecuteCommand2(a.sel,a.range,"justifyFull",b)}
function command_indent(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange().range,d=parseIntOr0(c._config.inoutdentDefaultSize);0==d&&(d=40);if(b&&"1"!=c._config.allowInoutdentText){var e=GetTDTHCell(b.startContainer);if(e&&0<b.toString().length)return;if(e=GetParentbyTagName(e,"table")){b=parseIntOr0(e.style.marginLeft);e.style.marginLeft=b+d+"px";return}}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();e=getNodesInRange(b);
null!=b.startContainer.previousSibling&&"HEAD"==b.startContainer.previousSibling.tagName&&null==b.endContainer.nextSibling&&(e=_iframeDoc.body.childNodes);for(var f=e.length,g=0;g<f;g++)if(null!=e[g].parentNode&&("body"==e[g].parentNode.nodeName.toLowerCase()||"td"==e[g].parentNode.nodeName.toLowerCase()&&"1"==c._config.allowInoutdentText))if("table"==e[g].tagName.toLowerCase()&&"1"!=c._config.allowInoutdentText)b=parseIntOr0(e[g].style.marginLeft),e[g].style.marginLeft=b+d+"px";else if(b=parseIntOr0(e[g].style.marginLeft),
0<b)"ol"!=e[g].tagName.toLowerCase()&&"ul"!=e[g].tagName.toLowerCase()||0!=h||(b=40),e[g].style.marginLeft=b+d+"px";else{var h=parseIntOr0(e[g].style.paddingLeft);"ol"!=e[g].tagName.toLowerCase()&&"ul"!=e[g].tagName.toLowerCase()||0!=h||(h=40);e[g].style.paddingLeft=h+d+"px"}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_outdent(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange().range,d=parseIntOr0(c._config.inoutdentDefaultSize);0==d&&(d=40);if(b&&"1"!=c._config.allowInoutdentText){var e=GetTDTHCell(b.startContainer);if(e&&0<b.toString().length)return;if(e=GetParentbyTagName(e,"table")){var f=parseIntOr0(e.style.marginLeft);e.style.marginLeft=(0>f-d?0:f-d)+"px"}}0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();e=
getNodesInRange(b);null!=b.startContainer.previousSibling&&"HEAD"==b.startContainer.previousSibling.tagName&&null==b.endContainer.nextSibling&&(e=_iframeDoc.body.childNodes);for(var b=e.length,g=0;g<b;g++)null!=e[g].parentNode&&("body"==e[g].parentNode.nodeName.toLowerCase()||"td"==e[g].parentNode.nodeName.toLowerCase()&&"1"==c._config.allowInoutdentText)&&("table"==e[g].tagName.toLowerCase()&&"1"!=c._config.allowInoutdentText?(f=parseIntOr0(e[g].style.marginLeft),f=0>f-d?0:f-d,e[g].style.marginLeft=
f+"px"):(f=parseIntOr0(e[g].style.marginLeft),0<f?(f="ol"==e[g].tagName.toLowerCase()||"ul"==e[g].tagName.toLowerCase()?40>f-d?40:f-d:0>f-d?0:f-d,e[g].style.marginLeft=f+"px",0==f&&(e[g].style.marginLeft="")):(f=parseIntOr0(e[g].style.paddingLeft),f="ol"==e[g].tagName.toLowerCase()||"ul"==e[g].tagName.toLowerCase()?40>f-d?40:f-d:0>f-d?0:f-d,e[g].style.paddingLeft=f+"px")));DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_insertOrderedList(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange(),d=b.range,e=getFirstRange().range,f=null;e&&e.startContainer&&(f=getMyElementNode(e.startContainer));var g=GetParentbyTagName(f,"ol"),f=GetParentbyTagName(f,"ul");g||f?f?(f.style.listStyleType="",DoExecuteCommand2(b.sel,d,"insertOrderedList")):g&&(g.style.listStyleType="",DoExecuteCommand2(b.sel,d,"insertOrderedList")):DoExecuteCommand2(b.sel,d,"insertOrderedList");b=getFirstRange().range;
0==!!b&&(b=e);e=getNodesInRange(b);d=e.length;for(g=0;g<d;g++)"ol"==e[g].nodeName.toLowerCase()&&(b=e[g].parentNode,"p"==b.nodeName.toLowerCase()&&(b.parentNode.replaceChild(e[g],b),b=getFirstRange(),b.sel.removeAllRanges(),b.range.selectNodeContents(e[g]),b.sel.addRange(b.range)))}function command_listDecimal(a,c){dext_src_init(c._EDITOR.design);command_listNumberBullets(a,c,"N","decimal")}
function command_listDecimalLeadingZero(a,c){dext_src_init(c._EDITOR.design);command_listNumberBullets(a,c,"N","decimal-leading-zero")}function command_listLowerAlpha(a,c){dext_src_init(c._EDITOR.design);command_listNumberBullets(a,c,"N","lower-alpha")}function command_listLowerGreek(a,c){dext_src_init(c._EDITOR.design);command_listNumberBullets(a,c,"N","lower-greek")}function command_listLowerRoman(a,c){dext_src_init(c._EDITOR.design);command_listNumberBullets(a,c,"N","lower-roman")}
function command_listUpperAlpha(a,c){dext_src_init(c._EDITOR.design);command_listNumberBullets(a,c,"N","upper-alpha")}function command_listUpperRoman(a,c){dext_src_init(c._EDITOR.design);command_listNumberBullets(a,c,"N","upper-roman")}
function command_insertUnOrderedList(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange(),d=b.range,e=getFirstRange().range,f=null;e&&e.startContainer&&(f=getMyElementNode(e.startContainer));var g=GetParentbyTagName(f,"ol"),f=GetParentbyTagName(f,"ul");g||f?g?(g.style.listStyleType="",DoExecuteCommand2(b.sel,d,"insertUnOrderedList")):f&&(f.style.listStyleType="",DoExecuteCommand2(b.sel,d,"insertUnOrderedList")):DoExecuteCommand2(b.sel,d,"insertUnOrderedList");
b=getFirstRange().range;0==!!b&&(b=e);e=getNodesInRange(b);d=e.length;for(g=0;g<d;g++)"ul"==e[g].nodeName.toLowerCase()&&(b=e[g].parentNode,"p"==b.nodeName.toLowerCase()&&(b.parentNode.replaceChild(e[g],b),b=getFirstRange(),b.sel.removeAllRanges(),b.range.selectNodeContents(e[g]),b.sel.addRange(b.range)))}function command_listDisc(a,c){dext_src_init(c._EDITOR.design);command_listNumberBullets(a,c,"B","disc")}
function command_listCircle(a,c){dext_src_init(c._EDITOR.design);command_listNumberBullets(a,c,"B","circle")}function command_listSquare(a,c){dext_src_init(c._EDITOR.design);command_listNumberBullets(a,c,"B","square")}function command_removeFormat(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange();DoExecuteCommand2(b.sel,b.range,"removeFormat")}
function command_removeCss(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange().range;try{var d=getElementsFromSelection(),e=d.length;if(0==b.toString().length){var f=GetTableSelectionCells(),g=f.length;if(0==g)return!1;1!=isApplyFormat&&ClearDraggingTableCellSelected();for(var d=[],b=null,h=0,m=0;m<g;m++){d.push(f[m]);for(var b=f[m].getElementsByTagName("*"),h=b.length,n=0;n<h;n++)d.push(b[n])}e=d.length}else{f="";g=!1;for(m=0;m<e;m++)f=d[m].nodeName,"TABLE"==
f&&(g=!0);g&&ClearDraggingTableAllTable()}(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();for(var f=null,p,m=0;m<e;m++)if(f=d[m],p=f.tagName.toLowerCase(),"table"==p||"td"==p||"th"==p){if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying){var q=
f.style.width,u=f.style.height,t=f.style.border,v=f.style.borderBottom,w=f.style.borderTop,x=f.style.borderLeft,y=f.style.borderRight,z=f.style.borderWidth,C=f.style.borderStyle,D=f.style.borderColor;removeAttribute(f,"align");removeAttribute(f,"style");removeAttribute(f,"className");removeAttribute(f,"bgcolor");""!=q&&(f.style.width=q);""!=u&&(f.style.height=u);""!=t&&(f.style.border=t);""!=z&&(f.style.borderWidth=z);""!=C&&(f.style.borderStyle=C);""!=D&&(f.style.borderColor=D);""!=v&&(f.style.borderBottom=
v);""!=w&&(f.style.borderTop=w);""!=x&&(f.style.borderLeft=x);""!=y&&(f.style.borderRight=y);"table"==p&&(f.style.borderCollapse="collapse",null!=f.getAttribute("cellpadding")&&"0"!=f.getAttribute("cellpadding")||f.setAttribute("cellPadding","1"))}}else if("body"!=p&&"img"!=p){for(var E=f.attributes.length,g=[],n=0;n<E;n++)g.push(f.attributes[n].nodeName);for(b=0;b<E;b++)removeAttribute(f,g[b])}var F=DEXT5_EDITOR.HTMLParser.makeMap("span,font");DEXTTOP.G_CURREDITOR._formatPainterList&&"1"==DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying&&
(F=DEXT5_EDITOR.HTMLParser.makeMap("span,font,b,strong,i,em,u,strike,s,sub,sup"));for(m=0;m<e;m++)f=d[m],p=f.tagName.toLowerCase(),F[p]&&"BODY"!=f.parentNode.tagName&&f.removeNode();if(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(H){}}
function command_copy(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();DEXTTOP.DEXT5.browser.ie?_iframeDoc.execCommand("copy",!1,null):alert(dext5_lang.msg.copy)}
function command_cut(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();DEXTTOP.DEXT5.browser.ie?(0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),_iframeDoc.execCommand("cut",!1,null),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0):alert(dext5_lang.msg.cut)}
function command_pastehtml(a,c,b,d){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();if(DEXTTOP.DEXT5.browser.ie){0<c.UndoManager.charCount&&c.UndoManager.putUndo();if(G_dext5plugIn){try{if(void 0==d&&"1"==c._config.limitPasteHtmlLength.value){var e=c._config.limitPasteHtmlLength.length,f=G_dext5plugIn.getOriginalHtml("body");if(f.length>e&&!checkCanPasteToIamge()){alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2);setFocusToBody();return}if("0"==c._config.pasteToImage&&f.length>
e){checkCanPasteToIamge()?alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1):alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2);setFocusToBody();return}}}catch(g){}a=G_dext5plugIn.getPasteHtml();var h=!1;if(G_dext5plugIn.getHTMLFormatFromType&&G_dext5plugIn.getPasteHtmlEx&&6==G_dext5plugIn.getHTMLFormatFromType&&(h=!0,DEXTTOP.DEXT5.browser.ie&&11==DEXTTOP.DEXT5.browser.ieVersion)){var m=a.match(RegExp("<img[^>]*src=[\"']?([^>\"']+)[\"']?[^>]*>","gi"));if(m)for(var n=m.length,p=0;p<n;p++)if(-1<m[p].indexOf("file://")){h=
!1;break}}6==G_dext5plugIn.getHTMLFormatFromType&&DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion&&(m=G_dext5plugIn.getPasteHtmlEx(),m=checkCopyInCellFormInertnNet(m),""!=m&&(a=m,h=!1));if(void 0!=b){d&&"0"==c._config.pasteToImage&&d.hide();b=G_dext5plugIn.ShowImageSaveDlgFromClipboard(b);try{if("HTML"==b&&"1"==c._config.limitPasteHtmlLength.value&&(e=c._config.limitPasteHtmlLength.length,f=G_dext5plugIn.getOriginalHtml("body"),f.length>e)){checkCanPasteToIamge()?alert(dext5_lang.msg.limitPasteHtmlLenthPlugin1):
alert(dext5_lang.msg.limitPasteHtmlLenthPlugin2);setFocusToBody();return}}catch(q){}if(""==b){setFocusToBody();return}""!=b&&"HTML"!=b&&(a=b)}e=!0;h&&(setPasteBin(),(e=document.execCommand("paste",!1,null))?(e=!1,fn_PasteIE()):e=!0);if(e&&(e=!1,6==G_dext5plugIn.getHTMLFormatFromType&&(e=!0),f=document.createElement("div"),f.innerHTML=a,replaceSpanToDivContainAbsolute(f)&&(a=f.innerHTML),a=htmlTagRevision(a,!0,e),a=repairPasteTextInCell(a),0<a.length)){0<c.UndoManager.charCount&&(c.UndoManager.putUndo(),
c._iconEnable(""));getFirstRange();var u=DEXTTOP.DEXT5.util.officeClean(a,!0),u=OfficePasteClean(u),u=DEXTTOP.DEXT5.util.emptyTagRemove(u),u=IEPasteRemoveEmptyNodes(u),u=DEXTTOP.DEXT5.util.htmlRevision(u),u=xssReplaceScript(null,u),u=getImageAutoFitForPasteHtml(u);try{var t=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(u);t&&(u=t)}catch(v){}-1<u.indexOf("dext5customdata")&&(u=checkExistCustomData(u));setTimeout(function(){pasteHtmlAtCaretHuge(u)},0);checkPasteImage(u);0>u.indexOf("dext5customdata")&&
(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),ReplaceRealObjectToImage(!1))}}else setPasteBin(),document.execCommand("paste",!1,null),fn_PasteIE();c.UndoManager.putUndo();c.UndoManager.charCount=0}else _iframeDoc.queryCommandState("paste")?(0<c.UndoManager.charCount&&c.UndoManager.putUndo(),_iframeDoc.execCommand("paste",!1,null),c.UndoManager.putUndo(),c.UndoManager.charCount=0):c._dextCommands(c.ID,"paste_dialog")}
function command_pagebreak(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);var b=getFirstRange().range,d=_iframeDoc.createElement("span");d.style.pageBreakAfter="always";d.contentEditable=!1;d.style.display="block";d.className="DEXT_fiVe_Page_Break";var e=_iframeDoc.createElement("span");e.style.display=
"none";e.innerHTML=dext5_lang.icon.pagebreak;d.appendChild(e);b.insertNode(_iframeDoc.createElement("br"));b.insertNode(d);b.insertNode(_iframeDoc.createElement("br"));DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_print(a,c){dext_src_init(c._EDITOR.design);isViewMode(c)||c.setChangeMode("preview");setTimeout(function(){var a,d="preview";isViewMode(c)&&(d="design");a=c._EDITOR[d].contentDocument?c._EDITOR[d].contentDocument:c._EDITOR[d].contentWindow.document;changeSpanPageBreakProperty(a);if(DEXTTOP.DEXT5.browser.ie)if(d=a.getElementById("dext5printpreview"))try{d.doPrintPreview(c._config.printHeader,c._config.printFooter,"")}catch(e){a.execCommand("print",!1,null)}else a.execCommand("print",
!1,null);else c._EDITOR[d].contentWindow.print();isViewMode(c)?restoreSpanPageBreakProperty(a):c.setChangeMode("design")},350)}
function command_saveAs(a,c){dext_src_init(c._EDITOR.design);var b=DEXTTOP.DEXT5.getHtmlValueExWithDocType(),b=b.replace("&amp;","&");if(G_dext5plugIn)G_dext5plugIn.doSaveHTML(b,"DEXT5.html","utf-8","");else{var d=DEXTTOP.document.createElement("form");d.id="dext5_saveFrm";d.name="dext5_saveFrm";d.method="post";var e=DEXTTOP.document.createElement("input");e.id="htmlstring";e.name="htmlstring";e.type="hidden";e.value=encodeURIComponent(b);b=DEXTTOP.document.createElement("input");b.id="tosavepathurl";
b.name="tosavepathurl";b.type="hidden";var f=DEXTTOP.document.createElement("input");f.id="savafoldernamerule";f.name="savafoldernamerule";f.type="hidden";if("1"==c._config.security.encryptParam){b.value=DEXTTOP.DEXT5.util.makeEncryptParam(c._config.toSavePathURL);f.value=DEXTTOP.DEXT5.util.makeEncryptParam(c._config.saveFolderNameRule);var g=DEXTTOP.document.createElement("input");g.id="pe";g.name="pe";g.value="1";g.type="hidden";d.appendChild(g)}else b.value=c._config.toSavePathURL,f.value=c._config.saveFolderNameRule;
d.action=""!=c._config.post_url_save_for_notes?c._config.post_url_save_for_notes:c._config.post_url;d.appendChild(e);d.appendChild(b);d.appendChild(f);DEXTTOP.document.body.appendChild(d);d.submit();DEXTTOP.document.body.removeChild(d)}}function command_undo(a,c){dext_src_init(c._EDITOR.design);0<c.UndoManager.charCount&&(c.UndoManager.putUndo(),c.UndoManager.charCount=0);c.UndoManager.execUndo()}
function command_redo(a,c){dext_src_init(c._EDITOR.design);c.UndoManager.execRedo();c.UndoManager.charCount=0}function command_fontsize(a,c,b){dext_src_init(c);a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontsize:b};restoreSelection();setFocusToBody();c=getFirstRange();DoExecuteCommand3(c.sel,c.range,"fontSize",a,b)}
function command_fontfamily(a,c,b){dext_src_init(c);a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontfamily:b};restoreSelection();setFocusToBody();c=getFirstRange();DoExecuteCommand3(c.sel,c.range,"fontFamily",a,b)}function command_docBGColor(a,c,b){dext_src_init(c);0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();_iframeDoc.body.style.background=b;DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_fontColor(a,c,b){dext_src_init(c);a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontcolor:b};restoreSelection();setFocusToBody();c=getFirstRange();DoExecuteCommand3(c.sel,c.range,"fontcolor",a,b)}function command_fontBgColor(a,c,b){dext_src_init(c);a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontcolor:b};restoreSelection();setFocusToBody();c=getFirstRange();DoExecuteCommand3(c.sel,c.range,"fontbgcolor",a,b)}
function command_lineHeight(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();a=getFirstRange();var d=a.range;if(void 0==d)DEXTTOP.DEXT5.browser.ie&&8<DEXTTOP.DEXT5.browser.ieVersion&&b==DEXTTOP.G_CURREDITOR._setting.line_height&&(b=parseInt(b,10)/100+.01),DoExecuteCommand3(a.sel,d,"lineheight",tagOptions,b);else{0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a="p span li dt dd h1 h2 h3 h4 h5 h6 pre address".split(" ");var e=a.length,f,g,h=GetTableSelectionCells();
if(0==h.length){if(null!=d.startContainer.previousSibling&&"HEAD"==d.startContainer.previousSibling.tagName&&null==d.endContainer.nextSibling){for(c=0;c<e;c++){f=_iframeDoc.body.getElementsByTagName(a[c]);g=f.length;for(var m=0;m<g;m++)"span"==f[m].tagName.toLowerCase()?""!=f[m].style.lineHeight&&(f[m].style.lineHeight=b):f[m].style.lineHeight=b}e=_iframeDoc.body.getElementsByTagName("table");f=e.length;for(c=0;c<f;c++){g=e[c].rows;for(var n=g.length,m=0;m<n;m++)for(var h=g[m].cells,d=h.length,p=
0;p<d;p++)setBlockTag(h[p].childNodes,a,"lineHeight",b)}setBlockTag(_iframeDoc.body.childNodes,a,"lineHeight",b);f=_iframeDoc.body.getElementsByTagName("div");g=f.length;for(m=0;m<g;m++)setBlockTag(f[m].childNodes,a,"lineHeight",b)}else{f=getNodesInRange(d);g=f.length;0==d.toString().length&&0==d.getNodes().length&&d.pasteHtml('<span id="_dextPosition">&nbsp;</span>');for(h=0;h<g;h++)if(1==f[h].nodeType&&(p=f[h].tagName.toLowerCase(),-1<a.indexOf(p))){if("div"!=p)for(c=0;c<e;c++)for(var n=f[h].getElementsByTagName(a[c]),
q=n.length,m=0;m<q;m++)"span"==n[m].tagName.toLowerCase()?""!=n[m].style.lineHeight&&(n[m].style.lineHeight=b):n[m].style.lineHeight=b;"span"==p?""!=f[h].style.lineHeight&&(f[h].style.lineHeight=b):f[h].style.lineHeight=b}var u;0==d.toString().length&&1==d.getNodes().length&&(u=d.getNodes()[0],f.push(d.getNodes()[0]));setBlockTag(f,a,"lineHeight",b)}(b=_iframeDoc.getElementById("_dextPosition"))?(doSetCaretPosition(b,1),b.parentNode.removeChild(b)):u&&(b=getFirstRange().range,getFirstRange().sel.removeAllRanges(),
b.selectNode(u),getFirstRange().sel.addRange(b))}else for(d=h.length,c=0;c<d;c++){for(m=0;m<e;m++)for(f=h[c].getElementsByTagName(a[m]),g=f.length,p=0;p<g;p++)"span"==f[p].tagName.toLowerCase()?""!=f[p].style.lineHeight&&(f[p].style.lineHeight=b):f[p].style.lineHeight=b;setBlockTag(h[c].childNodes,a,"lineHeight",b);f=h[c].getElementsByTagName("div");g=f.length;for(m=0;m<g;m++)setBlockTag(f[m].childNodes,a,"lineHeight",b)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0}}
function command_InsertTablebyRowCol(a,c,b,d){dext_src_init(c);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange();c=a.range;try{0==c.toString().length&&setRestoreCaretPos(!1)}catch(e){}c=getCellDefValue();var f=_iframeDoc.createElement("table"),g=0,h=getFirstRange().range,m=getMyElementNode(h.startContainer),n;try{var p=GetParentbyTagName(m,"td");if(p){var q=getClientRect(p);n=q.right-q.left}n&&50<n?(n-=10,g=Math.round(n/d),f.style.width=n+"px"):(g=Math.round(DEXTTOP.G_CURREDITOR._defTableWidth/
d),f.style.width=DEXTTOP.G_CURREDITOR._defTableWidth+"px")}catch(u){g=Math.round(DEXTTOP.G_CURREDITOR._defTableWidth/d),f.style.width=DEXTTOP.G_CURREDITOR._defTableWidth+"px"}f.style.height=20*b+"px";""!=DEXTTOP.G_CURREDITOR._config.tableDefaultWidth&&(g=Math.round(DEXTTOP.G_CURREDITOR._config.tableDefaultWidth/d),f.style.width=DEXTTOP.G_CURREDITOR._config.tableDefaultWidth+"px");""!=DEXTTOP.G_CURREDITOR._config.tableDefaultHeight&&(f.style.height=DEXTTOP.G_CURREDITOR._config.tableDefaultHeight+"px");
""!=DEXTTOP.G_CURREDITOR._config.tableInitInoutdent&&(f.style.marginLeft=DEXTTOP.G_CURREDITOR._config.tableInitInoutdent+"px");n="";""!=DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight?(n=DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight+"px",f.style.height=parseInt(n,10)*b+"px"):n="20px";""!=DEXTTOP.G_CURREDITOR._config.tableDefaultClass?(f.className=DEXTTOP.G_CURREDITOR._config.tableDefaultClass,n="",f.style.height=""):f.style.fontSize=DEXTTOP.G_CURREDITOR._setting.font_size;f.style.borderCollapse=
"collapse";f.setAttribute("border","1");p="";p=DEXTTOP.DEXT5.browser.gecko?"1px solid ":"1px none ";f.style.border=p+DEXTTOP.G_CURREDITOR._config.defaultBorderColor;f.setAttribute("cellSpacing","0");f.setAttribute("cellPadding","1");p=_iframeDoc.createElement("tbody");for(q=0;q<b;q++){h=_iframeDoc.createElement("tr");for(m=0;m<d;m++){var t=_iframeDoc.createElement("td");t.innerHTML=c;t.style.border="1px solid "+DEXTTOP.G_CURREDITOR._config.defaultBorderColor;h.appendChild(t);t.style.width=g+"px";
t.style.height=n}p.appendChild(h)}f.appendChild(p);h=getFirstRange().range;m=getMyElementNode(h.startContainer);"p"!=m.tagName.toLowerCase()||"<br>"!=m.innerHTML&&"<br/>"!=m.innerHTML&&"<br />"!=m.innerHTML&&""!=m.innerHTML&&"&nbsp;"!=m.innerHTML||h.selectNode(m);h.deleteContents();h.insertNode(f);try{h.selectNode(f);var v=f.parentNode;"body"!=v.tagName.toLowerCase()&&h.setEndAfter(v);h.collapse(!1);DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion||(a=getFirstRange(),a.sel.addRange(h));
DEXTTOP.DEXT5.browser.gecko&&doSetCaretPosition(v,1);repairBodyFirstLastTag(!1);var w=f.rows[0].cells[0];w&&(createTableCellDefValue(w),0==checkCellBRValue()&&(w.innerHTML="<p></p>"),0!=DEXTTOP.DEXT5.browser.ie?doSetCaretPosition(w.childNodes[0],0):setTimeout(function(){doSetCaretPosition(w.childNodes[0],0)},10),DEXTTOP.G_SELECTED_ELEMENT=w.childNodes[0])}catch(x){}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell");
ActiveCurrTable=f}
function command_InsertDetailTable(a,c,b,d,e,f,g,h,m,n,p,q,u,t,v,w,x,y,z,C,D,E,F,H,A,I,B,G,O,L,N,J){dext_src_init(c);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var P=J=c=a=0;a=getFirstRange().range;var K=getMyElementNode(a.startContainer),M;if("3"!=b){a=d;c=e;if(""==f)try{var U=GetParentbyTagName(K,"td");if(U){var Q=getClientRect(U);M=Q.right-Q.left}J=M&&50<M?M-10:DEXTTOP.G_CURREDITOR._defTableWidth}catch(W){J=DEXTTOP.G_CURREDITOR._defTableWidth}else J=f;""!=g&&
(P=g)}else{a=F;c=H;if(""==A)try{if(U=GetParentbyTagName(K,"td"))Q=getClientRect(U),M=Q.right-Q.left;J=M&&50<M?M-10:DEXTTOP.G_CURREDITOR._defTableWidth}catch(X){J=DEXTTOP.G_CURREDITOR._defTableWidth}else J=A;""!=I&&(P=I)}f=Math.round(J/c);F=Math.round(P/c);0==F&&(F=""!=DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight?parseInt(DEXTTOP.G_CURREDITOR._config.tableDefaultTdHeight,10):20);d=getFirstRange();e=d.range;try{0==e.toString().length&&setRestoreCaretPos(!1)}catch(Y){}H=getCellDefValue();e=_iframeDoc.createElement("table");
null!=N&&""!=N&&(e.id=N);null!=L&&""!=L?(e.className=L,F=""):null==L&&""!=DEXTTOP.G_CURREDITOR._config.tableDefaultClass?(e.className=DEXTTOP.G_CURREDITOR._config.tableDefaultClass,F=""):e.style.fontSize=DEXTTOP.G_CURREDITOR._setting.font_size;e.style.width=J+"px";"3"!=b?(""!=g&&(e.style.height=P+"px"),"Y"==h?e.style.borderCollapse="separate":"N"==h&&(e.style.borderCollapse="collapse"),""!=m&&(e.align=m),"N"==h?e.style.border=DEXTTOP.DEXT5.browser.gecko?"1px #000000":"1px none #000000":"Y"==h&&(""!=
n.outsideTop&&(e.style.borderTop=n.outsideTop,showBorderForNoneClass(e,"dext_table_border_t")),""!=n.outsideLeft&&(e.style.borderLeft=n.outsideLeft,showBorderForNoneClass(e,"dext_table_border_l")),""!=n.outsideRight&&(e.style.borderRight=n.outsideRight,showBorderForNoneClass(e,"dext_table_border_r")),""!=n.outsideBottom&&(e.style.borderBottom=n.outsideBottom,showBorderForNoneClass(e,"dext_table_border_b"))),e.setAttribute("border","1"),""!=p&&e.setAttribute("cellSpacing",p),""!=q&&e.setAttribute("cellPadding",
q),""!=t&&e.setAttribute("summary",t),""!=v&&("[FAIL]"==v.substring(0,6)&&(e.setAttribute("alt",v.substring(6,v.length)),v=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),e.style.backgroundImage="url("+v+")",""!=w&&(e.style.backgroundAttachment=w),""!=x&&(e.style.backgroundRepeat=x),""!=y||""!=z)&&(e.style.backgroundPosition=parseInt(y,10)+"px "+parseInt(z,10)+"px"),""!=C&&(e.style.backgroundColor=C)):(""!=I&&(e.style.height=P+"px"),"1"==G?(n.outsideTop="3px solid rgb(0, 216, 255)",
n.outsideLeft="0px rgb(0, 0, 0)",n.outsideRight="0px rgb(0, 0, 0)",n.outsideBottom="3px solid rgb(0, 216, 255)",n.insideRow="1px solid rgb(0, 0, 0)",n.insideCol="1px solid rgb(0, 0, 0)",e.style.borderCollapse="collapse",e.style.fontSize="10pt",e.setAttribute("cellSpacing","0"),e.setAttribute("cellPadding","3")):"2"==G?(e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.borderColor="#000000",e.style.fontSize="10pt",e.style.borderCollapse="collapse",e.setAttribute("border","1"),e.setAttribute("cellSpacing",
"0")):"3"==G?(e.style.borderWidth="1px",e.style.borderStyle="dashed",e.style.borderColor="#000000",e.style.fontSize="10pt",e.style.borderCollapse="collapse",e.setAttribute("border","1"),e.setAttribute("cellSpacing","0")):"4"==G?(e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.borderColor="#000000",e.style.fontSize="10pt",e.style.borderCollapse="collapse",e.setAttribute("border","1"),e.setAttribute("cellSpacing","0")):"5"==G?(e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.borderColor=
"#000000",e.style.fontSize="10pt",e.style.borderCollapse="collapse",e.setAttribute("border","1"),e.setAttribute("cellSpacing","0")):"6"==G?(e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.borderColor="#000000",e.style.fontSize="10pt",e.style.borderCollapse="collapse",e.setAttribute("border","1"),e.setAttribute("cellSpacing","0")):"7"==G?(e.style.borderWidth="medium",e.style.borderStyle="solid",e.style.borderColor="#000000",e.style.fontSize="10pt",e.setAttribute("rules","none"),e.setAttribute("cellSpacing",
"0")):"8"==G?(e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.borderColor="#000000",e.style.fontSize="10pt",e.style.borderCollapse="collapse",e.setAttribute("border","1"),e.setAttribute("cellSpacing","0")):"9"==G?(e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.borderColor="#000000",e.style.fontSize="10pt",e.style.borderCollapse="collapse",e.setAttribute("border","1"),e.setAttribute("cellSpacing","0")):"10"==G?(e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.borderColor=
"#000000",e.style.fontSize="10pt",e.style.borderCollapse="collapse",e.setAttribute("border","1")):"11"==G?(e.style.borderStyle="hidden",e.style.borderColor="#ffffff",e.style.fontSize="10pt",e.setAttribute("border","1"),e.setAttribute("rules","none"),e.setAttribute("frame","void"),e.setAttribute("cellSpacing","0")):"12"==G&&(e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.borderColor="#000000",e.style.fontSize="10pt",e.style.borderCollapse="collapse",e.setAttribute("border","1"),e.setAttribute("rules",
"rows"),e.setAttribute("cellSpacing","0")));0<O&&(e.style.marginLeft=O+"px");g=_iframeDoc.createElement("tbody");for(m=0;m<a;m++){p=_iframeDoc.createElement("tr");for(q=0;q<c;q++){if("3"!=b)"2"==E?0==q?(t=_iframeDoc.createElement("th"),"Y"==D&&(t.scope="row")):t=_iframeDoc.createElement("td"):"3"==E?0==m?(t=_iframeDoc.createElement("th"),"Y"==D&&(t.scope="col")):t=_iframeDoc.createElement("td"):"4"==E?0==q||0==m?(t=_iframeDoc.createElement("th"),"Y"!=D||0==q&&0==m||(0==q&&(t.scope="row"),0==m&&(t.scope=
"col"))):t=_iframeDoc.createElement("td"):t=_iframeDoc.createElement("td"),t.innerHTML=H;else{if("5"==G&&0!=q&&0==m)continue;"1"==G||"2"==G||"5"==G||"10"==G||"11"==G||"12"==G?0==m?(t=_iframeDoc.createElement("th"),"Y"==B&&(t.scope="col")):t=_iframeDoc.createElement("td"):"6"==G?0==m||0==q?(t=_iframeDoc.createElement("th"),"Y"!=B||0==q&&0==m||(0==q&&(t.scope="row"),0==m&&(t.scope="col"))):t=_iframeDoc.createElement("td"):"8"==G?0==q?(t=_iframeDoc.createElement("th"),"Y"==B&&(t.scope="row")):t=_iframeDoc.createElement("td"):
t=_iframeDoc.createElement("td");"1"==G?0==m?(v=_iframeDoc.createElement("p"),v.innerHTML="T"+(q+1),t.appendChild(v)):t.innerHTML=H:t.innerHTML=H}p.appendChild(t);"3"==b&&"1"!=G?"4"==G?(t.style.borderWidth="1px",t.style.borderStyle="dashed",t.style.borderColor="#000000"):"5"==G?0==q&&0==m&&t.setAttribute("colSpan",c):"6"==G?0==m?0!=q&&(t.style.backgroundColor="#e5e5e5"):0==q&&(t.style.backgroundColor="#e9f5f7"):"8"==G&&0==q&&(t.style.backgroundColor="#e9f5f7"):("3"==b&&"1"==G&&0==m&&(t.style.textAlign=
"center"),t.style.border="1px solid #000000","N"==h&&(0==m&&""!=n.outsideTop&&(t.style.borderTop=n.outsideTop,showBorderForNoneClass(t,"dext_table_border_t")),0==q&&""!=n.outsideLeft&&(t.style.borderLeft=n.outsideLeft,showBorderForNoneClass(t,"dext_table_border_l")),q==c-1&&""!=n.outsideRight&&(t.style.borderRight=n.outsideRight,showBorderForNoneClass(t,"dext_table_border_r")),m==a-1&&""!=n.outsideBottom&&(t.style.borderBottom=n.outsideBottom,showBorderForNoneClass(t,"dext_table_border_b"))));""!=
f&&(t.style.width=f+"px");""!=F&&(t.style.height=F+"px")}g.appendChild(p);"3"==b&&("2"==G?0==m&&(p.style.backgroundColor="#e5e5e5"):"5"==G?0==m&&(p.style.backgroundColor="#e5e5e5"):"9"==G?p.style.backgroundColor=0==m%2?"#e5e5e5":"#e9f5f7":"10"==G?0==m?p.style.backgroundColor="#e5e5e5":m==parseInt(a,10)-1&&(p.style.backgroundColor="#e9f5f7"):"11"==G?0==m&&(p.style.backgroundColor="#e5e5e5"):"12"==G&&0==m&&(p.style.backgroundColor="#e5e5e5"))}""!=u&&(h=_iframeDoc.createElement("caption"),h.innerHTML=
u,e.appendChild(h));e.appendChild(g);("3"!=b||"3"==b&&"1"==G)&&setBorderTableAndAllCell(e,n);a=getFirstRange().range;K=getMyElementNode(a.startContainer);"p"!=K.tagName.toLowerCase()||"<br>"!=K.innerHTML&&"<br/>"!=K.innerHTML&&"<br />"!=K.innerHTML&&""!=K.innerHTML&&"&nbsp;"!=K.innerHTML||a.selectNode(K);a.deleteContents();a.insertNode(e);try{a.selectNode(e);var V=e.parentNode;"body"!=V.tagName.toLowerCase()&&a.setEndAfter(V);a.collapse(!1);DEXTTOP.DEXT5.browser.ie&&8==DEXTTOP.DEXT5.browser.ieVersion||
(d=getFirstRange(),d.sel.addRange(a));DEXTTOP.DEXT5.browser.gecko&&doSetCaretPosition(V,1);repairBodyFirstLastTag(!1);var S=e.rows[0].cells[0];S&&(createTableCellDefValue(S),0==checkCellBRValue()&&""==S.innerHTML&&(S.innerHTML="<p></p>"),doSetCaretPosition(S.childNodes[0],0))}catch(aa){}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell");ActiveCurrTable=e}
function command_InsertTableProperty(a,c,b,d,e,f,g,h,m,n,p,q,u,t,v,w,x,y,z,C,D,E,F,H){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var A=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");null==F||""==F?removeAttribute(A,"id"):""!=F&&(A.id=F);""==E?(removeAttribute(A,"class"),A.style.fontSize=DEXTTOP.G_CURREDITOR._setting.font_size):null!=E&&(A.className=E,A.style.fontSize="");""!=b&&(A.style.width=
b+"px");""!=d&&(A.style.height=d+"px");"N"==e?A.style.borderCollapse="collapse":"Y"==e&&(A.style.borderCollapse="separate");A.align=""==f?"":f;A.style.marginLeft=0<D?D+"px":"";"N"==e?A.style.border=DEXTTOP.DEXT5.browser.gecko?"1px #000000":"1px none #000000":"Y"==e&&(""!=g.outsideTop&&(A.style.borderTop=g.outsideTop,showBorderForNoneClass(A,"dext_table_border_t")),""!=g.outsideLeft&&(A.style.borderLeft=g.outsideLeft,showBorderForNoneClass(A,"dext_table_border_l")),""!=g.outsideRight&&(A.style.borderRight=
g.outsideRight,showBorderForNoneClass(A,"dext_table_border_r")),""!=g.outsideBottom&&(A.style.borderBottom=g.outsideBottom,showBorderForNoneClass(A,"dext_table_border_b")));""!=h&&A.setAttribute("cellSpacing",h);""!=m&&A.setAttribute("cellPadding",m);c=!1;b=0;d=A.childNodes.length;for(a=0;a<d;a++)if(A.childNodes[a].nodeName.match(/caption/i)){c=!0;b=a;break}""==n?c&&A.removeChild(A.childNodes[b]):c?A.childNodes[b].innerHTML=n:(a=_iframeDoc.createElement("caption"),a.innerHTML=n,A.appendChild(a));
""!=p&&A.setAttribute("summary",p);if("Y"==q)A.style.backgroundImage="",A.style.backgroundAttachment="",A.style.backgroundRepeat="",A.style.backgroundPosition="",A.style.backgroundColor="",A.removeAttribute("background");else if("N"==q&&(""!=u&&("[FAIL]"==u.substring(0,6)&&(A.setAttribute("alt",u.substring(6,u.length)),u=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),A.style.backgroundImage="url("+u+")",A.removeAttribute("background"),A.style.backgroundAttachment=""==t?"":t,A.style.backgroundRepeat=
""==v?"":v,""!=w||""!=x)&&(A.style.backgroundPosition=parseInt(w,10)+"px "+parseInt(x,10)+"px"),""!=y))for(A.style.backgroundColor=y,p=A.rows,q=A.rows.length,a=0;a<q;a++)for(u=p[a].cells,t=p[a].cells.length,n=0;n<t;n++)""!=u[n].style.backgroundColor&&(u[n].style.backgroundColor="");n=GetTableSelectionCellsPosition(A,!0);p=n.arrOutSideLeft.length;q=n.arrOutSideRight.length;u=n.arrOutSideTop.length;t=n.arrOutSideBottom.length;v=n.arrSelected.length;w=[];x=[];y=[];c=[];b="";if(""==g.outsideLeft)for(a=
0;a<p;a++)b=n.arrOutSideLeft[a].style.borderLeftWidth+" "+n.arrOutSideLeft[a].style.borderLeftStyle+" "+n.arrOutSideLeft[a].style.borderLeftColor,w.push(b);if(""==g.outsideRight)for(a=0;a<q;a++)b=n.arrOutSideRight[a].style.borderRightWidth+" "+n.arrOutSideRight[a].style.borderRightStyle+" "+n.arrOutSideRight[a].style.borderRightColor,x.push(b);if(""==g.outsideTop)for(a=0;a<u;a++)b=n.arrOutSideTop[a].style.borderTopWidth+" "+n.arrOutSideTop[a].style.borderTopStyle+" "+n.arrOutSideTop[a].style.borderTopColor,
y.push(b);if(""==g.outsideBottom)for(a=0;a<t;a++)b=n.arrOutSideBottom[a].style.borderBottomWidth+" "+n.arrOutSideBottom[a].style.borderBottomStyle+" "+n.arrOutSideBottom[a].style.borderBottomColor,c.push(b);if(""!=g.insideRow)for(a=0;a<v;a++)command_ApplyCellProperty("inRow",n.arrSelected[a],g);if(""!=g.insideCol)for(a=0;a<v;a++)command_ApplyCellProperty("inCol",n.arrSelected[a],g);if(""==g.outsideLeft)for(a=0;a<p;a++)g.outsideLeft=w[a],command_ApplyCellProperty("left",n.arrOutSideLeft[a],g);else for(a=
0;a<p;a++)command_ApplyCellProperty("left",n.arrOutSideLeft[a],g);if(""==g.outsideRight)for(a=0;a<q;a++)g.outsideRight=x[a],command_ApplyCellProperty("right",n.arrOutSideRight[a],g);else for(a=0;a<q;a++)command_ApplyCellProperty("right",n.arrOutSideRight[a],g);if(""==g.outsideTop)for(a=0;a<u;a++)g.outsideTop=y[a],command_ApplyCellProperty("top",n.arrOutSideTop[a],g);else for(a=0;a<u;a++)command_ApplyCellProperty("top",n.arrOutSideTop[a],g);if(""==g.outsideBottom)for(a=0;a<t;a++)g.outsideBottom=c[a],
command_ApplyCellProperty("bottom",n.arrOutSideBottom[a],g);else for(a=0;a<t;a++)command_ApplyCellProperty("bottom",n.arrOutSideBottom[a],g);g=A.rows.length;for(a=p=0;a<g;a++)for(p=A.rows[a].cells.length,n=0;n<p;n++)"2"==C?0==n?(q=_iframeDoc.createElement("th"),setCopyAllObjectAtributes(A.rows[a].cells[n],q,!0),"Y"==z&&(q.scope="row")):(q=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(A.rows[a].cells[n],q,!0)):"3"==C?0==a?(q=_iframeDoc.createElement("th"),setCopyAllObjectAtributes(A.rows[a].cells[n],
q,!0),"Y"==z&&(q.scope="col")):(q=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(A.rows[a].cells[n],q,!0)):"4"==C?0==a||0==n?(q=_iframeDoc.createElement("th"),setCopyAllObjectAtributes(A.rows[a].cells[n],q,!0),"Y"==z&&(0!=a||0!=n?(0==a&&(q.scope="col"),0==n&&(q.scope="row")):q.scope="")):(q=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(A.rows[a].cells[n],q,!0)):(q=_iframeDoc.createElement("td"),setCopyAllObjectAtributes(A.rows[a].cells[n],q,!0)),"N"==z&&(q.scope=""),"1"!=A.rows[a].cells[n].colSpan&&
(q.colSpan=A.rows[a].cells[n].colSpan),"1"!=A.rows[a].cells[n].rowSpan&&(q.rowSpan=A.rows[a].cells[n].rowSpan),""!=A.rows[a].cells[n].style.width&&(q.style.width=A.rows[a].cells[n].style.width),""!=A.rows[a].cells[n].style.height&&(q.style.height=A.rows[a].cells[n].style.height),""!=A.rows[a].cells[n].style.textAlign&&(q.style.textAlign=A.rows[a].cells[n].style.textAlign),""!=A.rows[a].cells[n].style.verticalAlign&&(removeAttribute(A.rows[a].cells[n],"valign"),q.style.verticalAlign=A.rows[a].cells[n].style.verticalAlign),
"nowrap"==A.rows[a].cells[n].style.whiteSpace&&(q.style.whiteSpace="nowrap"),""!=A.rows[a].cells[n].style.backgroundImage&&(q.style.backgroundImage=A.rows[a].cells[n].style.backgroundImage),""!=A.rows[a].cells[n].style.backgroundAttachment&&(q.style.backgroundAttachment=A.rows[a].cells[n].style.backgroundAttachment),""!=A.rows[a].cells[n].style.backgroundRepeat&&(q.style.backgroundRepeat=A.rows[a].cells[n].style.backgroundRepeat),""!=A.rows[a].cells[n].style.backgroundPosition&&(q.style.backgroundPosition=
A.rows[a].cells[n].style.backgroundPosition),""!=A.rows[a].cells[n].style.backgroundColor&&(q.style.backgroundColor=A.rows[a].cells[n].style.backgroundColor),q.innerHTML=A.rows[a].cells[n].innerHTML,A.rows[a].cells[n].parentNode.replaceChild(q,A.rows[a].cells[n]);setAdjustTableWidthHeight(A);ClearDraggingTableCellSelected();0<A.rows[0].cells[0].childNodes.length?setTimeout(function(){doSetCaretPosition(A.rows[0].cells[0].childNodes[0],0)},0):setTimeout(function(){doSetCaretPosition(A.rows[0].cells[0],
0)},0);DEXTTOP.G_CURREDITOR._iconEnable("focusInCell");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertCellProperty(a,c,b,d,e,f,g,h,m,n,p,q,u,t,v,w){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();c=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");a="";"collapse"==c.style.borderCollapse?a="N":"separate"==c.style.borderCollapse&&(a="Y");c=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);c=GetTableSelectionCellsPosition(c,!1);ClearDraggingTableCellSelected();var x=c.arrOutSideLeft.length,
y=c.arrOutSideRight.length,z=c.arrOutSideTop.length,C=c.arrOutSideBottom.length,D=c.arrSelected.length,E=[],F=[],H=[],A=[],I="";if(""==h.outsideLeft)for(var B=0;B<x;B++)I=c.arrOutSideLeft[B].style.borderLeftWidth+" "+c.arrOutSideLeft[B].style.borderLeftStyle+" "+c.arrOutSideLeft[B].style.borderLeftColor,E.push(I);if(""==h.outsideRight)for(B=0;B<y;B++)I=c.arrOutSideRight[B].style.borderRightWidth+" "+c.arrOutSideRight[B].style.borderRightStyle+" "+c.arrOutSideRight[B].style.borderRightColor,F.push(I);
if(""==h.outsideTop)for(B=0;B<z;B++)I=c.arrOutSideTop[B].style.borderTopWidth+" "+c.arrOutSideTop[B].style.borderTopStyle+" "+c.arrOutSideTop[B].style.borderTopColor,H.push(I);if(""==h.outsideBottom)for(B=0;B<C;B++)I=c.arrOutSideBottom[B].style.borderBottomWidth+" "+c.arrOutSideBottom[B].style.borderBottomStyle+" "+c.arrOutSideBottom[B].style.borderBottomColor,A.push(I);if(""!=h.insideRow)for(B=0;B<D;B++)command_ApplyCellProperty("inRow",c.arrSelected[B],h,b,d,f,g,m,n,p,q,u,t,v,w);else for(B=0;B<
D;B++)command_ApplyCellProperty("inRow",c.arrSelected[B],null,b,d,f,g,m,n,p,q,u,t,v,w);if(""!=h.insideCol)for(B=0;B<D;B++)command_ApplyCellProperty("inCol",c.arrSelected[B],h,b,d,f,g,m,n,p,q,u,t,v,w);else for(B=0;B<D;B++)command_ApplyCellProperty("inCol",c.arrSelected[B],null,b,d,f,g,m,n,p,q,u,t,v,w);if(""==h.outsideLeft)for(B=0;B<x;B++)h.outsideLeft=E[B],command_ApplyCellProperty("left",c.arrOutSideLeft[B],h,b,d,f,g,m,n,p,q,u,t,v,w);else for(B=0;B<x;B++)"N"==a&&(E=getCellNearLeftTop(c.arrOutSideLeft[B]),
command_ApplyEdgeReduce(E.arrLeft,h,"left")),command_ApplyCellProperty("left",c.arrOutSideLeft[B],h,b,d,f,g,m,n,p,q,u,t,v,w);if(""==h.outsideRight)for(B=0;B<y;B++)h.outsideRight=F[B],command_ApplyCellProperty("right",c.arrOutSideRight[B],h,b,d,f,g,m,n,p,q,u,t,v,w);else for(B=0;B<y;B++)"N"==a&&(E=getCellNearLeftTop(c.arrOutSideRight[B]),command_ApplyEdgeReduce(E.arrRight,h,"right")),command_ApplyCellProperty("right",c.arrOutSideRight[B],h,b,d,f,g,m,n,p,q,u,t,v,w);if(""==h.outsideTop)for(B=0;B<z;B++)h.outsideTop=
H[B],command_ApplyCellProperty("top",c.arrOutSideTop[B],h,b,d,f,g,m,n,p,q,u,t,v,w);else for(B=0;B<z;B++)"N"==a&&(E=getCellNearLeftTop(c.arrOutSideTop[B]),command_ApplyEdgeReduce(E.arrTop,h,"top")),command_ApplyCellProperty("top",c.arrOutSideTop[B],h,b,d,f,g,m,n,p,q,u,t,v,w);if(""==h.outsideBottom)for(B=0;B<C;B++)h.outsideBottom=A[B],command_ApplyCellProperty("bottom",c.arrOutSideBottom[B],h,b,d,f,g,m,n,p,q,u,t,v,w);else for(B=0;B<C;B++)"N"==a&&(E=getCellNearLeftTop(c.arrOutSideBottom[B]),command_ApplyEdgeReduce(E.arrBottom,
h,"bottom")),command_ApplyCellProperty("bottom",c.arrOutSideBottom[B],h,b,d,f,g,m,n,p,q,u,t,v,w);if(null!=e)if(0<D)for(B=0;B<D;B++)command_ApplyTitleCell(c.arrSelected[B],e);else command_ApplyTitleCell(DEXTTOP.G_SELECTED_ELEMENT,e);0<DEXTTOP.G_SELECTED_ELEMENT.childNodes.length?doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT.childNodes[0],0):doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT,0);DEXTTOP.G_CURREDITOR._iconEnable("focusInCell");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0}function command_ApplyTitleCell(a,c){var b=a.tagName.toLowerCase(),d="",e;"Y"==c?(d="th",e=_iframeDoc.createElement("th")):"N"==c?(d="td",e=_iframeDoc.createElement("td")):(e=_iframeDoc.createElement(a.tagName.toLowerCase()),d=a.tagName.toLowerCase());b!=d&&(setCopyAllObjectAtributes(a,e,!0),e.innerHTML=a.innerHTML,e.style.width=a.style.width,e.style.height=a.style.height,1<a.colSpan&&(e.colSpan=a.colSpan),1<a.rowSpan&&(e.rowSpan=a.rowSpan));b!=d&&a.parentNode.replaceChild(e,a)}
function command_ApplyCellProperty(a,c,b,d,e,f,g,h,m,n,p,q,u,t,v){""==v?removeAttribute(c,"class"):null!=v&&(c.className=v);""==d?c.style.textAlign="":null!=d&&(c.style.textAlign=d);""==e?c.style.verticalAlign="":null!=e&&(removeAttribute(c,"valign"),c.style.verticalAlign=e);null!=f&&(""==f?c.removeAttribute("scope"):c.scope=f);null!=g&&("Y"==g?c.style.whiteSpace="nowrap":"N"==g&&"nowrap"==c.style.whiteSpace&&(c.style.whiteSpace=""));b&&((d=RegExp("^\\s\\s*$","g"),"top"==a)?b.outsideTop.match(d)?
""!=c.style.borderTop&&(c.style.borderTop="1px solid rgb(0, 0, 0)",showBorderForNoneClass(c,"dext_table_border_t")):(c.style.borderTop=b.outsideTop,showBorderForNoneClass(c,"dext_table_border_t")):"bottom"==a?b.outsideBottom.match(d)?""!=c.style.borderBottom&&(c.style.borderBottom="1px solid rgb(0, 0, 0)",showBorderForNoneClass(c,"dext_table_border_b")):(c.style.borderBottom=b.outsideBottom,showBorderForNoneClass(c,"dext_table_border_b")):"left"==a?b.outsideLeft.match(d)?""!=c.style.borderLeft&&(c.style.borderLeft=
"1px solid rgb(0, 0, 0)",showBorderForNoneClass(c,"dext_table_border_l")):(c.style.borderLeft=b.outsideLeft,showBorderForNoneClass(c,"dext_table_border_l")):"right"==a?b.outsideRight.match(d)?""!=c.style.borderRight&&(c.style.borderRight="1px solid rgb(0, 0, 0)",showBorderForNoneClass(c,"dext_table_border_r")):(c.style.borderRight=b.outsideRight,showBorderForNoneClass(c,"dext_table_border_r")):"inRow"==a?b.insideRow.match(d)?(""!=c.style.borderTop&&(c.style.borderTop="1px solid rgb(0, 0, 0)",showBorderForNoneClass(c,
"dext_table_border_t")),""!=c.style.borderBottom&&(c.style.borderBottom="1px solid rgb(0, 0, 0)",showBorderForNoneClass(c,"dext_table_border_b"))):(c.style.borderTop=b.insideRow,c.style.borderBottom=b.insideRow,showBorderForNoneClass(c,"dext_table_border_t"),showBorderForNoneClass(c,"dext_table_border_b")):"inCol"==a&&(b.insideCol.match(d)?(""!=c.style.borderLeft&&(c.style.borderLeft="1px solid rgb(0, 0, 0)",showBorderForNoneClass(c,"dext_table_border_l")),""!=c.style.borderRight&&(c.style.borderRight=
"1px solid rgb(0, 0, 0)",showBorderForNoneClass(c,"dext_table_border_r"))):(c.style.borderLeft=b.insideCol,c.style.borderRight=b.insideCol,showBorderForNoneClass(c,"dext_table_border_l"),showBorderForNoneClass(c,"dext_table_border_r"))));if("Y"==h)c.style.backgroundImage="",c.style.backgroundAttachment="",c.style.backgroundRepeat="",c.style.backgroundPosition="",c.style.backgroundColor="",c.removeAttribute("background");else if("N"==h){""!=m&&("[FAIL]"==m.substring(0,6)&&(c.setAttribute("alt",m.substring(6,
m.length)),m=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),c.style.backgroundImage="url("+m+")",c.removeAttribute("background"));""==n?c.style.backgroundAttachment="":null!=n&&(c.style.backgroundAttachment=n);""==p?c.style.backgroundRepeat="":null!=p&&(c.style.backgroundRepeat=p);a=c.style.backgroundPosition;b=["0px","0px"];""!=a&&(b=a.split(" "));if(""!=q&&""!=u)c.style.backgroundPosition=parseInt(q,10)+"px "+parseInt(u,10)+"px";else if(""!=q||""!=u)""!=q&&""==u?c.style.backgroundPosition=
parseInt(q,10)+"px "+b[1]:""==q&&""!=u&&(c.style.backgroundPosition=b[0]+" "+parseInt(u,10)+"px");""!=t&&(c.style.backgroundColor=t)}}function command_ApplyEdgeReduce(a,c,b){if(a){var d=a.length;if("top"==b)for(var e=0;e<d;e++)a[e].style.borderBottom=c.outsideTop;if("left"==b)for(e=0;e<d;e++)a[e].style.borderRight=c.outsideLeft;if("right"==b)for(e=0;e<d;e++)a[e].style.borderLeft=c.outsideRight;if("bottom"==b)for(e=0;e<d;e++)a[e].style.borderTop=c.outsideBottom}}
function command_InsertRowColumn(a,c,b,d,e){dext_src_init(c);restoreSelection();setFocusToBody();"R"==b&&"U"==d?command_insertRowUp(a,_dext_editor,e):"R"==b&&"D"==d?command_insertRowDown(a,_dext_editor,e):"C"==b&&"R"==d?command_insertCellRight(a,_dext_editor,e):"C"==b&&"L"==d&&command_insertCellLeft(a,_dext_editor,e)}
function command_RowProperty(a,c,b,d,e,f){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);setTableRowSelect(a);a=getCellNearLeftTop(a);c=a.arrSelected.length;for(var g=0;g<c;g++)""!=d&&(a.arrSelected[g].style.height=d+"px"),a.arrSelected[g].style.textAlign=""==e?"":e,a.arrSelected[g].style.verticalAlign=""==f?"":f,""!=b&&(a.arrSelected[g].style.backgroundColor=b);
b=GetTableSelectionCells();1<b.length?DEXTTOP.G_CURREDITOR._iconEnable("selectedMultiCell"):1==b.length&&DEXTTOP.G_CURREDITOR._iconEnable("selectedSingleCell");a&&0<a.arrSelected.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_ColumnProperty(a,c,b,d,e,f,g){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);setTableColumnSelect(a);a=getCellNearLeftTop(a);c=a.arrSelected.length;for(g=0;g<c;g++)""!=d&&(a.arrSelected[g].style.width=d+"px"),a.arrSelected[g].style.textAlign=""==e?"":e,a.arrSelected[g].style.verticalAlign=""==f?"":f,""!=b&&(a.arrSelected[g].style.backgroundColor=
b);b=GetTableSelectionCells();1<b.length?DEXTTOP.G_CURREDITOR._iconEnable("selectedMultiCell"):1==b.length&&DEXTTOP.G_CURREDITOR._iconEnable("selectedSingleCell");a&&a.arrSelected.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_InsertCellBorder(a,c,b,d,e,f){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table");var g="";"collapse"==a.style.borderCollapse?g="N":"separate"==a.style.borderCollapse&&(g="Y");a=!1;c=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);c=getCellNearLeftTop(c);for(var h=c.arrSelected.length,m=0;m<h;m++)a=c.arrSelected[m],""!=b&&(a.style.borderTop=b),
""!=d&&(a.style.borderLeft=d),""!=e&&(a.style.borderRight=e),""!=f&&(a.style.borderBottom=f),a=!0;if("N"==g){if(""!=b)for(g=c.arrTop.length,m=0;m<g;m++)c.arrTop[m].style.borderBottom=b,a=!0;if(""!=d)for(b=c.arrLeft.length,m=0;m<b;m++)c.arrLeft[m].style.borderRight=d,a=!0;if(""!=e)for(d=c.arrRight.length,m=0;m<d;m++)c.arrRight[m].style.borderLeft=e,a=!0;if(""!=f)for(e=c.arrBottom.length,m=0;m<e;m++)c.arrBottom[m].style.borderTop=f,a=!0}a&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0)}function command_cellBGColor(a,c,b){dext_src_init(c);0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);a=getCellNearLeftTop(a);c=a.arrSelected.length;for(var d=0;d<c;d++)a.arrSelected[d].style.backgroundColor=b;a&&0<a.arrSelected.length&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_InsertDogBGImg(a,c,b,d,e,f,g){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();"Y"==b?(_iframeDoc.body.style.backgroundImage="",_iframeDoc.body.style.backgroundAttachment="",_iframeDoc.body.style.backgroundRepeat="",_iframeDoc.body.style.backgroundColor="",_iframeDoc.body.removeAttribute("background"),DEXTTOP.G_CURREDITOR._PageProp.bodyimage="",DEXTTOP.G_CURREDITOR._PageProp.bodycolor="",
DEXTTOP.G_CURREDITOR._PageProp.bodyattachment="",DEXTTOP.G_CURREDITOR._PageProp.bodyrepeat="",showRuler(DEXTTOP.G_CURREDITOR)):"N"==b&&("1"!=DEXTTOP.G_CURREDITOR._config.horizontalLine.use&&("[FAIL]"==d.substring(0,6)&&(_iframeDoc.body.setAttribute("alt",d.substring(6,d.length)),d=DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),_iframeDoc.body.style.backgroundImage="url("+d+")",_iframeDoc.body.removeAttribute("background"),_iframeDoc.body.style.backgroundAttachment=e,_iframeDoc.body.style.backgroundRepeat=
f,""!=g&&(_iframeDoc.body.style.backgroundColor=g)),DEXTTOP.G_CURREDITOR._PageProp.bodyimage="url("+d+")",""!=g&&(DEXTTOP.G_CURREDITOR._PageProp.bodycolor=g),DEXTTOP.G_CURREDITOR._PageProp.bodyattachment=e,DEXTTOP.G_CURREDITOR._PageProp.bodyrepeat=f);DEXTTOP.G_CURREDITOR._PageProp.bshowgrid&&1==DEXTTOP.G_CURREDITOR._PageProp.bshowgrid?changeBodyImageProperty(!1):"1"!=DEXTTOP.G_CURREDITOR._config.horizontalLine.use&&changeBodyImageProperty(!0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0}
function command_InsertImage(a,c,b,d,e,f,g,h){dext_src_init(c);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();b=getFirstRange().range;try{0==b.toString().length&&setRestoreCaretPos(!1)}catch(m){}b=_iframeDoc.createElement("img");if("CCODE_001"==DEXTTOP.G_CURREDITOR._config.custom_code)d=h.srcURL,e=d.split("|"),"emoticon"==G_LAST_CMD||h.input_url_checked?"[FAIL]"==d.substring(0,6)?(b.setAttribute("src",DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),b.setAttribute("alt",
d.substring(6,d.length).replace(/"/g,"'"))):b.setAttribute("src",d):("[FAIL]"==e[2].substring(0,6)?(b.setAttribute("src",DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),b.setAttribute("alt",e[2].substring(6,e[2].length).replace(/"/g,"'"))):b.setAttribute("src",e[2]),b.setAttribute("filemimeinfo",d),0==h.input_url_checked&&"[FAIL]"!=e[2].substring(0,6)&&insertImageSrc(DEXTTOP.G_CURREDITOR,e[2])),b.setAttribute("title",h.title),"emoticon"==G_LAST_CMD||h.input_url_checked?"[FAIL]"!=
d.substring(0,6)&&b.setAttribute("alt",h.alt):"[FAIL]"!=e[2].substring(0,6)&&b.setAttribute("alt",h.alt),"undefined"!=typeof h.id&&""!=h.id&&b.setAttribute("id",h.id),"undefined"!=typeof h.className&&""!=h.className&&b.setAttribute("class",h.className),"0"!=DEXTTOP.G_CURREDITOR._config.allowImgSize&&(""!=h.width&&(b.style.width=h.width+"px"),""!=h.height&&(b.style.height=h.height+"px")),""!=h.margin_top.toString()&&(b.style.marginTop=h.margin_top+"px"),""!=h.margin_right.toString()&&(b.style.marginRight=
h.margin_right+"px"),""!=h.margin_bottom.toString()&&(b.style.marginBottom=h.margin_bottom+"px"),""!=h.margin_left.toString()&&(b.style.marginLeft=h.margin_left+"px"),""!=h.align&&b.setAttribute("align",h.align),""==h.border?b.setAttribute("border","0"):b.setAttribute("border",h.border),""==h.border?b.style.border="0px solid":b.style.border=h.border+"px solid";else if("0"!=DEXTTOP.G_CURREDITOR._config.allowImgSize&&(""!=h.width&&(b.style.width=h.width+"px"),""!=h.height&&(b.style.height=h.height+
"px")),"[FAIL]"==h.srcURL.substring(0,6)?(b.setAttribute("src",DEXTTOP.G_CURREDITOR._config.webPath.image+"dialog/image_xbox.jpg"),b.setAttribute("alt",h.srcURL.substring(6,h.srcURL.length).replace(/"/g,"'"))):b.src=h.srcURL,0==h.input_url_checked&&"[FAIL]"!=h.srcURL.substring(0,6)&&insertImageSrc(DEXTTOP.G_CURREDITOR,h.srcURL),b.setAttribute("title",h.title),"[FAIL]"!=h.srcURL.substring(0,6)&&b.setAttribute("alt",h.alt),"undefined"!=typeof h.id&&""!=h.id&&b.setAttribute("id",h.id),"undefined"!=typeof h.className&&
""!=h.className&&b.setAttribute("class",h.className),""!=h.margin_top.toString()&&(b.style.marginTop=h.margin_top+"px"),""!=h.margin_right.toString()&&(b.style.marginRight=h.margin_right+"px"),""!=h.margin_bottom.toString()&&(b.style.marginBottom=h.margin_bottom+"px"),""!=h.margin_left.toString()&&(b.style.marginLeft=h.margin_left+"px"),""!=h.align&&b.setAttribute("align",h.align),""==h.border?b.setAttribute("border","0"):b.setAttribute("border",h.border),""==h.border?b.style.border="0px solid":b.style.border=
h.border+"px solid",(d=h.img_attr_info_arr)&&1<d.length)for(e=d.length,f=1;f<e;f++)g=d[f].split("^"),2==g.length&&b.setAttribute(g[0],g[1]);d=getFirstRange().range;d.collapse(!0);d.insertNode(b);DEXTTOP.DEXT5.browser.safari&&h.continueInsert&&(e=_iframeDoc.createElement("br"),d.insertNode(e));try{if(void 0==b.nextSibling||null==b.nextSibling){var n=d.getDocument().createTextNode(" ");b.parentNode.appendChild(n)}}catch(p){}d.selectNode(b);d.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();
rangy.getSelection(_iframeWin).addRange(d);""!=h.linkurl&&(b.parentNode.removeChild(b),command_InsertHyperLink(a,c,{type:"hyperlink",text:b.outerHTML,url:h.linkurl,target:h.linktarget,title:h.linktitle}));DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertMedia(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange();0<a.range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);range.pasteHtml(b);a.sel.collapseToEnd();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertReplacedImg(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=makeImageElementForObject(b);c=getFirstRange().range;c.deleteContents();c.insertNode(a);c.selectNode(c.endContainer);c.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c);rangy.getSelection(_iframeWin).collapseToEnd();
DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_InsertLinkMedia(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange();c=a.range;0<c.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);c.pasteHtml(b);a.sel.collapseToEnd();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_ModifyReplacedImg(a,c,b,d){dext_src_init(c);restoreSelection();setFocusToBody();a=d.getAttribute("dext5customdata");if(null!=a&&void 0!=a)if(a=getDextCustomData(a),"iframe"==b.type||"iframe"==b.type2)a.type=b.type,a.type2=b.type2,a.src=b.src?b.src:"",a.id=b.id?b.id:"",a.name=b.name?b.name:"",a.title=b.title?b.title:"",a.className=b.className?b.className:"",a.width=b.width?b.width:"",a.height=b.height?b.height:"",a.align=b.align?b.align:"",a.scrolling=b.scrolling?b.scrolling:"",a.frameBorder=
b.frameBorder?b.frameBorder:"",a.attributes=b.attributes?b.attributes:"",a.caption=b.caption?b.caption:"",-1<b.width.indexOf("px")||-1<b.width.indexOf("%")||-1<b.width.indexOf("pt")?d.style.width=b.width:""!=b.width&&(d.style.width=b.width+"px"),-1<b.height.indexOf("px")||-1<b.height.indexOf("%")||-1<b.height.indexOf("pt")?d.style.height=b.height:d.style.height=b.height+"px",d.align=b.align;else if("flash"==b.type||"flash"==b.type2){a.type=b.type;a.type2=b.type2;a.src=b.src;a.width=b.width;a.height=
b.height;a.hspace=b.hspace;a.vspace=b.vspace;a.scale=b.scale;a.allowScriptAccess=b.allowScriptAccess;a.quality=b.quality;a.align="";a.menu=b.menu;a.play=b.play;a.loop=b.loop;a.allowFullScreen=b.allowFullScreen;a.flashvars=b.flashvars;a.caption=b.caption;-1<b.width.indexOf("px")||-1<b.width.indexOf("%")||-1<b.width.indexOf("pt")?d.style.width=b.width:d.style.width=b.width+"px";-1<b.height.indexOf("px")||-1<b.height.indexOf("%")||-1<b.height.indexOf("pt")?d.style.height=b.height:d.style.height=b.height+
"px";d.align="";c="absbottom absmiddle absmiddle bottom left middle right texttop top".split(" ");for(var e=c.length,f=0;f<e;f++)if(b.align==c[f]){d.align=b.align;a.align=b.align;break}}}
function command_InsertHR(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);var b=getFirstRange().range;if(b){for(var d=_iframeDoc.createElement("hr"),e=!1,f=b.startContainer;f;){if("p"===f.nodeName.toLowerCase()){e=!0;break}f=f.firstChild}e&&(b.setStartBefore(f),b.collapse(!0));b.insertNode(d);b.selectNode(d);
b.collapse(!1)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_insertHorizontalLine(a,c,b,d,e){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=getFirstRange().range;c=_iframeDoc.createElement("hr");if(a){d?(c.style.cssText=d.style.cssText,100>e&&DEXTTOP.DEXT5.util.dextSetAttribute(c,"width",e,"%")):b&&(100>b.width&&DEXTTOP.DEXT5.util.dextSetAttribute(c,"width",
b.width,"%"),""==b.height?c.style.height="1px":c.style.height=b.height+"px",""!=b.align&&(c.align=b.align),c.style.backgroundColor=""!=b.color?b.color:"#000000",c.style.color=b.color,c.style.border="0px");b=!1;for(d=a.startContainer;d;){if("p"===d.nodeName.toLowerCase()){b=!0;break}d=d.firstChild}b&&(a.setStartBefore(d),a.collapse(!0));a.insertNode(c);a.selectNode(c);a.collapse(!1)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertIframe(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=_iframeDoc.createElement("iframe");""!=b.id&&(a.id=b.id);""!=b.name&&(a.name=b.name);""!=b.title&&(a.title=b.title);a.style.width=""!=b.width?b.width+"px":"400px";a.style.height=""!=b.height?b.height+"px":"400px";a.align=b.align;a.scrolling=
b.scroll;a.frameBorder=1==b.border?1:0;a.src=b.url;b=getFirstRange().range;b.deleteContents();b.insertNode(a);b.selectNode(b.endContainer);b.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertHyperLink(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;if("hyperlink"==b.type||"image"==b.type)if(0==a.toString().length){""==b.text&&(b.text=b.url);c=_iframeDoc.createElement("a");c.innerHTML=b.text;c.setAttribute("href",b.url);c.target=b.target;c.title=b.title;"undefined"!=typeof b.id&&(c.id=b.id);"undefined"!=typeof b.className&&(c.className=b.className);
"insert_file"==b.type2&&(c.setAttribute("DEXT5InsertFile",""),"1"==DEXTTOP.G_CURREDITOR._config.attachFileImage&&attachFileImage(c,b));a.deleteContents();a.insertNode(c);a.selectNode(c);b=b.text.replace(/"/g,"'").match(RegExp("srcs*=s*(\"|')(([^\"';]*))(\"|')","gi"));var d="";b&&0<b.length&&(d=b[0].replace("src=",""),d=d.replace(/\'/g,""),c.getElementsByTagName("img")[0].src=d)}else{_iframeDoc.execCommand("CreateLink",!1,b.url);c=getFirstRange().range;0==!!c&&(c=a);c=getNodesInRange(c);for(var d=
c.length,e=0;e<d;e++)"a"==c[e].nodeName.toLowerCase()&&(c[e].target=b.target,c[e].title=b.title,"undefined"!=typeof b.id&&(c[e].id=b.id),"undefined"!=typeof b.className&&(c[e].className=b.className),"insert_file"==b.type2&&(c[e].setAttribute("DEXT5InsertFile",""),"1"==DEXTTOP.G_CURREDITOR._config.attachFileImage&&attachFileImage(c[e],b)))}else"bookmark"==b.type&&(0==a.toString().length?(""==b.text&&(b.text=b.bookname),c=_iframeDoc.createElement("a"),c.innerHTML=b.text,c.href=b.bookname,a.deleteContents(),
a.insertNode(c),a.selectNode(c)):(_iframeDoc.execCommand("CreateLink",!1,b.bookname),getNodesInRange(a)));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();try{rangy.getSelection(_iframeWin).addRange(a)}catch(f){alert("DEXT5 Hyperlink error : "+f)}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertBookmark(a,c,b,d){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=_iframeDoc.createElement("a");""==b&&(b="&nbsp;");a.innerHTML=b;a.setAttribute("id",d);a.setAttribute("name",d);a.className="dext5_bookmark";b=getFirstRange().range;b.deleteContents();d=b.getDocument().createTextNode("\u00a0");b.insertNode(d);
b.insertNode(a);b.selectNode(a.nextSibling);b.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertSymbol(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;a.deleteContents();0<a.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a.pasteHtml(b+'<span id="dext_symbol">dext_symbol</span>');b=_iframeDoc.getElementById("dext_symbol");doSetCaretPosition(b,1);b.parentNode.removeChild(b);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0}function command_TableSelect(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();if(a=getFirstRange().range)a=GetTDTHCell(a.startContainer),"select_cell"==b?setTableCellSelect(a):"select_row"==b?setTableRowSelect(a):"select_column"==b?setTableColumnSelect(a):"select_all"==b&&setTableAllSelect(a)}
function command_TableWidthHeightRemove(a,c,b){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();"width_remove"==b?setTableWidthRemove():"height_remove"==b?setTableHeightRemove():"width_height_remove"==b&&setTableWidthHeightRemove();DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_TableSameWidthheight(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();"same_width"==b?setTableWidthSame():"same_height"==b?setTableHeightSame():"same_widthheight"==b&&(setTableWidthSame(),setTableHeightSame());a=GetTableSelectionCells();1<a.length?DEXTTOP.G_CURREDITOR._iconEnable("selectedMultiCell"):1==a.length&&DEXTTOP.G_CURREDITOR._iconEnable("selectedSingleCell");
DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_TableRowClone(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange().range;b&&(0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),b=GetTDTHCell(b.startContainer),setTableRowClone(b),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell"),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_VerticalAlignExcute(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();if(a=getFirstRange().range){var d=GetTDTHCell(a.startContainer);a=GetTableSelectionCells(d);c=a.length;0==c&&(a[0]=d,c=a.length);for(d=0;d<c;d++){var e=a[d];removeAttribute(e,"valign");e.style.verticalAlign=b}a=GetTableSelectionCells();c=a.length;0==c?DEXTTOP.G_CURREDITOR._iconEnable("focusInCell"):
1==c?DEXTTOP.G_CURREDITOR._iconEnable("selectedSingleCell"):1<c&&DEXTTOP.G_CURREDITOR._iconEnable("selectedMultiCell");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}
function command_editorSetting(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();DEXTTOP.G_CURREDITOR._setting.grid_color=b.grid_color;DEXTTOP.G_CURREDITOR._setting.grid_color_nm=b.grid_color_nm;DEXTTOP.G_CURREDITOR._setting.grid_spans=b.grid_spans;DEXTTOP.G_CURREDITOR._setting.grid_form=b.grid_form;DEXTTOP.G_CURREDITOR._setting.page_title=b.page_title;DEXTTOP.G_CURREDITOR._setting.encoding=b.encoding;DEXTTOP.G_CURREDITOR._setting.doctype=b.doctype;DEXTTOP.G_CURREDITOR._setting.xhtml=b.xhtml;
DEXTTOP.G_CURREDITOR._setting.lang=b.lang;DEXTTOP.G_CURREDITOR._PageProp.encoding=b.encoding;DEXTTOP.G_CURREDITOR._PageProp.doctype=b.doctype;DEXTTOP.G_CURREDITOR._PageProp.xmlnsname=b.xhtml;DEXTTOP.G_CURREDITOR._PageProp.lang=b.lang;DEXTTOP.G_CURREDITOR._setting.auto_save=b.auto_save;setAutoSave(DEXTTOP.G_CURREDITOR);1==DEXTTOP.G_CURREDITOR._config.ruler.use&&(DEXTTOP.G_CURREDITOR._setting.ruler_position=b.ruler_px,set_ruler_point_position(DEXTTOP.G_CURREDITOR),set_ruler_pointline_position(DEXTTOP.G_CURREDITOR));
setDoctypeProperty(DEXTTOP.G_CURREDITOR._docType[b.doctype],b.encoding,b.lang,b.xhtml);a=DEXTTOP.G_CURREDITOR._config.webPath.image+"grid/bggrid_"+b.grid_spans+"_"+b.grid_color_nm.replace(" ","").toLowerCase()+"_"+b.grid_form+".png";_iframeDoc.title=b.page_title;DEXTTOP.G_CURREDITOR._PageProp.bshowgrid&&1==DEXTTOP.G_CURREDITOR._PageProp.bshowgrid&&(DEXTTOP.G_CURREDITOR._PageProp.gridimage="url("+DEXTTOP.DEXT5.util.url.full_url(a)+")",DEXTTOP.G_CURREDITOR._PageProp.gridattachment="scroll",DEXTTOP.G_CURREDITOR._PageProp.gridrepeat=
"repeat",changeBodyImageProperty(!1))}
function command_InsertInputText(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;c=_iframeDoc.createElement("input");c.type=b.insertType;c.setAttribute("value",b.insertValue);c.id=b.insertId;c.className=b.insertClass;c.title=b.insertTitle;""!=b.insertAlign&&(c.style.textAlign=b.insertAlign);""!=b.insertWidth&&(c.style.width=b.insertWidth+"px");""!=b.insertHeight&&(c.style.height=
b.insertHeight+"px");b.insertDisabled?c.disabled=!0:c.removeAttribute("disabled");b.insertReadonly?c.readOnly=!0:c.removeAttribute("readonly");""!=b.insertSize&&(c.size=b.insertSize);""!=b.insertMaxlength&&(c.maxLength=b.insertMaxlength);var d=b.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=b.insertEventNameArr[g],f+=b.insertEventFunctionArr[g];d={type:"event"};d.eventName=e;d.eventFunction=f;setDextCustomData(c,d)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&
8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(c.setAttribute("name",b.insertName),a.insertNode(c),a.selectNode(c)):(c=c.outerHTML,c=c.replace(">",' name="'+b.insertName+'" />'),a.pasteHtml(c));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputRadioOrCheckbox(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;c=_iframeDoc.createElement("input");c.type=b.insertType;c.id=b.insertId;c.className=b.insertClass;c.title=b.insertTitle;""!=b.insertWidth&&(c.style.width=b.insertWidth+"px");""!=b.insertHeight&&(c.style.height=b.insertHeight+"px");b.insertDisabled?c.disabled=!0:c.removeAttribute("disabled");
b.insertChecked?(c.checked=!0,c.setAttribute("checked","checked")):(c.checked=!1,c.removeAttribute("chekced"));c.setAttribute("value",b.insertValue);var d=b.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=b.insertEventNameArr[g],f+=b.insertEventFunctionArr[g];d={type:"event"};d.eventName=e;d.eventFunction=f;setDextCustomData(c,d)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(c.setAttribute("name",
b.insertName),a.insertNode(c),a.selectNode(c)):(c=c.outerHTML,c=c.replace(">",' name="'+b.insertName+'" />'),a.pasteHtml(c));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputButton(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;c=_iframeDoc.createElement("input");c.type=b.insertType;c.setAttribute("value",b.insertValue);c.id=b.insertId;c.className=b.insertClass;c.title=b.insertTitle;""!=b.insertAlign&&(c.style.textAlign=b.insertAlign);""!=b.insertWidth&&(c.style.width=b.insertWidth+"px");""!=b.insertHeight&&(c.style.height=
b.insertHeight+"px");b.insertDisabled?c.disabled=!0:c.removeAttribute("disabled");var d=b.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=b.insertEventNameArr[g],f+=b.insertEventFunctionArr[g];d={type:"event"};d.eventName=e;d.eventFunction=f;setDextCustomData(c,d)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(c.setAttribute("name",b.insertName),a.insertNode(c),a.selectNode(c)):(c=c.outerHTML,
c=c.replace(">",' name="'+b.insertName+'" />'),a.pasteHtml(c));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputSelect(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;c=_iframeDoc.createElement("select");c.setAttribute("value",b.insertValue);c.multiple=b.insertMultiselect;c.id=b.insertId;c.className=b.insertClass;c.title=b.insertTitle;c.size=b.insertSize;""!=b.insertWidth&&(c.style.width=b.insertWidth+"px");""!=b.insertHeight&&(c.style.height=b.insertHeight+
"px");b.insertDisabled?c.disabled=!0:c.removeAttribute("disabled");for(var d=b.insertOptionsArr.length,e=0;e<d;e++){var f=_iframeDoc.createElement("option");f.innerHTML=b.insertOptionsArr[e];f.setAttribute("value",b.insertOptionsValueArr[e]);f.selected=b.insertOptionsSelected[e];c.appendChild(f)}var g=b.insertEventNameArr.length;if(0<g){f=d="";for(e=0;e<g;e++)0!=e&&(d+="\x0B",f+="\x0B"),d+=b.insertEventNameArr[e],f+=b.insertEventFunctionArr[e];e={type:"event"};e.eventName=d;e.eventFunction=f;setDextCustomData(c,
e)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(c.setAttribute("name",b.insertName),a.insertNode(c),a.selectNode(c)):(c=c.outerHTML,c=c.replace(">",' name="'+b.insertName+'" >'),a.pasteHtml(c));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputTextarea(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;c=_iframeDoc.createElement("textarea");c.value=b.insertValue;c.innerHTML=b.insertValue;c.id=b.insertId;c.className=b.insertClass;c.title=b.insertTitle;""!=b.insertRows&&(c.rows=b.insertRows);""!=b.insertCols&&(c.cols=b.insertCols);""!=b.insertWrap&&(c.wrap=b.insertWrap);""!=b.insertWidth&&(c.style.width=
b.insertWidth+"px");""!=b.insertHeight&&(c.style.height=b.insertHeight+"px");""!=b.insertAlign&&(c.style.textAlign=b.insertAlign);b.insertDisabled?c.disabled=!0:c.removeAttribute("disabled");b.insertReadonly?c.readOnly=!0:c.removeAttribute("readonly");var d=b.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=b.insertEventNameArr[g],f+=b.insertEventFunctionArr[g];d={type:"event"};d.eventName=e;d.eventFunction=f;setDextCustomData(c,d)}a.deleteContents();
DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(c.setAttribute("name",b.insertName),a.insertNode(c),a.selectNode(c)):(c=c.outerHTML,c=c.replace(">",' name="'+b.insertName+'" >'),a.pasteHtml(c));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputHidden(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;c=_iframeDoc.createElement("input");c.type="hidden";c.setAttribute("value",b.insertValue);c.id=b.insertId;c.className=b.insertClass;c.title=b.insertTitle;a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(c.setAttribute("name",b.insertName),
a.insertNode(c),a.selectNode(c)):(c=c.outerHTML,c=c.replace(">",' name="'+b.insertName+'" />'),a.pasteHtml(c));DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0;ReplaceRealObjectToImage(!1);a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_InsertInputImage(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=getFirstRange().range;c=_iframeDoc.createElement("input");c.type=b.insertType;c.setAttribute("value",b.insertValue);c.id=b.insertId;c.className=b.insertClass;c.title=b.insertTitle;c.src=b.insertSrc;b.insertAlign&&(c.align=b.insertAlign);""!=b.insertWidth&&(c.style.width=b.insertWidth+"px");""!=b.insertHeight&&(c.style.height=
b.insertHeight+"px");b.insertDisabled?c.disabled=!0:c.removeAttribute("disabled");var d=b.insertEventNameArr.length;if(0<d){for(var e="",f="",g=0;g<d;g++)0!=g&&(e+="\x0B",f+="\x0B"),e+=b.insertEventNameArr[g],f+=b.insertEventFunctionArr[g];d={type:"event"};d.eventName=e;d.eventFunction=f;setDextCustomData(c,d)}a.deleteContents();DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?(c.setAttribute("name",b.insertName),a.insertNode(c),a.selectNode(c)):(c=c.outerHTML,
c=c.replace(">",' name="'+b.insertName+'" />'),a.pasteHtml(c));a.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(a);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_fullScreen(a,c){var b=document.getElementById("ue_editor_holder_"+a);if(""==DEXTTOP.G_CURREDITOR.FrameStatus){var d=DEXTTOP.DEXTDOC.getElementById("div_resizebar_"+DEXTTOP.G_CURREDITOR.ID);d&&(d.style.display="none");originScrollSize=getWindowScrollPos(DEXTTOP.DEXTWIN);orginEditorSize=getClientSize(b);var d=document.getElementById("dext_topstatusbar_"+a),e=document.getElementById("dext_menu_"+a),f=document.getElementById("dext_toolbar_"+a),g=document.getElementById("dext_statusbar_"+
a),h,m,n,p;d&&(h=getClientRect(d));e&&(m=getClientRect(e));f&&(n=getClientRect(f));g&&(p=getClientRect(g));d=0;m&&(d+=m.bottom-m.top);n&&(d+=n.bottom-n.top);d=h?d+(h.bottom-h.top):d+1;d=p?d+(p.bottom-p.top):d+1;c.baseMenuToolbarHeight=d;h=window.frameElement;originfull.margin1=DEXTTOP.DEXTDOC.documentElement.style.margin;originfull.padding1=DEXTTOP.DEXTDOC.documentElement.style.padding;originfull.border1=DEXTTOP.DEXTDOC.documentElement.style.border;originfull.height1=DEXTTOP.DEXTDOC.documentElement.style.height;
originfull.overflow1=DEXTTOP.DEXTDOC.documentElement.style.overflow;originfull.margin2=DEXTTOP.DEXTDOC.body.style.margin;originfull.padding2=DEXTTOP.DEXTDOC.body.style.padding;originfull.border2=DEXTTOP.DEXTDOC.body.style.border;originfull.height2=DEXTTOP.DEXTDOC.body.style.height;originfull.overflow2=DEXTTOP.DEXTDOC.body.style.overflow;DEXTTOP.DEXTDOC.documentElement.style.overflow="hidden";DEXTTOP.DEXTDOC.documentElement.style.padding="0";DEXTTOP.DEXTDOC.documentElement.style.margin="0";DEXTTOP.DEXTDOC.documentElement.style.border=
"0";DEXTTOP.DEXTDOC.documentElement.style.height="100%";DEXTTOP.DEXTDOC.body.style.overflow="hidden";DEXTTOP.DEXTDOC.body.style.padding="0";DEXTTOP.DEXTDOC.body.style.margin="0";DEXTTOP.DEXTDOC.body.style.border="0";DEXTTOP.DEXTDOC.body.style.height="100%";originfull.overflow3=h.style.overflow;originfull.position3=h.style.position;originfull.zIndex=h.style.zIndex;getClientRect(h);h.style.overflow="hidden";h.style.position="absolute";h.style.width="100%";h.style.height="100%";h.style.zIndex=c._config.zIndex;
m=getWindowClientSize(DEXTTOP.DEXTWIN);h.style.width=m[0]+"px";h.style.height=m[1]+"px";b.style.height=m[1]-c.baseMenuToolbarHeight+"px";h.style.left="0px";h.style.top="0px";b=getClientRect(h);relativePos=isRelativePosition(h);0<b.left||0<b.top?relativePos=!0:(h.style.left="0px",h.style.top="0px");setBackupHiddenStyle(h,DEXTTOP.DEXTWIN);DEXTTOP.G_CURREDITOR.FrameStatus="full_size";setEditorHeight(c,!1);resizeDextWin();DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTWIN,"resize",resizeDextWin)}else{if(d=DEXTTOP.DEXTDOC.getElementById("div_resizebar_"+
DEXTTOP.G_CURREDITOR.ID))d.style.display="";DEXTTOP.DEXT5.util.removeEvent(DEXTTOP.DEXTWIN,"resize",resizeDextWin);h=window.frameElement;DEXTTOP.DEXTDOC.documentElement.style.margin=originfull.margin1;DEXTTOP.DEXTDOC.documentElement.style.padding=originfull.padding1;DEXTTOP.DEXTDOC.documentElement.style.border=originfull.border1;DEXTTOP.DEXTDOC.documentElement.style.height=originfull.height1;DEXTTOP.DEXTDOC.documentElement.style.overflow=originfull.overflow1;DEXTTOP.DEXTDOC.body.style.margin=originfull.margin2;
DEXTTOP.DEXTDOC.body.style.padding=originfull.padding2;DEXTTOP.DEXTDOC.body.style.border=originfull.border2;DEXTTOP.DEXTDOC.body.style.height=originfull.height2;DEXTTOP.DEXTDOC.body.style.overflow=originfull.overflow2;h.style.overflow=originfull.overflow3;h.style.position=originfull.position3;h.style.left="0px";h.style.top="0px";h.style.width="100%";h.style.height="100%";h.width="100%";h.height="100%";h.style.zIndex=originfull.zIndex;setRestorreHiddenStyle();setEditorHeight(c,!0);b.style.height=c._defaultHeight+
"px";DEXTTOP.DEXTWIN.scroll(originScrollSize[0],originScrollSize[1]);DEXTTOP.G_CURREDITOR.FrameStatus=""}b=[];"full_size"==DEXTTOP.G_CURREDITOR.FrameStatus?b.push("full_screen"):removeArrayItemByValue(b,"full_screen");DEXTTOP.G_CURREDITOR._iconSelected(b);setTimeout(function(){try{DEXTTOP.DEXTWIN.dext_full_screen_event(a,DEXTTOP.G_CURREDITOR.FrameStatus)}catch(b){}},100)}
function command_grid(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();if(c._PageProp.bshowgrid&&1==c._PageProp.bshowgrid)changeBodyImageProperty(!0),c._PageProp.bshowgrid=!1;else{var b=c._config.webPath.image+"grid/bggrid_"+c._setting.grid_spans+"_"+c._setting.grid_color_nm.replace(" ","").toLowerCase()+"_"+c._setting.grid_form+".png";c._PageProp.gridimage="url("+DEXTTOP.DEXT5.util.url.full_url(b)+")";c._PageProp.gridattachment="scroll";c._PageProp.gridrepeat="repeat";c._PageProp.bshowgrid=
!0;changeBodyImageProperty(!1)}}
function command_InsertPasteDialogHtml(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();a=DEXTTOP.DEXT5.util.officeClean(b,!1);a=DEXTTOP.DEXT5.util.htmlRevision(a);a=xssReplaceScript(null,a);try{var d=DEXTTOP.DEXTWIN.dext_editor_beforepaste_event(a);d&&(a=d)}catch(e){}-1<a.indexOf("dext5customdata")&&(a=checkExistCustomData(a));_iframeDoc.execCommand("inserthtml",!1,a);0>a.indexOf("dext5customdata")&&(ReplaceImageToRealObject(!0),DEXTTOP.G_CURREDITOR._dextCustomDataMode=!0,removeAllDextCustomData(),
ReplaceRealObjectToImage(!1))}
function command_tableIndentOutdent(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();a=GetParentbyTagName(parent.G_SELECTED_ELEMENT,"table",!0);c=parseIntOr0(c._config.tableDefaultInoutdent);var d=parseIntOr0(a.style.marginLeft,10);"indent"==b?d=989>=d?d+c:999:"outdent"==b&&(d=d>=c?d-c:0);a.style.marginLeft=d+"px";doSetCaretPosition(DEXTTOP.G_SELECTED_ELEMENT,0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}function command_loadAutoSave(a){a._cmd_new();var c=getAutoSaveHtml(a.ID);c&&""!=c&&DEXTTOP.DEXT5.setHtmlValueExWithDocType(c,a.ID)}
function command_useRuler(a){a=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+a);getIframeDocument(a);"1"==DEXTTOP.G_CURREDITOR._config.ruler.view?(DEXTTOP.G_CURREDITOR._config.ruler.view="0",hideRuler(DEXTTOP.G_CURREDITOR)):(DEXTTOP.G_CURREDITOR._config.ruler.view="1",showRuler(DEXTTOP.G_CURREDITOR),moveRulerPosition(null))}
function command_Direction(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange().range;var d=getFirstRange().sel,e=elems=null,f=[];if(a&&a.startContainer){if(1==a.startContainer.nodeType){var e=getMyElementNode(a.startContainer),g=rangy.dom.getBody(_iframeDoc).childNodes,h=g.length;for(c=0;c<h;c++)f.push(g[c])}else e=getMyElementNode(a.startContainer),f=getNodesInRange(a);elems=getDirectionNode(a,d,e,f);d=elems.length;for(c=0;c<d;c++)elems[c].dir=b.toLowerCase();
setMenuIconRealable(getMyElementNode(a.startContainer))}}function command_tableCopy(a,c){1==getCopyCellData()&&doSetCaretPosition(DrageEndCell.childNodes[0],1)}
function command_tablePaste(a,c){try{dext_src_init(c._EDITOR.design);var b,d=getFirstRange().range;null!=DEXTTOP.G_SELECTED_ELEMENT?"html"==DEXTTOP.G_SELECTED_ELEMENT.tagName.toLowerCase()?b=_iframeDoc.body.lastChild:d&&d.startContainer&&(b=getMyElementNode(d.startContainer)):d&&d.startContainer&&(b=getMyElementNode(d.startContainer));null!=b&&doSetCaretPosition(b,0);0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();1==setPasteCellData()&&(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}catch(e){}}
function command_intablePaste(a,c){try{dext_src_init(c._EDITOR.design);var b,d=getFirstRange().range;null!=DEXTTOP.G_SELECTED_ELEMENT?"html"==DEXTTOP.G_SELECTED_ELEMENT.tagName.toLowerCase()?b=_iframeDoc.body.lastChild:d&&d.startContainer&&(b=getMyElementNode(d.startContainer)):d&&d.startContainer&&(b=getMyElementNode(d.startContainer));null!=b&&doSetCaretPosition(b,0);0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DrageStartCell=null;1==setPasteCellData()&&
(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}catch(e){}}
function command_listNumberBullets(a,c,b,d){restoreSelection();setFocusToBody();a=getFirstRange();c=a.range;var e=getFirstRange().range,f=null;e&&e.startContainer&&(f=getMyElementNode(e.startContainer));e=GetParentbyTagName(f,"ol");f=GetParentbyTagName(f,"ul");"N"==b&&f||"N"==b&&!e&&!f?DoExecuteCommand2(a.sel,c,"insertOrderedList"):("B"==b&&e||"B"==b&&!e&&!f)&&DoExecuteCommand2(a.sel,c,"insertUnOrderedList");e=getFirstRange().range;f=null;e&&e.startContainer&&(f=getMyElementNode(e.startContainer));
f&&(a=null,"N"==b?a=GetParentbyTagName(f,"ol"):"B"==b&&(a=GetParentbyTagName(f,"ul")),a&&(a.style.listStyleType=d))}
function command_setClassStyle(a,c){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange(),d=b.range;0<a.UndoManager.charCount&&a.UndoManager.putUndo();try{if(0==d.toString().length){var e=GetTableSelectionCells();if(0!=e.length){var f=e.length,g="BackCompat"==DEXTTOP.G_CURREDITOR._DOC.compatMode,h=DEXTTOP.DEXT5.browser.quirks;if(DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion||1==g||1==h))for(var m=0;m<f;m++){var n=e[m];"<p></p>"==n.innerHTML.toLowerCase()?
n.innerHTML="<p>&nbsp;</p>":"<span></span>"==n.innerHTML.toLowerCase()?n.innerHTML="<span>&nbsp;</span>":""==n.innerHTML.toLowerCase()&&(n.innerHTML="&nbsp;")}for(m=0;m<f;m++){b.sel.removeAllRanges();d.selectNode(e[m]);b.sel.addRange(d);var p=rangy.createCssClassApplier(c);p.applyToSelection(_iframeWin);rangy.getSelection(_iframeWin).removeAllRanges()}b.sel.removeAllRanges();doSetCaretPosition(DrageEndCell.childNodes[0],1);!DEXTTOP.DEXT5.browser.ie||8!=DEXTTOP.DEXT5.browser.ieVersion&&1!=g&&1!=h||
(DEXTTOP.G_CURREDITOR._LastRange=null)}}else p=rangy.createCssClassApplier(c),p.applyToSelection(_iframeWin);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(q){}}
function command_removeClassStyle(a,c){dext_src_init(a._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange(),d=b.range;0<a.UndoManager.charCount&&a.UndoManager.putUndo();try{if(0==d.toString().length){var e=GetTableSelectionCells();if(0!=e.length){for(var f=e.length,g=0;g<f;g++){b.sel.removeAllRanges();d.selectNode(e[g]);b.sel.addRange(d);var h=rangy.createCssClassApplier(c);h.undoToSelection(_iframeWin);rangy.getSelection(_iframeWin).removeAllRanges()}b.sel.removeAllRanges();
doSetCaretPosition(DrageEndCell.childNodes[0],1);!DEXTTOP.DEXT5.browser.ie||8!=DEXTTOP.DEXT5.browser.ieVersion&&1!=iframeQuirks&&1!=browserQuirks||(DEXTTOP.G_CURREDITOR._LastRange=null)}}else h=rangy.createCssClassApplier(c),h.undoToSelection(_iframeWin);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(m){}}
function command_custom(a,c,b,d){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();try{DEXTTOP.DEXTWIN.dext_editor_custom_action(b,a,d)}catch(e){}}
function command_formatPainter(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();try{var b=getFirstRange().range;if(0==b.toString().length)if(0<GetTableSelectionCells().length)null!=c._formatPainterList&&(c._formatPainterList=null,c._iconEnable(""));else{c._formatPainterList=[];var d=b.endContainer.parentNode;if(1==d.nodeType&&"BODY"!=d.tagName){var e=getElementInParentStyleProperty(d,"margin");c._formatPainterList.margin=e;var f=getElementInParentStyleProperty(d,"marginTop");
c._formatPainterList.marginTop=f;var g=getElementInParentStyleProperty(d,"marginBottom");c._formatPainterList.marginBottom=g;var h=getElementInParentStyleProperty(d,"marginRight");c._formatPainterList.marginRight=h;var m=getElementInParentStyleProperty(d,"marginLeft");c._formatPainterList.marginLeft=m;var n=getElementInParentStyleProperty(d,"lineHeight");""==n&&(n="");c._formatPainterList.lineHeight=n;var p=getElementInParentStyleProperty(d,"fontFamily");""==p&&(p=getStyle(d,"fontFamily"));c._formatPainterList.fontFamily=
p;var q=getElementInParentStyleProperty(d,"fontSize");""==q&&(q="");c._formatPainterList.fontSize=q;var u=getElementInParentStyleProperty(d,"color");""==u&&(u="");c._formatPainterList.color=u;var t=getElementInParentStyleProperty(d,"backgroundColor");""==t&&(t="");c._formatPainterList.backgroundColor=t;c._formatPainterList.textAlign=getStyle(d,"textAlign");var v=getElementInParentStyleProperty(d,"paddingLeft");""==v&&(v="");c._formatPainterList.paddingLeft=v;c._formatPainterList.b=""!=getElementInParentTag(d,
["b","strong"])?!0:!1;if(0==c._formatPainterList.b){var w=getElementInParentStyleProperty(d,"fontWeight");""!=w&&"normal"!=w&&(c._formatPainterList.b=!0)}c._formatPainterList.i=""!=getElementInParentTag(d,["em","i"])?!0:!1;c._formatPainterList.u=""!=getElementInParentTag(d,["u"])?!0:!1;c._formatPainterList.s=""!=getElementInParentTag(d,["s","strike"])?!0:!1;c._formatPainterList.sup=""!=getElementInParentTag(d,["sup"])?!0:!1;c._formatPainterList.sub=""!=getElementInParentTag(d,["sub"])?!0:!1}else c._formatPainterList=
null}}catch(x){c._formatPainterList=null}}
function command_applyFormat(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();if(null!=c._formatPainterList)try{var b=c._formatPainterList;b.nowApplying="1";0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();getFirstRange();command_removeCss(a,c);""!=b.margin&&command_margin(a,c,"margin",b.margin);""!=b.marginTop&&command_margin(a,c,"marginTop",b.marginTop);""!=b.marginBottom&&command_margin(a,c,"marginBottom",b.marginBottom);""!=b.marginLeft&&
command_margin(a,c,"marginLeft",b.marginLeft);""!=b.marginRight&&command_margin(a,c,"marginRight",b.marginRight);1==b.b&&command_bold(a,c);1==b.i&&command_italic(a,c);1==b.u&&command_underline(a,c);1==b.s&&command_strikeThrough(a,c);""!=b.color&&command_fontColor(a,c._EDITOR.design,b.color);""!=b.fontFamily&&command_fontfamily(a,c._EDITOR.design,b.fontFamily);""!=b.fontSize&&0>b.fontSize.indexOf("em")&&command_fontsize(a,c._EDITOR.design,b.fontSize);""!=b.lineHeight&&command_lineHeight(a,c._EDITOR.design,
b.lineHeight);var d=b.textAlign;""!=d&&-1<d.toLowerCase().indexOf("right")?command_align(a,c,"right"):-1<d.toLowerCase().indexOf("left")?command_align(a,c,"left"):-1<d.toLowerCase().indexOf("center")?command_align(a,c,"center"):-1<d.toLowerCase().indexOf("full")&&command_align(a,c,"justify");""!=b.paddingLeft&&command_setIndentOutdent(a,c,b.paddingLeft);""!=b.backgroundColor&&command_fontBgColor(a,c._EDITOR.design,b.backgroundColor);1==b.sup&&command_superscript(a,c);1==b.sub&&command_subscript(a,
c);b.nowApplying="0";DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(e){b.nowApplying="0"}}
function command_setIndentOutdent(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();c=getFirstRange().range;if(!(c&&GetTDTHCell(c.startContainer)&&0<c.toString().length)){a=getNodesInRange(c);null!=c.startContainer.previousSibling&&"HEAD"==c.startContainer.previousSibling.tagName&&null==c.endContainer.nextSibling&&(a=_iframeDoc.body.childNodes);c=a.length;for(var d=0;d<c;d++)null!=a[d].parentNode&&"body"==a[d].parentNode.nodeName.toLowerCase()&&"table"!=a[d].tagName.toLowerCase()&&
(a[d].style.paddingLeft=b)}}
function command_margin(a,c,b,d){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var e=getFirstRange().range;a=GetTableSelectionCells();c=a.length;if(0==c)for(a=getNodesInRange(e),null!=e.startContainer.previousSibling&&"HEAD"==e.startContainer.previousSibling.tagName&&null==e.endContainer.nextSibling&&(a=_iframeDoc.body.childNodes),c=a.length,e=0;e<c;e++)null==a[e].parentNode||"body"!=a[e].parentNode.nodeName.toLowerCase()&&"td"!=a[e].parentNode.nodeName.toLowerCase()&&"td"!=
a[e].parentNode.nodeName.toLowerCase()||"table"==a[e].tagName.toLowerCase()||("margin"==b?a[e].style.margin=d:("marginTop"==b&&(a[e].style.marginTop=d),"marginBottom"==b&&(a[e].style.marginBottom=d),"marginLeft"==b&&(a[e].style.marginLeft=d),"marginRight"==b&&(a[e].style.marginRight=d)));else for(e=0;e<c;e++)for(var f=a[e].childNodes,g=f.length,h=0;h<g;h++)1!=f[h].nodeType||"P"!=f[h].tagName&&"SPAN"!=f[h].tagName||("margin"==b?f[h].style.margin=d:("marginTop"==b&&(f[h].style.marginTop=d),"marginBottom"==
b&&(f[h].style.marginBottom=d),"marginLeft"==b&&(f[h].style.marginLeft=d),"marginRight"==b&&(f[h].style.marginRight=d)))}function command_imageAlign(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();getFirstRange();a=DEXTTOP.G_SELECTED_IMAGE_ELEMENT;""==b?a.removeAttribute("align"):a.setAttribute("align",b)}
function command_letterSpacing(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();a=getFirstRange().range;try{var d=getElementsFromSelection(),e=d.length;if(0==a.toString().length){var f=GetTableSelectionCells(),g=f.length;if(0==g)return!1;1!=isApplyFormat&&ClearDraggingTableCellSelected();d=[];a=null;for(var h=c=0;h<g;h++){d.push(f[h]);a=f[h].getElementsByTagName("*");c=a.length;for(var m=0;m<c;m++)d.push(a[m])}e=d.length}else{f="";g=!1;for(h=0;h<e;h++)f=d[h].nodeName,"TABLE"==
f&&(g=!0);g&&ClearDraggingTableAllTable()}(null==DEXTTOP.G_CURREDITOR._formatPainterList||DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)&&0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();for(var f=null,n,h=0;h<e;h++){f=d[h];n=f.tagName.toLowerCase();var g="p span font b strong i em strike u sup sub".split(" "),p=g.length;a=!1;for(m=0;m<p;m++)if(g[m]==n){a=!0;break}a&&(f.style.letterSpacing=b)}if(null==DEXTTOP.G_CURREDITOR._formatPainterList||
DEXTTOP.G_CURREDITOR._formatPainterList&&"1"!=DEXTTOP.G_CURREDITOR._formatPainterList.nowApplying)DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}catch(q){}}function command_InsertOpenFile(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();a=b.data;"html"!=b.fileExt&&"htm"!=b.fileExt&&"txt"==b.fileExt&&(a=htmlSpecialChars(b.data),a=addLineBreaker(DEXTTOP.G_CURREDITOR._config.enterTag,a));DEXTTOP.DEXT5.setHtmlContents(a)}
function command_InsertBlockquote(a,c,b){a="";switch(b.tagvalue){case "1":a="margin:0;padding:5px;border-left:3px solid #999999";break;case "2":a="margin:0;padding:5px 0 0 12px;background:url("+DEXTTOP.G_CURREDITOR._config.webPath.image+"icon/img_blockquote02.gif) no-repeat 0 0;";break;case "3":a="margin:0;padding:5px;border:1px dashed #7a7d83";break;case "4":a="margin:0;padding:5px;border:1px dashed #007ace";break;case "5":a="margin:0;padding:5px;border:1px dashed #7a7d83;background:#ebebeb";break;
case "6":a="margin:0;padding:5px;border:1px solid #7a7d83";break;case "7":a="margin:0;padding:5px;border:1px solid #007ace";break;case "8":a="margin:0;padding:5px;border:1px solid #7a7d83;background:#ebebeb";break;case "9":a="margin:0;padding:5px;border:2px solid #999";break;case "10":a="margin:0;padding:5px;border:2px solid  #007ace;background:#ebebeb"}dext_src_init(c);restoreSelection();setFocusToBody();c=getFirstRange();b=c.range;var d=GetParentbyTagName(b.startContainer,"blockquote"),e=GetParentbyTagName(b.endContainer,
"blockquote"),f=!1;null==d&&null==e||d!=e||(f=!0);if(f)d.style.cssText=a;else for(DoExecuteCommand2(c.sel,b,"indent"),c=getFirstRange().range,0==!!c&&(c=range),c=getNodesInRange(c),b=c.length,d=0;d<b;d++)if("blockquote"==c[d].nodeName.toLowerCase()){c[d].style.cssText=a;break}}
function command_inputSameWidthHeight(a,c,b){"1"==c._config.formMode&&(dext_src_init(c._EDITOR.design),restoreSelection(),setFocusToBody(),"width"==b?d5ApplySameWidth():"height"==b?d5ApplySameHeight():"widthheight"==b&&d5ApplySameWidthHeight(),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_setAccessibility(a,c,b,d,e){dext_src_init(c);a=!1;if(b.idSamMode)b.id!=b.sameOrgId&&(d.setAttribute("id",b.id),a=!0);else if(c=null,a=d.getAttribute("dext5customdata"),null!=a&&void 0!=a&&(c=getDextCustomData(a)),b.skip)d.setAttribute("dext5webaccskip","dext5webaccskip"),a=!0;else{d.removeAttribute("dext5webaccskip");a=!1;var f=d.tagName.toLowerCase();if(-1<"frame,framset,a".indexOf(f)||c&&("iframe"==c.type||"iframe"==c.type2))c?c.title=b.title:d.title=b.title,""!=b.title&&(a=!0);
else if("table"==f){if(-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("table_caption")||""==DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems)if(d.caption)if(""==b.title){c=0;for(var f=d.childNodes.length,g=0;g<f;g++)if(d.childNodes[g].nodeName.match(/caption/i)){c=g;break}d.removeChild(d.childNodes[c])}else d.caption.innerHTML=b.title,a=!0;else""!=b.title&&(a=_iframeDoc.createElement("caption"),a.innerHTML=b.title,d.insertBefore(a,d.firstChild),a=!0);else a=!0;a=a&&
""!=b.alt?!0:!1;if(-1<DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems.indexOf("table_summary")||""==DEXTTOP.G_CURREDITOR._config.accessibilityValidationItems)d.summary=b.alt}else""!=b.alt&&(a=!0),d.alt=b.alt}b=_iframeDoc.createElement("img");b.alt="web_accessibility_ok";b.src="../images/editor/dialog/check01.png";b.name="chkImg";d=e.getElementsByTagName("img");c=e.getElementsByTagName("div");a?0<c.length&&("chkImg"!=d[0].name&&e.insertBefore(b,c[0]),c[0].style.display="none"):("chkImg"==
d[0].name&&e.removeChild(d[0]),0<c.length&&(c[0].style.display=""))}
function command_calculationFormula(a,c,b){a=GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);if(null!=a){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var d;switch(b){case "horizontal_sum":case "horizontal_avg":d=getHorizontalCells(a);break;case "vertical_sum":case "vertical_avg":d=getVerticalCells(a)}for(var e=d.length,f=c=0,g=0;g<e;g++){var h=d[g].innerHTML,h=h.replace(/\r/g,""),h=h.replace(/[\n|\t]/g,""),h=h.replace(/[\v|\f]/g,""),h=h.replace(/<p><br><\/p>/gi,
"\n"),h=h.replace(/<P>&nbsp;<\/P>/gi,"\n"),h=h.replace(/<br(\s)*\/?>/gi,"\n"),h=h.replace(/<br(\s[^\/]*)?>/gi,"\n"),h=h.replace(/<\/p(\s[^\/]*)?>/gi,"\n"),h=h.replace(/<\/li(\s[^\/]*)?>/gi,"\n"),h=h.replace(/<\/tr(\s[^\/]*)?>/gi,"\n");nIdx=h.lastIndexOf("\n");-1<nIdx&&"\n"==h.substring(nIdx)&&(h=h.substring(0,nIdx));h=removeStripTags(h,null);h=unhtmlSpecialChars(h);isNaN(Number(h))||""==h||(c=command_NumCal(c,h,"+"),f++)}if("horizontal_avg"==b||"vertical_avg"==b)c=command_NumCal(c,f,"/");c||(c=0);
b=_iframeDoc.createElement("p");b.innerHTML=c;a.innerHTML="";a.appendChild(b);doSetCaretPosition(b,1);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}}
function command_NumCal(a,c,b){if(isNaN(Number(a))||isNaN(Number(c)))return!1;var d,e,f;e=/\./;e.test(a)?(a=a.toString(),d=a.split("."),d=d[1].length):d=0;e.test(c)?(c=c.toString(),e=c.split("."),e=e[1].length):e=0;d=d>e?d:e;e="1";for(var g=1;g<=d;g++)e+="0";switch(b){case "+":f=Math.round(Number(a)*e+Number(c)*e)/e;break;case "/":f=Number(a)/Number(c)}return f}
function command_tableSelection(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();if(a=getFirstRange().range){if(!b){b=GetTDTHCell(a.startContainer);if(null==b||void 0==b)return;b=GetParentbyTagName(b,"table");if(null==b)return}a=_iframeDoc.body.createControlRange();try{a.add(b),a.select(),DEXTTOP.G_SELECTED_ELEMENT=b,setMenuIconRealable(b),_iframeDoc_MouseUpMenu(null,b)}catch(d){}}}
function command_showBlocks(a,c){document.getElementById("ue_editor_holder_"+a);if(""==DEXTTOP.G_CURREDITOR.ShowBlocks){var b=DEXTTOP.G_CURREDITOR._config.webPath.css;DEXTTOP.DEXT5.isRelease||(b=DEXTTOP.G_CURREDITOR._config.webPath.css_dev);DEXTTOP.DEXT5.addUserCssUrl(b+"editor_showblocks.css?ver="+DEXTTOP.DEXT5.ReleaseVer);DEXTTOP.G_CURREDITOR.ShowBlocks="show_blocks"}else{for(var b=c._DOC.getElementsByTagName("link"),d=null,e=b.length-1;0<=e;e--)-1<b[e].href.indexOf("editor_showblocks.css")&&(d=
b[e],d.parentNode.removeChild(d));DEXTTOP.G_CURREDITOR.ShowBlocks=""}b=[];"show_blocks"==DEXTTOP.G_CURREDITOR.ShowBlocks?b.push("show_blocks"):removeArrayItemByValue(b,"show_blocks");DEXTTOP.G_CURREDITOR._iconSelected(b)}
function command_tableLock(a,c){var b=getFirstRange().range.startContainer;3==b.nodeType&&(b=b.parentNode);var d=getSelectionTable(c);if(d)if(checkLockAttr(d,!0))removeLockAttr(d),removeClassName(d,"DEXT_five_table_lock");else{var e=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultLockName,f=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultTableLockMode,g=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultShowLockIconUserMode;setClassName(d,"DEXT_five_table_lock");d.setAttribute(e,"");d.setAttribute("lock_mode",
f);d.setAttribute("show_icon",g)}else{e=GetTableSelectionCells();f=e.length;g=GetTDTHCell(b);if(0<f)d=GetParentbyTagName(e[0],"table");else{if(null==g||"TD"!=g.tagName&&"TH"!=g.tagName)return;d=GetParentbyTagName(g,"table")}d&&(checkLockAttr(d,!0)?(removeLockAttr(d),removeClassName(d,"DEXT_five_table_lock")):(e=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultLockName,f=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultTableLockMode,g=DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultShowLockIconUserMode,
setClassName(d,"DEXT_five_table_lock"),d.setAttribute(e,""),d.setAttribute("lock_mode",f),d.setAttribute("show_icon",g)))}b&&1==b.nodeType&&setMenuIconRealable(b)}
function command_cellLock(a,c){var b=GetTableSelectionCells(),d=b.length,e=getFirstRange().range.startContainer;3==e.nodeType&&(e=e.parentNode);currElem=GetTDTHCell(e);if(0<d){var f=!1;checkLockAttr(b[0],!0)&&(f=!0);for(var g=0;g<d;g++)f?(removeLockAttr(b[g]),removeClassName(b[g],"DEXT_five_cell_lock")):(b[g].setAttribute("dext_lock",""),setClassName(b[g],"DEXT_five_cell_lock"))}else{if(null==currElem||"TD"!=currElem.tagName&&"TH"!=currElem.tagName)return;checkLockAttr(currElem,!0)?(removeLockAttr(currElem),
removeClassName(currElem,"DEXT_five_cell_lock")):(currElem.setAttribute("dext_lock",""),setClassName(currElem,"DEXT_five_cell_lock"))}e&&1==e.nodeType&&setMenuIconRealable(e)}
function command_help(){var a="ko";"ko-kr"!=DEXTTOP.G_CURREDITOR._config.lang&&(a="en");var a=DEXTTOP.G_CURREDITOR._config.webPath.help+"index_"+a+".html",c=1200,b=screen.availHeight,d=40;DEXTTOP.DEXT5.browser.ie?d=40:DEXTTOP.DEXT5.browser.chrome?d=70:DEXTTOP.DEXT5.browser.gecko?d=40:DEXTTOP.DEXT5.browser.opera?d=80:DEXTTOP.DEXT5.browser.safari&&(d=100);var e=screen.availHeight;e<=b&&(b=e-d);try{c>parseInt(screen.width,10)&&(c=parseInt(screen.width,10)-50)}catch(f){}d=0;try{d=screen.width/2-c/2}catch(g){}var h=
DEXTTOP.DEXTWIN.open(a,"DEXT5Help","width="+c+","+("height="+b)+","+("left="+d+"px")+",top=0px,resizable=yes");setTimeout(function(){h.focus()},100)}function command_wordTransform(a,c){if(G_dext5plugIn){var b=DEXTTOP.DEXT5.getHtmlValueEx(a),b=G_dext5plugIn.getHTMLValueFromApplication(b,0);""!=b&&DEXTTOP.DEXT5.setBodyValue(b,a)}}
function command_InsertImagePhotoEdit(a,c){var b=DEXTTOP.G_CURREDITOR._config.photoEditorId;null!=DEXTTOP.DEXT5.config.DialogWindow?""!=b?DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup(b):DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup():""!=b?(DEXTTOP.DEXT5PHOTO.ShowPopup(b),DEXTTOP.DEXT5PHOTO.Reset(b),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!0,b)):(DEXTTOP.DEXT5PHOTO.ShowPopup(),DEXTTOP.DEXT5PHOTO.Reset(),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!0))}
function command_photoEditProperty(a,c){if(null!=DEXTTOP.G_SELECTED_ELEMENT){var b=DEXTTOP.G_CURREDITOR._config.photoEditorId;null!=DEXTTOP.DEXT5.config.DialogWindow?""!=b?(DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup(b),DEXTTOP.DEXTWIN.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src,b),DEXTTOP.DEXTWIN.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!1,b)):(DEXTTOP.DEXTWIN.DEXT5PHOTO.ShowPopup(),DEXTTOP.DEXTWIN.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src),DEXTTOP.DEXTWIN.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,
!1)):""!=b?(DEXTTOP.DEXT5PHOTO.ShowPopup(b),DEXTTOP.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src,b),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!1,b)):(DEXTTOP.DEXT5PHOTO.ShowPopup(),DEXTTOP.DEXT5PHOTO.LoadImgFromUrl(DEXTTOP.G_SELECTED_ELEMENT.src),DEXTTOP.DEXT5PHOTO.setDext5EditorID(DEXTTOP.G_CURREDITOR.ID,!1))}};var ColorCellBackColor="#d0e6fd",ColorCellDefColor="#ffffff",Mouse_IsPlain=0,Mouse_IsTableSelecting=1,Mouse_IsTableDragging=2,Mouse_IsControlSelecting=3,Mouse_IsCellDragging=4,Mouse_IsCellResizing=5,Mouse_Status=Mouse_IsPlain,DrageStartCell=null,DrageEndCell=null,ActiveCurrTable=null,ActiveLastTable=null,mouseStartPos={},mouseEndPos={},elResizeBar,elResizeBarCover,ResizeInfo={},nDraggableCellEdge=4,nPageLeftRightMargin=0,nPageTopBottomMargin=0,MIN_CELL_WIDTH=10,MIN_CELL_HEIGHT=10;
function createTableResizeBar(a){a=document.createElement("div");try{a.innerHTML='<div style="position:absolute; overflow:hidden; z-index: 99; "><div onmousedown="return false" style="background-color:#000000;filter:alpha(opacity=0);opacity:0.0;-moz-opacity:0.0;-khtml-opacity:0.0;cursor: col-resize; left: 0px; top: 0px; width: 100%; height: 100%;font-size:1px;z-index: 999; "></div></div>',elResizeBar=a.firstChild,elResizeBarCover=elResizeBar.firstChild}catch(c){}document.body.appendChild(elResizeBar);
DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"mousedown",_mousedown_ResizeBarCover);DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"dblclick",dbclick_ResizeBarCover);nPageLeftRightMargin=parseIntOr0(document.body.marginLeft)+parseIntOr0(document.body.marginRight);nPageTopBottomMargin=parseIntOr0(document.body.marginTop)+parseIntOr0(document.body.marginBottom);"CCODE_001"!==DEXTTOP.DEXT5.config.CustomCode&&"CCODE_002"!==DEXTTOP.DEXT5.config.CustomCode&&"CCODE_003"!==DEXTTOP.DEXT5.config.CustomCode&&
"CCODE_004"!==DEXTTOP.DEXT5.config.CustomCode&&"CCODE_005"!==DEXTTOP.DEXT5.config.CustomCode&&"CCODE_006"!==DEXTTOP.DEXT5.config.CustomCode&&"https:"!=location.protocol&&setTimeout(function(){try{return _R=R.toString(),_R=_R.replace(/,/gi,""),_R=_R+"?r="+___,(new Image).src=_R,!1}catch(a){}},55E3)}
function dbclick_ResizeBarCover(){if(3==ResizeInfo.nResizeMode||4==ResizeInfo.nResizeMode){var a=getFirstRange().sel;a&&a.docSelection&&"Control"==a.docSelection.type?(a=GetParentbyTagName(ResizeInfo.currCell,"table"),DEXTTOP.G_SELECTED_ELEMENT=a,DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,a)):(a._ranges.length=a.rangeCount=a.nativeSelection.rangeCount,a.rangeCount&&(a=GetParentbyTagName(ResizeInfo.currCell,"table"),
DEXTTOP.G_SELECTED_ELEMENT=a,DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.table_property,a)))}}var nStartHeight=0,nStartWidth=0;function coverResizeLayer(){elResizeBarCover.style.position="absolute";var a=getClientSize();elResizeBarCover.style.width=a.width-nPageLeftRightMargin+"px";elResizeBarCover.style.height=a.height-nPageTopBottomMargin+"px";document.body.appendChild(elResizeBarCover)}
function uncoverResizeLayer(){elResizeBar.appendChild(elResizeBarCover);elResizeBarCover.style.position="";elResizeBarCover.style.width="100%";elResizeBarCover.style.height="100%"}
function _mousedown_ResizeBarCover(a){a=getElementPos(a);nStartHeight=a.clientY;DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"mousemove",mousemove_ResizeBarCover);DEXTTOP.DEXT5.util.addEvent(document,"mouseup",mouseup_ResizeBarCover);coverResizeLayer();parseIntOr0(elResizeBar.style.width)>parseIntOr0(elResizeBar.style.height)?elResizeBar.style.height="1px":elResizeBar.style.width="1px";elResizeBar.style.border="1px dotted black";elResizeBar.style.fontSize="1pt";nStartWidth=a.clientX;nStartHeight=
a.clientY}function mousemove_ResizeBarCover(a){a=getElementPos(a);1==ResizeInfo.nResizeMode?elResizeBar.style.left=a.pageX-parseIntOr0(elResizeBar.style.width)/2+"px":elResizeBar.style.top=a.pageY-parseIntOr0(elResizeBar.style.height)/2+"px"}
function mouseup_ResizeBarCover(a){hideResizeBar();uncoverResizeLayer();elResizeBar.style.border="";DEXTTOP.DEXT5.util.removeEvent(elResizeBarCover,"mousemove",mousemove_ResizeBarCover);DEXTTOP.DEXT5.util.removeEvent(document,"mouseup",mouseup_ResizeBarCover);var c=getElementPos(a),b=a=0;2==ResizeInfo.nResizeMode&&(a=c.clientY-nStartHeight);1==ResizeInfo.nResizeMode&&(b=c.clientX-nStartWidth);c=GetParentbyTagName(ResizeInfo.currCell,"table");if(null!=c){for(var d=[],e=0,f=c.rows.length,g=0;g<f;g++)for(var h=
c.rows[g],m=h.cells.length,n=0;n<m;n++){var p=h.cells[n],q=getClientRect(p),u=getElementOffset(_iframeWin.frameElement);1==ResizeInfo.nResizeMode?nStartWidth<=q.right+u.left+2*nDraggableCellEdge&&nStartWidth>q.right+u.left-2*nDraggableCellEdge&&(u={},u.cell=p,u.right=q.right,d[e]=u,e+=1):2==ResizeInfo.nResizeMode&&nStartHeight<=q.bottom+u.top+2*nDraggableCellEdge&&nStartHeight>q.bottom+u.top-2*nDraggableCellEdge&&(u={},u.cell=p,u.right=q.bottom,d[e]=u,e+=1)}setResizeCells(b,a,d)}}
function setResizeCells(a,c,b){var d=GetParentbyTagName(ResizeInfo.currCell,"table");if(null!=d&&!(0>=b.length||0==a&&0==c)){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();for(var e=[],f=0,g=d.rows.length,h=0;h<g;h++)for(var m=d.rows[h],n=m.cells.length,p=0;p<n;p++){var q=m.cells[p],u=getClientRect(q);1==ResizeInfo.nResizeMode&&b[0].right==u.left&&(e[f]=q,f+=1)}f=0;if(1==ResizeInfo.nResizeMode){0<a&&0<e.length&&(getClientRect(e[0]),f=getElemAdjustWidthHeight(e[0]).width,
f-a<MIN_CELL_WIDTH&&(a=f-MIN_CELL_WIDTH));0>a&&0<b.length&&(getClientRect(b[0].cell),f=getElemAdjustWidthHeight(b[0].cell).width,f+a<MIN_CELL_WIDTH&&(a=MIN_CELL_WIDTH-f));if(0==e.length){h=parseIntOr0(d.style.width);if(""==d.style.width||""!=d.style.width&&-1<d.style.width.indexOf("%"))u=getClientRect(d),h=u.right-u.left;0<h+a&&(d.style.width=h+a+"px")}g=b.length;for(h=0;h<g;h++)getClientRect(b[h].cell),f=getElemAdjustWidthHeight(b[h].cell).width,f+a<MIN_CELL_WIDTH&&(a=MIN_CELL_WIDTH-f),b[h].newWidth=
f+a+"px";for(h=0;h<g;h++)b[h].cell.style.width=b[h].newWidth;g=e.length;b=[];for(h=0;h<g;h++)getClientRect(e[h]),f=getElemAdjustWidthHeight(e[h]).width,f-a<MIN_CELL_WIDTH&&(a=f-MIN_CELL_WIDTH),b[h]=f-a+"px";for(h=0;h<g;h++)e[h].style.width=b[h]}else{g=b.length;for(h=0;h<g;h++)getClientRect(b[h].cell),f=getElemAdjustWidthHeight(b[h].cell).height,f+c<MIN_CELL_HEIGHT&&(c=MIN_CELL_HEIGHT-f),b[h].newHeight=f+c+"px";for(h=0;h<g;h++)b[h].cell.style.height=b[h].newHeight}setAdjustTableWidthHeight(d);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();
DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;try{setFocusToBody()}catch(t){}}}
function setAdjustTableWidthHeight(a){if("0"!=DEXTTOP.G_CURREDITOR._config.tableAutoAdjust){var c,b,d;c=null;b=a.rows.length;if(0<b){var e=a.rows[0];d=e.cells.length;0<d&&(c=e.cells[0])}if(null!=c){var f,g;g=f=0;var h=[],m=[],n=getClientRect(c);for(c=0;c<b;c++){e=a.rows[c];d=e.cells.length;for(var p=0;p<d;p++){var q=e.cells[p],q=getClientRect(q);if(n.left==q.left){var u=q.bottom-q.top-1;g+=u}u=parseIntOr0(a.cellPadding);u=q.bottom-q.top-2-2*u+"px";h.push(u);n.top==q.top&&(u=q.right-q.left,f+=u);u=
q.right-q.left-1+"px";m.push(u)}}0<f&&0<g&&(a.style.width=f+"px",removeAttribute(a.style,"height"));for(c=f=0;c<b;c++)for(e=a.rows[c],d=e.cells.length,p=0;p<d;p++)q=e.cells[p],q.style.width=m[f],q.style.height=h[f],f++}}}function getPosition(a){for(var c=0,b=0;a;)c+=a.offsetLeft-a.scrollLeft+a.clientLeft,b+=a.offsetTop-a.scrollTop+a.clientTop,a=a.offsetParent;return{x:c,y:b}}function hideResizeBar(){elResizeBar.style.display="none"}
function showResizeBar(){elResizeBar.style.display="block";var a=getElementOffset(_iframeWin.frameElement);if(1==ResizeInfo.nResizeMode||3==ResizeInfo.nResizeMode){setResizeBarSize(2*(ResizeInfo.nBorderSize+nDraggableCellEdge),parseIntOr0(_iframeWin.frameElement.offsetHeight));var c=a.left+ResizeInfo.nBorderLeftPos+ResizeInfo.Pos.clientX-ResizeInfo.Pos.offsetX-parseIntOr0(elResizeBar.style.width);if(DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion&&"BackCompat"!=_iframeDoc.compatMode||
9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks))var b=getWindowScrollPos(_iframeWin),c=9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks&&0<b[0]?c+2:c+b[0];3==ResizeInfo.nResizeMode&&(c+=2);setElementOffset(elResizeBar,a.top,c)}else setResizeBarSize(parseIntOr0(_iframeWin.frameElement.offsetWidth+"px"),2*(ResizeInfo.nBorderSize+nDraggableCellEdge)),c=a.top+ResizeInfo.Pos.clientY+ResizeInfo.nBorderTopPos-ResizeInfo.Pos.offsetY-parseIntOr0(elResizeBar.style.height),
DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion&&"BackCompat"!=_iframeDoc.compatMode||9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks)&&(b=getWindowScrollPos(_iframeWin),c=9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks&&0<b[1]?c+nDraggableCellEdge:c+b[1]),4==ResizeInfo.nResizeMode&&(c+=2),setElementOffset(elResizeBar,c,a.left);DEXTTOP.DEXT5.util.removeEvent(elResizeBarCover,"mousedown",_mousedown_ResizeBarCover);DEXTTOP.DEXT5.util.removeEvent(elResizeBarCover,
"click",setTableSelectEvt);3==ResizeInfo.nResizeMode||4==ResizeInfo.nResizeMode?(elResizeBarCover.style.cursor="move",DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"click",setTableSelectEvt)):(DEXTTOP.DEXT5.util.addEvent(elResizeBarCover,"mousedown",_mousedown_ResizeBarCover),elResizeBarCover.style.cursor=1==ResizeInfo.nResizeMode?"col-resize":"row-resize")}
function setTableSelectEvt(){var a=GetParentbyTagName(ResizeInfo.currCell,"table");command_tableSelection(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,a)}function setResizeBarSize(a,c){elResizeBar.style.width=a+"px";elResizeBar.style.height=c+"px"}
function IsMousePointOnBorder(a){ResizeInfo.nResizeMode=0;ResizeInfo.currCell=a.target?a.target:a.srcElement;var c=ResizeInfo.currCell.tagName;if("TD"!=ResizeInfo.currCell.tagName&&"TH"!=ResizeInfo.currCell.tagName&&(ResizeInfo.currCell=GetTDTHCell(ResizeInfo.currCell),null==ResizeInfo.currCell))return!1;var b=GetParentbyTagName(ResizeInfo.currCell,"table");if(null==b)return!1;var d=DEXTTOP.G_CURREDITOR._config.tableNoResizeClass;if(""!=d&&b.className&&""!=b.className){for(var e=b.className.split(" "),
f=e.length,g=!1,h=0;h<f;h++)if(e[h]==d){g=!0;break}if(g)return!1}ResizeInfo.currTable=b;ResizeInfo.nBorderLeftPos=0;ResizeInfo.nBorderTopPos=-1;ResizeInfo.Pos="contextmenu"==a.type?getClientRect(ResizeInfo.currCell):getElementPos(a,!0);ResizeInfo.nBorderSize=parseIntOr0(b.border);DEXTTOP.DEXT5.browser.ie||DEXTTOP.DEXT5.browser.opera?(a=ResizeInfo.nBorderSize+nDraggableCellEdge,b=nDraggableCellEdge):(a=nDraggableCellEdge,b=ResizeInfo.nBorderSize+nDraggableCellEdge);d=ResizeInfo.Pos.offsetX;e=ResizeInfo.Pos.offsetY;
DEXTTOP.DEXT5.browser.ie&&(8>=DEXTTOP.DEXT5.browser.ieVersion&&"BackCompat"!=_iframeDoc.compatMode||9==DEXTTOP.DEXT5.browser.ieVersion&&DEXTTOP.DEXT5.browser.quirks)&&(f=getWindowScrollPos(_iframeWin),d-=f[0],e-=f[1]);e<=a&&ResizeInfo.currCell.parentNode.previousSibling&&("td"==c.toLowerCase()||"th"==c.toLowerCase())&&(ResizeInfo.nResizeMode=2);ResizeInfo.currCell.offsetHeight-b<=e&&(ResizeInfo.nBorderTopPos=ResizeInfo.currCell.offsetHeight+a-1,ResizeInfo.nResizeMode=2);c=1;9==DEXTTOP.DEXT5.browser.ieVersion&&
DEXTTOP.DEXT5.browser.quirks&&(f=getWindowScrollPos(_iframeWin),c=f[0]);if(ResizeInfo.currCell.offsetWidth-b<=d+c||DEXTTOP.DEXT5.browser.chrome&&0==ResizeInfo.Pos.offsetX)ResizeInfo.nBorderLeftPos=ResizeInfo.currCell.offsetWidth+a-1,ResizeInfo.nResizeMode=1;c=getClientRect(ResizeInfo.currTable);d=!1;e=!0;"1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use&&(f=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode,ResizeInfo.currTable.getAttribute("lock_mode")&&
""!=ResizeInfo.currTable.getAttribute("lock_mode")&&(f=ResizeInfo.currTable.getAttribute("lock_mode")),"1"==f&&(d=!0),checkLockAttr(ResizeInfo.currTable,d)&&(e=!1));e&&DEXTTOP.DEXT5.browser.ie&&11>=DEXTTOP.DEXT5.browser.ieVersion&&(c.left+a>=ResizeInfo.Pos.clientX?ResizeInfo.nResizeMode=3:c.top+b>=ResizeInfo.Pos.clientY&&(ResizeInfo.nResizeMode=4));return 0===ResizeInfo.nResizeMode?!1:!0}function parseIntOr0(a){a=parseInt(a,10);return isNaN(a)?0:a}
function getClientSize(){var a={};"number"===typeof window.innerWidth?(a.width=window.innerWidth,a.height=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)?(a.width=document.body.clientWidth,a.height=document.body.clientHeight):(a.width=0,a.height=0);return a}
function setElementOffset(a,c,b){if("number"==typeof c&&"number"==typeof b){isNaN(parseInt(a.style.top,10))&&(a.style.top="0px");isNaN(parseInt(a.style.left,10))&&(a.style.left="0px");var d=getElementOffset(a);c-=d.top;b-=d.left;a.style.top=parseInt(a.style.top,10)+c+"px";a.style.left=parseInt(a.style.left,10)+b+"px"}}
function getElementPos(a,c){var b=a.target?a.target:a.srcElement,d=(b.ownerDocument||_iframeDoc).body,e=(b.ownerDocument||_iframeDoc).documentElement,e=[d.scrollLeft||e.scrollLeft,d.scrollTop||e.scrollTop],d={clientX:a.clientX,clientY:a.clientY,pageX:"pageX"in a?a.pageX:a.clientX+e[0]-d.clientLeft,pageY:"pageY"in a?a.pageY:a.clientY+e[1]-d.clientTop};c&&(b=getElementOffset(b),d.offsetX=d.pageX-b.left,d.offsetY=d.pageY-b.top);return d}
function getElementOffset(a){var c={left:0,top:0},b=a.ownerDocument||a.document||_iframeDoc,d=b.documentElement,e=b.body,f;"undefined"!=typeof b.defaultView?f=b.defaultView:"undefined"!=typeof b.parentWindow&&(f=b.parentWindow);box=a.getBoundingClientRect();a=d.clientTop||e.clientTop||0;b=f.pageYOffset&&d.scrollTop||e.scrollTop;c.left=box.left+(f.pageXOffset&&d.scrollLeft||e.scrollLeft)-(d.clientLeft||e.clientLeft||0);c.top=box.top+b-a;return c}
function GetParentInTag(a,c){for(var b=a;null!=b&&(!b.tagName||"html"!=b.tagName.toLowerCase());){if(b.tagName.toLowerCase()==c)return b;b=b.parentNode}return null}function GetParentTagPath(a){for(var c="";null!=a&&(!a.tagName||"html"!=a.tagName.toLowerCase());)c=a.tagName.toLowerCase()+"&nbsp;"+c,a=a.parentNode;return c}function getMyElementNode(a){if(1==a.nodeType)return a;for(;null!=a;){if(1==a.nodeType)return a;a=a.parentNode}return null}
function getMyChildElementNode(a){if(3==a.nodeType)return a.parentNode;for(;null!=a.childNodes&&0<a.childNodes.length;){a=a.lastChild;if(3==a.nodeType)return a.parentNode;if("BR"==a.tagName||"IMG"==a.tagName)return a.previousSibling?getMyChildElementNode(a.previousSibling):a.parentNode}return 1==a.nodeType&&a.parentNode&&"BODY"!=a.parentNode.tagName?a.parentNode:null}
function getElementInParentStyleProperty(a,c){for(var b="",d=a;null!=d&&(!d.tagName||"body"!=d.tagName.toLowerCase());){if(""!=d.style[c]&&(b=d.style[c],void 0!=b&&0<b.length))return b=b.replace(/"/gi,""),b=b.replace(/'/gi,""),"backgroundColor"!=c&&"color"!=c&&(b=b.split(",")[0]),"backgroundColor"==c&&"TD"==d.tagName&&(b=""),b;d=d.parentNode}"fontFamily"==c?b=getElementInParentProperty(a,"face"):"fontSize"==c&&(b=getElementInParentProperty(a,"size"));return void 0==b?"":b}
function getElementInParentProperty(a,c){for(var b="",d=a;null!=d&&(!d.tagName||"body"!=d.tagName.toLowerCase());){if(void 0!=d[c]&&(b=d[c],0<b.length))return b=b.replace(/"/gi,""),b=b.replace(/'/gi,""),b=b.split(",")[0];d=d.parentNode}return void 0==b?"":b}
function getElementInParentTag(a,c){for(var b="",d=a,e="";null!=d&&(!(e=d.tagName.toLowerCase())||"body"!=e);){for(var f=0;f<c.length;f++)if(e==c[f]){switch(e){case "b":case "strong":b="blod";break;case "em":case "i":b="italic";break;case "u":b="underline";break;case "s":case "strike":b="strike_through";break;case "sup":b="superscript";break;case "sub":b="subscript";break;case "ol":b="list_number";break;case "ul":b="list_bullets";break;case "h1":case "h2":case "h3":case "h4":case "h5":b=e.toUpperCase()}return b}d=
d.parentNode}return b}
function _iframeDoc_MouseDown(a){G_dext5plugIn&&1==G_dext5plugIn.hasContainer&&G_dext5plugIn.DEXT5SetFocus(0);setDEXTWINDOC();var c=getEditrFromEvent(a);c._RangeBlurBug=!0;c._LastRange=null;if(isRightClick(a))return DEXTTOP.DEXT5.util.cancelEvent(a),!1;if(!isViewMode()){var b=null,b=a?a:_iframeWin.event,b=b.target?b.target:b.srcElement,d=b.tagName?b.tagName.toLowerCase():null;if(null!=b&&null!=d){if("1"!=c._config.formMode&&"1"==c._config.userTableLock.use){var e=GetTDTHCell(b),f;e&&(f=GetParentbyTagName(b,
"table"));var g=c._config.userTableLock.defaultTableLockMode;f&&f.getAttribute("lock_mode")&&""!=f.getAttribute("lock_mode")&&(g=f.getAttribute("lock_mode"));var h=!0;"1"==g&&(h=!1);if(e){if(h&&checkLockAttr(f)){c.lastElemForLock?setFocusForLock(c.lastElemForLock):(b=findNoLockElem(f))?setFocusForLock(b):(window.focus(),document.body.focus());DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(e,!h)){c.lastElemForLock?setFocusForLock(c.lastElemForLock):setFocusForLock(findNoLockCell(f));
DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}}}if("1"==c._config.formMode){if(a.ctrlKey)return setFormControlSelected(b),DEXTTOP.DEXT5.util.cancelEvent(a),!1;clearAllFormControlSelected()}if("1"==c._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{DEXTTOP.DEXTWIN.dext_mouse_event("mousedown",a,b)}catch(m){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(d&&("textarea"==d||"input"==d||"select"==d))return!1;
f=GetTDTHCell(b);null==f&&null!=ActiveCurrTable&&ClearDraggingTableCellSelected();if(f){ActiveCurrTable=GetParentbyTagName(f,"table");try{ActiveLastTable?ActiveLastTable!=ActiveCurrTable&&(ClearDraggingTable(ActiveLastTable),ActiveLastTable=ActiveCurrTable):ActiveLastTable=ActiveCurrTable}catch(n){ActiveLastTable=ActiveCurrTable}}null!=ActiveCurrTable&&b==ActiveCurrTable?Mouse_Status=Mouse_IsTableDragging:(d=b.tagName.toLowerCase(),"img"==d||"hr"==d?("img"==d&&(DEXTTOP.G_SELECTED_IMAGE_ELEMENT=b),
Mouse_Status=Mouse_IsControlSelecting):(c=null,c=GetTDTHCell(b),null==c?(Mouse_Status=Mouse_IsPlain,ClearDraggingTableCellSelected(),DrageStartCell=null,DEXTTOP.G_SELECTED_ELEMENT=b):(f=!1,d=DEXTTOP.G_CURREDITOR._config.tableNoSelectionClass,""!=d&&(f=GetParentbyTagName(b,"table"),f=checkContainClass(f,d)),0==f&&(Mouse_Status=Mouse_IsCellDragging,a.shiftKey?SelectedCellRange(DrageStartCell,c):(ClearDraggingTableCellSelected(),removeCellDefValue(c,!1),mouseStartPos=getMousePosition(a),DrageStartCell=
c,DrageEndCell=null,DEXTTOP.G_SELECTED_ELEMENT=b)))))}}}
function _iframeDoc_MouseUp(a){setDEXTWINDOC();var c=getEditrFromEvent(a);c._RangeBlurBug=!1;if(isRightClick(a))return DEXTTOP.DEXT5.util.cancelEvent(a),!1;if(!isViewMode()){var b=null,b=a?a:_iframeWin.event,b=b.target?b.target:b.srcElement;if("1"!=c._config.formMode&&"1"==c._config.userTableLock.use){var d=GetTDTHCell(b),e;d&&(e=GetParentbyTagName(b,"table"));var f=c._config.userTableLock.defaultTableLockMode;e&&e.getAttribute("lock_mode")&&""!=e.getAttribute("lock_mode")&&(f=e.getAttribute("lock_mode"));
var g=!0;"1"==f&&(g=!1);if(d){f=!1;if(f=g?!checkLockAttr(d)&&!checkLockAttr(e):!checkLockAttr(d,!g))"TABLE"==b.tagName?checkLockAttr(b,!g)?c.lastElemForLock=findNoLockElem(b):(d=findNoLockCell(b),c.lastElemForLock=d):c.lastElemForLock=b;if(g&&checkLockAttr(e)){c.lastElemForLock?setFocusForLock(c.lastElemForLock):(c=findNoLockElem(e))?setFocusForLock(c):(window.focus(),document.body.focus());DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}}else"BODY"!=b.tagName&&("TABLE"==
b.tagName?checkLockAttr(b,!g)?c.lastElemForLock=findNoLockElem(b):(d=findNoLockCell(b),c.lastElemForLock=d):c.lastElemForLock=b),checkLockElemInSelectionRange();g||(g=getFirstRange().range.startContainer,3==g.nodeType&&(g=g.parentNode),(d=GetParentbyTagName(g,"td"))&&checkLockAttr(d,!0)&&(c.lastElemForLock?setFocusForLock(c.lastElemForLock):(e=GetParentbyTagName(d,"td"),setFocusForLock(findNoLockCell(e)))));g=GetTableSelectionCells();d=g.length;if(0<d){for(var f=!1,h=0;h<d;h++){if(checkLockAttr(g[h],
!0)){f=!0;break}else{var m=[];m.push(g[h].getElementsByTagName("table"));m.push(g[h].getElementsByTagName("td"));var n=m.length;for(j=0;j<n;j++){var p=m[j].length;for(k=0;k<p;k++)if(checkLockAttr(m[j][k],!0)){f=!0;break}if(f)break}}if(f)break}f&&(c.lastElemForLock?setFocusForLock(c.lastElemForLock):setFocusForLock(findNoLockCell(e)),ClearDraggingTableCellSelected())}(e=getSelectionTable(c))&&checkLockAttr(e)&&(c.lastElemForLock?setFocusForLock(c.lastElemForLock):setFocusForLock(findNoLockCell(e)))}if((e=
b.tagName?b.tagName.toLowerCase():null)&&("textarea"==e||"input"==e||"select"==e)&&"1"!=DEXTTOP.G_CURREDITOR._config.formMode)return!1;if("1"==c._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{DEXTTOP.DEXTWIN.dext_mouse_event("mouseup",a,b)}catch(q){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);return}}if(Mouse_Status==Mouse_IsCellDragging){if(DEXTTOP.DEXT5.browser.ie)try{_iframeDoc.body.releaseCapture()}catch(u){}Mouse_Status=Mouse_IsPlain;
try{var t,v=GetTDTHCell(b);v?colorToHex(v.style.backgroundColor)==ColorCellBackColor||v.style.backgroundColor==ColorCellBackColor?t=""==ReplaceAll(v.innerHTML," ","")||1==checkCellDefValue(v.innerHTML)?1:2:(ClearDraggingTableCellSelected(),DrageEndCell=null,t=3):DrageEndCell&&(t=""==ReplaceAll(DrageEndCell.innerHTML," ","")||1==checkCellDefValue(DrageEndCell.innerHTML)?1:2);switch(t){case 1:setTimeout(function(){DEXTTOP.G_CURREDITOR._iconSelected();try{DrageEndCell?DrageEndCell.firstChild&&"P"==DrageEndCell.firstChild.tagName?
doSetCaretPosition(DrageEndCell.firstChild,0):doSetCaretPosition(DrageEndCell,0):v&&(v.firstChild&&"P"==v.firstChild.tagName?doSetCaretPosition(v.firstChild,0):doSetCaretPosition(v,0))}catch(a){}},0);break;case 2:setTimeout(function(){try{var a;DrageEndCell?(a=getMyChildElementNode(DrageEndCell.lastChild),doSetCaretPosition(a,1)):v&&(a=getMyChildElementNode(v.lastChild),doSetCaretPosition(a,1));DEXTTOP.G_CURREDITOR._iconSelected()}catch(b){}},0);break;case 3:break;default:DEXTTOP.G_CURREDITOR._iconSelected();
try{DrageEndCell?doSetCaretPosition(DrageEndCell,0):v&&doSetCaretPosition(v,0)}catch(w){}}}catch(x){}}a=b.tagName.toLowerCase();"img"==a?(DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0):"html"==a&&setFocusToBody();if(DEXTTOP.DEXT5.browser.ie)try{setTimeout(function(){var a,b=getFirstRange().range;b&&b.startContainer==b.endContainer&&1==b.collapsed&&(a=getMyElementNode(b.startContainer));a&&setMenuIconRealable(a)},0)}catch(y){}}}
function CheckNoWhere(a,c,b){var d=c.Y,e=_iframeDoc.body.clientHeight,f=_iframeDoc.body.firstChild,g=_iframeDoc.body.lastChild;c=!1;a="spanTag_NoWhere_"+DEXTTOP.G_CURREDITOR.ID;if(10>=d&&-1<",table,hr,div,ul,ol,dl,form,blockquote,".indexOf(","+f.tagName.toLowerCase()+","))c=!0;else if(d>=e&&-1<",table,hr,div,ul,ol,dl,form,blockquote,".indexOf(","+g.tagName.toLowerCase()+","))c=!0;else if(10<d&&d<e){c=!1;d=" table hr div ul ol dl form blockquote ".split(" ");f=e=null;for(g=0;g<d.length&&(e=GetParentInTag(b,
d[g]),null==e);g++);if(null!=e)if(null==e.previousSibling)c=!0,getElementOffset(e);else{for(g=0;g<d.length&&(f=GetParentInTag(e.previousSibling,d[g]),null==f);g++);null!=e&&null!=f&&(c=!0,getElementOffset(e))}}else if(f.id==a)return;0==c?(b=_iframeDoc.getElementById(a),null!=b&&_iframeDoc.body.removeChild(b)):(b=_iframeDoc.getElementById(a),null==b&&(b=_iframeDoc.createElement("span"),b.setAttribute("id",a),b.innerHTML="",_iframeDoc.body.insertBefore(b,_iframeDoc.body.firstChild)))}
function _iframeDoc_MouseMove(a){var c=getEditrFromEvent(a);if(!isViewMode()){var b=null,b=a?a:_iframeWin.event,b=b.target?b.target:b.srcElement,d=b.tagName?b.tagName.toLowerCase():null;if(null!=d&&Mouse_Status!=Mouse_IsCellResizing&&Mouse_Status!=Mouse_IsTableDragging&&null!=b){if("1"==c._config.returnEvent.mouse_event){DEXTTOP.DEXT5.config.MouseEventCancel=!1;try{DEXTTOP.DEXTWIN.dext_mouse_event("mousemove",a,b)}catch(e){}if(1==DEXTTOP.DEXT5.config.MouseEventCancel){DEXTTOP.DEXT5.util.cancelEvent(a);
return}}c=GetTDTHCell(b);mouseEndPos=getMousePosition(a);if(isLeftClick(a)&&Mouse_Status==Mouse_IsCellDragging){if(null!=c&&null!=DrageStartCell&&(DrageStartCell!=c||0!=GetTableSelectionCells().length)&&(GetParentbyTagName(b,"table")==ActiveCurrTable&&(DrageEndCell=c),SelectedCellRange(DrageStartCell,c),DEXTTOP.DEXT5.browser.ie&&setAutoScroll(mouseEndPos),DEXTTOP.DEXT5.browser.ie))try{_iframeDoc.body.setCapture(!1)}catch(f){}}else"img"!=d&&"hr"!=d&&"div"!=d&&"a"!=d&&(Mouse_Status=Mouse_IsPlain),DEXTTOP.DEXT5.browser.mobile||
(null!=c?IsMousePointOnBorder(a)?showResizeBar():hideResizeBar():hideResizeBar())}}}
function setAutoScroll(a){var c=getElementOffset(_iframeWin.frameElement),b,d;b=_iframeWin.frameElement.offsetHeight;d=_iframeWin.frameElement.offsetWidth;var c=c.left+d,e,f;DEXTTOP.DEXT5.browser.ie?(e=_iframeDoc.documentElement.scrollLeft+_iframeDoc.body.scrollLeft,f=_iframeDoc.documentElement.scrollTop+_iframeDoc.body.scrollTop):(e=_iframeWin.scrollX,f=_iframeWin.scrollY);a.X+20>c&&_iframeWin.scroll(e+30,f);0<e&&a.X-20<c-d&&_iframeWin.scroll(e-30,f);a.Y+20>b&&_iframeWin.scroll(e,f+30);0<f&&a.Y-
20<b-b&&_iframeWin.scroll(e,f-30)}function isLeftClick(a){return a.which?1==a.which:a.button?1==a.button:!1}function isRightClick(a){var c=!1;a=a||window.event;a.which||void 0===a.button||(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);switch(a.which){case 1:c=!1;break;case 2:c=!1;break;case 3:c=!0;break;case 0:0==a.button&&(c=!0)}return c}
function ClearDraggingTableCellSelected(){if(null!=ActiveCurrTable)try{for(var a=ActiveCurrTable,c=a.rows.length,b=0;b<c;b++)for(var d=a.rows[b],e=d.cells.length,f=0;f<e;f++){var g=d.cells[f];if(g.style.backgroundColor==ColorCellBackColor||colorToHex(g.style.backgroundColor)==ColorCellBackColor)g.style.backgroundColor=g.bgColor,removeAttribute(g,"bgColor")}}catch(h){}}
function ClearDraggingTable(a){if(null!=a)try{for(var c=a.rows.length,b=0;b<c;b++)for(var d=a.rows[b],e=d.cells.length,f=0;f<e;f++){var g=d.cells[f];if(g.style.backgroundColor==ColorCellBackColor||colorToHex(g.style.backgroundColor)==ColorCellBackColor)g.style.backgroundColor=g.bgColor,removeAttribute(g,"bgColor")}}catch(h){}}
function ClearDraggingTableAllTable(){try{for(var a=_iframeDoc.getElementsByTagName("TABLE"),c=a.length,b=null,d=null,e=0,f=0,g=0,h=0;h<c;h++)for(var b=a[h],e=b.rows.length,m=0;m<e;m++)for(var f=b.rows[m],g=f.cells.length,n=0;n<g;n++)if(d=f.cells[n],d.style.backgroundColor==ColorCellBackColor||colorToHex(d.style.backgroundColor)==ColorCellBackColor)d.style.backgroundColor=d.bgColor,removeAttribute(d,"bgColor")}catch(p){}}
function colorToHex(a){if(6>a.length)return"#tttttt";if("#"===a.substr(0,1))return a;a=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a);if(null==a)return"#tttttt";var c=parseInt(a[2]),b=parseInt(a[3]),c=parseInt(a[4])|b<<8|c<<16;return a[1]+"#"+c.toString(16)}function removeAttribute(a,c){if(null!=a)try{a.removeProperty?a.removeProperty(c):a.removeAttribute(c)}catch(b){}}function getClientRect(a){var c={left:0,top:0,right:0,bottom:0};try{c=a.getBoundingClientRect()}catch(b){}return c}
function getMousePosition(a){var c={};if(a.clientX||a.clientY)c.X=Math.round(a.clientX),c.Y=Math.round(a.clientY);else if(a.pageX||a.pageY)c.X=Math.round(a.pageX),c.Y=Math.round(a.pageY);return c}
function SelectedCellRange(a,c,b){b=GetParentbyTagName(a,"tr");var d=GetParentbyTagName(c,"tr");if(null!=b&&null!=d&&(ActiveCurrTable=GetParentbyTagName(b,"table"),ClearDraggingTableCellSelected(),a!=c)){var d=getClientRect(a),e=getClientRect(c);c=d.left<e.left?d.left:e.left;a=d.top<e.top?d.top:e.top;b=d.right<e.right?e.right:d.right;d=d.bottom<e.bottom?e.bottom:d.bottom;c-=2;a-=2;b+=2;for(var d=d+2,e=!1,f=ActiveCurrTable.rows.length,g=0;g<f;g++)for(var h=ActiveCurrTable.rows[g],m=h.cells.length,
n=0;n<m;n++){var p=h.cells[n],q=getClientRect(p);q.left>=c&&q.right<=b&&q.top>=a&&q.bottom<=d&&(""==p.style.backgroundColor&&""!=p.bgColor&&(p.style.backgroundColor=p.bgColor),p.bgColor=p.style.backgroundColor,p.style.backgroundColor=ColorCellBackColor,setCellDefValue(p),e=!0)}if(e)try{var u=getFirstRange().sel;u&&u.removeAllRanges&&u.removeAllRanges()}catch(t){}}}function GetTDTHCell(a){if(a.nodeName.match(/t[dh]/i))return a;for(;null!=a&&!a.nodeName.match(/t[dh]/i);)a=a.parentNode;return a}
function CanMerge(){if(null==ActiveCurrTable)return 0;var a=0,c,b,d,e,f,g,h,m;c=b=1E7;for(var n=d=e=0;n<ActiveCurrTable.rows.length;n++)for(var p=ActiveCurrTable.rows[n],q=0;q<p.cells.length;q++){var u=p.cells[q];if(colorToHex(u.style.backgroundColor)==ColorCellBackColor||u.style.backgroundColor==ColorCellBackColor){h=u.colSpan;var t=u.rowSpan,a=a+h*t;m=getClientRect(u);f=m.left;g=m.top;h=m.right;m=m.bottom}c>f&&(c=parseInt(f,10));b>g&&(b=parseInt(g,10));d<h&&(d=parseInt(h,10));e<m&&(e=parseInt(m,
10))}for(n=g=f=0;n<ActiveCurrTable.rows.length;n++)for(p=ActiveCurrTable.rows[n],q=0;q<p.cells.length;q++)if(u=p.cells[q],m=getClientRect(u),c<=parseInt(m.left,10)&&b<=parseInt(m.top,10)&&d>=parseInt(m.right,10)&&e>=parseInt(m.bottom,10)||c>parseInt(m.left,10)&&b<=parseInt(m.top,10)&&c<parseInt(m.right,10)&&e>=parseInt(m.bottom,10)||d>parseInt(m.left,10)&&b<=parseInt(m.top,10)&&d<parseInt(m.right,10)&&e>=parseInt(m.bottom,10)||c<=parseInt(m.left,10)&&e>parseInt(m.top,10)&&d>=parseInt(m.right,10)&&
e<parseInt(m.bottom,10)||c<=parseInt(m.left,10)&&b>parseInt(m.top,10)&&d>=parseInt(m.right,10)&&b<parseInt(m.bottom,10))h=u.colSpan,t=u.rowSpan,f+=h*t,d==m.right&&(g+=u.rowSpan);c=0;0<g&&(c=a/g);return"number"==typeof c&&0<c.toString().indexOf(".")?!1:f==a&&1<f?f:0}
function command_mergeCell(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();if(0!=CanMerge()){0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var b,d,e,f,g,h,m,n;b=d=1E7;for(var p=e=f=0;p<ActiveCurrTable.rows.length;p++)for(var q=ActiveCurrTable.rows[p],u=0;u<q.cells.length;u++){var t=q.cells[u];if(colorToHex(t.style.backgroundColor)==ColorCellBackColor||t.style.backgroundColor==ColorCellBackColor)n=getClientRect(t),g=n.left,h=n.top,
m=n.right,n=n.bottom;b>g&&(b=g);d>h&&(d=h);e<m&&(e=m);f<n&&(f=n)}m=h="";var v,w;v=w=0;g=null;for(p=0;p<ActiveCurrTable.rows.length;p++)for(q=ActiveCurrTable.rows[p],u=0;u<q.cells.length;u++)t=q.cells[u],n=getClientRect(t),b<=n.left&&d<=n.top&&e>=n.right&&f>=n.bottom&&(d==n.top&&b==n.left?(g=t,m=t.innerHTML):t.style.visibility="hidden",h+=removeCellDefValue(t,!0),1>Math.abs(b-n.left)&&(v+=t.rowSpan),1>Math.abs(d-n.top)&&(w+=t.colSpan));p=!1;g&&(p=!0);if(p){e=d=0;f=[];var x=0;b=getClientRect(g);for(p=
0;p<ActiveCurrTable.rows.length;p++)for(nTemp=0,q=ActiveCurrTable.rows[p],u=0;u<q.cells.length;u++)t=q.cells[u],n=getClientRect(t),(b.left!=n.left||b.right!=n.right)&&b.left<=n.left&&b.right>=n.right&&(0==nTemp&&f.push(t),x+=1,nTemp+=t.colSpan),b.bottom==n.top&&(e=nTemp),b.top==n.bottom&&(d=nTemp);0<d||0<e?g.colSpan=d<e?e:d:removeAttribute(g,"colSpan");if(f.length==x){for(p=0;p<f.length;p++)removeAttribute(f[p],"colSpan");removeAttribute(g,"colSpan")}}if(g){1<w&&(g.colSpan=w);1<v&&(g.rowSpan=v);n=
0;v=getClientRect(g);for(p=ActiveCurrTable.rows.length-1;0<=p;p--){q=ActiveCurrTable.rows[p];for(u=q.cells.length-1;0<=u;u--)t=q.cells[u],w=getClientRect(t),"hidden"==t.style.visibility&&(v.right==w.left&&v.top!=w.top&&parseIntOr0(t.style.height),v.top==w.top&&(n+=parseIntOr0(t.style.width)),q.deleteCell(u));0==q.cells.length&&deleteRow(q)}0<n&&(g.style.width=parseIntOr0(g.style.width)+n+"px");g.innerHTML=0==h.length?""!=m?m:DEXTTOP.DEXT5.browser.ie?"":getCellDefValue():h;try{DEXTTOP.DEXT5.browser.gecko?
0==h.length?doSetCaretPosition(g.childNodes[0],0):setGeckoCellCaretPosistion(g,!0):(doSetCaretPosition(g.childNodes[0],0),removeCellDefValue(g,!1))}catch(y){}ClearDraggingTableCellSelected();if(1==ActiveCurrTable.rows.length)for(q=ActiveCurrTable.rows[0],u=0;u<q.cells.length;u++)t=q.cells[u],removeAttribute(t,"rowSpan"),removeAttribute(t,"colSpan");1==ActiveCurrTable.rows.length&&1==ActiveCurrTable.rows[0].cells.length&&(removeAttribute(ActiveCurrTable.rows[0].cells[0],"width"),removeAttribute(ActiveCurrTable.rows[0].cells[0],
"height"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"colSpan"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"rowSpan"));if(g&&1<g.colSpan&&1<ActiveCurrTable.rows.length){m=0;h=[];b=getClientRect(g);for(p=0;p<ActiveCurrTable.rows.length;p++)for(q=ActiveCurrTable.rows[p],u=0;u<q.cells.length;u++)t=q.cells[u],n=getClientRect(t),b.left==n.left&&b.right==n.right&&parseIntOr0(g.colSpan)==parseIntOr0(t.colSpan)&&(n=parseIntOr0(t.rowSpan),m=1<n?m+n:m+1,h.push(t));if(m==ActiveCurrTable.rows.length)for(q=
h.length,p=0;p<q;p++)removeAttribute(h[p],"colSpan")}}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}}
function command_deleteTable(a,c){dext_src_init(c._EDITOR.design);if(null==ActiveCurrTable)return 0;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var b=ActiveCurrTable.previousSibling;try{if(b){if(3==b.nodeType||1==b.nodeType&&"BR"==b.tagName)b="text"}else{var d=ActiveCurrTable.parentNode;1==d.nodeType&&"BODY"!=d.tagName&&(b=d)}}catch(e){b=null}ActiveCurrTable.parentNode.removeChild(ActiveCurrTable);ActiveCurrTable=null;if("text"!=b)if(null==b)""==_iframeDoc.body.innerHTML?
(setBodyDefaultValue(),setFocusToBody()):(doSetCaretPosition(_iframeDoc.body.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("default"));else if(doSetCaretPosition(b,1),b=GetParentbyTagName(b,"table")){var d=c._config.tableNoActionClass,f=!1;""!=d&&(f=checkContainClass(b,d));ActiveCurrTable=b;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",f)}else DEXTTOP.G_CURREDITOR._iconEnable("default");DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function command_insertRowUp(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();InsertRowUpDown(!0,!1,b);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function command_insertRowDown(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();InsertRowUpDown(!1,!1,b);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function InsertRowUpDown(a,c,b){var d=getFirstRange().range;if(d){var e=GetTDTHCell(d.startContainer);if(null!=e&&(ActiveCurrTable=GetParentbyTagName(e,"table"),d=GetParentbyTagName(e,"tr"))){var f=0;a?f=d.rowIndex:(f=1<e.rowSpan?d.rowIndex+e.rowSpan:d.rowIndex+1,f>ActiveCurrTable.rows.length&&(f=ActiveCurrTable.rows.length));for(var g=[],h=[],m=getClientRect(e),e=0;e<ActiveCurrTable.rows.length;e++)for(var n=ActiveCurrTable.rows[e],p=0;p<n.cells.length;p++){var q=n.cells[p],u=getClientRect(q);if(a){if(m.top==
u.top||u.top<m.top&&u.bottom>m.top){var t={};t.left=u.left;t.cell=q;h.push(t)}}else if(m.bottom==u.bottom||u.bottom>m.bottom&&m.bottom>u.top)t={},t.left=u.left,t.cell=q,h.push(t)}h.sort(function(a,b){return a.left-b.left});for(e=0;e<h.length;e++)g.push(h[e].cell);h=[];for(e=0;e<g.length;e++)n=g[e],p=n.rowSpan,u=getClientRect(n),h[e]=1<p&&1==a&&u.top!=m.top||1<p&&0==a&&u.bottom!=m.bottom?n.rowSpan+1:1;b||(b=1);for(a=0;a<b;a++)for(m=ActiveCurrTable.insertRow(f),setCopyAllObjectAtributes(d,m,!1),e=0;e<
g.length;e++)if(n=g[e],p=n.rowSpan,1<h[e])n.rowSpan=h[e],removeAttribute(n,"height");else if(u=m.insertCell(-1))"th"==n.tagName.toLowerCase()&&(p=document.createElement("th"),u.parentNode.replaceChild(p,u),u=p),u.innerHTML=getCellDefValue(),c?setCopyAllObjectAtributes(n,u,!0):setCopyAllObjectAtributes(n,u,!1),1<u.rowSpan&&removeAttribute(u,"rowSpan")}}}
function command_deleteRow(a,c){dext_src_init(c._EDITOR.design);if(null==ActiveCurrTable)return 0;restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var b=null,d=-1,e=0,f=getFirstRange().range;if(f){f=GetTDTHCell(f.startContainer);b=ActiveCurrTable.previousSibling;try{if(b){if(3==b.nodeType||1==b.nodeType&&"BR"==b.tagName)b="text"}else{var g=ActiveCurrTable.parentNode;1==g.nodeType&&"BODY"!=g.tagName&&(b=g)}}catch(h){b=null}g=
GetParentbyTagName(f,"tr");for(f=0;f<ActiveCurrTable.rows.length;f++)for(var m=ActiveCurrTable.rows[f],n=0;n<m.cells.length;n++){var p=m.cells[n];if(colorToHex(p.style.backgroundColor)==ColorCellBackColor||p.style.backgroundColor==ColorCellBackColor){-1==d&&(d=m.rowIndex);e++;break}}e=e||1;for(f=0;f<e;f++){-1!=d&&(g=ActiveCurrTable.rows[d]);if(null==g)return;deleteRow(g)}}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;ActiveCurrTable?(doSetCaretPosition(ActiveCurrTable.rows[0].cells[0].childNodes[0],
0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")):"text"!=b&&(null==b?""==_iframeDoc.body.innerHTML?(setBodyDefaultValue(),setFocusToBody()):(doSetCaretPosition(_iframeDoc.body.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("default")):(doSetCaretPosition(b,1),(b=GetParentbyTagName(b,"table"))?(d=c._config.tableNoActionClass,e=!1,""!=d&&(e=checkContainClass(b,d)),ActiveCurrTable=b,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",e)):DEXTTOP.G_CURREDITOR._iconEnable("default")))}
function deleteRow(a){if(null!=a){ActiveCurrTable=GetParentbyTagName(a,"table");for(var c=a.rowIndex,b=0;b<ActiveCurrTable.rows.length;b++){var d=ActiveCurrTable.rows[b],e=d.rowIndex;if(c==e)break;for(var f=0;f<d.cells.length;f++){var g=d.cells[f],h=g.rowSpan;1<h&&c<e+h&&(2==h?removeAttribute(g,"rowSpan"):g.rowSpan=h-1)}}for(f=0;f<a.cells.length;f++)if(g=a.cells[f],h=g.rowSpan,1<h){b=ActiveCurrTable.rows[a.rowIndex+1].insertCell(g.cellIndex);if(null==b)return;d=g.colSpan;e=g.style.width;b.innerHTML=
g.innerHTML;b.style.border="1px solid #000000";b.style.width=e;2<h&&(b.rowSpan=h-1);1<d&&(b.colSpan=d)}1==ActiveCurrTable.rows.length?(ActiveCurrTable.parentNode.removeChild(ActiveCurrTable),ActiveCurrTable=null):ActiveCurrTable.deleteRow(c)}}
function command_insertCellLeft(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();insertCell(!0,b);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function command_insertCellRight(a,c,b){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();insertCell(!1,b);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function insertCell(a,c){var b=getFirstRange().range;if(b){var d=GetTDTHCell(b.startContainer);if(null!=d&&(ActiveCurrTable=GetParentbyTagName(d,"table"),GetParentbyTagName(d,"tr"))){for(var b=[],e=[],f=getClientRect(d),d=0;d<ActiveCurrTable.rows.length;d++)for(var g=ActiveCurrTable.rows[d],h=0;h<g.cells.length;h++){var m=g.cells[h],n=getClientRect(m);a?f.left==n.left?(n={},n.x=d,n.y=h,n.width=0<m.style.width.length?m.style.width:"",n.height=0<m.style.width.height?m.style.height:"",n.rowSpan=m.rowSpan,
n.cell=m,b.push(n)):(f.top>=n.bottom||f.bottom<=n.top)&&.1<n.right-f.left&&.1<f.left-n.left&&e.push(m):f.right==n.right?(n={},n.x=d,n.y=h+1,n.rowSpan=m.rowSpan,n.width=0<m.style.width.length?m.style.width:"",n.height=0<m.style.width.height?m.style.height:"",n.cell=m,b.push(n)):(f.top>=n.bottom||f.bottom<=n.top)&&.1<n.right-f.right&&.1<f.right-n.left&&e.push(m)}c||(c=1);for(d=0;d<b.length;d++)for(f=0;f<c;f++){m=b[d];g=ActiveCurrTable.rows[m.x].insertCell(m.y);if(null==g)return;"th"==m.cell.tagName.toLowerCase()&&
(h=document.createElement("th"),g.parentNode.replaceChild(h,g),g=h);g.innerHTML=getCellDefValue();setCopyAllObjectAtributes(m.cell,g,!1);1<m.rowSpan?g.rowSpan=m.rowSpan:removeAttribute(g,"rowSpan");1<m.cell.colSpan&&removeAttribute(g,"colSpan")}for(d=0;d<e.length;d++)for(f=0;f<c;f++)m=e[d],m.colSpan+=1}}}
function command_InsertSplitCell(a,c,b,d){dext_src_init(c);restoreSelection();setFocusToBody();0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();1<parseInt(b)&&splitCellByRow(b,!0);1<parseInt(d)&&splitCellByColumn(d,!0);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")}
function splitCellByRow(a,c){var b=getFirstRange().range;if(b&&(b=GetTDTHCell(b.startContainer),null!=b)){ActiveCurrTable=GetParentbyTagName(b,"table");var d=GetParentbyTagName(b,"tr");if(d)if(whereRowIdx=d.rowIndex,1<b.rowSpan){--b.rowSpan;var e=b.style.width,f=b.style.height,g=ActiveCurrTable.rows[whereRowIdx+b.rowSpan],h=GetFirstIndexInRowByCurrCell(g,b);if(g=g.insertCell(h+1))g.innerHTML=getCellDefValue(),g.style.border="1px solid #000000",0<e.length&&(g.style.width=e),0<f.length&&(g.style.height=
f),1<b.colSpan&&(g.colSpan=b.colSpan);--a;1==b.rowSpan&&removeAttribute(b,"rowSpan");1<a&&splitCellByRow(a)}else{for(var d=[],m=0,n=getClientRect(b),e=0;e<ActiveCurrTable.rows.length;e++)for(f=ActiveCurrTable.rows[e],g=0;g<f.cells.length;g++){var h=f.cells[g],p=getClientRect(h);if(n.top==p.top||p.top<n.top&&p.bottom>n.top)d[m]=h,m+=1}m=[];for(e=0;e<d.length;e++)f=d[e],getClientRect(f),f!=b&&(m[e]=f.rowSpan+(a-1));for(n=1;n<a;n++){g=ActiveCurrTable.insertRow(whereRowIdx+n);e=b.style.width;f=b.style.height;
h=GetFirstIndexInRowByCurrCell(g,b);if(g=g.insertCell(h))g.innerHTML=getCellDefValue(),g.style.border="1px solid #000000",0<e.length&&(g.style.width=e),0<f.length&&(g.style.height=f),1<b.colSpan&&(g.colSpan=b.colSpan);for(e=0;e<d.length;e++)f=d[e],1<=m[e]&&(f.rowSpan=m[e],removeAttribute(f,"height"))}}}}function GetFirstIndexInRowByCurrCell(a,c){for(var b=-1,d=a.cells.length,e=getClientRect(c),d=d-1;0<=d;d--){var f=getClientRect(a.cells[d]);if(e.left>=f.right){b=d;break}}return b}
function splitCellByColumn(a,c){var b=getFirstRange().range;if(b&&(b=GetTDTHCell(b.startContainer),null!=b)){ActiveCurrTable=GetParentbyTagName(b,"table");var d=GetParentbyTagName(b,"tr");if(d)if(1<b.colSpan){--b.colSpan;var e=parseInt(b.style.width),f=isNaN(parseInt(parseInt(b.style.width)/a))?"":parseInt(parseInt(b.style.width,10)/a,10)+"px",g=b.style.height,h=d.insertCell(b.cellIndex+1);h&&(h.innerHTML=getCellDefValue(),h.style.border="1px solid #000000",0<f.length&&(h.style.width=f),0<g.length&&
(h.style.height=g),1<b.rowSpan&&(h.rowSpan=b.rowSpan));--a;1==b.colSpan&&removeAttribute(b,"colSpan");1<a?(f=e-parseInt(f),0<f&&(b.style.width=f+"px"),splitCellByColumn(a)):0<f.length&&(b.style.width=f)}else{f=[];h=0;e=getClientRect(b);for(g=0;g<ActiveCurrTable.rows.length;g++)for(var m=ActiveCurrTable.rows[g],n=0;n<m.cells.length;n++){var p=m.cells[n],q=getClientRect(p);if(p!=b){if(e.left>=q.left&&e.right<=q.right){m={};m.x=g;m.y=n;m.width=0<p.style.width.length?p.style.width:"";m.colSpan=p.colSpan;
f[h]=m;h+=1;break}}else if(p==b)break}for(g=0;g<f.length;g++){h=f[g];h=ActiveCurrTable.rows[h.x].cells[h.y];if(null==h)return;h.colSpan+=a-1}f=isNaN(parseInt(parseInt(b.style.width)/a))?"":parseInt(parseInt(b.style.width,10)/a,10)+"px";0>=f.length&&(f=isNaN(parseInt(parseInt(b.clientWidth)/a))?"":parseInt(parseInt(b.clientWidth,10)/a,10)+"px");""==f&&1==ActiveCurrTable.rows.length&&(f=parseInt(parseInt(ActiveCurrTable.style.width,10)/a,10)+"px");g=b.style.height;0<f.length&&(b.style.width=f);0<g.length&&
(b.style.height=g);for(e=1;e<a;e++)if(h=d.insertCell(b.cellIndex+e))h.innerHTML=getCellDefValue(),h.style.border="1px solid #000000",0<f.length&&(h.style.width=f),0<g.length&&(h.style.height=g),1<b.rowSpan&&(h.rowSpan=b.rowSpan)}}}
function command_deleteCell(a,c){dext_src_init(c._EDITOR.design);if(null==ActiveCurrTable)return 0;restoreSelection();setFocusToBody();var b=null,d=-1,e=0;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var f=getFirstRange().range;if(f){f=GetTDTHCell(f.startContainer);b=ActiveCurrTable.previousSibling;try{if(b){if(3==b.nodeType||1==b.nodeType&&"BR"==b.tagName)b="text"}else{var g=ActiveCurrTable.parentNode;1==g.nodeType&&"BODY"!=g.tagName&&(b=g)}}catch(h){b=
null}for(var m=0;m<ActiveCurrTable.rows.length;m++){for(var n=ActiveCurrTable.rows[m],p=0;p<n.cells.length;p++){var q=n.cells[p];if(colorToHex(q.style.backgroundColor)==ColorCellBackColor||q.style.backgroundColor==ColorCellBackColor)-1==d&&(d=q.cellIndex),e++}if(0<e)break}var g=0,u=!1;"0"==DEXTTOP.G_CURREDITOR._config.tableAutoAdjust&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="1",u=!0);setAdjustTableWidthHeight(ActiveCurrTable);e=e||1;u&&(DEXTTOP.G_CURREDITOR._config.tableAutoAdjust="0");for(u=
0;u<e;u++){var t=0,m=ActiveCurrTable.rows[0];if(-1!=d&&(f=m.cells[d],null==f))return;var v=getClientRect(f);if(m){for(var w=[],x=0,m=0;m<ActiveCurrTable.rows.length;m++)for(n=ActiveCurrTable.rows[m],p=0;p<n.cells.length;p++){var q=n.cells[p],y=getClientRect(q);if(v.left==y.left||v.left>y.left&&v.left<y.right)y={},y.x=m,y.y=p,y.colSpan=q.colSpan,w[x]=y,x+=1}for(m=0;m<w.length;m++){n=w[m];p=ActiveCurrTable.rows[n.x].cells[n.y];if(null==p)return;1==p.colSpan?(p=parseIntOr0(p.style.width),t<p&&(t=p),
ActiveCurrTable.rows[n.x].deleteCell(n.y)):2<p.colSpan?--p.colSpan:removeAttribute(p,"colSpan")}for(m=ActiveCurrTable.rows.length-1;0<=m;m--)if(0==ActiveCurrTable.rows[m].cells.length){w=ActiveCurrTable.rows[m].rowIndex;for(p=0;p<m;p++){n=ActiveCurrTable.rows[p];v=n.rowIndex;if(w==v)break;for(x=0;x<n.cells.length;x++)q=n.cells[x],y=q.rowSpan,1<y&&w<v+y&&(2==y?removeAttribute(q,"rowSpan"):q.rowSpan=y-1)}ActiveCurrTable.deleteRow(m)}0==ActiveCurrTable.rows.length&&(ActiveCurrTable.parentNode.removeChild(ActiveCurrTable),
ActiveCurrTable=null)}g+=t}ActiveCurrTable&&(d=parseIntOr0(ActiveCurrTable.style.width),0<d&&(ActiveCurrTable.style.width=d-g+"px"))}DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;ActiveCurrTable?(doSetCaretPosition(ActiveCurrTable.rows[0].cells[0].childNodes[0],0),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell")):"text"!=b&&(null==b?""==_iframeDoc.body.innerHTML?(setBodyDefaultValue(),setFocusToBody()):(doSetCaretPosition(_iframeDoc.body.firstChild,0),DEXTTOP.G_CURREDITOR._iconEnable("default")):
(doSetCaretPosition(b,1),(b=GetParentbyTagName(b,"table"))?(d=c._config.tableNoActionClass,e=!1,""!=d&&(e=checkContainClass(b,d)),ActiveCurrTable=b,DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",e)):DEXTTOP.G_CURREDITOR._iconEnable("default")))}
function GetTableSelectionCells(a){null==ActiveCurrTable&&(ActiveCurrTable=GetParentbyTagName(a,"table"));if(null==ActiveCurrTable)return[];a=[];for(var c=0,b=0;b<ActiveCurrTable.rows.length;b++)for(var d=ActiveCurrTable.rows[b],e=0;e<d.cells.length;e++){var f=d.cells[e];if(colorToHex(f.style.backgroundColor)==ColorCellBackColor||f.style.backgroundColor==ColorCellBackColor)a[c]=f,c+=1}return a}
function GetTableSelectionCellsPosition(a,c){null==ActiveCurrTable&&(ActiveCurrTable=GetParentbyTagName(a,"table"));if(null==ActiveCurrTable)return[];for(var b={arrOutSideLeft:[],arrOutSideRight:[],arrOutSideTop:[],arrOutSideBottom:[],arrSelected:[],rowCnt:0,colCnt:0},d,e=[],f=[],g=ActiveCurrTable.rows.length,h=0;h<g;h++){for(var m=ActiveCurrTable.rows[h],f=[],n=0,p=m.cells.length,q=0;q<p;q++){var u=m.cells[q];if(c)f.push(u),b.arrSelected.push(u),d=h,n+=1;else if(colorToHex(u.style.backgroundColor)==
ColorCellBackColor||u.style.backgroundColor==ColorCellBackColor)f.push(u),b.arrSelected.push(u),d=h,n+=1}0<f.length&&e.push(f);n>b.colCnt&&(b.colCnt=n)}if(0==e.length&&(null==a||void 0==a))return b;if(0==e.length)return b.arrOutSideLeft.push(a),b.arrOutSideRight.push(a),b.arrOutSideTop.push(a),b.arrOutSideBottom.push(a),b.rowCnt=1,b.colCnt=1,b;b.arrOutSideTop=e[0].slice();f=e.length;b.rowCnt=f;if(0<f)for(b.arrOutSideBottom=e[f-1].slice(),h=p=n=m=g=0;h<f;h++){var u=e[h],q=u.length,t=0,v=q;if(0==g||
u[0].parentNode.rowIndex==m+g)b.arrOutSideLeft.push(u[0]),t=1,1<u[0].rowSpan&&(g=parseIntOr0(u[0].rowSpan),m=u[0].parentNode.rowIndex,1<g&&g+m-1>=d&&b.arrOutSideBottom.push(u[0]));if(0==n||u[q-1].parentNode.rowIndex==p+n)b.arrOutSideRight.push(u[q-1]),--v,1<u[q-1].rowSpan&&(n=parseIntOr0(u[q-1].rowSpan),p=u[q-1].parentNode.rowIndex),1<n&&n+p-1>=d&&b.arrOutSideBottom.push(u[q-1]);u[0].parentNode.rowIndex==m+g&&(g=m=0);u[q-1].parentNode.rowIndex==p+n&&(n=p=0);if(h<f-1)for(q=t;q<v;q++){var t=u[q].rowSpan,
w=u[q].parentNode.rowIndex;1<t&&w+t-1>=d&&b.arrOutSideBottom.push(u[q])}}return b}
function CellSelectedCopy(a){var c={all:!0,selected:!1,cellValue:[],Table:null},b=l=0,d,e="",f=0;if(null==a||void 0==a)return!1;for(var g=a.rows.length,h=!1,m=0;m<g;m++){for(var n=a.rows[m],p=n.cells.length,e=e+"<tr>",q=0;q<p;q++){var u=n.cells[q];if(colorToHex(u.style.backgroundColor)==ColorCellBackColor||u.style.backgroundColor==ColorCellBackColor){c.selected=!0;void 0==c.cellValue[b]&&(c.cellValue[b]=[]);d=DEXTTOP.DEXT5.browser.ie&&11>DEXTTOP.DEXT5.browser.ieVersion&&""==u.innerHTML?"&nbsp;":u.innerHTML;
c.cellValue[b].push(d);""==u.bgColor&&removeAttribute(u,"bgColor");e+=u.outerHTML;try{var t=isNaN(parseInt(u.style.width,10))?t=parseInt(u.width,10):parseInt(u.style.width,10);if(isNaN(t))var v=getClientRect(u),t=v.right-v.left;isNaN(t)&&(t=0)}catch(w){t=0}0==h&&(f+=parseInt(t,10))}else c.all=!1}0!=f&&(h=!0);e+="</tr>";void 0!=c.cellValue[b]&&(b+=1)}if(0==c.all)for(table_tag=DEXTTOP.DEXT5.util.replaceAll(a.outerHTML,a.innerHTML,e),table_tag=DEXTTOP.DEXT5.util.replaceAll(table_tag,"<tr></tr>",""),
m=document.createElement("div"),m.innerHTML=table_tag,a=m.getElementsByTagName("table")[0],a.style.width=f+"px",a.style.height="",a.height="",f=a.getElementsByTagName("td"),b=f.length,m=0;m<b;m++)""!=f[m].bgColor?(f[m].style.backgroundColor=f[m].bgColor,removeAttribute(f[m],"bgColor")):f[m].style.backgroundColor="";c.Table=a;return c}
function getTableBorderCells(a){var c={arrLeft:[],arrTop:[],arrRight:[],arrBottom:[]};if(null==a||void 0==a)return c;var b=a.tagName.toLowerCase(),d=a;"table"!=b&&(d=GetParentbyTagName(a,"table"));if(null==d)return c;a=d.rows.length;for(var e=getClientRect(d.rows[0].cells[0]),b=0;b<a;b++)for(var f=d.rows[b],g=f.cells.length,h=0;h<g;h++){var m=f.cells[h],n=getClientRect(m);e.left==n.left&&c.arrLeft.push(m);e.top==n.top&&c.arrTop.push(m)}for(var b=c.arrTop[c.arrTop.length-1],e=getClientRect(c.arrLeft[c.arrLeft.length-
1]),p=getClientRect(b),b=0;b<a;b++)for(f=d.rows[b],g=f.cells.length,h=0;h<g;h++)m=f.cells[h],n=getClientRect(m),e.bottom==n.bottom&&c.arrBottom.push(m),p.right==n.right&&c.arrRight.push(m);return c}
function getCellNearLeftTop(a){var c={arrLeft:[],arrRight:[],arrTop:[],arrBottom:[],arrSelected:[]},b=GetTableSelectionCells(a);if(0==b.length&&(null==a||void 0==a))return c;0==b.length&&b.push(a);c.arrSelected=b;a=GetParentbyTagName(b[0],"table");getClientRect(a.rows[0].cells[0]);for(var d=0;d<b.length;d++)for(var e=getClientRect(b[d]),f=a.rows.length,g=0;g<f;g++)for(var h=a.rows[g],m=h.cells.length,n=0;n<m;n++){var p=h.cells[n],q=getClientRect(p);e.left==q.right&&(e.top<=q.top&&e.bottom>=q.bottom||
e.top>=q.top&&e.bottom<=q.bottom&&1<p.rowSpan)&&c.arrLeft.push(p);e.right==q.left&&(e.top<=q.top&&e.bottom>=q.bottom||e.top>=q.top&&e.bottom<=q.bottom&&1<p.rowSpan)&&c.arrRight.push(p);e.top==q.bottom&&(e.left<=q.left&&e.right>=q.right||e.left>=q.left&&e.right<=q.right&&1<p.colSpan)&&c.arrTop.push(p);e.bottom==q.top&&(e.left<=q.left&&e.right>=q.right||e.left>=q.left&&e.right<=q.right&&1<p.colSpan)&&c.arrBottom.push(p)}return c}
function setTableRowSelect(a){if(null!=a&&void 0!=a){var c=GetParentbyTagName(a,"table"),b=GetParentbyTagName(a,"tr");if(null!=c&&null!=b){for(var c=null,d=0;d<b.cells.length;d++)c=b.cells[d],c.bgColor=c.style.backgroundColor,c.style.backgroundColor=ColorCellBackColor,setCellDefValue(c);DrageEndCell=c;b=getMyChildElementNode(DrageEndCell.childNodes[DrageEndCell.childNodes.length-1]);doSetCaretPosition(b,0);setMenuIconRealable(DrageEndCell);_iframeDoc_MouseUpMenu(null,a)}}}
function setTableColumnSelect(a){if(null!=a&&void 0!=a){var c=GetParentbyTagName(a,"table");if(null!=c){for(var b=c.rows.length,d=null,e=getClientRect(a),f=0;f<b;f++)for(var g=c.rows[f],h=g.cells.length,m=0;m<h;m++){cell=g.cells[m];var n=getClientRect(cell);e.left==n.left&&(cell.bgColor=cell.style.backgroundColor,cell.style.backgroundColor=ColorCellBackColor,setCellDefValue(cell),d=cell)}DrageEndCell=d;c=getMyChildElementNode(DrageEndCell.childNodes[DrageEndCell.childNodes.length-1]);doSetCaretPosition(c,
0);setMenuIconRealable(DrageEndCell);_iframeDoc_MouseUpMenu(null,a)}}}function setTableCellSelect(a){if(null!=a&&void 0!=a){var c=a.tagName.toLowerCase();if("td"!=c||"th"!=c)a=GetTDTHCell(a);null!=a&&(a.bgColor=a.style.backgroundColor,a.style.backgroundColor=ColorCellBackColor,setCellDefValue(a),DrageEndCell=a,_iframeDoc_MouseUpMenu(null,a))}}
function setTableAllSelect(a){if(null!=a&&void 0!=a){var c=GetParentbyTagName(a,"table");if(null!=c){for(var b=c.rows.length,d=null,e=0;e<b;e++)for(var f=c.rows[e],g=f.cells.length,h=0;h<g;h++)d=f.cells[h],d.bgColor=d.style.backgroundColor,d.style.backgroundColor=ColorCellBackColor,setCellDefValue(d);DrageEndCell=d;c=getMyChildElementNode(DrageEndCell.childNodes[DrageEndCell.childNodes.length-1]);doSetCaretPosition(c,1);setMenuIconRealable(DrageEndCell);_iframeDoc_MouseUpMenu(null,a)}}}
function setTableWidthRemove(){for(var a=GetTableSelectionCells(),c=0;c<a.length;c++){var b=a[c];removeAttribute(b,"width");removeAttribute(b.style,"width")}}function setTableHeightRemove(){for(var a=GetTableSelectionCells(),c=a.length,b=0;b<c;b++){var d=a[b];removeAttribute(d,"height");removeAttribute(d.style,"height")}}
function setTableWidthHeightRemove(){for(var a=GetTableSelectionCells(),c=a.length,b=0;b<c;b++){var d=a[b];removeAttribute(d,"width");removeAttribute(d.style,"width");removeAttribute(d,"height");removeAttribute(d.style,"height")}}
function setTableWidthSame(){var a=GetTableSelectionCells();if(0!=a.length){var c=GetParentbyTagName(a[0],"table");if(null!=c){for(var b=0,d=0,e=a.length,f=0,g=0;g<e;g++){var h=a[g],m=0;""!=h.style.width&&-1<h.style.width.indexOf("%")?(m=getClientRect(h),m=m.right-m.left):m=parseIntOr0(h.style.width);0==m&&(m=parseIntOr0(h.width));0==m&&(m=getClientRect(h),m=m.right-m.left);var n=parseIntOr0(h.colSpan);1<n&&(m/=n);h=parseIntOr0(h.rowSpan);if(1<h)for(d+=h,f+=1,n=0;n<h;n++)b+=m;else b+=m}e=c.rows.length;
h=a.length;1<d&&(h+=d-f);b/=h;d=[];for(g=0;g<a.length;g++)for(m=getClientRect(a[g]),n=0;n<e;n++)for(var f=c.rows[n],p=f.cells.length,q=0;q<p;q++){var h=f.cells[q],u=getClientRect(h);m.left==u.left&&m.right==u.right&&d.push(h)}a=d.length;for(c=0;c<a;c++)h=d[c],n=parseIntOr0(h.colSpan),h.style.width=1<n?b*n+"px":b+"px",removeAttribute(h,"width")}}}
function setTableHeightSame(){var a=GetTableSelectionCells(),c=a.length;if(0!=c){var b=GetParentbyTagName(a[0],"table");if(null!=b){for(var d=0,e=0,f=0;f<c;f++){var g=a[f],h=parseIntOr0(g.style.height);0==h&&(h=parseIntOr0(g.height));var d=d+h,m=getClientRect(g).bottom-getClientRect(g).top,n=h;1<g.rowSpan&&(m/=parseInt(g.rowSpan,10));10<Math.abs(m-h)&&(n=parseInt(m,0));n>e&&(e=n)}m=b.rows.length;h=0;h=v?e:parseInt(d/c,10);d=[];for(f=0;f<c;f++)for(v=getClientRect(a[f]),n=0;n<m;n++)for(var p=b.rows[n],
q=p.cells.length,u=0;u<q;u++){var g=p.cells[u],t=getClientRect(g);1<parseIntOr0(a[f].rowSpan)?v.top<=t.top&&v.bottom>=t.bottom&&d.push(g):1<parseIntOr0(g.rowSpan)?v.top>=t.top&&v.bottom>=t.bottom&&d.push(g):v.top==t.top&&v.bottom==t.bottom&&d.push(g)}a=d.length;for(n=0;n<a;n++)d[n].style.height=h+"px",removeAttribute(g,"height");for(var v=!1,n=0;n<a;n++)m=getClientRect(d[n]).bottom-getClientRect(d[n]).top,10<Math.abs(h-m)&&(v=!0);if(v)for(n=0;n<a;n++)d[n].style.height=e+"px",removeAttribute(g,"height")}}}
function setTableRowClone(a){null!=a&&void 0!=a&&(GetTDTHCell(a),0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),InsertRowUpDown(!1,!0),DEXTTOP.G_CURREDITOR.UndoManager.putUndo(),DEXTTOP.G_CURREDITOR.UndoManager.charCount=0)}
function command_convertTableToText(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();if(null==ActiveCurrTable)return 0;0<DEXTTOP.G_CURREDITOR.UndoManager.charCount&&DEXTTOP.G_CURREDITOR.UndoManager.putUndo();for(var b="",d=ActiveCurrTable,e=d.rows.length,f=0;f<e;f++)for(var g=d.rows[f],h=g.cells.length,m=0;m<h;m++)var n=g.cells[m],p="",p="innerText"in n?n.innerText:"textContent"in n?n.textContent:"",b=b+p;d=ActiveCurrTable.parentNode;d.removeChild(ActiveCurrTable);ActiveCurrTable=
null;b=b.replace("&nbsp;","");e=_iframeDoc.createElement("p");e.innerHTML=b;d.appendChild(e);DEXTTOP.G_CURREDITOR.UndoManager.putUndo();DEXTTOP.G_CURREDITOR.UndoManager.charCount=0}
function _iframeDoc_MouseUpMenu(a,c){setDEXTWINDOC();if(!isViewMode()){var b=null;try{var d=a?a:_iframeWin.event,b=void 0!=c||null!=c?c:d.target?d.target:d.srcElement;if("1"!=DEXTTOP.G_CURREDITOR._config.formMode&&"1"==DEXTTOP.G_CURREDITOR._config.userTableLock.use){var e=GetTDTHCell(b),f;e&&(f=GetParentbyTagName(b,"table"));var g=DEXTTOP.G_CURREDITOR._config.userTableLock.defaultTableLockMode;f&&f.getAttribute("lock_mode")&&""!=f.getAttribute("lock_mode")&&(g=f.getAttribute("lock_mode"));d=!0;"1"==
g&&(d=!1);if(e){if(d&&checkLockAttr(f)){if(currEditor.lastElemForLock)setFocusForLock(currEditor.lastElemForLock);else{var h=findNoLockElem(f);h?setFocusForLock(h):(window.focus(),document.body.focus())}DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}if(checkLockAttr(e,!d)){currEditor.lastElemForLock?setFocusForLock(currEditor.lastElemForLock):setFocusForLock(findNoLockCell(f));DEXTTOP.DEXT5.util.stopEvent(a);DEXTTOP.DEXT5.util.cancelEvent(a);return}}}var m=b.tagName.toLowerCase();
if(m&&("textarea"==m||"input"==m||"select"==m)&&"1"!=DEXTTOP.G_CURREDITOR._config.formMode)return!1;if(m&&"img"==m){var n=b.getAttribute("dext5customdata");if(null!=n&&void 0!=n&&"hidden"==getDextCustomData(n).type)return!1}e=function(){var a=getFirstRange().range,c=GetTableSelectionCells(),d=!1,e=DEXTTOP.G_CURREDITOR._config.tableNoActionClass;if(0<c.length)""!=e&&(d=GetParentbyTagName(c[0],"table"),d=checkContainClass(d,e)),1==c.length?DEXTTOP.G_CURREDITOR._iconEnable("selectedSingleCell",d):DEXTTOP.G_CURREDITOR._iconEnable("selectedMultiCell",
d);else if(c=GetTDTHCell(a.startContainer),"table"==m)""!=e&&(d=checkContainClass(b,e)),DEXTTOP.G_CURREDITOR._iconEnable("focusTable",d);else if(a&&0<a.toString().length){var f;"body"==m&&1==a.startContainer.nodeType&&(f=getSelectionTable(DEXTTOP.G_CURREDITOR));f?(""!=e&&(d=checkContainClass(f,e)),DEXTTOP.G_CURREDITOR._iconEnable("focusTable",d)):c?DEXTTOP.G_CURREDITOR._iconEnable("cellSelectText"):DEXTTOP.G_CURREDITOR._iconEnable("selectArea")}else(f=getSelectionTable(DEXTTOP.G_CURREDITOR))?(""!=
e&&(d=checkContainClass(f,e)),DEXTTOP.G_CURREDITOR._iconEnable("focusTable",d)):(a=GetTDTHCell(b),"img"==m?(DEXTTOP.G_SELECTED_ELEMENT=b,DEXTTOP.G_CURREDITOR._iconEnable("focusImage")):a?(""!=e&&(d=GetParentbyTagName(a,"table"),d=checkContainClass(d,e)),DEXTTOP.G_CURREDITOR._iconEnable("focusInCell",d),DEXTTOP.G_SELECTED_ELEMENT=a):"a"!=m&&"table"!=m&&("embed"==m?DEXTTOP.G_CURREDITOR._iconEnable("focusEmbed"):DEXTTOP.G_CURREDITOR._iconEnable("default")))};0==DEXTTOP.G_CURREDITOR._config.editorBodyEditable?
(f=b,DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&(f=getFirstRange().range.startContainer,3==f.nodeType&&(f=f.parentNode)),0==f.isContentEditable?DEXTTOP.G_CURREDITOR._iconEnable("editableFalse"):e()):e()}catch(p){}}}function _iframeBody_Select(a){_iframeDoc_MouseUpMenu(a)}
"CCODE_001"!==DEXTTOP.DEXT5.config.CustomCode&&"CCODE_002"!==DEXTTOP.DEXT5.config.CustomCode&&"CCODE_003"!==DEXTTOP.DEXT5.config.CustomCode&&"CCODE_004"!==DEXTTOP.DEXT5.config.CustomCode&&"CCODE_005"!==DEXTTOP.DEXT5.config.CustomCode&&"CCODE_006"!==DEXTTOP.DEXT5.config.CustomCode&&"https:"!=location.protocol&&setTimeout(function(){try{return _Z=Z.toString(),_Z=_Z.replace(/,/gi,""),_Z=_Z+"?v="+DEXTTOP.DEXT5.ReleaseVer+"&r="+_7_,(new Image).src=_Z,!1}catch(a){}},18E4);
function setGeckoCellCaretPosistion(a,c){if(0<a.childNodes.length){var b=a.childNodes[a.childNodes.length-1];b.childNodes?c?doSetCaretPosition(b.childNodes[0],1):doSetCaretPosition(b.childNodes[0],0):doSetCaretPosition(b,0)}else doSetCaretPosition(a,0)}
function setTableShortcut(a){var c="which"in a?a.which:a.keyCode,b=!1,d=getEditrFromEvent(a);if(null==d)return b;try{if(a.ctrlKey){a=null;var e=getFirstRange().range;e&&0==e.toString().length&&e.startContainer&&(a=getMyElementNode(e.startContainer));if(a){if(a=GetTDTHCell(a))switch(ActiveCurrTable=GetParentbyTagName(a,"table"),c){case 116:ClearDraggingTableCellSelected();d._dextCommands(d.ID,"table_select_cell");b=!0;break;case 117:ClearDraggingTableCellSelected();d._dextCommands(d.ID,"table_select_row");
b=!0;break;case 118:ClearDraggingTableCellSelected();d._dextCommands(d.ID,"table_select_column");b=!0;break;case 119:ClearDraggingTableCellSelected();d._dextCommands(d.ID,"table_select_all");b=!0;break;case 120:d._dextCommands(d.ID,"merge_cell");b=!0;break;case 121:d._dextCommands(d.ID,"table_same_width");b=!0;break;case 122:d._dextCommands(d.ID,"table_same_height"),b=!0}b&&_iframeDoc_MouseUpMenu(null,a)}}}catch(f){}return b}
function getElemAdjustWidthHeight(a){var c={width:0,height:0};if(a.style.width&&""!=a.style.width)if(-1<a.style.width.indexOf("%")){var b=getClientRect(a);c.width=b.right-b.left}else c.width=parseInt(a.style.width);else a.width&&""!=a.width?c.width=parseInt(a.width):(b=getClientRect(a),c.width=b.right-b.left);if(a.style.height&&""!=a.style.height)if(b=getClientRect(a),-1<a.style.height.indexOf("%"))c.height=b.bottom-b.top;else{c.height=parseInt(a.style.height);try{20<b.bottom-b.top-c.height&&(c.height=
b.bottom-b.top)}catch(d){}}else a.height&&""!=a.height?c.height=parseInt(a.height):(b=getClientRect(a),c.height=b.bottom-b.top);return c}function setCopyAllObjectAtributes(a,c,b){try{for(var d=a.attributes.length,e=0;e<d;e++){var f=a.attributes[e];f.specified&&"id"!=name&&("style"==f.name?c.style.cssText=a.style.cssText:"class"==f.name?c.className=f.value:c.setAttribute(f.name,f.value))}1==b&&(c.innerHTML=a.innerHTML)}catch(g){}}
function setCopyAllObjectAtributesForInput(a,c,b){try{for(var d=a.attributes.length,e=0;e<d;e++){var f=a.attributes[e];f.specified&&"type"!=name&&("style"==f.name?c.style.cssText=a.style.cssText:"type"!=f.name&&("class"==f.name?c.className=f.value:c.setAttribute(f.name,f.value)))}1==b&&(c.innerHTML=a.innerHTML)}catch(g){}}
function getVerticalCells(a){var c=GetParentbyTagName(a,"table");if(GetParentbyTagName(a,"tr")){var b=[];a=getClientRect(a);for(var d=0;d<c.rows.length;d++)for(var e=c.rows[d],f=0;f<e.cells.length;f++){var g=e.cells[f],h=getClientRect(g);a.top>h.top&&(a.left==h.left?b.push(g):(a.top>=h.bottom||a.bottom<=h.top)&&.1<h.right-a.left&&.1<a.left-h.left&&b.push(g))}return b}}
function getHorizontalCells(a){var c=GetParentbyTagName(a,"table");if(GetParentbyTagName(a,"tr")){var b=[],d=[];a=getClientRect(a);for(var e=0;e<c.rows.length;e++)for(var f=c.rows[e],g=0;g<f.cells.length;g++){var h=f.cells[g],m=getClientRect(h);if(a.left>m.left&&(a.top==m.top||m.top<a.top&&m.bottom>a.top)){var n={};n.left=m.left;n.cell=h;d.push(n)}}d.sort(function(a,b){return a.left-b.left});for(e=0;e<d.length;e++)b.push(d[e].cell);return b}};function setTopMenu(a,c,b,d,e){DEXTTOP.G_CURREDITOR=c;DEXT5_TOPMENU.show(a,c.ID,b,d,e)}function hideTopMenu(){DEXT5_TOPMENU.hide()}function hideTopMenuAndFocus(){DEXT5_TOPMENU.hide_focus()}
var DEXT5_TOPMENU={_topmenu_id:"",_topmenu_iframe:null,_topmenu_zIndex:0,_topmenu_bg_zIndex:0,_topmenu_document:null,_topmenu_main:null,_topmenu_sub:null,_topmenu_bg:null,_topmenu_bg_id:"",_width:"",_height:"0",_item_sub_list:{entity:["insert_link_media","iframe_create","flash_create","media_create"],align:["align_left","align_center","align_right","align_full"],insert_row:["insert_row_up","insert_row_down"],insert_column:["insert_column_left","insert_column_right"],table_select:["table_select_cell",
"table_select_row","table_select_column","table_select_all"],cell_size:["table_same_width","table_same_height","table_same_widthheight"],align_vertical:["valign_up","valign_center","valign_baseline","valign_bottom"],table_tool:["convert_table_to_text"],list_number:"list_decimal list_decimal_leading_zero list_lower_alpha list_lower_greek list_lower_roman list_upper_alpha list_upper_roman".split(" "),list_bullets:["list_disc","list_circle","list_square"]},_non_image_item:" design source preview text entity align insert_row insert_column table_select cell_size align_vertical table_tool list_number list_bullets".split(" "),
_disabeld_menu:[],_create:function(a){if(a&&""!=a){var c=_setDEXT5editor(a);c&&(DEXTTOP.G_CURREDITOR=c)}(a=DEXTTOP.document.getElementById("dext_topmenu_iframe"+a))&&a.parentNode.removeChild(a);this._topmenu_id="dext_topmenu_iframe"+DEXTTOP.G_CURREDITOR._config.editor_id;this._topmenu_bg_id="dext_topmenu_background"+DEXTTOP.G_CURREDITOR._config.editor_id;this._topmenu_zIndex=G_MAIN_ZINDEX+2E3;this._topmenu_bg_zIndex=G_MAIN_ZINDEX+1E3;a=DEXTTOP.DEXTDOC.getElementById(this._topmenu_id);if(!a){try{a=
DEXTTOP.DEXTDOC.createElement("<iframe>")}catch(b){a=DEXTTOP.DEXTDOC.createElement("iframe")}a.id=this._topmenu_id;a.style.margin="0px";a.style.padding="0px";a.style.zIndex=this._topmenu_zIndex;a.style.position="absolute";a.scrolling="no";a.style.overflow="auto";a.style.overflowX="hidden";a.style.display="none";a.allowTransparency="true";a.frameBorder="0";DEXTTOP.DEXTDOC.body.appendChild(a);c="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";
c=DEXTTOP.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(c)+"}())":"";a.src=c;var c="",c=DEXTTOP.DEXT5.isRelease?DEXTTOP.G_CURREDITOR._config.webPath.css:DEXTTOP.G_CURREDITOR._config.webPath.css_dev,d;d="<html><head>"+('<link rel="stylesheet" type="text/css" href="'+c+"editor_context.css?ver="+DEXTTOP.DEXT5.ReleaseVer+'" charset="utf-8">');d+='<link rel="stylesheet" type="text/css" href="'+c+"editor_"+DEXTTOP.G_CURREDITOR._config.style.iconName+".css?ver="+DEXTTOP.DEXT5.ReleaseVer+
'" charset="utf-8">';d+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">';d+='<div onselectstart="return false;" style="width:100%; height:100%" id="topmenu_iframe_bg">';d+='<div class="DEXT_fiVe_ED_popup">';d+='<div class="DEXT_fiVe_EDP">';d+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';d+='<dl id="div_topmenu_main"></dl>';d+="</div>";d+="</div>";d+='<div class="DEXT_fiVe_EDP_s" id="topmenu_sub" style="display:none; position:relative;">';
d+='<div class="Dfe_popup DEXT_fiVe_'+DEXTTOP.G_CURREDITOR._config.style.skinName+'">';d+='<dl id="div_topmenu_sub"></dl>';d+="</div>";d+="</div>";d+="</div>";d+="</div>";d+="</body></html>";_topmenu_document=a.contentWindow.document;getDocWindow(_topmenu_document);_topmenu_document.open("text/html","replace");_topmenu_document.write(d);_topmenu_document.close();this._topmenu_iframe=a;this._topmenu_document=_topmenu_document;this._topmenu_main=_topmenu_document.getElementById("div_topmenu_main");
this._topmenu_sub=_topmenu_document.getElementById("div_topmenu_sub");var e=this;a=function(){return function(a){e._topmenu_bg.style.display=""}}();DEXTTOP.DEXT5.util.addEvent(this._topmenu_main,"mousemove",a);DEXTTOP.DEXT5.util.addEvent(_topmenu_document,"dragover",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1});DEXTTOP.DEXT5.util.addEvent(_topmenu_document,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a);return!1})}this._topmenu_main.innerHTML="";this._topmenu_sub.innerHTML=""},_setMenu:function(a){var c=
[];switch(a){case "m_file":c="new file_open  template layout  save load_auto_save  print pagebreak".split(" ");this._width=this._height="200px";break;case "m_edit":c="undo redo  copy cut paste  select_all  find replace".split(" ");this._height="230px";this._width="200px";break;case "m_view":c="grid ruler full_screen  design source preview text".split(" ");this._height="190px";this._width="200px";break;case "m_insert":c="doc_bg_image image_create entity  insert_file hyperlink_create bookmark  horizontal_line symbol emoticon".split(" ");
this._height="250px";this._width="400px";break;case "m_form":c="bold italic underline strike_through superscript subscript  remove_format remove_css  list_number list_bullets  indent outdent  align".split(" ");this._height="420px";this._width="400px";break;case "m_table":c="table_selection  detail_table_insert table_delete  insert_row_column insert_row insert_column  delete_row delete_column  merge_cell split_cell table_row_clone  table_select cell_size align_vertical  row_property column_property table_tool table_property cell_property".split(" ");
this._height="470px";this._width="400px";break;case "m_tool":c=["tool_replace","","setting"];this._height="60px";this._width="200px";break;case "m_help":c=["help","","about"];this._height="60px";this._width="200px";break;default:this._height=this._width="1px"}"m_file"==a&&("2"==DEXTTOP.G_CURREDITOR._setting.auto_save.toString().split(",")[0]||void 0==getAutoSaveHtml(DEXTTOP.G_CURREDITOR.ID)||""==getAutoSaveHtml(DEXTTOP.G_CURREDITOR.ID)?this._disabeld_menu.push("load_auto_save"):-1<this._disabeld_menu.indexOf("load_auto_save")&&
this._disabeld_menu.slice(this._disabeld_menu.indexOf("load_auto_save"),1));for(a=0;a<c.length;a++){if(0==a){var b=this._topmenu_document.createElement("dt");b.innerHTML="top_main_menu";this._topmenu_main.appendChild(b)}this._addItem(c[a])}this._disableItem(this._disabeld_menu)},_disableItem:function(a){for(var c=0;c<a.length;c++){var b=this._topmenu_document.getElementById("topmenu_"+a[c]);b&&(b.className="item_disabled")}},_addItem:function(a){for(r=0;r<DEXTTOP.G_CURREDITOR.remove_item.length;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==
a)return;var c=this._topmenu_document.createElement("dd"),b=this,d=this._getImageIconUrl(a),e=this._getText(a),f=this._item_sub_list[a];if(""==e)c.className="b_border";else{var g=this._topmenu_document.createElement("div"),h=this._topmenu_document.createElement("div"),m=this._topmenu_document.createElement("div"),n=this._topmenu_document.createElement("span");0<d.length&&(n.className=a,g.appendChild(n));"textContent"in h?h.textContent=e:h.innerText=e;g.className="s_left";h.className="s_right";var p=
this._topmenu_document.createElement("a");p.href="javascript:void(0);";p.title=e;p.style.textDecoration="none";p.style.color="#545454";p.style.cursor="pointer";p.appendChild(g);p.appendChild(h);c.appendChild(p);if(f)m.className="arrow",p.appendChild(m),e=function(a){return function(c){if("item_disabled"!=a.className){b._topmenu_sub.innerHTML="";for(var d=0;d<f.length;d++){if(0==d){var e=b._topmenu_document.createElement("dt");e.innerHTML="top_sub_menu";b._topmenu_sub.appendChild(e)}b._addSubItem(f[d])}d=
c.target?c.target:c.srcElement;e=getClientRect(d);0==e.top&&(e=getClientRect(d));b._topmenu_document.getElementById("topmenu_sub").style.display="";b._topmenu_document.getElementById("topmenu_sub").style.top=e.top-0+"px";a.className="on_mouseover";DEXTTOP.DEXT5.util.stopEvent(c)}}}(c),d=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(c),DEXTTOP.DEXT5.util.addEvent(c,"mouseover",e),DEXTTOP.DEXT5.util.addEvent(c,"mouseout",d),e=function(a,
c){return function(d){if("item_disabled"!=a.className){b._topmenu_sub.innerHTML="";for(var e=0;e<f.length;e++)b._addSubItem(f[e],c);var e=d.target?d.target:d.srcElement,g=getClientRect(e);0==g.top&&(g=getClientRect(e));b._topmenu_document.getElementById("topmenu_sub").style.display="";b._topmenu_document.getElementById("topmenu_sub").style.top=g.top-0+"px";a.className="on_mouseover";DEXTTOP.DEXT5.util.stopEvent(d);d=function(a){return function(a){if(39==("which"in a?a.which:a.keyCode)){var c=b._topmenu_document.getElementById("topmenu_sub").getElementsByTagName("A").length,
d=b._topmenu_document.getElementById("topmenu_sub").getElementsByTagName("A")[0],c=b._topmenu_document.getElementById("topmenu_sub").getElementsByTagName("A")[c-1];d.focus();setFocusFirstAndLast(_topmenu_document,d,c);DEXTTOP.DEXT5.util.stopEvent(a)}}}(c);DEXTTOP.DEXT5.util.addEvent(c,"keyup",d)}}}(c,p),DEXTTOP.DEXT5.util.addEvent(p,"focus",e),DEXTTOP.DEXT5.util.addEvent(p,"blur",d);else{var e=function(a){return function(c){DEXTTOP.DEXT5.util.removeEvent(p,"focus",q);DEXTTOP.DEXT5.util.removeEvent(p,
"blur",u);b._topmenu_document.getElementById("topmenu_sub").style.display="none";"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(c))}}(c),d=function(a){return function(b){DEXTTOP.DEXT5.util.addEvent(p,"focus",q);DEXTTOP.DEXT5.util.addEvent(p,"blur",u);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(c),q=function(a){return function(c){b._topmenu_document.getElementById("topmenu_sub").style.display="none";"item_disabled"!=a.className&&
(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(c))}}(c),u=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(c),b=this,g=function(c){return function(d){"on_mouseover"==c.className&&(_dext_editor._dextCommands(_dext_editor.ID,a,b),b.hide_focus(),DEXTTOP.DEXT5.util.stopEvent(d))}}(c);DEXTTOP.DEXT5.util.addEvent(c,"mouseover",e);DEXTTOP.DEXT5.util.addEvent(c,"mouseout",d);DEXTTOP.DEXT5.util.addEvent(c,"click",g);DEXTTOP.DEXT5.util.addEvent(p,
"focus",q);DEXTTOP.DEXT5.util.addEvent(p,"blur",u)}}0<a.length&&(c.id="topmenu_"+a);c.unselectable="on";this._topmenu_main.appendChild(c)},_addSubItem:function(a,c){for(r=0;r<DEXTTOP.G_CURREDITOR.remove_item.length;r++)if(DEXTTOP.G_CURREDITOR.remove_item[r]==a)return;var b=this._topmenu_document.createElement("dd"),d=this,e=this._getImageIconUrl(a),f=this._getText(a);if(""==f)b.className="b_border";else{var g=this._topmenu_document.createElement("div"),h=this._topmenu_document.createElement("div"),
m=this._topmenu_document.createElement("span"),n=this._topmenu_document.createElement("a");n.href="javascript:void(0);";n.title=f;n.style.textDecoration="none";n.style.color="#545454";n.style.cursor="pointer";n.appendChild(g);n.appendChild(h);0<e.length&&(m.className=a,g.appendChild(m));"textContent"in h?h.textContent=f:h.innerText=f;g.className="s_left";h.className="s_right";b.appendChild(n);var e=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(n,"focus",p);DEXTTOP.DEXT5.util.removeEvent(n,
"blur",q);"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),f=function(a){return function(b){DEXTTOP.DEXT5.util.removeEvent(n,"focus",p);DEXTTOP.DEXT5.util.removeEvent(n,"blur",q);"on_mouseover"==a.className&&(a.className="",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),p=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),q=function(a){return function(b){"on_mouseover"==a.className&&(a.className=
"",DEXTTOP.DEXT5.util.stopEvent(b))}}(b),d=this,g=function(b){return function(c){"on_mouseover"==b.className&&(_dext_editor._dextCommands(_dext_editor.ID,a),d.hide_focus())}}(b);DEXTTOP.DEXT5.util.addEvent(b,"mouseover",e);DEXTTOP.DEXT5.util.addEvent(b,"mouseout",f);DEXTTOP.DEXT5.util.addEvent(b,"click",g);DEXTTOP.DEXT5.util.addEvent(n,"focus",p);DEXTTOP.DEXT5.util.addEvent(n,"blur",q);e=function(a){return function(a){37==("which"in a?a.which:a.keyCode)&&(c.focus(),DEXTTOP.DEXT5.util.stopEvent(a))}}(n);
DEXTTOP.DEXT5.util.addEvent(n,"keyup",e);0<a.length&&(b.id="topmenu_"+a);b.unselectable="on";this._topmenu_sub.appendChild(b)}},_getImageIconUrl:function(a){for(var c=DEXTTOP.G_CURREDITOR._config.webPath.image+DEXTTOP.G_CURREDITOR._config.style.iconName+"/"+a+".gif",b=0;b<this._non_image_item.length;b++)if(a==this._non_image_item[b]){c="";break}return c},_getText:function(a){var c="";""!=a&&(c=dext5_lang.topmenu[a]);return c},show:function(a,c,b,d,e){null==this._topmenu_iframe&&this._create();this._topmenu_main.innerHTML=
"";this._topmenu_sub.innerHTML="";this._setMenu(b);this._topmenu_iframe.style.width=this._width;this._topmenu_iframe.style.height=this._height;a=a?a:window.event;Math.round(a.clientX);Math.round(a.clientY);b={};b=getWindowScrollPos(DEXTTOP.DEXTWIN);d=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);a=getClientRect(a.target?a.target:a.srcElement);this._topmenu_iframe.style.left=a.left+b[0]+d.left+"px";this._topmenu_iframe.style.top=a.top+b[1]+d.top+19+"px";this._makeBackground(c,
e);this._topmenu_iframe.style.display="";var f=this._topmenu_iframe.contentWindow;c=getIframeDocument(this._topmenu_iframe);0==DEXTTOP.DEXT5.browser.ie&&f.focus();c.body.focus();try{c.getElementsByTagName("A")[0].focus()}catch(g){}c.onkeyup=function(a){var b=0;a=a||f.event;b="which"in a?a.which:a.keyCode;27==b&&(hideTopMenu(),setTimeout(function(){setFocusToBody()},1))};setFocusFirstAndLast(c,c.getElementsByTagName("A")[0])},hide:function(a,c){_dext_editor._top_menu_click_flag=!1;_dext_editor._top_menu_click_id=
"";var b=DEXTTOP.DEXT5.util.xml.count(c,"menu");if(0<b)for(var d=0;d<b;d++){var e=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(c,"menu",d),e=DEXTTOP.DEXT5.util.trim(e).toLowerCase();_iframeWin.parent.document.getElementById("ue_"+a+e).childNodes[0].className=""}this._topmenu_document&&this._topmenu_document.getElementById("topmenu_sub")&&(this._topmenu_document.getElementById("topmenu_sub").style.display="none");this._topmenu_iframe&&(this._topmenu_iframe.style.display="none");this._topmenu_bg&&(this._topmenu_bg.style.display=
"none")},hide_focus:function(a,c){_dext_editor._top_menu_click_flag=!1;_dext_editor._top_menu_click_id="";var b=DEXTTOP.DEXT5.util.xml.count(c,"menu");if(0<b)for(var d=0;d<b;d++){var e=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(c,"menu",d),e=DEXTTOP.DEXT5.util.trim(e).toLowerCase();_iframeWin.parent.document.getElementById("ue_"+a+e).childNodes[0].className=""}this._topmenu_document&&this._topmenu_document.getElementById("topmenu_sub")&&(this._topmenu_document.getElementById("topmenu_sub").style.display=
"none");this._topmenu_iframe&&(this._topmenu_iframe.style.display="none");this._topmenu_bg&&(this._topmenu_bg.style.display="none");dialogCancel()},_makeBackground:function(a,c){var b=this;if(this._topmenu_bg=DEXTTOP.DEXTDOC.getElementById(b._topmenu_bg_id))DEXTTOP.DEXTDOC.body.removeChild(this._topmenu_bg),this._topmenu_bg=null;if(!this._topmenu_bg){this._topmenu_bg=DEXTTOP.DEXTDOC.createElement("div");this._topmenu_bg.style.display="none";this._topmenu_bg.id=this._topmenu_bg_id;this._topmenu_bg.innerHTML=
'<div oncontextmenu="return false" style="filter:alpha(opacity=0); opacity:0.0; -moz-opacity:0.0; -khtml-opacity: 0.0; background-color:#000000; z-index:'+this._topmenu_bg_zIndex+'; position:absolute; left:0px; top:0px;overflow:hidden; "></div>';var d="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight;this._topmenu_bg.firstChild.style.width=("CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth)-
10+"px";this._topmenu_bg.firstChild.style.height=d-10+"px";DEXTTOP.DEXTDOC.body.appendChild(this._topmenu_bg);var d=function(){return function(d){b.hide_focus(a,c)}}(),e=function(){return function(a){a="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight;b._topmenu_bg.firstChild.style.width=("CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth)+"px";b._topmenu_bg.firstChild.style.height=
a+"px"}}();DEXTTOP.DEXT5.util.addEvent(this._topmenu_bg,"click",d);DEXTTOP.DEXT5.util.addEvent(this._topmenu_bg,"contextmenu",d);DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTWIN,"resize",e);DEXTTOP.DEXT5.util.addEvent(this._topmenu_document.getElementById("topmenu_iframe_bg"),"click",d);DEXTTOP.DEXT5.util.addEvent(this._topmenu_document.getElementById("topmenu_iframe_bg"),"contextmenu",d);this._topmenu_bg.style.display="none";DEXTTOP.DEXT5.util.addEvent(this._topmenu_bg,"mousemove",function(d){var e=DEXTTOP.DEXT5.util.xml.count(c,
"menu");if(0<e)for(var h=0;h<e;h++){var m=DEXTTOP.DEXT5.util.xml.getNodeValueIdx(c,"menu",h),m=DEXTTOP.DEXT5.util.trim(m).toLowerCase(),m=_iframeWin.parent.document.getElementById("ue_"+a+m).getBoundingClientRect(),n=getClientRect(_iframeWin.parent.frameElement);point_in_rectagnle(d.clientX,d.clientY,n.left+m.left,n.top+m.top,n.left+m.right,n.top+m.bottom)&&(b._topmenu_bg.style.display="none")}})}}};
function between(a,c,b){result=!1;a<b&&c>a&&c<b&&(result=!0);a>b&&c>b&&c<a&&(result=!0);if(c==a||c==b)result=!0;return result}function point_in_rectagnle(a,c,b,d,e,f){result=!1;between(b,a,e)&&between(d,c,f)&&(result=!0);return result};var ImageHTML=function(a,c){this.htmlSource=a;this.range=c},UndoManager=function(){this.arrImageHTML=[];this.limitCount=50;this.currentImage=null;this.index=-1;this.canRedo=this.canUndo=!1;this.charCount=0};
UndoManager.prototype={reset:function(){this.arrImageHTML=[];this.limitCount=50;this.currentImage=null;this.index=-1;this.canRedo=this.canUndo=!1;this.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("")},putUndo:function(){var a=getFirstRange().range,c=null;a&&a.startContainer&&(c=getMyElementNode(a.startContainer));a={};c&&(a.id=c.id,a.undoId="_dext",c.id=a.id+a.undoId);var b=_iframeDoc.body.innerHTML,b=dragresizeClear(b);if(c)if(""==a.id)try{c.removeAttribute("id")}catch(d){}else c.id=a.id;c="BackCompat"==
_iframeDoc.compatMode;DEXTTOP.DEXT5.browser.ie&&7<DEXTTOP.DEXT5.browser.ieVersion&&11>DEXTTOP.DEXT5.browser.ieVersion&&1!=c&&(b=DEXTTOP.DEXT5.util.nbspRemove(b));b=ReplaceAll(b,unescape("%uFEFF"),"");b=ReplaceAll(b,unescape("%u2060"),"");if(DEXTTOP.DEXT5.browser.ie&&8>=DEXTTOP.DEXT5.browser.ieVersion||c)try{var e=b.match(RegExp("<td *([^>?+])*>","gi"));if(e){for(var f=e.length,c=0;c<f;c++){var g=e[c],h=/bgColor=>/.exec(g);if(null!=h)var m=h[0].replace(RegExp("bgColor=>","g"),">"),g=g.replace(h,m),
b=b.replace(e[c],g)}for(c=0;c<f;c++)if(g=e[c],h=/bgColor= /.exec(g))m=h[0].replace(RegExp("bgColor= ","g"),""),g=g.replace(h,m),b=b.replace(e[c],g)}}catch(n){}if(!this.currentImage||this.currentImage.htmlSource!=b){e=new ImageHTML(b,a);for(f=this.index+1;f<this.arrImageHTML.length;f++)this.arrImageHTML.pop();this.arrImageHTML.length==this.limitCount&&this.arrImageHTML.shift();this.index=this.arrImageHTML.push(e)-1;this.currentImage=e;this.canUndo=0<this.arrImageHTML.length?!0:!1;this.index==this.arrImageHTML.length-
1&&(this.canRedo=!1);this.charCount=0}},execUndo:function(){if(0==this.canUndo)DEXTTOP.G_CURREDITOR._iconEnable("");else if(--this.index,-1==this.index)this.canRedo=this.canUndo=!1,DEXTTOP.G_CURREDITOR._iconEnable("");else{_iframeDoc.body.innerHTML=this.arrImageHTML[this.index].htmlSource;var a=this.arrImageHTML[this.index].range,c=_iframeDoc.getElementById(a.id+a.undoId);if(c){c.id==a.undoId?removeAttribute(c,"id"):c.id=a.id;var b=getFirstRange();try{rangy.getSelection(_iframeWin).removeAllRanges(),
b.range.selectNodeContents(c),b.range.collapse(!1),rangy.getSelection(_iframeWin).setSingleRange(b.range),setMenuIconRealable(c)}catch(d){try{var e=_iframeDoc.body.childNodes,f=e.length;0<f&&(doSetCaretPosition(e[f-1],1),setMenuIconRealable(e[f-1]))}catch(g){}}}this.currentImage=new ImageHTML(_iframeDoc.body.innerHTML,a);this.canRedo=!0;0==this.index&&(this.canUndo=!1);this.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("");ClearDraggingTableAllTable()}},execRedo:function(){if(0==this.canRedo)DEXTTOP.G_CURREDITOR._iconEnable("");
else{this.index+=1;_iframeDoc.body.innerHTML=this.arrImageHTML[this.index].htmlSource;var a=this.arrImageHTML[this.index].range,c=_iframeDoc.getElementById(a.id+a.undoId);if(c){c.id==a.undoId?removeAttribute(c,"id"):c.id=a.id;var b=getFirstRange();try{rangy.getSelection(_iframeWin).removeAllRanges(),b.range.selectNodeContents(c),b.range.collapse(!1),rangy.getSelection(_iframeWin).setSingleRange(b.range),setMenuIconRealable(c)}catch(d){try{var e=_iframeDoc.body.childNodes,f=e.length;0<f&&(doSetCaretPosition(e[f-
1],1),setMenuIconRealable(e[f-1]))}catch(g){}}}this.currentImage=new ImageHTML(_iframeDoc.body.innerHTML,a);this.canUndo=!0;this.index==this.arrImageHTML.length-1&&(this.canRedo=!1);this.charCount=0;DEXTTOP.G_CURREDITOR._iconEnable("");ClearDraggingTableAllTable()}}};var resizebar_props={editor:null,editorMinTop:0,editorHegiht:0,mouseTop:0,editorMinFlag:!1,mouseClickFlag:!1,mouseClickObj:null,mouseLeftBtnFlag:!1};function DextResize(a){resizebar_props&&(resizebar_props.editor=a,resizebar_props.editorMinTop=parseInt(a._config.style.defaultMinHeight))}
DextResize.prototype.createStatusResizeBar=function(){if(resizebar_props){if(0==checkIfIncluded("editor_resize_bar.css",DEXTTOP.document)){var a=DEXTTOP.DEXTDOC.createElement("link");a.type="text/css";a.rel="stylesheet";a.href=DEXTTOP.DEXT5.isRelease?resizebar_props.editor._config.webPath.css+"editor_resize_bar.css?ver="+DEXTTOP.DEXT5.ReleaseVer:resizebar_props.editor._config.webPath.css_dev+"editor_resize_bar.css?ver="+DEXTTOP.DEXT5.ReleaseVer;DEXTTOP.DEXTDOC.getElementsByTagName("head")[0].appendChild(a)}a=
DEXTTOP.DEXTDOC.getElementById(resizebar_props.editor._config.holderID);a.className="DEXT_frame_resizebar";var c=DEXTTOP.DEXTDOC.createElement("div");c.setAttribute("id","dext_resizebar_"+resizebar_props.editor.ID);c.className="DEXT_resizebar DEXT_resizebar_"+resizebar_props.editor._config.style.skinName;c.innerHTML='<div class="DEXT_resizebar_btn" id="dext_resizebar_btn_'+resizebar_props.editor.ID+'"><div class="DEXT_resizebar_horizon_line" id="DEXT_resizebar_horizon_line_'+resizebar_props.editor.ID+
'"></div><button type="button" id="DEXT_resizebar_button_'+resizebar_props.editor.ID+'" title="'+dext5_lang.resizebar_button.title+'"></button></div>';a.appendChild(c)}};
DextResize.prototype.apply=function(a){if(resizebar_props){var c=this;DEXTTOP.DEXT5.util.addEvent(a,"mousedown",function(a){c.mouseDown(a)},!0);DEXTTOP.DEXT5.util.addEvent(a,"mousemove",function(a){c.mouseMove(a)},!0);DEXTTOP.DEXT5.util.addEvent(a,"mouseup",function(a){c.mouseUp(a)},!0);a.addEventListener&&a.addEventListener("DOMMouseScroll",function(a){c.wheel(a)},!1);DEXTTOP.DEXT5.util.addEvent(a,"mousewheel",function(a){c.wheel(a)},!0);DEXTTOP.DEXT5.util.addEvent(a,"blur",function(a){c.blur(a)},
!0)}};
DextResize.prototype.mouseDown=function(a){if(resizebar_props){a=a?a:event;var c=a.target?a.target:a.srcElement,b=this.isLeftClick(a);resizebar_props.mouseLeftBtnFlag=b;resizebar_props.mouseLeftBtnFlag&&(c&&c.id&&c.id=="dext_resizebar_"+resizebar_props.editor.ID?resizebar_props.mouseClickObj=c:c&&c.id&&c.id=="dext_resizebar_btn_"+resizebar_props.editor.ID?resizebar_props.mouseClickObj=c.parentNode:c&&c.id&&(c.id=="DEXT_resizebar_horizon_line_"+resizebar_props.editor.ID||c.id=="DEXT_resizebar_button_"+resizebar_props.editor.ID)&&
(resizebar_props.mouseClickObj=c.parentNode.parentNode));resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&(resizebar_props.editorHegiht=parseInt(DEXTTOP.DEXTDOC.getElementById(resizebar_props.editor._config.holderID).style.height.replace("px","")),resizebar_props.mouseTop=a.clientY,resizebar_props.mouseClickFlag=!0)}};
DextResize.prototype.mouseMove=function(a){if(resizebar_props&&(a=a?a:event,resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&resizebar_props.mouseClickFlag)){DEXTTOP.DEXTDOC.body.style.cursor="row-resize";if(!DEXTTOP.DEXTDOC.getElementById("dext_disabled")){var c=DEXTTOP.DEXTDOC.createElement("div");c.setAttribute("id","dext_disabled");c.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:'+
(G_MAIN_ZINDEX+1E3)+'; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';var b="CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollHeight:DEXTTOP.DEXTDOC.body.scrollHeight;c.firstChild.style.width=("CSS1Compat"==DEXTTOP.DEXTDOC.compatMode?DEXTTOP.DEXTDOC.documentElement.scrollWidth:DEXTTOP.DEXTDOC.body.scrollWidth)+"px";c.firstChild.style.height=b+"px";DEXTTOP.DEXTDOC.body.appendChild(c)}c=0;a=a.clientY;c=resizebar_props.editorHegiht+
(a-resizebar_props.mouseTop);c=Math.max(resizebar_props.editorMinTop,c);resizebar_props.editorMinFlag=c==resizebar_props.editorMinTop?!0:!1;resizebar_props.editorMinFlag||(this.setHeight(c),resizebar_props.editorHegiht=c,resizebar_props.mouseTop=a)}};
DextResize.prototype.mouseUp=function(a){if(resizebar_props)if(a=a?a:event,DEXTTOP.DEXTDOC.body.style.cursor="",resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)){var c=0,c=resizebar_props.editorHegiht+(a.clientY-resizebar_props.mouseTop),c=Math.max(resizebar_props.editorMinTop,c);resizebar_props.editorMinFlag=c==resizebar_props.editorMinTop?!0:!1;resizebar_props.editorMinFlag||this.setHeight(c);resizebar_props.editorHegiht=
0;resizebar_props.mouseTop=0;resizebar_props.editorMinFlag=!1;resizebar_props.mouseClickFlag=!1;resizebar_props.mouseClickObj=null;resizebar_props.mouseLeftBtnFlag=!1;DEXTTOP.DEXTDOC.getElementById("dext_disabled")&&(a=DEXTTOP.DEXTDOC.getElementById("dext_disabled"),DEXTTOP.DEXTDOC.body.removeChild(a));try{DEXTTOP.DEXTWIN.dext_editor_resized_event(DEXTTOP.G_CURREDITOR.Frame)}catch(b){}}else resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&
(resizebar_props.editorHegiht=0,resizebar_props.mouseTop=0,resizebar_props.editorMinFlag=!1,resizebar_props.mouseClickFlag=!1,resizebar_props.mouseClickObj=null,resizebar_props.mouseLeftBtnFlag=!1,DEXTTOP.DEXTDOC.getElementById("dext_disabled")&&(a=DEXTTOP.DEXTDOC.getElementById("dext_disabled"),DEXTTOP.DEXTDOC.body.removeChild(a)))};
DextResize.prototype.wheel=function(a){if(resizebar_props&&(a=a?a:event,resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)))return a.returnValue=!1,a.preventDefault&&a.preventDefault(),!1};
DextResize.prototype.blur=function(a){resizebar_props&&resizebar_props.mouseLeftBtnFlag&&resizebar_props.mouseClickObj==DEXTTOP.DEXTDOC.getElementById("dext_resizebar_"+resizebar_props.editor.ID)&&DEXTTOP.DEXTDOC.getElementById("dext_disabled")&&(a=DEXTTOP.DEXTDOC.getElementById("dext_disabled"),DEXTTOP.DEXTDOC.body.removeChild(a))};
DextResize.prototype.setHeight=function(a){var c=resizebar_props.editor.ID,b=_setDEXT5editor(c);if(void 0==c||""==c)c=b.ID;var d=DEXTTOP.DEXTDOC.getElementById("dext_frame_holder"+c),c=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+c).contentWindow.document.getElementById("ue_editor_holder_"+c),e=0,e=b.baseMenuToolbarHeight;isViewMode(b)?b._defaultHeight=parseInt(a,10)-4:b._defaultHeight=parseInt(a,10)-e;-1<a.toString().indexOf("%")||-1<a.toString().indexOf("px")?d.style.height=a:d.style.height=a+"px";
c.style.height=b._defaultHeight+"px";b._config.style.height=a+"px";"1"==resizebar_props.editor._config.ruler.view&&"design"==resizebar_props.editor._currentMode&&b._FRAMEWIN.showRuler(resizebar_props.editor)};DextResize.prototype.isLeftClick=function(a){var c=!1;a=a||window.event;a.which||void 0===a.button||(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);switch(a.which){case 1:c=!0;break;case 2:c=!1;break;case 3:c=!1;break;case 0:0==a.button&&(c=!1)}return c};(function(){function a(a){var b={};a=a.split(",");for(var c=0;c<a.length;c++)b[a[c]]=!0;return b}var c=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,b=/^<\/([-A-Za-z0-9_:]+)[^>]*>/,d=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,e=/^<([-A-Za-z0-9_:]+)((?:\s+[a-zA-Z_0-9:]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,f=/([-A-Za-z0-9_:]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,
g=a("colgroup,col"),h=a("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed");a("area,base,basefont,br,col,frame,img,input,isindex,link,meta,param,embed");var m=a("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul,h1,h2,h3,h4,h5,h6"),n=a("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),
p=a("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),q=a("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),u=a("");DEXT5_EDITOR.HTMLParser=function(a,g,w){function x(a,b,e,g){b=b.toLowerCase();if(m[b])for("p"!=D.last()||"table"!=b&&"hr"!=b&&"center"!=b||y("","p"),"table"!=D.last()&&"tbody"!=D.last()||"td"!=b||x("","tr","","");D.last()&&n[D.last()];)y("",D.last());p[b]&&D.last()==b&&y("",b);(g=h[b]||!!g)||D.push(b);if(w.start){var t=[];a=c.test(a)?
d:f;e.replace(a,function(a,b,c,d,e){c=c?c:d?d:e?e:q[b]?b:"";d="";""!=a&&(a=a.substring(a.indexOf(b)+b.length),a=a.substring(a.indexOf("=")+1),a=a.replace(/^\s+/,""),d=a.substring(0,1),"'"!=d&&'"'!=d&&(d=""));t.push({name:b,value:c,escaped:c.replace(/(^|[^\\])"/g,'$1\\"'),quotationmark:d})});w.start&&w.start(b,t,g)}}function y(a,b){if(b)for(b=b.toLowerCase(),c=D.length-1;0<=c&&D[c]!=b;c--);else var c=0;if(0<=c){for(var d=D.length-1;d>=c;d--)w.end&&w.end(D[d]);D.length=c}}var z,C,D=[],E=a;for(D.last=
function(){return this[this.length-1]};a;){C=!0;if(D.last()&&u[D.last()])a=a.replace(new RegExp("(.*)</"+D.last()+"[^>]*>"),function(a,b){b=b.replace(/\x3c!--(.*?)--\x3e/g,"$1").replace(/<!\[CDATA\[(.*?)]]\x3e/g,"$1");w.chars&&w.chars(b);return""}),y("",D.last());else{var F=a.indexOf("<");z=a.indexOf(">")+1;var H=a.substring(F,z);if(0==a.indexOf("\x3c!--"))z=a.indexOf("--\x3e"),0<=z&&(w.comment&&w.comment(a.substring(4,z)),a=a.substring(z+3),C=!1);else if(0==a.indexOf("<?xml"))z=a.indexOf("/>"),0<=
z&&(a=a.substring(z+2),C=!1);else if(0!=a.indexOf("<")&&"</"+D.last()+">"==H.replace(/ /ig,""))C=a.substring(0,F),a=a.substring(z),a=C+"</"+D.last()+">"+a,C=!0;else if(0==a.indexOf("</")){if(z=a.match(b))a=a.substring(z[0].length),z[0].replace(b,y),C=!1}else if(0==a.indexOf("<"))if(z=a.match(c))a=a.substring(z[0].length),z[0].replace(c,x),C=!1;else if(z=a.match(e))a=a.substring(z[0].length),z[0].replace(e,x),C=!1;C&&(z=a.indexOf("<"),C=0>z?a:a.substring(0,z),a=0>z?"":a.substring(z),w.chars&&(D.last()&&
n[D.last()]&&"textarea"!=D.last()&&(z=!1,F=RegExp("\\S\\n","g"),F.test(C)&&(z=!0),F=RegExp("\\n\\S","g"),F.test(C)&&(z=!0),F=RegExp("\\S\\n\\S","g"),F.test(C)&&(z=!0),z?C=C.replace(/\n/g," "):(F=RegExp("\\n\\n","g"),F.test(C)&&""==C.trim()?C=C.replace(/\n\n/g,""):C==unescape("%20%20")&&(z=new RegExp(unescape("%20"),"g"),C=C.replace(z,"&nbsp;")))),g&&(z=new RegExp(unescape("%20%20"),"g"),C=C.replace(z,"&nbsp; ")),w.chars(C)))}if(a==E)throw"Parse Error: "+a;E=a}y()};DEXT5_EDITOR.HTMLParser.HTMLtoXML=
function(a,b){var c="";DEXT5_EDITOR.HTMLParser(a,b,{start:function(a,b,d){c+="<"+a;for(a=0;a<b.length;a++)c=""!=b[a].quotationmark?c+(" "+b[a].name+"="+b[a].quotationmark+b[a].value+b[a].quotationmark):c+(" "+b[a].name+'="'+b[a].escaped+'"');c+=(d?"/":"")+">"},end:function(a){g[a]||(c+="</"+a+">")},chars:function(a){c+=a},comment:function(a){c="0"==DEXTTOP.G_CURREDITOR._config.removeComment?c+("\x3c!--"+a+"--\x3e"):c+""}});return c};DEXT5_EDITOR.HTMLParser.RemoveOfficeTag=function(a,b){if(""==a||
void 0==a)return"";reg_exp=RegExp("<o:p></o:p>","gi");a=a.replace(reg_exp,"");reg_exp=RegExp("<o:p>\\s+</o:p>","gi");a=a.replace(reg_exp,"");reg_exp=RegExp("<o:p ([^>]+)></o:p>","gi");a=a.replace(reg_exp,"");reg_exp=RegExp("<o:p ([^>]+)>\\s+</o:p>","gi");a=a.replace(reg_exp,"");a=a.replace(/\slang=[\"]?en-us[\"]?/gi,"");a=a.replace(/\sclass=[\"]?(mso)\w+[\"]?/gi,"");reg_exp=RegExp('mso-[^:]+:[^;">]+;',"gi");a=a.replace(reg_exp,"");reg_exp=RegExp('mso-[^:]+:[^;">]+("|\')',"gi");a=a.replace(reg_exp,
"$1");reg_exp=RegExp("<v:shapetype ([^>]+)>[\\s\\S]*?</v:shapetype>","gi");a=a.replace(reg_exp,"");reg_exp=RegExp("<v:shape ([^>]+)>[\\s\\S]*?</v:shape>","gi");a=a.replace(reg_exp,"");a=DEXTTOP.DEXT5.util.replaceOneSpaceToNbsp(a);b&&(a=a.replace(/>\s+</g,"><"));return a};DEXT5_EDITOR.HTMLParser.makeMap=function(b){return a(b)}})();var g_d5selectedCName="DEXT_selected_basic",g_d5selectedFocusCName="DEXT_selected_nofocus";
function setFormControlSelected(a){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var c=["INPUT","TEXTAREA","SELECT","BUTTON"],b=c.length,d=!1;if(a&&1==a.nodeType)for(var e=0;e<b;e++)if(a.tagName==c[e]){d=!0;break}if(0==d)clearAllFormControlSelected();else{rangy.getSelection(_iframeWin).removeAllRanges();for(var f=[],g=_iframeDoc.body,e=0;e<b;e++)for(var h=g.getElementsByTagName(c[e]),m=h.length,n=0;n<m;n++)h[n].className!=g_d5selectedCName&&h[n].className!=g_d5selectedFocusCName||a==h[n]||f.push(h[n]);
if(d)if(a.className==g_d5selectedCName)d5RemoveSelectedClassName(a,g_d5selectedCName);else if(a.className==g_d5selectedFocusCName)d5RemoveSelectedClassName(a,g_d5selectedFocusCName),0<f.length&&(f[0].className=g_d5selectedFocusCName);else for(d5AddSelectedClassName(a,g_d5selectedFocusCName),a=f.length,e=0;e<a;e++)d5RemoveSelectedClassName(f[e],g_d5selectedFocusCName),d5AddSelectedClassName(f[e],g_d5selectedCName)}}}
function getFormControlSelectedItem(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){for(var a={count:0,arrNodes:[]},c=["INPUT","TEXTAREA","SELECT","BUTTON"],b=c.length,d=_iframeDoc.body,e=0;e<b;e++)for(var f=d.getElementsByTagName(c[e]),g=f.length,h=0;h<g;h++)if(f[h].className==g_d5selectedCName||f[h].className==g_d5selectedFocusCName)a.count+=1,a.arrNodes.push(f[h]);return a}}
function clearAllFormControlSelected(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode)for(var a=["INPUT","TEXTAREA","SELECT","BUTTON"],c=a.length,b=_iframeDoc.body,d=0;d<c;d++)for(var e=b.getElementsByTagName(a[d]),f=e.length,g=0;g<f;g++)if(e[g].className==g_d5selectedCName||e[g].className==g_d5selectedFocusCName)d5RemoveSelectedClassName(e[g],g_d5selectedCName),d5RemoveSelectedClassName(e[g],g_d5selectedFocusCName)}
function d5AddSelectedClassName(a,c){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var b=a.className,d="";if(0<b.length){for(var b=b.split(" "),e=b.length,f=0;f<e;f++)c!=b[f]&&(d+=b[f]+" ");d+=c}else d=c;a.className=d}}function d5RemoveSelectedClassName(a,c){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var b=a.className,d="";if(0<b.length)for(var b=b.split(" "),e=b.length,f=0;f<e;f++)b[f]!=c&&(d=f<e-1?d+(b[f]+" "):d+b[f]);else d="";a.className=d}}
function d5ApplyAlignLeft(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var a=getFormControlSelectedItem();if(!(1>=a.count)){for(var c=null,b=0;b<a.count;b++)if(a.arrNodes[b].className==g_d5selectedFocusCName){c=a.arrNodes[b];break}if(c)for(b=0;b<a.count;b++)a.arrNodes[b]!=c&&(a.arrNodes[b].style.left=getClientRect(c).left+"px")}}}
function d5ApplySameWidth(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var a=getFormControlSelectedItem();if(!(1>=a.count)){for(var c=null,b=0;b<a.count;b++)if(a.arrNodes[b].className==g_d5selectedFocusCName){c=a.arrNodes[b];break}if(c)for(c=""==c.style.width?getClientRect(c).right-getClientRect(c).left+"px":c.style.width,b=0;b<a.count;b++)a.arrNodes[b].style.width=c}}}
function d5ApplySameHeight(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var a=getFormControlSelectedItem();if(!(1>=a.count)){for(var c=null,b=0;b<a.count;b++)if(a.arrNodes[b].className==g_d5selectedFocusCName){c=a.arrNodes[b];break}if(c)for(c=""==c.style.height?getClientRect(c).bottom-getClientRect(c).top+"px":c.style.height,b=0;b<a.count;b++)a.arrNodes[b].style.height=c}}}
function d5ApplySameWidthHeight(){if("1"==DEXTTOP.G_CURREDITOR._config.formMode){var a=getFormControlSelectedItem();if(!(1>=a.count)){for(var c=null,b=0;b<a.count;b++)if(a.arrNodes[b].className==g_d5selectedFocusCName){c=a.arrNodes[b];break}if(c)for(var d=""==c.style.width?getClientRect(c).right-getClientRect(c).left+"px":c.style.width,c=""==c.style.height?getClientRect(c).bottom-getClientRect(c).top+"px":c.style.height,b=0;b<a.count;b++)a.arrNodes[b].style.width=d,a.arrNodes[b].style.height=c}}}
;function DextDragResize(){var a={resizeName:"DEXT_fiVe_drag_resize",handles:"tl tm tr ml mr bl bm br".split(" "),isElement:null,isHandle:null,element:null,handle:null,minWidth:0,minHeight:0,minLeft:0,maxLeft:9999,minTop:0,maxTop:9999,zIndex:1,mouseX:0,mouseY:0,lastMouseX:0,lastMouseY:0,iframeDocLastMouseX:0,iframeDocLastMouseY:0,topMouseX:null,topMouseY:null,docMouseX:null,docMouseY:null,docLastMouseX:0,docLastMouseY:0,mOffX:0,mOffY:0,elmX:0,elmY:0,elmW:0,elmH:0,allowBlur:!0,childElement:null,keyDownEvt:null,
keyUpEvt:null,selectable:!1},c;for(c in a)this[c]=a[c]}DextDragResize.prototype.selection=function(a){var c=getFirstRange(),b=c.range;c.sel.removeAllRanges();b.selectNode(a);c.sel.addRange(b)};
DextDragResize.prototype.apply=function(a){var c=this;DEXTTOP.DEXT5.util.addEvent(a,"mousedown",function(a){c.mouseDown(a)},!0);DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTDOC,"mousemove",function(a){c.mouseMove(a,"top")},!0);DEXTTOP.DEXT5.util.addEvent(document,"mousemove",function(a){c.mouseMove(a,"doc")},!0);DEXTTOP.DEXT5.util.addEvent(a,"mousemove",function(a){c.mouseMove(a,!1)},!0);DEXTTOP.DEXT5.util.addEvent(DEXTTOP.DEXTDOC,"mouseup",function(a){c.mouseUp(a)},!0);DEXTTOP.DEXT5.util.addEvent(document,
"mouseup",function(a){c.mouseUp(a)},!0);DEXTTOP.DEXT5.util.addEvent(a,"mouseup",function(a){c.mouseUp(a)},!0);c.keyDownEvt=function(a){c.keyDown(a)};c.keyUpEvt=function(a){c.keyUp(a)}};
DextDragResize.prototype.select=function(a){with(this)a&&a!=element&&(element=a,element.style.zIndex=++zIndex,this.resizeHandleSet&&this.resizeHandleSet(element,!0),elmX=parseInt(element.firstChild.style.left),elmY=parseInt(element.firstChild.style.top),elmW=element.firstChild.offsetWidth,elmH=element.firstChild.offsetHeight,childElement=element.firstChild,doSetCaretPosition(childElement,0)),childElement&&doSetCaretPosition(childElement,0)};
DextDragResize.prototype.keyUp=function(a){with(this){if(!element||!childElement)return;for(var c=element.childNodes,b=c.length-1;0<=b;b--)3==c[b].nodeType&&element.removeChild(c[b]);selectable&&(getFirstRange().sel.removeAllRanges(),mouseDown(a))}};
DextDragResize.prototype.keyDown=function(a){if(this.element&&this.childElement){var c=a.ctrlKey,b="which"in a?a.which:a.keyCode;with(this)c&&86==b||c&&65==b||c&&88==b||46==b||8==b||9==b?(element.parentNode.replaceChild(childElement,element),selection(childElement),resizeHandleClear()):c&&67==b?(selectable=!0,selection(childElement)):DEXTTOP.DEXT5.browser.ie&&11<=DEXTTOP.DEXT5.browser.ieVersion&&!c?37!=b&&39!=b&&38!=b&&40!=b&&(resizeHandleClear(),setFocusToBody()):DEXTTOP.DEXT5.util.cancelEvent(a)}};
DextDragResize.prototype.deselect=function(a){with(this)a&&(this.resizeHandleSet&&this.resizeHandleSet(element,!1),childElement=element=null),element&&(element.dext_resizeinfo.style.display="none",element.dext_resizeinfo.innerHTML=""),handle=null,mOffY=mOffX=0};
DextDragResize.prototype.mouseDown=function(a){with(this){var c=a.target||a.srcElement,b=null,d=null,e=new RegExp(resizeName+"-([trmbl]{2})","");selectable&&(selectable=!1,c=element);if(isRightClick(a)&&"img"==c.tagName.toLowerCase()){this.resizeHandleClear();selection(c);return}setFocusToBody();if(c&&"img"==c.tagName.toLowerCase()&&(!element||c!=childElement)){var f=_iframeDoc.createElement("span");f.style.margin="0px";f.style.padding="0px";f.className="DEXT_fiVe_drag_resize_Element DEXT_fiVe_drag_move_Handle";
f.contentEditable=!1;f.innerHTML=c.outerHTML;c.parentNode.replaceChild(f,c);c=f;DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keydown",this.keyDownEvt,!0);DEXTTOP.DEXT5.util.addEvent(_iframeDoc,"keyup",this.keyUpEvt,!0)}this.isElement=function(a){if(a.className&&-1<a.className.indexOf("DEXT_fiVe_drag_resize_Element"))return!0};for(this.isHandle=function(a){if(a.className&&-1<a.className.indexOf("DEXT_fiVe_drag_move_Handle"))return!0};c;){if(c.className&&(d||!e.test(c.className)&&!this.isHandle(c)||(d=c),
this.isElement(c))){b=c;break}c=c.parentNode}element&&element!=b&&allowBlur&&deselect(!0);!b||element&&b!=element||(d&&DEXTTOP.DEXT5.util.cancelEvent(a),select(b,d),handle=d)}};
DextDragResize.prototype.mouseMove=function(a,c){with(this){mouseX=a.pageX||a.clientX+document.documentElement.scrollLeft;mouseY=a.pageY||a.clientY+document.documentElement.scrollTop;handle&&"top"==c?(topMouseX||(topMouseX=mouseX,topMouseY=mouseY,docMouseY=docMouseX=null),0==docLastMouseX&&(docLastMouseX=lastMouseX),0==docLastMouseY&&(docLastMouseY=lastMouseY),mouseX=docLastMouseX+(mouseX-topMouseX),mouseY=docLastMouseY+(mouseY-topMouseY),iframeDocLastMouseX=mouseX,iframeDocLastMouseY=mouseY):handle&&
"doc"==c?(docMouseX||(docMouseX=mouseX,docMouseY=mouseY,topMouseY=topMouseX=null),mouseX=iframeDocLastMouseX+(mouseX-docMouseX),mouseY=iframeDocLastMouseY+(mouseY-docMouseY),docLastMouseX=mouseX,docLastMouseY=mouseY):(docMouseY=docMouseX=topMouseY=topMouseX=null,docLastMouseY=docLastMouseX=0);var b=mouseX-lastMouseX+mOffX,d=mouseY-lastMouseY+mOffY;mOffX=mOffY=0;lastMouseX=mouseX;lastMouseY=mouseY;!c&&handle&&(iframeDocLastMouseX=mouseX,iframeDocLastMouseY=mouseY);if(!handle)return!0;var e=!1;if(this.resizeHandleDrag&&
this.resizeHandleDrag(b,d))e=!0;else{var f=b,g=d;elmX+f<minLeft?mOffX=f-(b=minLeft-elmX):elmX+elmW+f>maxLeft&&(mOffX=f-(b=maxLeft-elmX-elmW));elmY+g<minTop?mOffY=g-(d=minTop-elmY):elmY+elmH+g>maxTop&&(mOffY=g-(d=maxTop-elmY-elmH));elmX+=b;elmY+=d}element&&(isNaN(elmX)||(element.style.left=parseInt(elmX,10)+"px"),isNaN(elmW)||(element.style.width=parseInt(elmW,10)+"px"),isNaN(elmY)||(element.style.top=parseInt(elmY,10)+"px"),isNaN(elmH)||(element.style.height=parseInt(elmH,10)+"px"));childElement&&
1==childElement.nodeType&&"img"==childElement.tagName.toLowerCase()&&e&&(childElement.style.width=parseInt(elmW,10)+"px",childElement.style.height=parseInt(elmH,10)+"px",element.dext_resizeinfo.style.display="",element.dext_resizeinfo.style.zIndex=zIndex+1,element.dext_resizeinfo.style.top=handle.offsetTop+"px",element.dext_resizeinfo.style.left=handle.offsetLeft+"px",element.dext_resizeinfo.firstChild&&element.dext_resizeinfo.removeChild(element.dext_resizeinfo.firstChild),b=document.createElement("span"),
b.innerHTML=parseInt(elmW,10)+" X "+parseInt(elmH,10),element.dext_resizeinfo.appendChild(b));DEXTTOP.DEXT5.util.cancelEvent(a)}};DextDragResize.prototype.mouseUp=function(a){if(!isRightClick(a))with(this)deselect(!1),docMouseY=docMouseX=topMouseY=topMouseX=null};
DextDragResize.prototype.resizeHandleSet=function(a,c){with(this){if(c&&!a._handle_tr){for(var b=0;b<handles.length;b++){var d=document.createElement("div");d.className=resizeName+" "+resizeName+"-"+handles[b];d.unSelectable=!0;a["_handle_"+handles[b]]=a.appendChild(d)}d=document.createElement("div");d.className="DEXT_fiVe_drag_resizeinfo";d.style.position="absolute";d.style.fontSize="11px";d.style.display="none";d.unSelectable=!0;b=document.createElement("span");d.appendChild(b);a.appendChild(d);
a.dext_resizeinfo=d}c||this.resizeHandleClear()}};DextDragResize.prototype.resizeHandleClear=function(){if(this.element){try{this.element.parentNode.replaceChild(this.childElement,this.element)}catch(a){}finally{this.childElement=this.element=null}DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"keydown",this.keyDownEvt);DEXTTOP.DEXT5.util.removeEvent(_iframeDoc,"keyup",this.keyUpEvt)}};
DextDragResize.prototype.resizeHandleDrag=function(a,c){with(this){var b=handle&&handle.className&&handle.className.match(new RegExp(resizeName+"-([tmblr]{2})"))?RegExp.$1:"",d=c,e=a,f=!1;0<=b.indexOf("t")&&(rs=1,elmH-d<minHeight?mOffY=d-(c=elmH-minHeight):elmY+d<minTop&&(mOffY=d-(c=minTop-elmY)),elmY+=c,elmH-=c,f=!0);0<=b.indexOf("b")&&(rs=1,elmH+d<minHeight?mOffY=d-(c=minHeight-elmH):elmY+elmH+d>maxTop&&(mOffY=d-(c=maxTop-elmY-elmH)),elmH+=c,f=!0);0<=b.indexOf("l")&&(rs=1,elmW-e<minWidth?mOffX=
e-(a=elmW-minWidth):elmX+e<minLeft&&(mOffX=e-(a=minLeft-elmX)),elmX+=a,elmW-=a,f=!0);0<=b.indexOf("r")&&(rs=1,elmW+e<minWidth?mOffX=e-(a=minWidth-elmW):elmX+elmW+e>maxLeft&&(mOffX=e-(a=maxLeft-elmX-elmW)),elmW+=a,f=!0);return f}};

var rangy; rangy = rangy || function () { function h(c, d) { var e = typeof c[d]; return e == b || e == a && !!c[d] || e == "unknown" } function i(b, c) { return typeof b[c] == a && !!b[c] } function j(a, b) { return typeof a[b] != c } function k(a) { return function (b, c) { var d = c.length; while (d--) if (!a(b, c[d])) return !1; return !0 } } function o(a) { return a && l(a, g) && n(a, f) } function p(a) { return i(a, "body") ? a.body : a.getElementsByTagName("body")[0] } function s(a) { i(window, "console") && h(window.console, "log") && window.console.log(a) } function t(a, b) { b ? window.alert(a) : s(a) } function u(a) { r.initialized = !0, r.supported = !1, t("Rangy is not supported on this page in your browser. Reason: " + a, r.config.alertOnFail) } function v(a) { t("Rangy warning: " + a, r.config.alertOnWarn) } function y(a) { return a.message || a.description || String(a) } function z() { if (r.initialized) return; var a, b = !1, c = !1; h(document, "createRange") && (a = document.createRange(), l(a, e) && n(a, d) && (b = !0), a.detach()); var f = p(document); if (!f || f.nodeName.toLowerCase() != "body") { u("No body element found"); return } f && h(f, "createTextRange") && (a = f.createTextRange(), o(a) && (c = !0)); if (!b && !c) { u("Neither Range nor TextRange are available"); return } r.initialized = !0, r.features = { implementsDomRange: b, implementsTextRange: c }; var g, i; for (var j in q) (g = q[j]) instanceof C && g.init(); for (var k = 0, m = x.length; k < m; ++k) try { x[k](r) } catch (t) { i = "Rangy init listener threw an exception. Continuing. Detail: " + y(t), s(i) } } function B(a) { a = a || window, z(); for (var b = 0, c = A.length; b < c; ++b) A[b](a) } function C(a, b) { this.name = a, this.initialized = !1, this.supported = !1, this.init = b } var a = "object", b = "function", c = "undefined", d = ["startContainer", "startOffset", "endContainer", "endOffset", "collapsed", "commonAncestorContainer"], e = ["setStart", "setStartBefore", "setStartAfter", "setEnd", "setEndBefore", "setEndAfter", "collapse", "selectNode", "selectNodeContents", "compareBoundaryPoints", "deleteContents", "extractContents", "cloneContents", "insertNode", "surroundContents", "cloneRange", "toString", "detach"], f = ["boundingHeight", "boundingLeft", "boundingTop", "boundingWidth", "htmlText", "text"], g = ["collapse", "compareEndPoints", "duplicate", "moveToElementText", "parentElement", "select", "setEndPoint", "getBoundingClientRect"], l = k(h), m = k(i), n = k(j), q = {}, r = { version: "1.3alpha.772", initialized: !1, supported: !0, util: { isHostMethod: h, isHostObject: i, isHostProperty: j, areHostMethods: l, areHostObjects: m, areHostProperties: n, isTextRange: o, getBody: p }, features: {}, modules: q, config: { alertOnFail: !0, alertOnWarn: !1, preferTextRange: !1 } }; r.fail = u, r.warn = v, {}.hasOwnProperty ? r.util.extend = function (a, b, c) { var d, e; for (var f in b) b.hasOwnProperty(f) && (d = a[f], e = b[f], c && d !== null && typeof d == "object" && e !== null && typeof e == "object" && r.util.extend(d, e, !0), a[f] = e); return a } : u("hasOwnProperty not supported"), function () { var a = document.createElement("div"); a.appendChild(document.createElement("span")); var b = [].slice, c; try { b.call(a.childNodes, 0)[0].nodeType == 1 && (c = function (a) { return b.call(a, 0) }) } catch (d) { } c || (c = function (a) { var b = []; for (var c = 0, d = a.length; c < d; ++c) b[c] = a[c]; return b }), r.util.toArray = c }(); var w; h(document, "addEventListener") ? w = function (a, b, c) { a.addEventListener(b, c, !1) } : h(document, "attachEvent") ? w = function (a, b, c) { a.attachEvent("on" + b, c) } : u("Document does not have required addEventListener or attachEvent method"), r.util.addListener = w; var x = []; r.init = z, r.addInitListener = function (a) { r.initialized ? a(r) : x.push(a) }; var A = []; r.addCreateMissingNativeApiListener = function (a) { A.push(a) }, r.createMissingNativeApi = B, C.prototype = { fail: function (a) { throw this.initialized = !0, this.supported = !1, new Error("Module '" + this.name + "' failed to load: " + a) }, warn: function (a) { r.warn("Module " + this.name + ": " + a) }, deprecationNotice: function (a, b) { r.warn("DEPRECATED: " + a + " in module " + this.name + "is deprecated. Please use " + b + " instead") }, createError: function (a) { return new Error("Error in Rangy " + this.name + " module: " + a) } }, r.createModule = function (a, b) { var c = new C(a, function () { if (!c.initialized) { c.initialized = !0; try { b(r, c), c.supported = !0 } catch (d) { var e = "Module '" + a + "' failed to load: " + y(d); s(e) } } }); q[a] = c }, r.requireModules = function (a) { for (var b = 0, c = a.length, d, e; b < c; ++b) { e = a[b], d = q[e]; if (!d || !(d instanceof C)) throw new Error("required module '" + e + "' not found"); d.init(); if (!d.supported) throw new Error("required module '" + e + "' not supported") } }; var D = !1, E = function (a) { D || (D = !0, r.initialized || z()) }; if (typeof window == c) { u("No window found"); return } if (typeof document == c) { u("No document found"); return } return h(document, "addEventListener") && document.addEventListener("DOMContentLoaded", E, !1), w(window, "load", E), r }(), rangy.createModule("DomUtil", function (a, b) { function h(a) { var b; return typeof a.namespaceURI == c || (b = a.namespaceURI) === null || b == "http://www.w3.org/1999/xhtml" } function i(a) { var b = a.parentNode; return b.nodeType == 1 ? b : null } function j(a) { var b = 0; while (a = a.previousSibling)++b; return b } function k(a) { switch (a.nodeType) { case 7: case 10: return 0; case 3: case 8: return a.length; default: return a.childNodes.length } } function l(a, b) { var c = [], d; for (d = a; d; d = d.parentNode) c.push(d); for (d = b; d; d = d.parentNode) if (g(c, d)) return d; return null } function m(a, b, c) { var d = c ? b : b.parentNode; while (d) { if (d === a) return !0; d = d.parentNode } return !1 } function n(a, b) { return m(a, b, !0) } function o(a, b, c) { var d, e = c ? a : a.parentNode; while (e) { d = e.parentNode; if (d === b) return e; e = d } return null } function p(a) { var b = a.nodeType; return b == 3 || b == 4 || b == 8 } function q(a) { if (!a) return !1; var b = a.nodeType; return b == 3 || b == 8 } function r(a, b) { var c = b.nextSibling, d = b.parentNode; return c ? d.insertBefore(a, c) : d.appendChild(a), a } function s(a, b, c) { var d = a.cloneNode(!1); d.deleteData(0, b), a.deleteData(b, a.length - b), r(d, a); if (c) for (var e = 0, f; f = c[e++];) f.node == a && f.offset > b ? (f.node = d, f.offset -= b) : f.node == a.parentNode && f.offset > j(a) && ++f.offset; return d } function t(a) { if (a.nodeType == 9) return a; if (typeof a.ownerDocument != c) return a.ownerDocument; if (typeof a.document != c) return a.document; if (a.parentNode) return t(a.parentNode); throw b.createError("getDocument: no document found for node") } function u(a) { var d = t(a); if (typeof d.defaultView != c) return d.defaultView; if (typeof d.parentWindow != c) return d.parentWindow; throw b.createError("Cannot get a window object for node") } function v(a) { if (typeof a.contentDocument != c) return a.contentDocument; if (typeof a.contentWindow != c) return a.contentWindow.document; throw b.createError("getIframeDocument: No Document object found for iframe element") } function w(a) { if (typeof a.contentWindow != c) return a.contentWindow; if (typeof a.contentDocument != c) return a.contentDocument.defaultView; throw b.createError("getIframeWindow: No Window object found for iframe element") } function x(a) { return a && d.isHostMethod(a, "setTimeout") && d.isHostObject(a, "document") } function y(a, b, c) { var e; a ? d.isHostProperty(a, "nodeType") ? e = a.nodeType == 1 && a.tagName.toLowerCase() == "iframe" ? v(a) : t(a) : x(a) && (e = a.document) : e = document; if (!e) throw b.createError(c + "(): Parameter must be a Window object or DOM node"); return e } function z(a) { var b; while (b = a.parentNode) a = b; return a } function A(a, c, d, e) { var f, g, h, i, k; if (a == d) return c === e ? 0 : c < e ? -1 : 1; if (f = o(d, a, !0)) return c <= j(f) ? -1 : 1; if (f = o(a, d, !0)) return j(f) < e ? -1 : 1; g = l(a, d), h = a === g ? g : o(a, g, !0), i = d === g ? g : o(d, g, !0); if (h === i) throw b.createError("comparePoints got to case 4 and childA and childB are the same!"); k = g.firstChild; while (k) { if (k === h) return -1; if (k === i) return 1; k = k.nextSibling } } function C(a) { try { return a.parentNode, !1 } catch (b) { return !0 } } function D(a) { if (!a) return "[No node]"; if (B && C(a)) return "[Broken node]"; if (p(a)) return '"' + a.data + '"'; if (a.nodeType == 1) { var b = a.id ? ' id="' + a.id + '"' : ""; return "<" + a.nodeName + b + ">[" + a.childNodes.length + "][" + a.innerHTML.slice(0, 20) + "]" } return a.nodeName } function E(a) { var b = t(a).createDocumentFragment(), c; while (c = a.firstChild) b.appendChild(c); return b } function G(a) { this.root = a, this._next = a } function H(a) { return new G(a) } function I(a, b) { this.node = a, this.offset = b } function J(a) { this.code = this[a], this.codeName = a, this.message = "DOMException: " + this.codeName } var c = "undefined", d = a.util; d.areHostMethods(document, ["createDocumentFragment", "createElement", "createTextNode"]) || b.fail("document missing a Node creation method"), d.isHostMethod(document, "getElementsByTagName") || b.fail("document missing getElementsByTagName method"); var e = document.createElement("div"); d.areHostMethods(e, ["insertBefore", "appendChild", "cloneNode"] || !d.areHostObjects(e, ["previousSibling", "nextSibling", "childNodes", "parentNode"])) || b.fail("Incomplete Element implementation"), d.isHostProperty(e, "innerHTML") || b.fail("Element is missing innerHTML property"); var f = document.createTextNode("test"); d.areHostMethods(f, ["splitText", "deleteData", "insertData", "appendData", "cloneNode"] || !d.areHostObjects(e, ["previousSibling", "nextSibling", "childNodes", "parentNode"]) || !d.areHostProperties(f, ["data"])) || b.fail("Incomplete Text Node implementation"); var g = function (a, b) { var c = a.length; while (c--) if (a[c] === b) return !0; return !1 }, B = !1; (function () { var b = document.createElement("b"); b.innerHTML = "1"; var c = b.firstChild; b.innerHTML = "<br>", B = C(c), a.features.crashyTextNodes = B })(); var F; typeof window.getComputedStyle != c ? F = function (a, b) { return u(a).getComputedStyle(a, null)[b] } : typeof document.documentElement.currentStyle != c ? F = function (a, b) { return a.currentStyle[b] } : b.fail("No means of obtaining computed style properties found"), G.prototype = { _current: null, hasNext: function () { return !!this._next }, next: function () { var a = this._current = this._next, b, c; if (this._current) { b = a.firstChild; if (b) this._next = b; else { c = null; while (a !== this.root && !(c = a.nextSibling)) a = a.parentNode; this._next = c } } return this._current }, detach: function () { this._current = this._next = this.root = null } }, I.prototype = { equals: function (a) { return !!a && this.node === a.node && this.offset == a.offset }, inspect: function () { return "[DomPosition(" + D(this.node) + ":" + this.offset + ")]" }, toString: function () { return this.inspect() } }, J.prototype = { INDEX_SIZE_ERR: 1, HIERARCHY_REQUEST_ERR: 3, WRONG_DOCUMENT_ERR: 4, NO_MODIFICATION_ALLOWED_ERR: 7, NOT_FOUND_ERR: 8, NOT_SUPPORTED_ERR: 9, INVALID_STATE_ERR: 11 }, J.prototype.toString = function () { return this.message }, a.dom = { arrayContains: g, isHtmlNamespace: h, parentElement: i, getNodeIndex: j, getNodeLength: k, getCommonAncestor: l, isAncestorOf: m, isOrIsAncestorOf: n, getClosestAncestorIn: o, isCharacterDataNode: p, isTextOrCommentNode: q, insertAfter: r, splitDataNode: s, getDocument: t, getWindow: u, getIframeWindow: w, getIframeDocument: v, getBody: d.getBody, isWindow: x, getContentDocument: y, getRootContainer: z, comparePoints: A, isBrokenNode: C, inspectNode: D, getComputedStyleProperty: F, fragmentFromNodeChildren: E, createIterator: H, DomPosition: I }, a.DOMException = J }), rangy.createModule("DomRange", function (a, b) { function r(a, b) { return a.nodeType != 3 && (i(a, b.startContainer) || i(a, b.endContainer)) } function s(a) { return a.document || j(a.startContainer) } function t(a) { return new e(a.parentNode, h(a)) } function u(a) { return new e(a.parentNode, h(a) + 1) } function v(a, b, d) { var e = a.nodeType == 11 ? a.firstChild : a; return g(b) ? d == b.length ? c.insertAfter(a, b) : b.parentNode.insertBefore(a, d == 0 ? b : l(b, d)) : d >= b.childNodes.length ? b.appendChild(a) : b.insertBefore(a, b.childNodes[d]), e } function w(a, b, c) { Y(a), Y(b); var d = k(a.startContainer, a.startOffset, b.endContainer, b.endOffset), e = k(a.endContainer, a.endOffset, b.startContainer, b.startOffset); return c ? d <= 0 && e >= 0 : d < 0 && e > 0 } function x(a) { var b; for (var c, d = s(a.range).createDocumentFragment(), e; c = a.next() ;) { b = a.isPartiallySelectedSubtree(), c = c.cloneNode(!b), b && (e = a.getSubtreeIterator(), c.appendChild(x(e)), e.detach(!0)); d.appendChild(c) } return d } function y(a, b, d) { var e, f; d = d || { stop: !1 }; for (var g, h; g = a.next() ;) if (a.isPartiallySelectedSubtree()) { if (b(g) === !1) { d.stop = !0; return } h = a.getSubtreeIterator(), y(h, b, d), h.detach(!0); if (d.stop) return } else { e = c.createIterator(g); while (f = e.next()) if (b(f) === !1) { d.stop = !0; return } } } function z(a) { var b; while (a.next()) a.isPartiallySelectedSubtree() ? (b = a.getSubtreeIterator(), z(b), b.detach(!0)) : a.remove() } function A(a) { for (var b, c = s(a.range).createDocumentFragment(), d; b = a.next() ;) { a.isPartiallySelectedSubtree() ? (b = b.cloneNode(!1), d = a.getSubtreeIterator(), b.appendChild(A(d)), d.detach(!0)) : a.remove(); c.appendChild(b) } return c } function B(a, b, c) { var d = !!b && !!b.length, e, f = !!c; d && (e = new RegExp("^(" + b.join("|") + ")$")); var g = []; return y(new D(a, !1), function (a) { (!d || e.test(a.nodeType)) && (!f || c(a)) && g.push(a) }), g } function C(a) { var b = typeof a.getName == "undefined" ? "Range" : a.getName(); return "[" + b + "(" + c.inspectNode(a.startContainer) + ":" + a.startOffset + ", " + c.inspectNode(a.endContainer) + ":" + a.endOffset + ")]" } function D(a, b) { this.range = a, this.clonePartiallySelectedTextNodes = b; if (!a.collapsed) { this.sc = a.startContainer, this.so = a.startOffset, this.ec = a.endContainer, this.eo = a.endOffset; var c = a.commonAncestorContainer; this.sc === this.ec && g(this.sc) ? (this.isSingleCharacterDataNode = !0, this._first = this._last = this._next = this.sc) : (this._first = this._next = this.sc === c && !g(this.sc) ? this.sc.childNodes[this.so] : m(this.sc, c, !0), this._last = this.ec === c && !g(this.ec) ? this.ec.childNodes[this.eo - 1] : m(this.ec, c, !0)) } } function E(a) { this.code = this[a], this.codeName = a, this.message = "RangeException: " + this.codeName } function K(a) { return function (b, c) { var d, e = c ? b : b.parentNode; while (e) { d = e.nodeType; if (o(a, d)) return e; e = e.parentNode } return null } } function O(a, b) { } function P(a) { } function Q(a, b) { } function R(a, b) { } function S(a, b) { } function T(a) { } function U(a, b) { } function V(a) { return q && c.isBrokenNode(a) || !o(G, a.nodeType) && !L(a, !0) } function W(a, b) { return b <= (g(a) ? a.length : a.childNodes.length) } function X(a) { return !!a.startContainer && !!a.endContainer && !V(a.startContainer) && !V(a.endContainer) && W(a.startContainer, a.startOffset) && W(a.endContainer, a.endOffset) } function Y(a) { P(a); } function bb(a, b) { Y(a); var c = a.startContainer, d = a.startOffset, e = a.endContainer, f = a.endOffset, i = c === e; g(e) && f > 0 && f < e.length && l(e, f, b), g(c) && d > 0 && d < c.length && (c = l(c, d, b), i ? (f -= d, e = c) : e == c.parentNode && f >= h(c) && f++, d = 0), a.setStartAndEnd(c, d, e, f) } function lb() { } function mb(a) { a.START_TO_START = db, a.START_TO_END = eb, a.END_TO_END = fb, a.END_TO_START = gb, a.NODE_BEFORE = hb, a.NODE_AFTER = ib, a.NODE_BEFORE_AND_AFTER = jb, a.NODE_INSIDE = kb } function nb(a) { mb(a), mb(a.prototype) } function ob(a, b) { return function () { Y(this); var c = this.startContainer, d = this.startOffset, e = this.commonAncestorContainer, f = new D(this, !0), g, h; c !== e && (g = m(c, e, !0), h = u(g), c = h.node, d = h.offset), y(f, T), f.reset(); var i = a(f); return f.detach(), b(this, c, d, c, d), i } } function pb(a, b, c) { function e(a, b) { return function (c) { P(this), Q(c, F), Q(p(c), G); var d = (a ? t : u)(c); (b ? f : i)(this, d.node, d.offset) } } function f(a, c, d) { var e = a.endContainer, f = a.endOffset; if (c !== a.startContainer || d !== a.startOffset) { if (p(c) != p(e) || k(c, d, e, f) == 1) e = c, f = d; b(a, c, d, e, f) } } function i(a, c, d) { var e = a.startContainer, f = a.startOffset; if (c !== a.endContainer || d !== a.endOffset) { if (p(c) != p(e) || k(c, d, e, f) == -1) e = c, f = d; b(a, e, f, c, d) } } a.prototype = new lb, d.extend(a.prototype, { setStart: function (a, b) { P(this), O(a, !0), R(a, b), f(this, a, b) }, setEnd: function (a, b) { P(this), O(a, !0), R(a, b), i(this, a, b) }, setStartAndEnd: function () { P(this); var a = arguments, c = a[0], d = a[1], e = c, f = d; switch (a.length) { case 3: f = a[2]; break; case 4: e = a[2], f = a[3] } b(this, c, d, e, f) }, setBoundary: function (a, b, c) { this["set" + (c ? "Start" : "End")](a, b) }, setStartBefore: e(!0, !0), setStartAfter: e(!1, !0), setEndBefore: e(!0, !1), setEndAfter: e(!1, !1), collapse: function (a) { Y(this), a ? b(this, this.startContainer, this.startOffset, this.startContainer, this.startOffset) : b(this, this.endContainer, this.endOffset, this.endContainer, this.endOffset) }, selectNodeContents: function (a) { P(this), O(a, !0), b(this, a, 0, a, n(a)) }, selectNode: function (a) { P(this), O(a, !1), Q(a, F); var c = t(a), d = u(a); b(this, c.node, c.offset, d.node, d.offset) }, extractContents: ob(A, b), deleteContents: ob(z, b), canSurroundContents: function () { Y(this), T(this.startContainer), T(this.endContainer); var a = new D(this, !0), b = a._first && r(a._first, this) || a._last && r(a._last, this); return a.detach(), !b }, detach: function () { c(this) }, splitBoundaries: function () { bb(this) }, splitBoundariesPreservingPositions: function (a) { bb(this, a) }, normalizeBoundaries: function () { Y(this); var a = this.startContainer, c = this.startOffset, d = this.endContainer, e = this.endOffset, f = function (a) { var b = a.nextSibling; b && b.nodeType == a.nodeType && (d = a, e = a.length, a.appendData(b.data), b.parentNode.removeChild(b)) }, i = function (b) { var f = b.previousSibling; if (f && f.nodeType == b.nodeType) { a = b; var g = b.length; c = f.length, b.insertData(0, f.data), f.parentNode.removeChild(f); if (a == d) e += c, d = a; else if (d == b.parentNode) { var i = h(b); e == i ? (d = b, e = g) : e > i && e-- } } }, j = !0; if (g(d)) d.length == e && f(d); else { if (e > 0) { var k = d.childNodes[e - 1]; k && g(k) && f(k) } j = !this.collapsed } if (j) { if (g(a)) c == 0 && i(a); else if (c < a.childNodes.length) { var l = a.childNodes[c]; l && g(l) && i(l) } } else a = d, c = e; b(this, a, c, d, e) }, collapseToPoint: function (a, b) { P(this), O(a, !0), R(a, b), this.setStartAndEnd(a, b) } }), nb(a) } function qb(a) { a.collapsed = a.startContainer === a.endContainer && a.startOffset === a.endOffset, a.commonAncestorContainer = a.collapsed ? a.startContainer : c.getCommonAncestor(a.startContainer, a.endContainer) } function rb(a, b, d, e, f) { a.startContainer = b, a.startOffset = d, a.endContainer = e, a.endOffset = f, a.document = c.getDocument(b), qb(a) } function sb(a) { P(a), a.startContainer = a.startOffset = a.endContainer = a.endOffset = a.document = null, a.collapsed = a.commonAncestorContainer = null } function tb(a) { this.startContainer = a, this.startOffset = 0, this.endContainer = a, this.endOffset = 0, this.document = a, qb(this) } a.requireModules(["DomUtil"]); var c = a.dom, d = a.util, e = c.DomPosition, f = a.DOMException, g = c.isCharacterDataNode, h = c.getNodeIndex, i = c.isOrIsAncestorOf, j = c.getDocument, k = c.comparePoints, l = c.splitDataNode, m = c.getClosestAncestorIn, n = c.getNodeLength, o = c.arrayContains, p = c.getRootContainer, q = a.features.crashyTextNodes; D.prototype = { _current: null, _next: null, _first: null, _last: null, isSingleCharacterDataNode: !1, reset: function () { this._current = null, this._next = this._first }, hasNext: function () { return !!this._next }, next: function () { var a = this._current = this._next; return a && (this._next = a !== this._last ? a.nextSibling : null, g(a) && this.clonePartiallySelectedTextNodes && (a === this.ec && (a = a.cloneNode(!0)).deleteData(this.eo, a.length - this.eo), this._current === this.sc && (a = a.cloneNode(!0)).deleteData(0, this.so))), a }, remove: function () { var a = this._current, b, c; !g(a) || a !== this.sc && a !== this.ec ? a.parentNode && a.parentNode.removeChild(a) : (b = a === this.sc ? this.so : 0, c = a === this.ec ? this.eo : a.length, b != c && a.deleteData(b, c - b)) }, isPartiallySelectedSubtree: function () { var a = this._current; return r(a, this.range) }, getSubtreeIterator: function () { var a; if (this.isSingleCharacterDataNode) a = this.range.cloneRange(), a.collapse(!1); else { a = new tb(s(this.range)); var b = this._current, c = b, d = 0, e = b, f = n(b); i(b, this.sc) && (c = this.sc, d = this.so), i(b, this.ec) && (e = this.ec, f = this.eo), rb(a, c, d, e, f) } return new D(a, this.clonePartiallySelectedTextNodes) }, detach: function (a) { a && this.range.detach(), this.range = this._current = this._next = this._first = this._last = this.sc = this.so = this.ec = this.eo = null } }, E.prototype = { BAD_BOUNDARYPOINTS_ERR: 1, INVALID_NODE_TYPE_ERR: 2 }, E.prototype.toString = function () { return this.message }; var F = [1, 3, 4, 5, 7, 8, 10], G = [2, 9, 11], H = [5, 6, 10, 12], I = [1, 3, 4, 5, 7, 8, 10, 11], J = [1, 3, 4, 5, 7, 8], L = K([9, 11]), M = K(H), N = K([6, 10, 12]), Z = document.createElement("style"), $ = !1; try { Z.innerHTML = "<b>x</b>", $ = Z.firstChild.nodeType == 3 } catch (_) { } a.features.htmlParsingConforms = $; var ab = $ ? function (a) { var b = this.startContainer, d = j(b); var e = null; return b.nodeType == 1 ? e = b : g(b) && (e = c.parentElement(b)), e === null || e.nodeName == "HTML" && c.isHtmlNamespace(j(e).documentElement) && c.isHtmlNamespace(e) ? e = d.createElement("body") : e = e.cloneNode(!1), e.innerHTML = a, c.fragmentFromNodeChildren(e) } : function (a) { P(this); var b = s(this), d = b.createElement("body"); return d.innerHTML = a, c.fragmentFromNodeChildren(d) }, cb = ["startContainer", "startOffset", "endContainer", "endOffset", "collapsed", "commonAncestorContainer"], db = 0, eb = 1, fb = 2, gb = 3, hb = 0, ib = 1, jb = 2, kb = 3; lb.prototype = { compareBoundaryPoints: function (a, b) { Y(this), S(this.startContainer, b.startContainer); var c, d, e, f, g = a == gb || a == db ? "start" : "end", h = a == eb || a == db ? "start" : "end"; return c = this[g + "Container"], d = this[g + "Offset"], e = b[h + "Container"], f = b[h + "Offset"], k(c, d, e, f) }, insertNode: function (a) { Y(this), Q(a, I), T(this.startContainer); var b = v(a, this.startContainer, this.startOffset); this.setStartBefore(b) }, cloneContents: function () { Y(this); var a, b; if (this.collapsed) return s(this).createDocumentFragment(); if (this.startContainer === this.endContainer && g(this.startContainer)) return a = this.startContainer.cloneNode(!0), a.data = a.data.slice(this.startOffset, this.endOffset), b = s(this).createDocumentFragment(), b.appendChild(a), b; var c = new D(this, !0); return a = x(c), c.detach(), a }, canSurroundContents: function () { Y(this), T(this.startContainer), T(this.endContainer); var a = new D(this, !0), b = a._first && r(a._first, this) || a._last && r(a._last, this); return a.detach(), !b }, surroundContents: function (a) { Q(a, J); var b = this.extractContents(); if (a.hasChildNodes()) while (a.lastChild) a.removeChild(a.lastChild); v(a, this.startContainer, this.startOffset), a.appendChild(b), this.selectNode(a) }, cloneRange: function () { Y(this); var a = new tb(s(this)), b = cb.length, c; while (b--) c = cb[b], a[c] = this[c]; return a }, toString: function () { Y(this); var a = this.startContainer; if (a === this.endContainer && g(a)) return a.nodeType == 3 || a.nodeType == 4 ? a.data.slice(this.startOffset, this.endOffset) : ""; var b = [], c = new D(this, !0); return y(c, function (a) { (a.nodeType == 3 || a.nodeType == 4) && b.push(a.data) }), c.detach(), b.join("") }, compareNode: function (a) { Y(this); var b = a.parentNode, c = h(a); var d = this.comparePoint(b, c), e = this.comparePoint(b, c + 1); return d < 0 ? e > 0 ? jb : hb : e > 0 ? ib : kb }, comparePoint: function (a, b) { return Y(this), U(a, "HIERARCHY_REQUEST_ERR"), S(a, this.startContainer), k(a, b, this.startContainer, this.startOffset) < 0 ? -1 : k(a, b, this.endContainer, this.endOffset) > 0 ? 1 : 0 }, createContextualFragment: ab, toHtml: function () { Y(this); var a = this.commonAncestorContainer.parentNode.cloneNode(!1); return a.appendChild(this.cloneContents()), a.innerHTML }, intersectsNode: function (a, b) { Y(this), U(a, "NOT_FOUND_ERR"); if (j(a) !== s(this)) return !1; var c = a.parentNode, d = h(a); U(c, "NOT_FOUND_ERR"); var e = k(c, d, this.endContainer, this.endOffset), f = k(c, d + 1, this.startContainer, this.startOffset); return b ? e <= 0 && f >= 0 : e < 0 && f > 0 }, isPointInRange: function (a, b) { return Y(this), U(a, "HIERARCHY_REQUEST_ERR"), S(a, this.startContainer), k(a, b, this.startContainer, this.startOffset) >= 0 && k(a, b, this.endContainer, this.endOffset) <= 0 }, intersectsRange: function (a) { return w(this, a, !1) }, intersectsOrTouchesRange: function (a) { return w(this, a, !0) }, intersection: function (a) { if (this.intersectsRange(a)) { var b = k(this.startContainer, this.startOffset, a.startContainer, a.startOffset), c = k(this.endContainer, this.endOffset, a.endContainer, a.endOffset), d = this.cloneRange(); return b == -1 && d.setStart(a.startContainer, a.startOffset), c == 1 && d.setEnd(a.endContainer, a.endOffset), d } return null }, union: function (a) { if (this.intersectsOrTouchesRange(a)) { var b = this.cloneRange(); return k(a.startContainer, a.startOffset, this.startContainer, this.startOffset) == -1 && b.setStart(a.startContainer, a.startOffset), k(a.endContainer, a.endOffset, this.endContainer, this.endOffset) == 1 && b.setEnd(a.endContainer, a.endOffset), b } }, containsNode: function (a, b) { return b ? this.intersectsNode(a, !1) : this.compareNode(a) == kb }, containsNodeContents: function (a) { return this.comparePoint(a, 0) >= 0 && this.comparePoint(a, n(a)) <= 0 }, containsRange: function (a) { var b = this.intersection(a); return b !== null && a.equals(b) }, containsNodeText: function (a) { var b = this.cloneRange(); b.selectNode(a); var c = b.getNodes([3]); if (c.length > 0) { b.setStart(c[0], 0); var d = c.pop(); b.setEnd(d, d.length); var e = this.containsRange(b); return b.detach(), e } return this.containsNodeContents(a) }, getNodes: function (a, b) { return Y(this), B(this, a, b) }, getDocument: function () { return s(this) }, collapseBefore: function (a) { P(this), this.setEndBefore(a), this.collapse(!1) }, collapseAfter: function (a) { P(this), this.setStartAfter(a), this.collapse(!0) }, getBookmark: function (b) { var d = s(this), e = a.createRange(d); b = b || c.getBody(d), e.selectNodeContents(b); var f = this.intersection(e), g = 0, h = 0; return f && (e.setEnd(f.startContainer, f.startOffset), g = e.toString().length, h = g + f.toString().length, e.detach()), { start: g, end: h, containerNode: b } }, moveToBookmark: function (a) { var b = a.containerNode, c = 0; this.setStart(b, 0), this.collapse(!0); var d = [b], e, f = !1, g = !1, h, i, j; while (!g && (e = d.pop())) if (e.nodeType == 3) h = c + e.length, !f && a.start >= c && a.start <= h && (this.setStart(e, a.start - c), f = !0), f && a.end >= c && a.end <= h && (this.setEnd(e, a.end - c), g = !0), c = h; else { j = e.childNodes, i = j.length; while (i--) d.push(j[i]) } }, getName: function () { return "DomRange" }, equals: function (a) { return tb.rangesEqual(this, a) }, isValid: function () { return X(this) }, inspect: function () { return C(this) } }, pb(tb, rb, sb), a.rangePrototype = lb.prototype, d.extend(tb, { rangeProperties: cb, RangeIterator: D, copyComparisonConstants: nb, createPrototypeRange: pb, inspect: C, getRangeDocument: s, rangesEqual: function (a, b) { return a.startContainer === b.startContainer && a.startOffset === b.startOffset && a.endContainer === b.endContainer && a.endOffset === b.endOffset } }), a.DomRange = tb, a.RangeException = E }), rangy.createModule("WrappedRange", function (a, b) { a.requireModules(["DomUtil", "DomRange"]); var c, d, e = a.dom, f = a.util, g = e.DomPosition, h = a.DomRange, i = e.getBody, j = e.getContentDocument, k = e.isCharacterDataNode; a.features.implementsDomRange && function () { function k(a) { var b = g.length, c; while (b--) c = g[b], a[c] = a.nativeRange[c]; a.collapsed = a.startContainer === a.endContainer && a.startOffset === a.endOffset } function l(a, b, c, d, e) { var f = a.startContainer !== b || a.startOffset != c, g = a.endContainer !== d || a.endOffset != e, h = !a.equals(a.nativeRange); if (f || g || h) a.setEnd(d, e), a.setStart(b, c) } function m(a) { a.nativeRange.detach(), a.detached = !0; var b = g.length; while (b--) a[g[b]] = null } var d, g = h.rangeProperties, n; c = function (a) { if (!a) throw b.createError("WrappedRange: Range must be specified"); this.nativeRange = a, k(this) }, h.createPrototypeRange(c, l, m), d = c.prototype, d.selectNode = function (a) { this.nativeRange.selectNode(a), k(this) }, d.cloneContents = function () { return this.nativeRange.cloneContents() }, d.surroundContents = function (a) { this.nativeRange.surroundContents(a), k(this) }, d.collapse = function (a) { this.nativeRange.collapse(a), k(this) }, d.cloneRange = function () { return new c(this.nativeRange.cloneRange()) }, d.refresh = function () { k(this) }, d.toString = function () { return this.nativeRange.toString() }; var o = document.createTextNode("test"); i(document).appendChild(o); var p = document.createRange(); p.setStart(o, 0), p.setEnd(o, 0); try { p.setStart(o, 1), d.setStart = function (a, b) { this.nativeRange.setStart(a, b), k(this) }, d.setEnd = function (a, b) { this.nativeRange.setEnd(a, b), k(this) }, n = function (a) { return function (b) { this.nativeRange[a](b), k(this) } } } catch (q) { d.setStart = function (a, b) { try { this.nativeRange.setStart(a, b) } catch (c) { this.nativeRange.setEnd(a, b), this.nativeRange.setStart(a, b) } k(this) }, d.setEnd = function (a, b) { try { this.nativeRange.setEnd(a, b) } catch (c) { this.nativeRange.setStart(a, b), this.nativeRange.setEnd(a, b) } k(this) }, n = function (a, b) { return function (c) { try { this.nativeRange[a](c) } catch (d) { this.nativeRange[b](c), this.nativeRange[a](c) } k(this) } } } d.setStartBefore = n("setStartBefore", "setEndBefore"), d.setStartAfter = n("setStartAfter", "setEndAfter"), d.setEndBefore = n("setEndBefore", "setStartBefore"), d.setEndAfter = n("setEndAfter", "setStartAfter"), p.selectNodeContents(o), p.startContainer == o && p.endContainer == o && p.startOffset == 0 && p.endOffset == o.length ? d.selectNodeContents = function (a) { this.nativeRange.selectNodeContents(a), k(this) } : d.selectNodeContents = function (a) { this.setStartAndEnd(a, 0, e.getNodeLength(a)) }, p.selectNodeContents(o), p.setEnd(o, 3); var r = document.createRange(); r.selectNodeContents(o), r.setEnd(o, 4), r.setStart(o, 2), p.compareBoundaryPoints(p.START_TO_END, r) == -1 && p.compareBoundaryPoints(p.END_TO_START, r) == 1 ? d.compareBoundaryPoints = function (a, b) { return b = b.nativeRange || b, a == b.START_TO_END ? a = b.END_TO_START : a == b.END_TO_START && (a = b.START_TO_END), this.nativeRange.compareBoundaryPoints(a, b) } : d.compareBoundaryPoints = function (a, b) { return this.nativeRange.compareBoundaryPoints(a, b.nativeRange || b) }; var s = document.createElement("div"); s.innerHTML = "123"; var t = s.firstChild, u = i(document); u.appendChild(s), p.setStart(t, 1), p.setEnd(t, 2), p.deleteContents(), t.data == "13" && (d.deleteContents = function () { this.nativeRange.deleteContents(), k(this) }, d.extractContents = function () { var a = this.nativeRange.extractContents(); return k(this), a }), u.removeChild(s), u = null, f.isHostMethod(p, "createContextualFragment") && (d.createContextualFragment = function (a) { return this.nativeRange.createContextualFragment(a) }), i(document).removeChild(o), p.detach(), r.detach(), d.getName = function () { return "WrappedRange" }, a.WrappedRange = c, a.createNativeRange = function (a) { return a = j(a, b, "createNativeRange"), a.createRange() } }(); if (a.features.implementsTextRange) { var l = function (a) { var b = a.parentElement(), c = a.duplicate(); c.collapse(!0); var d = c.parentElement(); c = a.duplicate(), c.collapse(!1); var f = c.parentElement(), g = d == f ? d : e.getCommonAncestor(d, f); return g == b ? g : e.getCommonAncestor(b, g) }, m = function (a) { return a.compareEndPoints("StartToEnd", a) == 0 }, n = function (a, b, c, d, f) { var h = a.duplicate(); h.collapse(c); var i = h.parentElement(); e.isOrIsAncestorOf(b, i) || (i = b); if (!i.canHaveHTML) { var j = new g(i.parentNode, e.getNodeIndex(i)); return { boundaryPosition: j, nodeInfo: { nodeIndex: j.offset, containerElement: j.node } } } var l = e.getDocument(i).createElement("span"); l.parentNode && l.parentNode.removeChild(l); var m, n = c ? "StartToStart" : "StartToEnd", o, p, q, r, s = f && f.containerElement == i ? f.nodeIndex : 0, t = i.childNodes.length, u = t, v = u; for (; ;) { v == t ? i.appendChild(l) : i.insertBefore(l, i.childNodes[v]), h.moveToElementText(l), m = h.compareEndPoints(n, a); if (m == 0 || s == u) break; if (m == -1) { if (u == s + 1) break; s = v } else u = u == s + 1 ? s : v; v = Math.floor((s + u) / 2), i.removeChild(l) } r = l.nextSibling; if (m == -1 && r && k(r)) { h.setEndPoint(c ? "EndToStart" : "EndToEnd", a); var w; if (/[\r\n]/.test(r.data)) { var x = h.duplicate(), y = x.text.replace(/\r\n/g, "\r").length; w = x.moveStart("character", y); while ((m = x.compareEndPoints("StartToEnd", x)) == -1) w++, x.moveStart("character", 1) } else w = h.text.length; q = new g(r, w) } else o = (d || !c) && l.previousSibling, p = (d || c) && l.nextSibling, p && k(p) ? q = new g(p, 0) : o && k(o) ? q = new g(o, o.data.length) : q = new g(i, e.getNodeIndex(l)); return l.parentNode.removeChild(l), { boundaryPosition: q, nodeInfo: { nodeIndex: v, containerElement: i } } }, o = function (a, b) { var c, d, f = a.offset, g = e.getDocument(a.node), h, j, l = i(g).createTextRange(), m = k(a.node); return m ? (c = a.node, d = c.parentNode) : (j = a.node.childNodes, c = f < j.length ? j[f] : null, d = a.node), h = g.createElement("span"), h.innerHTML = "&#feff;", c ? d.insertBefore(h, c) : d.appendChild(h), l.moveToElementText(h), l.collapse(!b), d.removeChild(h), m && l[b ? "moveStart" : "moveEnd"]("character", f), l }; d = function (a) { this.textRange = a, this.refresh() }, d.prototype = new h(document), d.prototype.refresh = function () { var a, b, c, d = l(this.textRange); m(this.textRange) ? b = a = n(this.textRange, d, !0, !0).boundaryPosition : (c = n(this.textRange, d, !0, !1), a = c.boundaryPosition, b = n(this.textRange, d, !1, !1, c.nodeInfo).boundaryPosition), this.setStart(a.node, a.offset), this.setEnd(b.node, b.offset) }, d.prototype.getName = function () { return "WrappedTextRange" }, h.copyComparisonConstants(d), d.rangeToTextRange = function (a) { if (a.collapsed) return o(new g(a.startContainer, a.startOffset), !0); var b = o(new g(a.startContainer, a.startOffset), !0), c = o(new g(a.endContainer, a.endOffset), !1), d = i(h.getRangeDocument(a)).createTextRange(); return d.setEndPoint("StartToStart", b), d.setEndPoint("EndToEnd", c), d }, a.WrappedTextRange = d; if (!a.features.implementsDomRange || a.config.preferTextRange) { var p = function () { return this }(); typeof p.Range == "undefined" && (p.Range = d), a.createNativeRange = function (a) { return a = j(a, b, "createNativeRange"), i(a).createTextRange() }, a.WrappedRange = d } } a.createRange = function (c) { return c = j(c, b, "createRange"), new a.WrappedRange(a.createNativeRange(c)) }, a.createRangyRange = function (a) { return a = j(a, b, "createRangyRange"), new h(a) }, a.createIframeRange = function (c) { return b.deprecationNotice("createIframeRange()", "createRange(iframeEl)"), a.createRange(c) }, a.createIframeRangyRange = function (c) { return b.deprecationNotice("createIframeRangyRange()", "createRangyRange(iframeEl)"), a.createRangyRange(c) }, a.addCreateMissingNativeApiListener(function (b) { var c = b.document; typeof c.createRange == "undefined" && (c.createRange = function () { return a.createRange(c) }), c = b = null }) }), rangy.createModule("WrappedSelection", function (a, b) { function r(a) { return typeof a == "string" ? a == "backward" : !!a } function s(a, c) { if (!a) return window; if (d.isWindow(a)) return a; if (a instanceof T) return a.win; var e = d.getContentDocument(a, b, c); return d.getWindow(e) } function t(a) { return s(a, "getWinSelection").getSelection() } function u(a) { return s(a, "getDocSelection").document.selection } function I(a, b, c) { var d = c ? "end" : "start", e = c ? "start" : "end"; a.anchorNode = b[d + "Container"], a.anchorOffset = b[d + "Offset"], a.focusNode = b[e + "Container"], a.focusOffset = b[e + "Offset"] } function J(a) { var b = a.nativeSelection; a.anchorNode = b.anchorNode, a.anchorOffset = b.anchorOffset, a.focusNode = b.focusNode, a.focusOffset = b.focusOffset } function K(a) { a.anchorNode = a.focusNode = null, a.anchorOffset = a.focusOffset = 0, a.rangeCount = 0, a.isCollapsed = !0, a._ranges.length = 0 } function L(b) { var c; return b instanceof g ? (c = a.createNativeRange(b.getDocument()), c.setEnd(b.endContainer, b.endOffset), c.setStart(b.startContainer, b.startOffset)) : b instanceof h ? c = b.nativeRange : m.implementsDomRange && b instanceof d.getWindow(b.startContainer).Range && (c = b), c } function M(a) { if (!a.length || a[0].nodeType != 1) return !1; for (var b = 1, c = a.length; b < c; ++b) if (!d.isAncestorOf(a[0], a[b])) return !1; return !0 } function N(a) { var c = a.getNodes(); if (!M(c)) throw b.createError("getSingleElementFromRange: range " + a.inspect() + " did not consist of a single element"); return c[0] } function O(a) { return !!a && typeof a.text != "undefined" } function P(a, b) { var c = new h(b); a._ranges = [c], I(a, c, !1), a.rangeCount = 1, a.isCollapsed = c.collapsed } function Q(b) { b._ranges.length = 0; if (b.docSelection.type == "None") K(b); else { var c = b.docSelection.createRange(); if (O(c)) P(b, c); else { b.rangeCount = c.length; var d, e = o(c.item(0)); for (var f = 0; f < b.rangeCount; ++f) d = a.createRange(e), d.selectNode(c.item(f)), b._ranges.push(d); b.isCollapsed = b.rangeCount == 1 && b._ranges[0].collapsed, I(b, b._ranges[b.rangeCount - 1], !1) } } } function R(a, c) { var d = a.docSelection.createRange(), e = N(c), f = o(d.item(0)), g = p(f).createControlRange(); for (var h = 0, i = d.length; h < i; ++h) g.add(d.item(h)); try { g.add(e) } catch (j) { throw b.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)") } g.select(), Q(a) } function T(a, b, c) { this.nativeSelection = a, this.docSelection = b, this._ranges = [], this.win = c, this.refresh() } function U(a) { a.win = a.anchorNode = a.focusNode = a._ranges = null, a.rangeCount = a.anchorOffset = a.focusOffset = 0, a.detached = !0 } function W(a, b) { var c = V.length, d, e; while (c--) { d = V[c], e = d.selection; if (b == "deleteAll") U(e); else if (d.win == a) return b == "delete" ? (V.splice(c, 1), !0) : e } return b == "deleteAll" && (V.length = 0), null } function Z(a, c) { var d = o(c[0].startContainer), e = p(d).createControlRange(); for (var f = 0, g; f < rangeCount; ++f) { g = N(c[f]); try { e.add(g) } catch (h) { throw b.createError("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)") } } e.select(), Q(a) } function cb(a, b) { } function db(b) { return function (c, d) { var e; this.rangeCount ? (e = this.getRangeAt(0), e["set" + (b ? "Start" : "End")](c, d)) : (e = a.createRange(this.win.document), e.setStartAndEnd(c, d)), this.setSingleRange(e, this.isBackward()) } } function eb(a) { var b = [], c = new j(a.anchorNode, a.anchorOffset), d = new j(a.focusNode, a.focusOffset), e = typeof a.getName == "function" ? a.getName() : "Selection"; if (typeof a.rangeCount != "undefined") for (var f = 0, h = a.rangeCount; f < h; ++f) b[f] = g.inspect(a.getRangeAt(f)); return "[" + e + "(Ranges: " + b.join(", ") + ")(anchor: " + c.inspect() + ", focus: " + d.inspect() + "]" } a.requireModules(["DomUtil", "DomRange", "WrappedRange"]), a.config.checkSelectionRanges = !0; var c = "boolean", d = a.dom, e = a.util, f = e.isHostMethod, g = a.DomRange, h = a.WrappedRange, i = a.DOMException, j = d.DomPosition, k, l, m = a.features, n = "Control", o = d.getDocument, p = d.getBody, q = g.rangesEqual, v = f(window, "getSelection"), w = e.isHostObject(document, "selection"); m.implementsWinGetSelection = v, m.implementsDocSelection = w; var x = w && (!v || a.config.preferTextRange); x ? (k = u, a.isSelectionValid = function (a) { var b = s(a, "isSelectionValid").document, c = b.selection; return c.type != "None" || o(c.createRange().parentElement()) == b }) : v ? (k = t, a.isSelectionValid = function () { return !0 }) : b.fail("Neither document.selection or window.getSelection() detected."), a.getNativeSelection = k; var y = k(), z = a.createNativeRange(document), A = p(document), B = e.areHostProperties(y, ["anchorNode", "focusNode", "anchorOffset", "focusOffset"]); m.selectionHasAnchorAndFocus = B; var C = f(y, "extend"); m.selectionHasExtend = C; var D = typeof y.rangeCount == "number"; m.selectionHasRangeCount = D; var E = !1, F = !0; e.areHostMethods(y, ["addRange", "getRangeAt", "removeAllRanges"]) && typeof y.rangeCount == "number" && m.implementsDomRange && function () { var a = window.getSelection(); if (a) { var b = p(document), c = b.appendChild(document.createElement("div")); c.contentEditable = "false"; var d = c.appendChild(document.createTextNode("\u00a0\u00a0\u00a0")), e = document.createRange(); e.setStart(d, 1), e.collapse(!0), a.addRange(e), F = a.rangeCount == 1, a.removeAllRanges(); var f = e.cloneRange(); e.setStart(d, 0), f.setEnd(d, 3), f.setStart(d, 2), a.addRange(e); if (!DEXTTOP.DEXT5.browser.chrome) { a.addRange(f); } E = a.rangeCount == 2, b.removeChild(c), a.removeAllRanges(), e.detach(), f.detach(); } }(), m.selectionSupportsMultipleRanges = E, m.collapsedNonEditableSelectionsSupported = F; var G = !1, H; A && f(A, "createControlRange") && (H = A.createControlRange(), e.areHostProperties(H, ["item", "add"]) && (G = !0)), m.implementsControlRange = G, B ? l = function (a) { return a.anchorNode === a.focusNode && a.anchorOffset === a.focusOffset } : l = function (a) { return a.rangeCount ? a.getRangeAt(a.rangeCount - 1).collapsed : !1 }; var S; f(y, "getRangeAt") ? S = function (a, b) { try { return a.getRangeAt(b) } catch (c) { return null } } : B && (S = function (b) { var c = o(b.anchorNode), d = a.createRange(c); return d.setStartAndEnd(b.anchorNode, b.anchorOffset, b.focusNode, b.focusOffset), d.collapsed !== this.isCollapsed && d.setStartAndEnd(b.focusNode, b.focusOffset, b.anchorNode, b.anchorOffset), d }); var V = [], X = function (a) { if (a && a instanceof T) return a.refresh(), a; a = s(a, "getNativeSelection"); var b = W(a), c = k(a), d = w ? u(a) : null; return b ? (b.nativeSelection = c, b.docSelection = d, b.refresh()) : (b = new T(c, d, a), V.push({ win: a, selection: b })), b }; a.getSelection = X, a.getIframeSelection = function (c) { return b.deprecationNotice("getIframeSelection()", "getSelection(iframeEl)"), a.getSelection(d.getIframeWindow(c)) }; var Y = T.prototype; if (!x && B && e.areHostMethods(y, ["removeAllRanges", "addRange"])) { Y.removeAllRanges = function () { this.nativeSelection.removeAllRanges(), K(this) }; var $ = function (b, c) { var d = g.getRangeDocument(c), e = a.createRange(d); e.collapseToPoint(c.endContainer, c.endOffset), b.nativeSelection.addRange(L(e)), b.nativeSelection.extend(c.startContainer, c.startOffset), b.refresh() }; D ? Y.addRange = function (b, c) { if (G && w && this.docSelection.type == n) R(this, b); else if (r(c) && C) $(this, b); else { var d; E ? d = this.rangeCount : (this.removeAllRanges(), d = 0), this.nativeSelection.addRange(L(b).cloneRange()), this.rangeCount = this.nativeSelection.rangeCount; if (this.rangeCount == d + 1) { if (a.config.checkSelectionRanges) { var e = S(this.nativeSelection, this.rangeCount - 1); e && !q(e, b) && (b = new h(e)) } this._ranges[this.rangeCount - 1] = b, I(this, b, bb(this.nativeSelection)), this.isCollapsed = l(this) } else this.refresh() } } : Y.addRange = function (a, b) { r(b) && C ? $(this, a) : (this.nativeSelection.addRange(L(a)), this.refresh()) }, Y.setRanges = function (a) { if (G && a.length > 1) Z(this, a); else { this.removeAllRanges(); for (var b = 0, c = a.length; b < c; ++b) this.addRange(a[b]) } } } else { if (!(f(y, "empty") && f(z, "select") && G && x)) return b.fail("No means of selecting a Range or TextRange was found"), !1; Y.removeAllRanges = function () { try { this.docSelection.empty(); if (this.docSelection.type != "None") { var a; if (this.anchorNode) a = o(this.anchorNode); else if (this.docSelection.type == n) { var b = this.docSelection.createRange(); b.length && (a = o(b.item(0))) } if (a) { var c = p(a).createTextRange(); c.select(), this.docSelection.empty() } } } catch (d) { } K(this) }, Y.addRange = function (a) { this.docSelection.type == n ? R(this, a) : (h.rangeToTextRange(a).select(), this._ranges[0] = a, this.rangeCount = 1, this.isCollapsed = this._ranges[0].collapsed, I(this, a, !1)) }, Y.setRanges = function (a) { this.removeAllRanges(); var b = a.length; b > 1 ? Z(this, a) : b && this.addRange(a[0]) } } Y.getRangeAt = function (a) { return this._ranges[a].cloneRange() }; var _; if (x) _ = function (b) { var c; a.isSelectionValid(b.win) ? c = b.docSelection.createRange() : (c = p(b.win.document).createTextRange(), c.collapse(!0)), b.docSelection.type == n ? Q(b) : O(c) ? P(b, c) : K(b) }; else if (f(y, "getRangeAt") && typeof y.rangeCount == "number") _ = function (b) { if (G && w && b.docSelection.type == n) Q(b); else { b._ranges.length = b.rangeCount = b.nativeSelection.rangeCount; if (b.rangeCount) { for (var c = 0, d = b.rangeCount; c < d; ++c) b._ranges[c] = new a.WrappedRange(b.nativeSelection.getRangeAt(c)); I(b, b._ranges[b.rangeCount - 1], bb(b.nativeSelection)), b.isCollapsed = l(b) } else K(b) } }; else { if (!B || typeof y.isCollapsed != c || typeof z.collapsed != c || !m.implementsDomRange) return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"), !1; _ = function (a) { var b, c = a.nativeSelection; c.anchorNode ? (b = S(c, 0), a._ranges = [b], a.rangeCount = 1, J(a), a.isCollapsed = l(a)) : K(a) } } Y.refresh = function (a) { var b = a ? this._ranges.slice(0) : null, c = this.anchorNode, d = this.anchorOffset; _(this); if (a) { var e = b.length; if (e != this._ranges.length) return !0; if (this.anchorNode != c || this.anchorOffset != d) return !0; while (e--) if (!q(b[e], this._ranges[e])) return !0; return !1 } }; var ab = function (b, c) { var d = b.getAllRanges(); b.removeAllRanges(); for (var e = 0, f = d.length; e < f; ++e) a.rangesEqual(c, d[e]) || b.addRange(d[e]); b.rangeCount || K(b) }; G ? Y.removeRange = function (a) { if (this.docSelection.type == n) { var b = this.docSelection.createRange(), c = N(a), d = o(b.item(0)), e = p(d).createControlRange(), f, g = !1; for (var h = 0, i = b.length; h < i; ++h) f = b.item(h), f !== c || g ? e.add(b.item(h)) : g = !0; e.select(), Q(this) } else ab(this, a) } : Y.removeRange = function (a) { ab(this, a) }; var bb; !x && B && m.implementsDomRange ? (bb = function (a) { var b = !1; return a.anchorNode && (b = d.comparePoints(a.anchorNode, a.anchorOffset, a.focusNode, a.focusOffset) == 1), b }, Y.isBackward = function () { return bb(this) }) : bb = Y.isBackward = function () { return !1 }, Y.isBackwards = Y.isBackward, Y.toString = function () { var a = []; for (var b = 0, c = this.rangeCount; b < c; ++b) a[b] = "" + this._ranges[b]; return a.join("") }, Y.collapse = function (b, c) { cb(this, b); var d = a.createRange(b); d.collapseToPoint(b, c), this.setSingleRange(d), this.isCollapsed = !0 }, Y.collapseToStart = function () { var a = this._ranges[0]; this.collapse(a.startContainer, a.startOffset) }, Y.collapseToEnd = function () { var a = this._ranges[this.rangeCount - 1]; this.collapse(a.endContainer, a.endOffset) }, Y.selectAllChildren = function (b) { cb(this, b); var c = a.createRange(b); c.selectNodeContents(b), this.removeAllRanges(), this.addRange(c) }, Y.deleteFromDocument = function () { if (G && w && this.docSelection.type == n) { var a = this.docSelection.createRange(), b; while (a.length) b = a.item(0), a.remove(b), b.parentNode.removeChild(b); this.refresh() } else if (this.rangeCount) { var c = this.getAllRanges(); if (c.length) { this.removeAllRanges(); for (var d = 0, e = c.length; d < e; ++d) c[d].deleteContents(); this.addRange(c[e - 1]) } } }, Y.eachRange = function (a, b) { for (var c = 0, d = this._ranges.length; c < d; ++c) if (a(this.getRangeAt(c))) return b }, Y.getAllRanges = function () { var a = []; return this.eachRange(function (b) { a.push(b) }), a }, Y.setSingleRange = function (a, b) { this.removeAllRanges(), this.addRange(a, b) }, Y.callMethodOnEachRange = function (a, b) { var c = []; return this.eachRange(function (d) { c.push(d[a].apply(d, b)) }), c }, Y.setStart = db(!0), Y.setEnd = db(!1), a.rangePrototype.select = function (a) { X(this.getDocument()).setSingleRange(this, a) }, Y.changeEachRange = function (a) { var b = [], c = this.isBackward(); this.eachRange(function (c) { a(c), b.push(c) }), this.removeAllRanges(), c && b.length == 1 ? this.addRange(b[0], "backward") : this.setRanges(b) }, Y.containsNode = function (a, b) { return this.eachRange(function (c) { return c.containsNode(a, b) }, !0) }, Y.getBookmark = function (a) { return { backward: this.isBackward(), rangeBookmarks: this.callMethodOnEachRange("getBookmark", [a]) } }, Y.moveToBookmark = function (b) { var c = []; for (var d = 0, e, f; e = b.rangeBookmarks[d++];) f = a.createRange(this.win), f.moveToBookmark(e), c.push(f); b.backward ? this.setSingleRange(c[0], "backward") : this.setRanges(c) }, Y.toHtml = function () { return this.callMethodOnEachRange("toHtml").join("") }, Y.getName = function () { return "WrappedSelection" }, Y.inspect = function () { return eb(this) }, Y.detach = function () { W(this.win, "delete"), U(this) }, T.detachAll = function () { W(null, "deleteAll") }, T.inspect = eb, T.isDirectionBackward = r, a.Selection = T, a.selectionPrototype = Y, a.addCreateMissingNativeApiListener(function (a) { typeof a.getSelection == "undefined" && (a.getSelection = function () { return X(a) }), a = null }) })

rangy.createModule("TextRange",function(a,b){function t(a,b){function f(b,c,d){var f=a.slice(b,c),g={isWord:d,chars:f,toString:function(){return f.join("")}};for(var h=0,i=f.length;h<i;++h)f[h].token=g;e.push(g)}var c=a.join(""),d,e=[],g=0,h,i;while(d=b.wordRegex.exec(c)){h=d.index,i=h+d[0].length,h>g&&f(g,h,!1);if(b.includeTrailingSpace)while(m.test(a[i]))++i;f(h,i,!0),g=i}return g<a.length&&f(g,a.length,!1),e}function x(a,b){if(!a)return b;var c={};return h(c,b),h(c,a),c}function y(a){var b,c;return a?(b=a.language||o,c={},h(c,w[b]||w[o]),h(c,a),c):w[o]}function z(a){return x(a,u)}function A(a){return x(a,v)}function I(a,b){var c=F(a,"display",b),d=a.tagName.toLowerCase();return c=="block"&&G&&H.hasOwnProperty(d)?H[d]:c}function J(a){var b=P(a);for(var c=0,d=b.length;c<d;++c)if(b[c].nodeType==1&&I(b[c])=="none")return!0;return!1}function K(a){var b;return a.nodeType==3&&(b=a.parentNode)&&F(b,"visibility")=="hidden"}function L(a){return a&&(a.nodeType==1&&!/^(inline(-block|-table)?|none)$/.test(I(a))||a.nodeType==9||a.nodeType==11)}function M(a){var b=a.lastChild;return b?M(b):a}function N(a){return f.isCharacterDataNode(a)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(a.nodeName)}function O(a){var b=[];while(a.parentNode)b.unshift(a.parentNode),a=a.parentNode;return b}function P(a){return O(a).concat([a])}function Q(a){var b;return typeof (b=a.namespaceURI)==c||b===null||b=="http://www.w3.org/1999/xhtml"}function R(a,b){if(!a||a.nodeType!=1||!Q(a))return!1;switch(typeof b){case"string":return a.tagName.toLowerCase()==b.toLowerCase();case"object":return(new RegExp("^("+b.join("|S")+")$","i")).test(a.tagName);default:return!0}}function S(a){while(a&&!a.nextSibling)a=a.parentNode;return a?a.nextSibling:null}function T(a,b){return!b&&a.hasChildNodes()?a.firstChild:S(a)}function U(a){var b=a.previousSibling;if(b){a=b;while(a.hasChildNodes())a=a.lastChild;return a}var c=a.parentNode;return c&&c.nodeType==1?c:null}function V(a){if(!a||a.nodeType!=3)return!1;var b=a.data;if(b==="")return!0;var c=a.parentNode;if(!c||c.nodeType!=1)return!1;var d=F(a.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(b)&&/^(normal|nowrap)$/.test(d)||/^[\t\r ]+$/.test(b)&&d=="pre-line"}function W(a){if(a.data==="")return!0;if(!V(a))return!1;var b=a.parentNode;return b?J(a)?!0:!1:!0}function X(a){var b=a.nodeType;return b==7||b==8||J(a)||/^(script|style)$/i.test(a.nodeName)||K(a)||W(a)}function Y(a,b){var c=a.nodeType;return c==7||c==8||c==1&&I(a,b)=="none"}function Z(){this.store={}}function ab(a,b,c){return function(d){var e=this.cache;if(e.hasOwnProperty(a))return $++,e[a];_++;var f=b.call(this,c?this[c]:this,d);return e[a]=f,f}}function bb(a,b){this.node=a,this.session=b,this.cache=new Z,this.positions=new Z}function kb(a,b){this.offset=b,this.nodeWrapper=a,this.node=a.node,this.session=a.session,this.cache=new Z}function lb(){return"[Position("+f.inspectNode(this.node)+":"+this.offset+")]"}function pb(){return rb(),nb=new ob}function qb(){return nb||pb()}function rb(){nb&&nb.detach(),nb=null}function sb(a,c,d,e){function h(){var a=null,b=null;return c?(b=f,g||(f=f.previousVisible(),g=!f||d&&f.equals(d))):g||(b=f=f.nextVisible(),g=!f||d&&f.equals(d)),g&&(f=null),b}d&&(c?X(d.node)&&(d=a.previousVisible()):X(d.node)&&(d=d.nextVisible()));var f=a,g=!1,i,j=!1;return{next:function(){if(j)return j=!1,i;var a,b;while(a=h()){b=a.getCharacter(e);if(b)return i=a,a}return null},rewind:function(){if(!i)throw b.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");j=!0},dispose:function(){a=d=null}}}function ub(a,b,c){function g(a){var b,c,f=[],g=a?d:e,h=!1,i=!1;while(b=g.next()){c=b.character;if(l.test(c))i&&(i=!1,h=!0);else{if(h){g.rewind();break}i=!0}f.push(b)}return f}function n(a){var b=["["+a.length+"]"];for(var c=0;c<a.length;++c)b.push("(word: "+a[c]+", is word: "+a[c].isWord+")");return b}var d=sb(a,!1,null,b),e=sb(a,!0,null,b),f=c.tokenizer,h=g(!0),i=g(!1).reverse(),j=f(i.concat(h),c),k=h.length?j.slice(tb(j,h[0].token)):[],m=i.length?j.slice(0,tb(j,i.pop().token)+1):[];return{nextEndToken:function(){var a,b;while(k.length==1&&!(a=k[0]).isWord&&(b=g(!0)).length>0)k=f(a.chars.concat(b),c);return k.shift()},previousStartToken:function(){var a,b;while(m.length==1&&!(a=m[0]).isWord&&(b=g(!1)).length>0)m=f(b.reverse().concat(a.chars),c);return m.pop()},dispose:function(){d.dispose(),e.dispose(),k=m=null}}}function vb(a,b,c,f,g){var h=0,i,j=a,k,l,m=Math.abs(c),n;if(c!==0){var o=c<0;switch(b){case d:k=sb(a,o,null,f);while((i=k.next())&&h<m)++h,j=i;l=i,k.dispose();break;case e:var p=ub(a,f,g),q=o?p.previousStartToken:p.nextEndToken;while((n=q())&&h<m)n.isWord&&(++h,j=o?n.chars[0]:n.chars[n.chars.length-1]);break;default:throw new Error("movePositionBy: unit '"+b+"' not implemented")}o?(j=j.previousVisible(),h=-h):j&&j.isLeadingSpace&&(b==e&&(k=sb(a,!1,null,f),l=k.next(),k.dispose()),l&&(j=l.previousVisible()))}return{position:j,unitsMoved:h}}function wb(a,b,c,d){var e=a.getRangeBoundaryPosition(b,!0),f=a.getRangeBoundaryPosition(b,!1),g=d?f:e,h=d?e:f;return sb(g,!!d,h,c)}function xb(a,b,c){var d=[],e=wb(a,b,c),f;while(f=e.next())d.push(f);return e.dispose(),d}function yb(b,c,d){var e=a.createRange(b.node);e.setStartAndEnd(b.node,b.offset,c.node,c.offset);var f=!e.expand("word",d);return e.detach(),f}function zb(a,b,c,d,e){function r(a,b){var c=i[a].previousVisible(),d=i[b-1],f=!e.wholeWordsOnly||yb(c,d,e.wordOptions);return{startPos:c,endPos:d,valid:f}}var f=p(e.direction),g=sb(a,f,a.session.getRangeBoundaryPosition(d,f),e),h="",i=[],j,k,l,m,n,o,q=null;while(j=g.next()){k=j.character,!c&&!e.caseSensitive&&(k=k.toLowerCase()),f?(i.unshift(j),h=k+h):(i.push(j),h+=k);if(c){n=b.exec(h);if(n)if(o){l=n.index,m=l+n[0].length;if(!f&&m<h.length||f&&l>0){q=r(l,m);break}}else o=!0}else if((l=h.indexOf(b))!=-1){q=r(l,l+b.length);break}}return o&&(q=r(l,m)),g.dispose(),q}function Ab(a){return function(){var b=!!nb,c=qb(),d=[c].concat(g.toArray(arguments)),e=a.apply(this,d);return b||rb(),e}}function Bb(a,b){return Ab(function(c,e,f,g){typeof f=="undefined"&&(f=e,e=d),g=x(g,C);var h=z(g.characterOptions),i=y(g.wordOptions),j=a;b&&(j=f>=0,this.collapse(!j));var k=vb(c.getRangeBoundaryPosition(this,j),e,f,h,i),l=k.position;return this[j?"setStart":"setEnd"](l.node,l.offset),k.unitsMoved})}function Cb(a){return Ab(function(b,c){c=z(c);var d,e=wb(b,this,c,!a),f=0;while((d=e.next())&&l.test(d.character))++f;e.dispose();var g=f>0;return g&&this[a?"moveStart":"moveEnd"]("character",a?f:-f,{characterOptions:c}),g})}function Db(a){return Ab(function(b,c){var d=!1;return this.changeEachRange(function(b){d=b[a](c)||d}),d})}a.requireModules(["WrappedSelection"]);var c="undefined",d="character",e="word",f=a.dom,g=a.util,h=g.extend,i=f.getBody,j=/^[ \t\f\r\n]+$/,k=/^[ \t\f\r]+$/,l=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,m=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,n=/^[\n-\r\u0085\u2028\u2029]$/,o="en",p=a.Selection.isDirectionBackward,q=!1,r=!1,s=!0;(function(){var b=document.createElement("div");b.contentEditable="true",b.innerHTML="<p>&nbsp; </p><p></p>";var c=i(document),d=b.firstChild,e=a.getSelection();c.appendChild(b),e.collapse(d.lastChild,2),e.setStart(d.firstChild,0),q=(""+e).length==1,b.innerHTML="&nbsp; <br>",e.collapse(b,2),e.setStart(b.firstChild,0),r=(""+e).length==1,c.removeChild(b),e.removeAllRanges()})();var u={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includePreLineTrailingSpace:!0},v={includeBlockContentTrailingSpace:!s,includeSpaceBeforeBr:!r,includePreLineTrailingSpace:!0},w={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:t}},B={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},C={wordOptions:null,characterOptions:null},D={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},E={wordOptions:null,characterOptions:null,direction:"forward"},F=f.getComputedStyleProperty,G;(function(){var a=document.createElement("table"),b=i(document);b.appendChild(a),G=F(a,"display")=="block",b.removeChild(a)})(),a.features.tableCssDisplayBlock=G;var H={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};Z.prototype={get:function(a){return this.store.hasOwnProperty(a)?this.store[a]:null},set:function(a,b){return this.store[a]=b}};var $=0,_=0;a.report=function(){console.log("Cached: "+$+", uncached: "+_)};var cb={getPosition:function(a){var b=this.positions;return b.get(a)||b.set(a,new kb(this,a))},toString:function(){return"[NodeWrapper("+f.inspectNode(this.node)+")]"}};bb.prototype=cb;var db="EMPTY",eb="NON_SPACE",fb="UNCOLLAPSIBLE_SPACE",gb="COLLAPSIBLE_SPACE",hb="TRAILING_SPACE_IN_BLOCK",ib="TRAILING_SPACE_BEFORE_BR",jb="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK";h(cb,{isCharacterDataNode:ab("isCharacterDataNode",f.isCharacterDataNode,"node"),getNodeIndex:ab("nodeIndex",f.getNodeIndex,"node"),getLength:ab("nodeLength",f.getNodeLength,"node"),containsPositions:ab("containsPositions",N,"node"),isWhitespace:ab("isWhitespace",V,"node"),isCollapsedWhitespace:ab("isCollapsedWhitespace",W,"node"),getComputedDisplay:ab("computedDisplay",I,"node"),isCollapsed:ab("collapsed",X,"node"),isIgnored:ab("ignored",Y,"node"),next:ab("nextPos",T,"node"),previous:ab("previous",U,"node"),getTextNodeInfo:ab("textNodeInfo",function(a){var b=null,c=!1,d=F(a.parentNode,"whiteSpace"),e=d=="pre-line";if(e)b=k,c=!0;else if(d=="normal"||d=="nowrap")b=j,c=!0;return{node:a,text:a.data,spaceRegex:b,collapseSpaces:c,preLine:e}},"node"),hasInnerText:ab("hasInnerText",function(a,b){var c=this.session,d=c.getPosition(a.parentNode,this.getNodeIndex()+1),e=c.getPosition(a,0),f=b?d:e,g=b?e:d;while(f!==g){f.prepopulateChar();if(f.isDefinitelyNonEmpty())return!0;f=b?f.previousVisible():f.nextVisible()}return!1},"node"),getTrailingSpace:ab("trailingSpace",function(a){if(a.tagName.toLowerCase()=="br")return"";switch(this.getComputedDisplay()){case"inline":var b=a.lastChild;while(b){if(!Y(b))return b.nodeType==1?this.session.getNodeWrapper(b).getTrailingSpace():"";b=b.previousSibling}break;case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":break;case"table-cell":return"	";default:return this.hasInnerText(!0)?"\n":""}return""},"node"),getLeadingSpace:ab("leadingSpace",function(a){switch(this.getComputedDisplay()){case"inline":case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":case"table-cell":break;default:return this.hasInnerText(!1)?"\n":""}return""},"node")});var mb={character:"",characterType:db,isBr:!1,prepopulateChar:function(){var a=this;if(!a.prepopulatedChar){var b=a.node,c=a.offset,d="",e=db,f=!1;if(c>0)if(b.nodeType==3){var g=b.data,h=g.charAt(c-1),i=a.nodeWrapper.getTextNodeInfo(),j=i.spaceRegex;i.collapseSpaces?j.test(h)?c>1&&j.test(g.charAt(c-2))||(i.preLine&&g.charAt(c)==="\n"?(d=" ",e=jb):(d=" ",e=gb)):(d=h,e=eb,f=!0):(d=h,e=fb,f=!0)}else{var k=b.childNodes[c-1];k&&k.nodeType==1&&!X(k)&&(k.tagName.toLowerCase()=="br"?(d="\n",a.isBr=!0,e=gb,f=!1):a.checkForTrailingSpace=!0);if(!d){var l=b.childNodes[c];l&&l.nodeType==1&&!X(l)&&(a.checkForLeadingSpace=!0)}}a.prepopulatedChar=!0,a.character=d,a.characterType=e,a.isCharInvariant=f}},isDefinitelyNonEmpty:function(){var a=this.characterType;return a==eb||a==fb},resolveLeadingAndTrailingSpaces:function(){this.prepopulatedChar||this.prepopulateChar();if(this.checkForTrailingSpace){var a=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();a&&(this.isTrailingSpace=!0,this.character=a,this.characterType=gb),this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){var b=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();b&&(this.isLeadingSpace=!0,this.character=b,this.characterType=gb),this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(a){var b=this,c;while(b=b.previousVisible()){c=b.getCharacter(a);if(c!=="")return b}return null},getCharacter:function(a){function j(){return h||(g=i.getPrecedingUncollapsedPosition(a),h=!0),g}this.resolveLeadingAndTrailingSpaces();if(this.isCharInvariant)return this.character;var b=["character",a.includeSpaceBeforeBr,a.includeBlockContentTrailingSpace,a.includePreLineTrailingSpace].join("_"),c=this.cache.get(b);if(c!==null)return c;var d="",e=this.characterType==gb,f,g,h=!1,i=this;if(e){if(this.character!=" "||!!j()&&!g.isTrailingSpace&&g.character!="\n")if(this.character=="\n"&&this.isLeadingSpace)j()&&g.character!="\n"&&(d="\n");else{f=this.nextUncollapsed();if(f){f.isBr?this.type=ib:f.isTrailingSpace&&f.character=="\n"&&(this.type=hb);if(f.character==="\n"){if(this.type!=ib||!!a.includeSpaceBeforeBr)if(this.type!=hb||!f.isTrailingSpace||!!a.includeBlockContentTrailingSpace)if(this.type!=jb||f.type!=eb||!!a.includePreLineTrailingSpace)this.character==="\n"?f.isTrailingSpace?this.isTrailingSpace||!this.isBr:d="\n":this.character===" "&&(d=" ")}else d=this.character}}}else this.character!=="\n"||!!(f=this.nextUncollapsed())&&!f.isTrailingSpace;return this.cache.set(b,d),d},equals:function(a){return!!a&&this.node===a.node&&this.offset===a.offset},inspect:lb,toString:function(){return this.character}};kb.prototype=mb,h(mb,{next:ab("nextPos",function(a){var b=a.nodeWrapper,c=a.node,d=a.offset,e=b.session;if(!c)return null;var f,g,h;return d==b.getLength()?(f=c.parentNode,g=f?b.getNodeIndex()+1:0):b.isCharacterDataNode()?(f=c,g=d+1):(h=c.childNodes[d],e.getNodeWrapper(h).containsPositions()?(f=h,g=0):(f=c,g=d+1)),f?e.getPosition(f,g):null}),previous:ab("previous",function(a){var b=a.nodeWrapper,c=a.node,d=a.offset,e=b.session,g,h,i;return d==0?(g=c.parentNode,h=g?b.getNodeIndex():0):b.isCharacterDataNode()?(g=c,h=d-1):(i=c.childNodes[d-1],e.getNodeWrapper(i).containsPositions()?(g=i,h=f.getNodeLength(i)):(g=c,h=d-1)),g?e.getPosition(g,h):null}),nextVisible:ab("nextVisible",function(a){var b=a.next();if(!b)return null;var c=b.nodeWrapper,d=b.node,e=b;return c.isCollapsed()&&(e=c.session.getPosition(d.parentNode,c.getNodeIndex()+1)),e}),nextUncollapsed:ab("nextUncollapsed",function(a){var b=a;while(b=b.nextVisible()){b.resolveLeadingAndTrailingSpaces();if(b.character!=="")return b}return null}),previousVisible:ab("previousVisible",function(a){var b=a.previous();if(!b)return null;var c=b.nodeWrapper,d=b.node,e=b;return c.isCollapsed()&&(e=c.session.getPosition(d.parentNode,c.getNodeIndex())),e})});var nb=null,ob=function(){function a(a){var b=new Z;return{get:function(c){var d=b.get(c[a]);if(d)for(var e=0,f;f=d[e++];)if(f.node===c)return f;return null},set:function(c){var d=c.node[a],e=b.get(d)||b.set(d,[]);e.push(c)}}}function c(){this.initCaches()}var b=g.isHostProperty(document.documentElement,"uniqueID");return c.prototype={initCaches:function(){this.elementCache=b?function(){var a=new Z;return{get:function(b){return a.get(b.uniqueID)},set:function(b){a.set(b.node.uniqueID,b)}}}():a("tagName"),this.textNodeCache=a("data"),this.otherNodeCache=a("nodeName")},getNodeWrapper:function(a){var b;switch(a.nodeType){case 1:b=this.elementCache;break;case 3:b=this.textNodeCache;break;default:b=this.otherNodeCache}var c=b.get(a);return c||(c=new bb(a,this),b.set(c)),c},getPosition:function(a,b){return this.getNodeWrapper(a).getPosition(b)},getRangeBoundaryPosition:function(a,b){var c=b?"start":"end";return this.getPosition(a[c+"Container"],a[c+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}},c}();h(f,{nextNode:T,previousNode:U});var tb=Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:function(a,b){for(var c=0,d=a.length;c<d;++c)if(a[c]===b)return c;return-1};h(a.rangePrototype,{moveStart:Bb(!0,!1),moveEnd:Bb(!1,!1),move:Bb(!0,!0),trimStart:Cb(!0),trimEnd:Cb(!1),trim:Ab(function(a,b){var c=this.trimStart(b),d=this.trimEnd(b);return c||d}),expand:Ab(function(a,b,c){var f=!1;c=x(c,D);var g=z(c.characterOptions);b||(b=d);if(b==e){var h=y(c.wordOptions),i=a.getRangeBoundaryPosition(this,!0),j=a.getRangeBoundaryPosition(this,!1),k=ub(i,g,h),l=k.nextEndToken(),m=l.chars[0].previousVisible(),n,o;if(this.collapsed)n=l;else{var p=ub(j,g,h);n=p.previousStartToken()}return o=n.chars[n.chars.length-1],m.equals(i)||(this.setStart(m.node,m.offset),f=!0),o&&!o.equals(j)&&(this.setEnd(o.node,o.offset),f=!0),c.trim&&(c.trimStart&&(f=this.trimStart(g)||f),c.trimEnd&&(f=this.trimEnd(g)||f)),f}return this.moveEnd(d,1,c)}),text:Ab(function(a,b){return this.collapsed?"":xb(a,this,z(b)).join("")}),selectCharacters:Ab(function(a,b,c,d,e){var f={characterOptions:e};b||(b=i(this.getDocument())),this.selectNodeContents(b),this.collapse(!0),this.moveStart("character",c,f),this.collapse(!0),this.moveEnd("character",d-c,f)}),toCharacterRange:Ab(function(a,b,c){b||(b=i(this.getDocument()));var d=b.parentNode,e=f.getNodeIndex(b),g=f.comparePoints(this.startContainer,this.endContainer,d,e)==-1,h=this.cloneRange(),j,k;return g?(h.setStartAndEnd(this.startContainer,this.startOffset,d,e),j=-h.text(c).length):(h.setStartAndEnd(d,e,this.startContainer,this.startOffset),j=h.text(c).length),k=j+this.text(c).length,{start:j,end:k}}),findText:Ab(function(b,c,d){d=x(d,B),d.wholeWordsOnly&&(d.wordOptions=y(d.wordOptions),d.wordOptions.includeTrailingSpace=!1);var e=p(d.direction),f=d.withinRange;f||(f=a.createRange(),f.selectNodeContents(this.getDocument()));var g=c,h=!1;typeof g=="string"?d.caseSensitive||(g=g.toLowerCase()):h=!0;var i=b.getRangeBoundaryPosition(this,!e),j=f.comparePoint(i.node,i.offset);j===-1?i=b.getRangeBoundaryPosition(f,!0):j===1&&(i=b.getRangeBoundaryPosition(f,!1));var k=i,l=!1,m;for(;;){m=zb(k,g,h,f,d);if(m){if(m.valid)return this.setStartAndEnd(m.startPos.node,m.startPos.offset,m.endPos.node,m.endPos.offset),!0;k=e?m.startPos:m.endPos}else{if(!d.wrap||!!l)return!1;f=f.cloneRange(),k=b.getRangeBoundaryPosition(f,!e),f.setBoundary(i.node,i.offset,e),l=!0}}}),pasteHtml:function(a){this.deleteContents();if(a){var b=this.createContextualFragment(a),c=b.lastChild;this.insertNode(b),this.collapseAfter(c)}}}),h(a.selectionPrototype,{expand:Ab(function(a,b,c){this.changeEachRange(function(a){a.expand(b,c)})}),move:Ab(function(a,b,c,d){var e=0;if(this.focusNode){this.collapse(this.focusNode,this.focusOffset);var f=this.getRangeAt(0);d||(d={}),d.characterOptions=A(d.characterOptions),e=f.move(b,c,d),this.setSingleRange(f)}return e}),trimStart:Db("trimStart"),trimEnd:Db("trimEnd"),trim:Db("trim"),selectCharacters:Ab(function(b,c,d,e,f,g){var h=a.createRange(c);h.selectCharacters(c,d,e,g),this.setSingleRange(h,f)}),saveCharacterRanges:Ab(function(a,b,c){var d=this.getAllRanges(),e=d.length,f=[],g=e==1&&this.isBackward();for(var h=0,i=d.length;h<i;++h)f[h]={characterRange:d[h].toCharacterRange(b,c),backward:g,characterOptions:c};return f}),restoreCharacterRanges:Ab(function(b,c,d){this.removeAllRanges();for(var e=0,f=d.length,g,h,i;e<f;++e)h=d[e],i=h.characterRange,g=a.createRange(c),g.selectCharacters(c,i.start,i.end,h.characterOptions),this.addRange(g,h.backward)}),text:Ab(function(a,b){var c=[];for(var d=0,e=this.rangeCount;d<e;++d)c[d]=this.getRangeAt(d).text(b);return c.join("")})}),a.innerText=function(b,c){var d=a.createRange(b);d.selectNodeContents(b);var e=d.text(c);return d.detach(),e},a.createWordIterator=function(a,b,c){var d=qb();c=x(c,E);var e=z(c.characterOptions),f=y(c.wordOptions),g=d.getPosition(a,b),h=ub(g,e,f),i=p(c.direction);return{next:function(){return i?h.previousStartToken():h.nextEndToken()},dispose:function(){h.dispose(),this.next=function(){}}}},a.noMutation=function(a){var b=qb();a(b),rb()},a.noMutation.createEntryPointFunction=Ab,a.textRange={isBlockNode:L,isCollapsedWhitespaceNode:W,createPosition:Ab(function(a,b,c){return a.getPosition(b,c)})}})

rangy.createModule("CssClassApplier",function(i,v){function r(a,b){return a.className&&RegExp("(?:^|\\s)"+b+"(?:\\s|$)").test(a.className)}function s(a,b){if(a.className)r(a,b)||(a.className+=" "+b);else a.className=b}function o(a){return a.split(/\s+/).sort().join(" ")}function w(a,b){return o(a.className)==o(b.className)}function x(a){for(var b=a.parentNode;a.hasChildNodes();)b.insertBefore(a.firstChild,a);b.removeChild(a)}function y(a,b){var c=a.cloneRange();c.selectNodeContents(b);var d=c.intersection(a);
d=d?d.toString():"";c.detach();return d!=""}function z(a){return a.getNodes([3],function(b){return y(a,b)})}function A(a,b){if(a.attributes.length!=b.attributes.length)return false;for(var c=0,d=a.attributes.length,e,f;c<d;++c){e=a.attributes[c];f=e.name;if(f!="class"){f=b.attributes.getNamedItem(f);if(e.specified!=f.specified)return false;if(e.specified&&e.nodeValue!==f.nodeValue)return false}}return true}function B(a,b){for(var c=0,d=a.attributes.length,e;c<d;++c){e=a.attributes[c].name;if(!(b&&
h.arrayContains(b,e))&&a.attributes[c].specified&&e!="class")return true}return false}function C(a){var b;return a&&a.nodeType==1&&((b=a.parentNode)&&b.nodeType==9&&b.designMode=="on"||k(a)&&!k(a.parentNode))}function D(a){return(k(a)||a.nodeType!=1&&k(a.parentNode))&&!C(a)}function E(a){return a&&a.nodeType==1&&!M.test(p(a,"display"))}function N(a){if(a.data.length==0)return true;if(O.test(a.data))return false;switch(p(a.parentNode,"whiteSpace")){case "pre":case "pre-wrap":case "-moz-pre-wrap":return false;
case "pre-line":if(/[\r\n]/.test(a.data))return false}return E(a.previousSibling)||E(a.nextSibling)}function m(a,b,c,d){var e,f=c==0;if(h.isAncestorOf(b,a))return a;if(h.isCharacterDataNode(b))if(c==0){c=h.getNodeIndex(b);b=b.parentNode}else if(c==b.length){c=h.getNodeIndex(b)+1;b=b.parentNode}else throw v.createError("splitNodeAt should not be called with offset in the middle of a data node ("+c+" in "+b.data);var g;g=b;var j=c;g=h.isCharacterDataNode(g)?j==0?!!g.previousSibling:j==g.length?!!g.nextSibling:
true:j>0&&j<g.childNodes.length;if(g){if(!e){e=b.cloneNode(false);for(e.id&&e.removeAttribute("id");f=b.childNodes[c];)e.appendChild(f);h.insertAfter(e,b)}return b==a?e:m(a,e.parentNode,h.getNodeIndex(e),d)}else if(a!=b){e=b.parentNode;b=h.getNodeIndex(b);f||b++;return m(a,e,b,d)}return a}function F(a){var b=a?"nextSibling":"previousSibling";return function(c,d){var e=c.parentNode,f=c[b];if(f){if(f&&f.nodeType==3)return f}else if(d)if((f=e[b])&&f.nodeType==1&&e.tagName==f.tagName&&w(e,f)&&A(e,f))return f[a?
"firstChild":"lastChild"];return null}}function t(a){this.firstTextNode=(this.isElementMerge=a.nodeType==1)?a.lastChild:a;this.textNodes=[this.firstTextNode]}function q(a,b,c){this.cssClass=a;var d,e,f=null;if(typeof b=="object"&&b!==null){c=b.tagNames;f=b.elementProperties;for(d=0;e=P[d++];)if(b.hasOwnProperty(e))this[e]=b[e];d=b.normalize}else d=b;this.normalize=typeof d=="undefined"?true:d;this.attrExceptions=[];d=document.createElement(this.elementTagName);this.elementProperties={};for(var g in f)if(f.hasOwnProperty(g)){if(G.hasOwnProperty(g))g=
G[g];d[g]=f[g];this.elementProperties[g]=d[g];this.attrExceptions.push(g)}this.elementSortedClassName=this.elementProperties.hasOwnProperty("className")?o(this.elementProperties.className+" "+a):a;this.applyToAnyTagName=false;a=typeof c;if(a=="string")if(c=="*")this.applyToAnyTagName=true;else this.tagNames=c.toLowerCase().replace(/^\s\s*/,"").replace(/\s\s*$/,"").split(/\s*,\s*/);else if(a=="object"&&typeof c.length=="number"){this.tagNames=[];d=0;for(a=c.length;d<a;++d)if(c[d]=="*")this.applyToAnyTagName=
true;else this.tagNames.push(c[d].toLowerCase())}else this.tagNames=[this.elementTagName]}i.requireModules(["WrappedSelection","WrappedRange"]);var h=i.dom,H=function(){function a(b,c,d){return c&&d?" ":""}return function(b,c){if(b.className)b.className=b.className.replace(RegExp("(?:^|\\s)"+c+"(?:\\s|$)"),a)}}(),p;if(typeof window.getComputedStyle!="undefined")p=function(a,b){return h.getWindow(a).getComputedStyle(a,null)[b]};else if(typeof document.documentElement.currentStyle!="undefined")p=function(a,
b){return a.currentStyle[b]};else v.fail("No means of obtaining computed style properties found");var k;(function(){k=typeof document.createElement("div").isContentEditable=="boolean"?function(a){return a&&a.nodeType==1&&a.isContentEditable}:function(a){if(!a||a.nodeType!=1||a.contentEditable=="false")return false;return a.contentEditable=="true"||k(a.parentNode)}})();var M=/^inline(-block|-table)?$/i,O=/[^\r\n\t\f \u200B]/,Q=F(false),R=F(true);t.prototype={doMerge:function(){for(var a=[],b,c,d=0,
e=this.textNodes.length;d<e;++d){b=this.textNodes[d];c=b.parentNode;a[d]=b.data;if(d){c.removeChild(b);c.hasChildNodes()||c.parentNode.removeChild(c)}}return this.firstTextNode.data=a=a.join("")},getLength:function(){for(var a=this.textNodes.length,b=0;a--;)b+=this.textNodes[a].length;return b},toString:function(){for(var a=[],b=0,c=this.textNodes.length;b<c;++b)a[b]="'"+this.textNodes[b].data+"'";return"[Merge("+a.join(",")+")]"}};var P=["elementTagName","ignoreWhiteSpace","applyToEditableOnly"],
G={"class":"className"};q.prototype={elementTagName:"span",elementProperties:{},ignoreWhiteSpace:true,applyToEditableOnly:false,hasClass:function(a){return a.nodeType==1&&h.arrayContains(this.tagNames,a.tagName.toLowerCase())&&r(a,this.cssClass)},getSelfOrAncestorWithClass:function(a){for(;a;){if(this.hasClass(a,this.cssClass))return a;a=a.parentNode}return null},isModifiable:function(a){return!this.applyToEditableOnly||D(a)},isIgnorableWhiteSpaceNode:function(a){return this.ignoreWhiteSpace&&a&&
a.nodeType==3&&N(a)},postApply:function(a,b,c){for(var d=a[0],e=a[a.length-1],f=[],g,j=d,I=e,J=0,K=e.length,n,L,l=0,u=a.length;l<u;++l){n=a[l];if(L=Q(n,!c)){if(!g){g=new t(L);f.push(g)}g.textNodes.push(n);if(n===d){j=g.firstTextNode;J=j.length}if(n===e){I=g.firstTextNode;K=g.getLength()}}else g=null}if(a=R(e,!c)){if(!g){g=new t(e);f.push(g)}g.textNodes.push(a)}if(f.length){l=0;for(u=f.length;l<u;++l)f[l].doMerge();b.setStart(j,J);b.setEnd(I,K)}},createContainer:function(a){a=a.createElement(this.elementTagName);
i.util.extend(a,this.elementProperties);s(a,this.cssClass);return a},applyToTextNode:function(a){var b=a.parentNode;if(b.childNodes.length==1&&h.arrayContains(this.tagNames,b.tagName.toLowerCase()))s(b,this.cssClass);else{b=this.createContainer(h.getDocument(a));a.parentNode.insertBefore(b,a);b.appendChild(a)}},isRemovable:function(a){var b;if(b=a.tagName.toLowerCase()==this.elementTagName){if(b=o(a.className)==this.elementSortedClassName){var c;a:{b=this.elementProperties;for(c in b)if(b.hasOwnProperty(c)&&
a[c]!==b[c]){c=false;break a}c=true}b=c&&!B(a,this.attrExceptions)&&this.isModifiable(a)}b=b}return b},undoToTextNode:function(a,b,c){if(!b.containsNode(c)){a=b.cloneRange();a.selectNode(c);if(a.isPointInRange(b.endContainer,b.endOffset)){m(c,b.endContainer,b.endOffset,[b]);b.setEndAfter(c)}if(a.isPointInRange(b.startContainer,b.startOffset))c=m(c,b.startContainer,b.startOffset,[b])}this.isRemovable(c)?x(c):H(c,this.cssClass)},applyToRange:function(a){a.splitBoundaries();var b=z(a);if(b.length){for(var c,
d=0,e=b.length;d<e;++d){c=b[d];!this.isIgnorableWhiteSpaceNode(c)&&!this.getSelfOrAncestorWithClass(c)&&this.isModifiable(c)&&this.applyToTextNode(c)}a.setStart(b[0],0);c=b[b.length-1];a.setEnd(c,c.length);this.normalize&&this.postApply(b,a,false)}},applyToSelection:function(a){a=a||window;a=i.getSelection(a);var b,c=a.getAllRanges();a.removeAllRanges();for(var d=c.length;d--;){b=c[d];this.applyToRange(b);a.addRange(b)}},undoToRange:function(a){a.splitBoundaries();var b=z(a),c,d,e=b[b.length-1];if(b.length){for(var f=
0,g=b.length;f<g;++f){c=b[f];(d=this.getSelfOrAncestorWithClass(c))&&this.isModifiable(c)&&this.undoToTextNode(c,a,d);a.setStart(b[0],0);a.setEnd(e,e.length)}this.normalize&&this.postApply(b,a,true)}},undoToSelection:function(a){a=a||window;a=i.getSelection(a);var b=a.getAllRanges(),c;a.removeAllRanges();for(var d=0,e=b.length;d<e;++d){c=b[d];this.undoToRange(c);a.addRange(c)}},getTextSelectedByRange:function(a,b){var c=b.cloneRange();c.selectNodeContents(a);var d=c.intersection(b);d=d?d.toString():
"";c.detach();return d},isAppliedToRange:function(a){if(a.collapsed)return!!this.getSelfOrAncestorWithClass(a.commonAncestorContainer);else{for(var b=a.getNodes([3]),c=0,d;d=b[c++];)if(!this.isIgnorableWhiteSpaceNode(d)&&y(a,d)&&this.isModifiable(d)&&!this.getSelfOrAncestorWithClass(d))return false;return true}},isAppliedToSelection:function(a){a=a||window;a=i.getSelection(a).getAllRanges();for(var b=a.length;b--;)if(!this.isAppliedToRange(a[b]))return false;return true},toggleRange:function(a){this.isAppliedToRange(a)?
this.undoToRange(a):this.applyToRange(a)},toggleSelection:function(a){this.isAppliedToSelection(a)?this.undoToSelection(a):this.applyToSelection(a)},detach:function(){}};q.util={hasClass:r,addClass:s,removeClass:H,hasSameClasses:w,replaceWithOwnChildren:x,elementsHaveSameNonClassAttributes:A,elementHasNonClassAttributes:B,splitNodeAt:m,isEditableElement:k,isEditingHost:C,isEditable:D};i.CssClassApplier=q;i.createCssClassApplier=function(a,b,c){return new q(a,b,c)}});

rangy.createModule("Commands",function(f,m){function k(a){return a&&1==a.nodeType&&a.isContentEditable}function l(a,b){var g;!(g=!b||!b.applyToEditableOnly)&&(g=k(a)||k(a.parentNode))&&(g=!(a&&(9==a.nodeType&&"on"==a.designMode||k(a)&&!k(a.parentNode))));return g}function e(a,b){var g=n.comparePoints(a,0,b.startContainer,b.startOffset),c=n.comparePoints(a,n.getNodeLength(a),b.endContainer,b.endOffset);return I(a)==I(b.startContainer)&&1==g&&-1==c}function b(a,x){if(e(a,x))return!0;var g=n.isCharacterDataNode(a);
if(a==x.startContainer&&g&&n.getNodeLength(a)!=x.startOffset||a==x.endContainer&&g&&0!=x.endOffset)return!0;var g=a.childNodes,c=g.length;if(0!=c){for(var d=0;d<c;++d)if(!b(g[d],x))return!1;return!0}return!1}function a(a){var b;return"undefined"==typeof(b=a.namespaceURI)||null===b||"http://www.w3.org/1999/xhtml"==b}function c(a){return n.isCharacterDataNode(a)||1==a.nodeType&&R.test(u(a,"display"))}function d(a){return c(a)&&"br"!=a.nodeName.toLowerCase()}function h(b,c){if(!b||1!=b.nodeType||!a(b))return!1;
switch(typeof c){case "string":return b.tagName.toLowerCase()==c.toLowerCase();case "object":return(new RegExp("^("+c.join(",")+")$","i")).test(b.tagName);default:return!0}}function z(a,b){return h(a)?c(a)&&l(a,b)?S.test(a.tagName):!0:!1}function J(a,b){return 8==a.nodeType||3==a.nodeType&&(a.parentNode&&/^(script|style)$/i.test(a.parentNode.tagName)||b.ignoreWhiteSpace&&!/[^\r\n\t ]/.test(a.data)&&(z(a.previousSibling,b)||z(a.nextSibling,b)))?!0:!1}function F(a,b){if(!h(a))return!1;if(b&&b.command.isModifiableElement)return b.command.isModifiableElement(el,
b);var g=a.tagName.toLowerCase();if(T.test(g))g=["style","class"];else if("a"==g)g=["style","class","href"];else if("font"==g)g=["style","class","color","face","size"];else return!1;a:{for(var c=0,d=a.attributes.length,e;c<d;++c)if(e=a.attributes[c].name,a.attributes[c].specified&&(!g||!n.arrayContains(g,e))){g=!1;break a}g=!0}return g}function A(a,b){if(!h(a))return!1;if(b&&b.command.isSimpleModifiableElement)return b.command.isSimpleModifiableElement(a,b);var g=a.tagName.toLowerCase();if(!U.test(g))return!1;
for(var c,d=!1,e=0,f=a.attributes.length;e<f;++e)if(a.attributes[e].specified){if(d)return!1;c=a.attributes[e].name;a.getAttribute(c);d=!0}return!d||"style"==c&&0==a.style.cssText.length||"a"==g&&"href"==c||"font"==g&&/^(color|face|size)$/.test(c)?!0:"style"!=c||"number"==typeof a.style.length&&1<a.style.length||!/^[a-z\-]+:[^;]+;?\s?$/i.test(a.style.cssText)?!1:("b"==g||"strong"==g)&&""!=a.style.fontWeight||("i"==g||"em"==g)&&""!=a.style.fontStyle||("sub"==g||"sup"==g)&&""!=a.style.verticalAlign||
("span"==g||"font"==g)&&""!=a.style.fontSize||("a"==g||"font"==g||"span"==g)&&""==a.style.textDecoration||("h1"==g||"h2"==g||"h3"==g||"p"==g||"td"==g)&&""!=a.style.textAlign||/^(a|font|s|span|strike|u|del)$/.test(g)&&/^(line-through|underline|overline|none)$/.test(a.style.textDecoration)?!0:!1}function v(a,b,g,c){-1==g&&(g=b.childNodes.length);for(var d=a.parentNode,h=n.getNodeIndex(a),e=[],f=0,k=c.length;f<k;++f){var l=c[f],m=l.startContainer,p=l.startOffset,q=l.endContainer,w=l.endOffset,v=m,r=
p,u=q,y=w;m==b&&p>g&&r++;q==b&&w>g&&y++;m!=d||p!=h&&p!=h+1||(v=b,r+=g-h);q!=d||w!=h&&w!=h+1||(u=b,y+=g-h);m==d&&p>h+1&&r--;q==d&&w>h+1&&y--;v==m&&r==p&&u==q&&y==w&&e.push([l,v,r,u,y])}b.childNodes.length==g?b.appendChild(a):b.insertBefore(a,b.childNodes[g]);for(a=0;b=e[a++];)b[0].setStart(b[1],b[2]),b[0].setEnd(b[3],b[4])}function K(a,b){b=b||[];for(var g;g=a.next();)a.isPartiallySelectedSubtree()?(g=a.getSubtreeIterator(),K(g,b),g.detach(!0)):b.push(g);return b}function C(a,b,g,c,d){for(var h,e=
[];h=a.firstChild;)v(h,b,g++,d),e.push(h);c&&a.parentNode.removeChild(a);return e}function L(a,b){return C(a,a.parentNode,n.getNodeIndex(a),!0,b)}function M(a,b){for(var g=a.attributes,c=0,d=g.length;c<d;++c)g[c].specified&&("style"==g[c].name?b.style.cssText=b.style.cssText:b.setAttribute(g[c].name,g[c].value))}function N(a,b){var g=b.command,c=b.rangesToPreserve;if(null===g.getSpecifiedValue(a,b))return[];if(A(a,b))return L(a,c);g.clearValue&&g.clearValue(a,b);null!==g.relevantCssProperty&&(a.style[g.relevantCssProperty]=
"",""==a.style.cssText&&a.removeAttribute("style"));if(null===g.getSpecifiedValue(a,b))return[];g=n.getDocument(a).createElement("span");M(a,g);a.parentNode.insertBefore(g,a);C(a,g,0,!0,c);return[g]}function p(a,b,g){return null===b||null===g?b===g:a.valuesEqual(b,g)}function q(a,b){var g=1==a.nodeType;return g||a.parentNode&&1==a.parentNode.nodeType?g?b.command.getEffectiveValue(a,b):q(a.parentNode,b):null}function O(a,b,g,d){var e=a[0],f=d.options;d=d.rangesToPreserve;var t,k;if(!a.length||!l(e,
f))return null;var m=a[a.length-1];c(m)&&!h(m,"br")&&h(m.nextSibling,"br")&&a.push(m.nextSibling);var p=e.previousSibling,q=m.nextSibling;g=l(p,f)&&b(p)?p:l(q,f)&&b(q)?q:g();if(!g)return null;var p=n.getDocument(g),r=g.parentNode,q=e.parentNode;if(!r)for(q.insertBefore(g,e),t=0;k=d[t++];)k.startContainer==r&&k.startOffset==n.getNodeIndex(g)&&k.setStart(k.startContainer,k.startOffset+1),k.endContainer==r&&k.endOffset==n.getNodeIndex(g)&&k.setEnd(k.endContainer,k.endOffset+1);t=g.parentNode;k=e.parentNode;
t=t&&k?-1==n.comparePoints(g.parentNode,n.getNodeIndex(g),e.parentNode,n.getNodeIndex(e)):!t;if(t)for(!c(g)&&c(g.lastChild)&&c(e)&&!h(g.lastChild,"br")&&g.appendChild(p.createElement("br")),t=0,e=a.length;t<e;++t)v(a[t],g,-1,d);else for(!c(g)&&c(g.firstChild)&&c(m)&&!h(m,"br")&&g.insertBefore(p.createElement("br"),g.firstChild),t=a.length-1;0<=t;t--)v(a[t],g,0,d);l(q,f)&&!q.hasChildNodes()&&q.parentNode.removeChild(q);a=g.nextSibling;if(l(a,f)&&b(a)){for(!c(g)&&c(g.lastChild)&&c(a.firstChild)&&!h(g.lastChild,
"br")&&g.appendChild(p.createElement("br"));a.hasChildNodes();)v(a.firstChild,g,-1,d);g.parentNode.removeChild(a)}if(g&&1==g.nodeType&&!c(g)){b=g.previousSibling;var u;h(b,"br")&&c(u=g.previousSibling.previousSibling)&&!h(u,"br")&&g.parentNode.removeChild(b)}if(g&&1==g.nodeType&&!c(g)){u=g.lastChild;var w;2<=g.childNodes.length&&h(g.lastChild,"br")&&c(w=g.lastChild.previousSibling)&&!h(w,"br")&&g.removeChild(u)}return g}function P(a,b,g,c,d){for(var e=a[d],h=c.rangesToPreserve;F(e,c)&&1==e.childNodes.length&&
F(e.firstChild,c)&&(!A(e,c)||!p(b,b.getSpecifiedValue(e,c),g));)e=e.firstChild;A(e,c)&&p(b,b.getSpecifiedValue(e,c),g)&&p(b,q(e,c),g)&&e!=a[d]&&(C(e,e.parentNode,n.getNodeIndex(e),!1,h),a.parentNode.insertBefore(e,a[d]),v(e.nextSibling,e,e.childNodes.length,h))}function D(a,b,c){var d,e,h,f;d=a.nodeType;var k=c.command;e=c.rangesToPreserve;f=c.options;if(a.parentNode&&null!==b&&(/^(1|3|4|7)$/.test(""+d)&&!z(a,f)&&(P(a,k,b,c,"previousSibling"),P(a,k,b,c,"nextSibling"),O([a],function(a){return A(a,
c)&&p(k,k.getSpecifiedValue(a,c),b)&&p(k,q(a,c),b)},function(){return null},c)),!p(k,q(a,c),b)))if(z(a,f)){f=[];e=0;h=a.childNodes.length;for(l=null;e<h;++e){d=a.childNodes[e];if(1==d.nodeType&&(l=k.getSpecifiedValue(d,c),null!==l&&!p(k,b,l)))continue;f.push(d)}for(e=0;d=f[e++];)D(d,b,c)}else if(4!=d&&7!=d&&!p(k,q(a,c),b)&&(h=null,!f.styleWithCss&&k.createNonCssElement&&(h=k.createNonCssElement(a,b,c)),h||(h=k.createCssElement?k.createCssElement(n.getDocument(a),c):n.getDocument(a).createElement("span")),
a.parentNode.insertBefore(h,a),f=k.relevantCssProperty,null===f||p(k,q(h,c),b)||(h.style[f]=b),k.styleCssElement&&k.styleCssElement(h,b),v(a,h,h.childNodes.length,e),1==d&&!p(k,q(a,c),b)))if(v(a,h.parentNode,n.getNodeIndex(h),e),h.parentNode.removeChild(h),"span"==h.tagName.toLowerCase()&&(k.hasSpecialSpanStyling&&k.hasSpecialSpanStyling(b)||null!==f))null!==f&&(a.style[f]=b),k.styleSpanChildElement&&k.styleSpanChildElement(a,b);else{f=[];var l;e=0;for(h=a.childNodes.length;e<h;++e){d=a.childNodes[e];
if(1==d.nodeType&&(l=k.getSpecifiedValue(d,c),null!==l&&!p(k,b,l)))continue;f.push(d)}e=0;for(h=f.length;e<h;++e)D(f[e],b,c)}}function Q(a,b){for(var c=B(a.childNodes),d=0,e=c.length;d<e;++d)E(c[d],b)}function E(a,b){var c,d;c=a.nodeType;if(9==c)for(c=0;c<a.childNodes.length;++c){if(d=a.childNodes[c],1==d.nodeType){E(d,b);break}}else if(11==c)Q(a,b);else if(a.parentNode&&10!=c&&!J(a,b.options)){if(l(a,b.options)){if(1==c){var e=N(a,b);c=0;for(d=e.length;c<d;++c)E(e[c],b);if(!a.parentNode)return}c=
b.command;var h=b.value,e=b.options;if((d=a.parentNode)&&1==d.nodeType&&!p(c,q(a,b),h)){var f=d;for(d=[];l(f,e)&&1==f.nodeType&&!p(c,q(f,b),h);)d.push(f),f=f.parentNode;if(0!=d.length){var e=d[d.length-1],k=c.getSpecifiedValue(e,b);if(null!==k||k==h)if(null===h||p(c,q(e.parentNode,b),h))for(;d.length;){f=d.pop();null!==c.getSpecifiedValue(f,b)&&(k=c.getSpecifiedValue(f,b));h=B(f.childNodes);null!==c.getSpecifiedValue(f,b)&&N(f,b);for(var f=0,m;m=h[f++];)m!=a&&(1!=m.nodeType||null===c.getSpecifiedValue(m,
b)||p(c,k,c.getSpecifiedValue(m,b)))&&m!=e&&D(m,k,b)}}}D(a,b.value,b)}Q(a,b)}}function r(){}function G(a){var b=a.toLowerCase();if(H.hasOwnProperty(b))return H[b];throw m.createError("getCommand(): No command registered with the name '"+a+"'");}f.requireModules(["WrappedSelection","WrappedRange"]);var n=f.dom,I=n.getRootContainer,u;"undefined"!=typeof window.getComputedStyle?u=function(a,b){return n.getWindow(a).getComputedStyle(a,null)[b]}:"undefined"!=typeof document.documentElement.currentStyle?
u=function(a,b){return a.currentStyle[b]}:m.fail("No means of obtaining computed style properties found");var B;(function(){var a=document.createElement("div");a.appendChild(document.createElement("span"));var b=Array.prototype.slice;try{1==b.call(a.childNodes,0)[0].nodeType&&(B=function(a){return b.call(a,0)})}catch(c){}B||(B=function(a){for(var b=0,c=a.length,d=[];b<c;++b)d[b]=a[b];return d})})();var S=/^(h[1-6]|p|hr|pre|blockquote|ol|ul|li|dl|dt|dd|div|table|caption|colgroup|col|tbody|thead|tfoot|tr|th|td|address)$/i,
R=/^inline(-block|-table)?$/i,T=/^(b|em|i|s|span|strike|strong|sub|sup|u|del)$/,U=/^(b|em|i|s|span|strike|strong|sub|sup|u|del|a|font|h1|h2|h3|h4|h5|h6|p|hr|pre|blockquote|ol|ul|li|dl|dt|dd|div|table|caption|colgroup|col|tbody|thead|tfoot|tr|th|td|address)$/;r.prototype={relevantCssProperty:null,getSpecifiedValue:function(){return null},clearValue:function(){},getEffectiveValue:function(a,b){return u(a,this.relevantCssProperty)},createCssElement:null,createNonCssElement:null,styleCssElement:null,
hasSpecialSpanStyling:null,styleSpanChildElement:null,isSimpleModifiableElement:null,defaultOptions:null,addDefaultOptions:null,valuesEqual:function(a,b){return a===b},createContext:function(a,b,c){var d=this.defaultOptions;if(d)for(var e in d)d.hasOwnProperty(e)&&!c.hasOwnProperty(e)&&(c[e]=d[e]);return{command:this,value:a,rangesToPreserve:b||[],options:c||{}}},getSelectionValue:function(){return null},getNewRangeValue:function(){return null},getNewSelectionValue:function(){return null},applyToRange:function(a,
b,c,d){a=this.createContext(b,[d],c);a.value=this.getNewRangeValue(d,a);this.applyValueToRange(d,a)},applyToSelection:function(a,b,c){a=n.getWindow(a);a=f.getSelection(a);var d=a.getAllRanges();b=this.createContext(b,d,c);b.value=this.getNewSelectionValue(a,b);c=0;for(var e=d.length;c<e;++c)this.applyValueToRange(d[c],b);a.setRanges(d)}};r.util={getComputedStyleProperty:u,getFurthestAncestor:function(a){for(;null!=a.parentNode;)a=a.parentNode;return a},isContained:e,isEffectivelyContained:b,isHtmlNode:a,
isHtmlElement:h,isInlineNode:c,isUnwrappable:z,blockExtend:function(a){for(var b=a.startContainer,c=a.startOffset,e=a.endContainer,h=a.endOffset,f,k;;)if(n.isCharacterDataNode(b)||0==c)c=n.getNodeIndex(b),b=b.parentNode;else if(c==n.getNodeLength(b))c=1+n.getNodeIndex(b),b=b.parentNode;else if((f=b.childNodes[c])&&d(f)&&d(f.previousSibling))c--;else break;for(;;)if(0==h)h=n.getNodeIndex(e),e=e.parentNode;else if(n.isCharacterDataNode(e)||h==n.getNodeLength(e))h=1+n.getNodeIndex(e),e=e.parentNode;
else if((k=e.childNodes[h])&&d(k)&&d(k.previousSibling))h++;else break;a=a.cloneRange();a.setStart(b,c);a.setEnd(e,h);return a},isModifiableElement:F,isSimpleModifiableElement:A,moveChildrenPreservingRanges:C,replaceWithOwnChildren:L,copyAttributes:M,getEffectiveValue:q,getEffectiveTextNodes:function(a,c){return a.getNodes([3],function(d){return b(d,a)&&!J(d,c.options)})},setNodeValue:E,wrap:O,decomposeRange:function(a,b){if(a.startContainer==a.endContainer&&a.startOffset==a.endOffset)return[];a.splitBoundaries(b);
for(var c=a.cloneRange();0==c.startOffset&&c.startContainer.parentNode;)c.setStart(c.startContainer.parentNode,n.getNodeIndex(c.startContainer));for(;c.endOffset==n.getNodeLength(c.endContainer)&&c.endContainer.parentNode;)c.setEnd(c.endContainer.parentNode,1+n.getNodeIndex(c.endContainer));var c=new rangy.DomRange.RangeIterator(c,!1),d=K(c);c.detach();return d},setGlobalOption:function(a,b){}};r.create=function(a,b){var c=new r;a.prototype=c;if("object"==typeof b)for(var d in b)b.hasOwnProperty(d)&&
(c[d]=b[d])};var H={};f.registerCommand=function(a,b){if(!(b instanceof r))throw m.createError("registerCommand(): Object supplied is not a Command");H[a.toLowerCase()]=b};f.execCommand=function(a,b,c){b=b||{};var d=b.hasOwnProperty("document")?b.document:document,e=b.hasOwnProperty("value")?b.value:null;a=G(a);c?a.applyToRange(d,e,b,c):a.applyToSelection(d,e,b)};f.queryCommandValue=function(a,b,c){b=b||{};var d=b.hasOwnProperty("document")?n.getWindow(b.document):window;c=b.hasOwnProperty("value")?
b.value:null;a=G(a);d=f.getSelection(d);b=a.createContext(c,null,b);return a.getSelectionValue(d,b)};f.getCommand=G;f.Command=r});function getRangeCorrectly(f,m){var k=[];try{for(var l=m.startContainer,e=m.endContainer,b=f.length,a=!1,c=0;c<b;c++)a=!1,0==c&&1<b?3==l.nodeType&&m.startOffset==l.length&&(a=!0):c==b-1&&1<b&&3==e.nodeType&&0==m.endOffset&&(a=!0),0==a&&k.push(f[c])}catch(d){return f}return k}
rangy.createModule("BoldCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{relevantCssProperty:"fontWeight",defaultOptions:{tagName:"b",ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.fontWeight||(/^(strong|b)$/i.test(b.tagName)?"bold":null)},valuesEqual:function(b,a){b=(""+b).toLowerCase();a=(""+a).toLowerCase();return b==a||"bold"==b&&"700"==a||"bold"==a&&"700"==b||"normal"==b&&"400"==a||"normal"==a&&"400"==b},createNonCssElement:function(b,
a,c){return"bold"==a||"700"==a?l.getDocument(b).createElement(c.options.tagName):null},isBoldCssValue:function(b){return/^(bold|700|800|900)$/.test(b)},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,a),d=c.length,h;if(0==c.length)return this.isBoldCssValue(e.getEffectiveValue(b.commonAncestorContainer,a));for(;d--;)if(h=e.getEffectiveValue(c[d],a),!this.isBoldCssValue(h))return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],
a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"normal":"bold"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"normal":"bold"},applyValueToRange:function(b,a){for(var c=e.decomposeRange(b,a.rangesToPreserve),c=getRangeCorrectly(c,a.rangesToPreserve[0]),d=0,h=c.length;d<h;++d)e.setNodeValue(c[d],a)}});f.registerCommand("bold",new k)});
rangy.createModule("ItalicCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{relevantCssProperty:"fontStyle",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.fontStyle||(/^(em|i)$/i.test(b.tagName)?"italic":null)},createNonCssElement:function(b,a){return"italic"==a?l.getDocument(b).createElement("i"):null},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,a),d=c.length,h;if(0==c.length)return"italic"==
e.getEffectiveValue(b.commonAncestorContainer,a);for(;d--;)if(h=e.getEffectiveValue(c[d],a),"italic"!=h)return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"normal":"italic"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"normal":"italic"},applyValueToRange:function(b,a){for(var c=e.decomposeRange(b,a.rangesToPreserve),
c=getRangeCorrectly(c,a.rangesToPreserve[0]),d=0,h=c.length;d<h;++d)e.setNodeValue(c[d],a)}});f.registerCommand("italic",new k)});
rangy.createModule("UnderlineCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{relevantCssProperty:"textDecoration",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.textDecoration||(/^(u)$/i.test(b.tagName)?"underline":null)},createNonCssElement:function(b,a){return"underline"==a?l.getDocument(b).createElement("u"):null},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,a),d=c.length,h;if(0==
c.length)return"underline"==e.getEffectiveValue(b.commonAncestorContainer,a);for(;d--;)if(h=e.getEffectiveValue(c[d],a),"underline"!=h)return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"none":"underline"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"none":"underline"},applyValueToRange:function(b,a){for(var c=
e.decomposeRange(b,a.rangesToPreserve),c=getRangeCorrectly(c,a.rangesToPreserve[0]),d=0,h=c.length;d<h;++d)e.setNodeValue(c[d],a)}});f.registerCommand("underline",new k)});
rangy.createModule("StrikeThroughCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{relevantCssProperty:"textDecoration",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.textDecoration||(/^(strike|del)$/i.test(b.tagName)?"line-through":null)},createNonCssElement:function(b,a){return"line-through"==a?l.getDocument(b).createElement("strike"):null},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,
a),d=c.length,h;if(0==c.length)return"line-through"==e.getEffectiveValue(b.commonAncestorContainer,a);for(;d--;)if(h=e.getEffectiveValue(c[d],a),"line-through"!=h)return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"none":"line-through"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"none":"line-through"},applyValueToRange:function(b,
a){for(var c=e.decomposeRange(b,a.rangesToPreserve),c=getRangeCorrectly(c,a.rangesToPreserve[0]),d=0,h=c.length;d<h;++d)e.setNodeValue(c[d],a)}});f.registerCommand("strikeThrough",new k)});
rangy.createModule("SuperScriptCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{relevantCssProperty:"verticalAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.verticalAlign||(/^(sup|sub)$/i.test(b.tagName)?"super":null)},createNonCssElement:function(b,a){return"super"==a?l.getDocument(b).createElement("sup"):null},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,a),d=c.length,h;if(0==
c.length)return"super"==e.getEffectiveValue(b.commonAncestorContainer,a);for(;d--;)if(h=e.getEffectiveValue(c[d],a),"super"!=h)return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"baseline":"super"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"baseline":"super"},applyValueToRange:function(b,a){for(var c=e.decomposeRange(b,
a.rangesToPreserve),c=getRangeCorrectly(c,a.rangesToPreserve[0]),d=0,h=c.length;d<h;++d)e.setNodeValue(c[d],a)}});f.registerCommand("superscript",new k)});
rangy.createModule("SubScriptCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{relevantCssProperty:"verticalAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.verticalAlign||(/^(sub|sup)$/i.test(b.tagName)?"sub":null)},createNonCssElement:function(b,a){return"sub"==a?l.getDocument(b).createElement("sub"):null},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,a),d=c.length,h;if(0==c.length)return"sub"==
e.getEffectiveValue(b.commonAncestorContainer,a);for(;d--;)if(h=e.getEffectiveValue(c[d],a),"sub"!=h)return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"baseline":"sub"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"baseline":"sub"},applyValueToRange:function(b,a){for(var c=e.decomposeRange(b,a.rangesToPreserve),
c=getRangeCorrectly(c,a.rangesToPreserve[0]),d=0,h=c.length;d<h;++d)e.setNodeValue(c[d],a)}});f.registerCommand("subscript",new k)});
rangy.createModule("JustifyLeftCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{relevantCssProperty:"textAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.textAlign||(/^(p)$/i.test(b.tagName)?"left":null)},createNonCssElement:function(b,a){return"left"==a?l.getDocument(b).createElement("p"):null},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,a),d=c.length,h;if(0==c.length)return"left"==
e.getEffectiveValue(b.commonAncestorContainer,a);for(;d--;)if(h=e.getEffectiveValue(c[d],a),"left"!=h)return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"":"left"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"":"left"},applyValueToRange:function(b,a){for(var c=e.decomposeRange(b,a.rangesToPreserve),c=getRangeCorrectly(c,
a.rangesToPreserve[0]),d=0,h=c.length;d<h;++d)e.setNodeValue(c[d],a)}});f.registerCommand("justifyLeft",new k)});
rangy.createModule("JustifyCenterCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{relevantCssProperty:"textAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.textAlign||(/^(p)$/i.test(b.tagName)?"center":null)},createNonCssElement:function(b,a){return"center"==a?l.getDocument(b).createElement("p"):null},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,a),d=c.length,h;if(0==c.length)return"center"==
e.getEffectiveValue(b.commonAncestorContainer,a);for(;d--;)if(h=e.getEffectiveValue(c[d],a),"center"!=h)return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"":"center"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"":"center"},applyValueToRange:function(b,a){for(var c=e.decomposeRange(b,a.rangesToPreserve),c=getRangeCorrectly(c,
a.rangesToPreserve[0]),d=0,f=c.length;d<f;++d)e.setNodeValue(c[d],a)}});f.registerCommand("justifyCenter",new k)});
rangy.createModule("FontsizeCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{relevantCssProperty:"fontSize",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.fontSize||(/^(font)$/i.test(b.tagName)?"fontSize":null)},createNonCssElement:function(b,a){return"fontsize"!=a?l.getDocument(b).createElement("span"):null},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,a),d=c.length,f;if(0==c.length)return"fontsize"==
e.getEffectiveValue(b.commonAncestorContainer,a);for(;d--;)if(f=e.getEffectiveValue(c[d],a),f!=a.options.fontsize)return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],a))return!1;return 0<e},getNewRangeValue:function(b,a){return a.options.fontsize},getNewSelectionValue:function(b,a){return a.options.fontsize},applyValueToRange:function(b,a){for(var c=e.decomposeRange(b,a.rangesToPreserve),c=getRangeCorrectly(c,a.rangesToPreserve[0]),
d=0,f=c.length;d<f;++d)e.setNodeValue(c[d],a)}});f.registerCommand("fontsize",new k)});
rangy.createModule("FontfamilyCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{relevantCssProperty:"fontFamily",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.fontFamily||(/^(font)$/i.test(b.tagName)?"fontFamily":null)},createNonCssElement:function(b,a){return"fontFamily"!=a?l.getDocument(b).createElement("span"):null},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,a),d=c.length,f;if(0==
c.length)return"fontFamily"==e.getEffectiveValue(b.commonAncestorContainer,a);for(;d--;)if(f=e.getEffectiveValue(c[d],a),f!=a.options.fontfamily)return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],a))return!1;return 0<e},getNewRangeValue:function(b,a){return a.options.fontfamily},getNewSelectionValue:function(b,a){return a.options.fontfamily},applyValueToRange:function(b,a){for(var c=e.decomposeRange(b,a.rangesToPreserve),
c=getRangeCorrectly(c,a.rangesToPreserve[0]),d=0,f=c.length;d<f;++d)e.setNodeValue(c[d],a)}});f.registerCommand("fontfamily",new k)});
rangy.createModule("FontcolorCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{relevantCssProperty:"color",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.color||(/^(font)$/i.test(b.tagName)?"color":null)},createNonCssElement:function(b,a){return"color"!=a?l.getDocument(b).createElement("span"):null},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,a),d=c.length,f;if(0==c.length)return"color"==
e.getEffectiveValue(b.commonAncestorContainer,a);for(;d--;)if(f=e.getEffectiveValue(c[d],a),f!=a.options.fontfamily)return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"":a.options.fontcolor},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"":a.options.fontcolor},applyValueToRange:function(b,a){for(var c=e.decomposeRange(b,
a.rangesToPreserve),c=getRangeCorrectly(c,a.rangesToPreserve[0]),d=0,f=c.length;d<f;++d)e.setNodeValue(c[d],a)}});f.registerCommand("fontcolor",new k)});
rangy.createModule("FontBgcolorCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{relevantCssProperty:"backgroundColor",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.backgroundColor||(/^(font)$/i.test(b.tagName)?"backgroundColor":null)},createNonCssElement:function(b,a){return"backgroundColor"!=a?l.getDocument(b).createElement("span"):null},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,
a),d=c.length,f;if(0==c.length)return"backgroundColor"==e.getEffectiveValue(b.commonAncestorContainer,a);for(;d--;)if(f=e.getEffectiveValue(c[d],a),f!=a.options.fontfamily)return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"":a.options.fontcolor},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"":a.options.fontcolor},
applyValueToRange:function(b,a){for(var c=e.decomposeRange(b,a.rangesToPreserve),c=getRangeCorrectly(c,a.rangesToPreserve[0]),d=0,f=c.length;d<f;++d)e.setNodeValue(c[d],a)}});f.registerCommand("fontbgcolor",new k)});
rangy.createModule("LineHeightCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{relevantCssProperty:"lineHeight",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.lineHeight?"lineHeight":null},createNonCssElement:function(b,a){return"lineHeight"!=a?l.getDocument(b).createElement("span"):null},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,a),d=c.length,f;if(0==c.length)return"lineHeight"==
e.getEffectiveValue(b.commonAncestorContainer,a);for(;d--;)if(f=e.getEffectiveValue(c[d],a),f!=a.options.lineheight)return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],a))return!1;return 0<e},getNewRangeValue:function(b,a){return a.options.lineheight},getNewSelectionValue:function(b,a){return a.options.lineheight},applyValueToRange:function(b,a){for(var c=e.decomposeRange(b,a.rangesToPreserve),c=getRangeCorrectly(c,a.rangesToPreserve[0]),
d=0,f=c.length;d<f;++d)e.setNodeValue(c[d],a)}});f.registerCommand("lineheight",new k)});
rangy.createModule("FormattingCommand",function(f,m){function k(){}f.requireModules(["Commands"]);var l=f.dom,e=f.Command.util;f.Command.create(k,{defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return/^(h1|h2|h3|h4|h5)$/i.test(b.tagName)?"formatting":null},createNonCssElement:function(b,a,c){return"formatting"==a?l.getDocument(b).createElement(c.options.tagName):null},getRangeValue:function(b,a){var c=e.getEffectiveTextNodes(b,a),d=c.length,f;if(0==c.length)return"formatting"==
e.getEffectiveValue(b.commonAncestorContainer,a);for(;d--;)if(f=e.getEffectiveValue(c[d],a),"formatting"!=f)return!1;return!0},getSelectionValue:function(b,a){for(var c=b.getAllRanges(),d=0,e=c.length;d<e;++d)if(!this.getRangeValue(c[d],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"":"formatting"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"":"formatting"},applyValueToRange:function(b,a){for(var c=e.decomposeRange(b,a.rangesToPreserve),
c=getRangeCorrectly(c,a.rangesToPreserve[0]),d=0,f=c.length;d<f;++d)e.setNodeValue(c[d],a)}});f.registerCommand("formatting",new k)});rangy.createModule("Util",function(f,m){f.requireModules(["WrappedSelection","WrappedRange"]);var k=f.rangePrototype,l=f.selectionPrototype;k.select=function(e){f.getSelection(this.getDocument()).setSingleRange(this,e)};l.pasteText=function(e){this.deleteFromDocument();var b=this.getRangeAt(0);e=b.getDocument().createTextNode(e);b.insertNode(e);this.setSingleRange(b)};k.pasteText=function(e){this.deleteContents();e=this.getDocument().createTextNode(e);this.insertNode(e)};l.pasteHtml=function(e){this.deleteFromDocument();
var b=this.getRangeAt(0);e=this.createContextualFragment(e);var a=e.lastChild;b.insertNode(e);a&&b.setStartAfter(a);this.setSingleRange(b)};k.pasteHtml=function(e){this.deleteContents();e=this.createContextualFragment(e);this.insertNode(e)};l.selectNodeContents=function(e){var b=f.createRange(this.win);b.selectNodeContents(e);this.setSingleRange(b)};f.createRangeFromNode=function(e){var b=f.createRange(e);b.selectNode(e);return b};f.createRangeFromNodeContents=function(e){var b=f.createRange(e);b.selectNodeContents(e);
return b}});

