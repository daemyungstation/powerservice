<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="PS250300" classname="캠페인관리" inheritanceid="" position="absolute 0 0 989 795" titletext="월간교육평가결과" onload="PS250300_onload">
    <Layouts>
      <Layout>
        <Tab id="Tab00" taborder="0" tabindex="0" scrollbars="autoboth" position2="absolute l:0 r:1 t:8 b:12" positiontype="position2">
          <Tabpages>
            <Tabpage id="tabpage1" text="상담사별">
              <Layouts>
                <Layout>
                  <Static id="stc_04" class="sta_workSrcBg" position2="absolute l:10 r:9 t:7px h:42" positiontype="position2">
                    <Layouts>
                      <Layout width="989" height="42"/>
                    </Layouts>
                  </Static>
                  <Static id="stc05" text="교육년월" class="sta_workSrcLabel1" position2="absolute l:30 w:92 t:18 h:20" positiontype="position2"/>
                  <Static id="stc00" text="상담그룹" class="sta_workSrcLabel1" position2="absolute l:209 w:63 t:18 h:20" positiontype="position2"/>
                  <Calendar id="cal_startd" taborder="3" dateformat="yyyy-MM" editformat="yyyy-MM" value="null" position2="absolute l:93 w:95 t:17 h:20" positiontype="position2"/>
                  <Grid id="Grid00" taborder="5" binddataset="ds_list_edctTrprResult" autoenter="select" useinputpanel="false" autofittype="col" position2="absolute l:10 r:10 t:91 b:8" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="219"/>
                          <Column size="81"/>
                          <Column size="106"/>
                          <Column size="99"/>
                        </Columns>
                        <Rows>
                          <Row size="25" band="head"/>
                          <Row size="25"/>
                          <Row size="24" band="summary"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="팀"/>
                          <Cell col="1" text="사원번호"/>
                          <Cell col="2" text="상담사"/>
                          <Cell col="3" text="교육유형"/>
                          <Cell col="4" text="교육과정명"/>
                          <Cell col="5" text="교육일자"/>
                          <Cell col="6" text="교육시간(H)"/>
                          <Cell col="7" text="평가점수"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:team_nm" suppress="1"/>
                          <Cell col="1" displaytype="normal" edittype="none" text="bind:empl_no" suppress="2"/>
                          <Cell col="2" displaytype="normal" edittype="none" text="bind:user_nm" suppress="2"/>
                          <Cell col="3" displaytype="normal" edittype="none" text="bind:edct_typ_nm"/>
                          <Cell col="4" displaytype="normal" edittype="none" style="align:left middle;" text="bind:edct_crs_nm"/>
                          <Cell col="5" displaytype="normal" edittype="none" text="bind:edct_stt_dt" calendardisplaynulltype="nullmask" subsumtext="소계"/>
                          <Cell col="6" displaytype="normal" text="bind:edct_atnc_hr_new"/>
                          <Cell col="7" text="bind:edct_cmcr_scr"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="6" text="합계" taborder="undefined"/>
                          <Cell col="6" displaytype="normal" text="expr:totalTime"/>
                          <Cell col="7" text="expr:getSum(&quot;edct_cmcr_scr&quot;)"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Button id="btn_Search" taborder="7" onclick="btn_search_onclick" class="btn_WF_Search" tooltiptext="조회" style="padding:0 0 0 0;shadow:drop 0,0 0 transparent;" position2="absolute r:103 w:72 t:17px h:20" positiontype="position2"/>
                  <Button id="btn_Init" taborder="8" onclick="btn_Init_onclick" class="btn_WF_Return" tooltiptext="초기화" style="padding:0 0 0 0;" position2="absolute r:29 w:72 t:17px h:20" positiontype="position2"/>
                  <Button id="btn_excel" taborder="9" text="엑셀다운" onclick="btn_excel_onclick" class="btn_WF_Common" tooltiptext="엑셀다운" style="padding:0 0 0 0;" position2="absolute r:9 w:72 t:68px h:20" positiontype="position2"/>
                  <Combo id="cbo_srch_hgrn_team_cd" taborder="10" innerdataset="@ds_hgrnTeamCd" codecolumn="team_cd" datacolumn="team_nm" onitemchanged="cbo_onitemchanged" position2="absolute l:272 w:121 t:17 h:20" positiontype="position2" displaynulltext="전체"/>
                  <Combo id="cbo_srch_team_cd" taborder="11" displaynulltext="전체" innerdataset="@ds_teamCd" codecolumn="team_cd" datacolumn="team_nm" onitemchanged="cbo_onitemchanged" position2="absolute l:395 w:121 t:17 h:20" positiontype="position2"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage2" text="과정별">
              <Layouts>
                <Layout>
                  <Static id="stc_04" class="sta_workSrcBg" position2="absolute l:10 r:9 t:7px h:42" positiontype="position2">
                    <Layouts>
                      <Layout width="989" height="42"/>
                    </Layouts>
                  </Static>
                  <Static id="stc05" text="교육년월" class="sta_workSrcLabel1" position2="absolute l:30 w:92 t:18 h:20" positiontype="position2"/>
                  <Static id="stc00" text="교육유형" class="sta_workSrcLabel1" position2="absolute l:209 w:63 t:18 h:20" positiontype="position2"/>
                  <Grid id="Grid00" taborder="4" binddataset="ds_list_processEdctTrprResult" autoenter="select" useinputpanel="false" autofittype="col" position2="absolute l:10 r:10 t:91 b:10" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="140"/>
                          <Column size="70"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="104"/>
                          <Column size="65"/>
                          <Column size="80"/>
                          <Column size="99"/>
                          <Column size="90"/>
                          <Column size="94"/>
                        </Columns>
                        <Rows>
                          <Row size="25" band="head"/>
                          <Row size="25"/>
                          <Row size="24" band="summary"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="교육과정명"/>
                          <Cell col="1" text="교육일자"/>
                          <Cell col="2" text="강사"/>
                          <Cell col="3" text="교육장소"/>
                          <Cell col="4" text="교육대상"/>
                          <Cell col="5" text="팀"/>
                          <Cell col="6" text="사원번호"/>
                          <Cell col="7" text="상담사"/>
                          <Cell col="8" text="교육시간(H)"/>
                          <Cell col="9" text="평가점수"/>
                        </Band>
                        <Band id="body">
                          <Cell style="align:left middle;" text="bind:edct_crs_nm" displayexpdec="-1" suppress="1"/>
                          <Cell col="1" displaytype="normal" edittype="none" text="bind:edct_stt_dt" editdisplay="edit" suppress="1" calendardisplaynulltype="none"/>
                          <Cell col="2" displaytype="normal" edittype="none" text="bind:edct_lctr_nm" suppress="1" combodisplay="edit"/>
                          <Cell col="3" displaytype="normal" edittype="none" text="bind:edct_plc_nm" suppress="1" calendardisplay="edit"/>
                          <Cell col="4" displaytype="normal" edittype="none" text="bind:edct_trgt_nm" suppress="1"/>
                          <Cell col="5" text="bind:team_nm" suppress="1"/>
                          <Cell col="6" text="bind:empl_no"/>
                          <Cell col="7" text="bind:user_nm" subsumtext="소계"/>
                          <Cell col="8" displaytype="normal" text="bind:edct_atnc_hr_new"/>
                          <Cell col="9" text="bind:edct_cmcr_scr"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="8" text="합계" taborder="undefined"/>
                          <Cell col="8" text="expr:totalTime2"/>
                          <Cell col="9" text="expr:getSum(&quot;edct_cmcr_scr&quot;)"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Button id="btn_Search" taborder="6" onclick="btn_search_onclick2" class="btn_WF_Search" tooltiptext="조회" style="padding:0 0 0 0;shadow:drop 0,0 0 transparent;" position2="absolute r:103 w:72 t:17px h:20" positiontype="position2"/>
                  <Button id="btn_Init" taborder="7" onclick="btn_Init_onclick2" class="btn_WF_Return" tooltiptext="초기화" style="padding:0 0 0 0;" position2="absolute r:29 w:72 t:17px h:20" positiontype="position2"/>
                  <Button id="btn_excel2" taborder="8" text="엑셀다운" onclick="btn_excel_onclick2" class="btn_WF_Common" tooltiptext="엑셀다운" style="padding:0 0 0 0;" position2="absolute r:9 w:72 t:68px h:20" positiontype="position2"/>
                  <Combo id="cbo_srch_typ_cd" taborder="9" innerdataset="@ds_TypCd" codecolumn="cd" datacolumn="cd_nm" position2="absolute l:272 w:142 t:17 h:20" positiontype="position2"/>
                  <Calendar id="cal_startd" taborder="10" dateformat="yyyy-MM" editformat="yyyy-MM" position2="absolute l:93 w:95 t:17 h:20" positiontype="position2"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
      </Layout>
    </Layouts>
    <Bind/>
    <Objects>
      <Dataset id="ds_teamCd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="team_cd" type="STRING" size="256"/>
          <Column id="team_nm" type="STRING" size="256"/>
          <Column id="hgrn_team_cd" type="STRING" size="256"/>
          <Column id="team_lvl_cnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_allTeamCd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_hgrnTeamCd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="team_cd" type="STRING" size="256"/>
          <Column id="team_nm" type="STRING" size="256"/>
          <Column id="hgrn_team_cd" type="STRING" size="256"/>
          <Column id="team_lvl_cnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="edct_crs_id" type="STRING" size="256"/>
          <Column id="user_id" type="STRING" size="256"/>
          <Column id="team1_cd" type="STRING" size="256"/>
          <Column id="team2_cd" type="STRING" size="256"/>
          <Column id="eduSelectcheck" type="STRING" size="256"/>
          <Column id="edct_prgr_stat_cd" type="STRING" size="256"/>
          <Column id="edct_atnc_dt" type="STRING" size="256"/>
          <Column id="edct_atnc_stt_hr_cd" type="STRING" size="256"/>
          <Column id="edct_atnc_end_hr_cd" type="STRING" size="256"/>
          <Column id="startd" type="STRING" size="256"/>
          <Column id="edct_typ_cd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_temp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_time" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="cd"/>
            <Col id="cd_nm">00시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">0010</Col>
            <Col id="cd_nm">00시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">0020</Col>
            <Col id="cd_nm">00시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">0030</Col>
            <Col id="cd_nm">00시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">0040</Col>
            <Col id="cd_nm">00시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">0050</Col>
            <Col id="cd_nm">00시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">0100</Col>
            <Col id="cd_nm">01시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">0110</Col>
            <Col id="cd_nm">01시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">0120</Col>
            <Col id="cd_nm">01시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">0130</Col>
            <Col id="cd_nm">01시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">0140</Col>
            <Col id="cd_nm">01시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">0150</Col>
            <Col id="cd_nm">01시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">0200</Col>
            <Col id="cd_nm">02시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">0210</Col>
            <Col id="cd_nm">02시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">0220</Col>
            <Col id="cd_nm">02시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">0230</Col>
            <Col id="cd_nm">02시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">0240</Col>
            <Col id="cd_nm">02시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">0250</Col>
            <Col id="cd_nm">02시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">0300</Col>
            <Col id="cd_nm">03시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">0310</Col>
            <Col id="cd_nm">03시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">0320</Col>
            <Col id="cd_nm">03시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">0330</Col>
            <Col id="cd_nm">03시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">0340</Col>
            <Col id="cd_nm">03시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">0350</Col>
            <Col id="cd_nm">03시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">0400</Col>
            <Col id="cd_nm">04시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">0410</Col>
            <Col id="cd_nm">04시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">0420</Col>
            <Col id="cd_nm">04시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">0430</Col>
            <Col id="cd_nm">04시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">0440</Col>
            <Col id="cd_nm">04시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">0450</Col>
            <Col id="cd_nm">04시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">0500</Col>
            <Col id="cd_nm">05시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">0510</Col>
            <Col id="cd_nm">05시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">0520</Col>
            <Col id="cd_nm">05시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">0530</Col>
            <Col id="cd_nm">05시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">0540</Col>
            <Col id="cd_nm">05시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">0550</Col>
            <Col id="cd_nm">05시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">0600</Col>
            <Col id="cd_nm">06시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">0610</Col>
            <Col id="cd_nm">06시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">0620</Col>
            <Col id="cd_nm">06시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">0630</Col>
            <Col id="cd_nm">06시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">0640</Col>
            <Col id="cd_nm">06시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">0650</Col>
            <Col id="cd_nm">06시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">0700</Col>
            <Col id="cd_nm">07시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">0710</Col>
            <Col id="cd_nm">07시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">0720</Col>
            <Col id="cd_nm">07시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">0730</Col>
            <Col id="cd_nm">07시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">0740</Col>
            <Col id="cd_nm">07시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">0750</Col>
            <Col id="cd_nm">07시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">0800</Col>
            <Col id="cd_nm">08시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">0810</Col>
            <Col id="cd_nm">08시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">0820</Col>
            <Col id="cd_nm">08시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">0830</Col>
            <Col id="cd_nm">08시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">0840</Col>
            <Col id="cd_nm">08시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">0850</Col>
            <Col id="cd_nm">08시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">0900</Col>
            <Col id="cd_nm">09시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">0910</Col>
            <Col id="cd_nm">09시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">0920</Col>
            <Col id="cd_nm">09시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">0930</Col>
            <Col id="cd_nm">09시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">0940</Col>
            <Col id="cd_nm">09시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">0950</Col>
            <Col id="cd_nm">09시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">1000</Col>
            <Col id="cd_nm">10시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">1010</Col>
            <Col id="cd_nm">10시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">1020</Col>
            <Col id="cd_nm">10시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">1030</Col>
            <Col id="cd_nm">10시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">1040</Col>
            <Col id="cd_nm">10시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">1050</Col>
            <Col id="cd_nm">10시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">1100</Col>
            <Col id="cd_nm">11시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">1110</Col>
            <Col id="cd_nm">11시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">1120</Col>
            <Col id="cd_nm">11시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">1130</Col>
            <Col id="cd_nm">11시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">1140</Col>
            <Col id="cd_nm">11시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">1150</Col>
            <Col id="cd_nm">11시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">1200</Col>
            <Col id="cd_nm">12시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">1210</Col>
            <Col id="cd_nm">12시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">1220</Col>
            <Col id="cd_nm">12시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">1230</Col>
            <Col id="cd_nm">12시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">1240</Col>
            <Col id="cd_nm">12시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">1250</Col>
            <Col id="cd_nm">12시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">1300</Col>
            <Col id="cd_nm">13시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">1310</Col>
            <Col id="cd_nm">13시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">1320</Col>
            <Col id="cd_nm">13시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">1330</Col>
            <Col id="cd_nm">13시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">1340</Col>
            <Col id="cd_nm">13시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">1350</Col>
            <Col id="cd_nm">13시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">1400</Col>
            <Col id="cd_nm">14시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">1410</Col>
            <Col id="cd_nm">14시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">1420</Col>
            <Col id="cd_nm">14시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">1430</Col>
            <Col id="cd_nm">14시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">1440</Col>
            <Col id="cd_nm">14시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">1450</Col>
            <Col id="cd_nm">14시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">1500</Col>
            <Col id="cd_nm">15시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">1510</Col>
            <Col id="cd_nm">15시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">1520</Col>
            <Col id="cd_nm">15시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">1530</Col>
            <Col id="cd_nm">15시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">1540</Col>
            <Col id="cd_nm">15시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">1550</Col>
            <Col id="cd_nm">15시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">1600</Col>
            <Col id="cd_nm">16시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">1610</Col>
            <Col id="cd_nm">16시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">1620</Col>
            <Col id="cd_nm">16시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">1630</Col>
            <Col id="cd_nm">16시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">1640</Col>
            <Col id="cd_nm">16시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">1650</Col>
            <Col id="cd_nm">16시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">1700</Col>
            <Col id="cd_nm">17시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">1710</Col>
            <Col id="cd_nm">17시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">1720</Col>
            <Col id="cd_nm">17시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">1730</Col>
            <Col id="cd_nm">17시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">1740</Col>
            <Col id="cd_nm">17시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">1750</Col>
            <Col id="cd_nm">17시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">1800</Col>
            <Col id="cd_nm">18시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">1810</Col>
            <Col id="cd_nm">18시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">1820</Col>
            <Col id="cd_nm">18시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">1830</Col>
            <Col id="cd_nm">18시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">1840</Col>
            <Col id="cd_nm">18시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">1850</Col>
            <Col id="cd_nm">18시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">1900</Col>
            <Col id="cd_nm">19시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">1910</Col>
            <Col id="cd_nm">19시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">1920</Col>
            <Col id="cd_nm">19시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">1930</Col>
            <Col id="cd_nm">19시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">1940</Col>
            <Col id="cd_nm">19시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">1950</Col>
            <Col id="cd_nm">19시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">2000</Col>
            <Col id="cd_nm">20시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">2010</Col>
            <Col id="cd_nm">20시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">2020</Col>
            <Col id="cd_nm">20시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">2030</Col>
            <Col id="cd_nm">20시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">2040</Col>
            <Col id="cd_nm">20시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">2050</Col>
            <Col id="cd_nm">20시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">2100</Col>
            <Col id="cd_nm">21시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">2110</Col>
            <Col id="cd_nm">21시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">2120</Col>
            <Col id="cd_nm">21시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">2130</Col>
            <Col id="cd_nm">21시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">2140</Col>
            <Col id="cd_nm">21시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">2150</Col>
            <Col id="cd_nm">21시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">2200</Col>
            <Col id="cd_nm">22시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">2210</Col>
            <Col id="cd_nm">22시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">2220</Col>
            <Col id="cd_nm">22시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">2230</Col>
            <Col id="cd_nm">22시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">2240</Col>
            <Col id="cd_nm">22시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">2250</Col>
            <Col id="cd_nm">22시간 50분</Col>
          </Row>
          <Row>
            <Col id="cd">2300</Col>
            <Col id="cd_nm">23시간 00분</Col>
          </Row>
          <Row>
            <Col id="cd">2310</Col>
            <Col id="cd_nm">23시간 10분</Col>
          </Row>
          <Row>
            <Col id="cd">2320</Col>
            <Col id="cd_nm">23시간 20분</Col>
          </Row>
          <Row>
            <Col id="cd">2330</Col>
            <Col id="cd_nm">23시간 30분</Col>
          </Row>
          <Row>
            <Col id="cd">2340</Col>
            <Col id="cd_nm">23시간 40분</Col>
          </Row>
          <Row>
            <Col id="cd">2350</Col>
            <Col id="cd_nm">23시간 50분</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_TypCd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_edctTrprResult" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" keystring="G:team_nm">
        <ColumnInfo>
          <Column id="edct_atnc_hr" type="STRING" size="256"/>
          <Column id="team_nm" type="STRING" size="256"/>
          <Column id="user_nm" type="STRING" size="256"/>
          <Column id="edct_atnc_tm" type="STRING" size="256"/>
          <Column id="newedct_stt_dt" type="STRING" size="256"/>
          <Column id="usercount" type="STRING" size="256"/>
          <Column id="team_cd" type="STRING" size="256"/>
          <Column id="empl_no" type="STRING" size="256"/>
          <Column id="edct_stt_dt" type="STRING" size="256"/>
          <Column id="edct_prgr_stat_cd" type="STRING" size="256"/>
          <Column id="edct_cmcr_scr" type="INT" size="256"/>
          <Column id="edct_crs_nm" type="STRING" size="256"/>
          <Column id="user_id" type="STRING" size="256"/>
          <Column id="edct_atnc_hr_new" type="STRING" size="256"/>
          <Column id="teamcount" type="STRING" size="256"/>
          <Column id="edct_crs_id" type="STRING" size="256"/>
          <Column id="edct_atnc_dt" type="STRING" size="256"/>
          <Column id="edct_typ_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_processEdctTrprResult" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" keystring="G:edct_crs_nm,team_nm">
        <ColumnInfo>
          <Column id="edct_atnc_hr" type="STRING" size="256"/>
          <Column id="team_nm" type="STRING" size="256"/>
          <Column id="user_nm" type="STRING" size="256"/>
          <Column id="edct_atnc_tm" type="STRING" size="256"/>
          <Column id="newedct_stt_dt" type="STRING" size="256"/>
          <Column id="educount" type="STRING" size="256"/>
          <Column id="edct_plc_nm" type="STRING" size="256"/>
          <Column id="edct_typ_cd" type="STRING" size="256"/>
          <Column id="team_cd" type="STRING" size="256"/>
          <Column id="empl_no" type="STRING" size="256"/>
          <Column id="edct_stt_dt" type="STRING" size="256"/>
          <Column id="edct_lctr_nm" type="STRING" size="256"/>
          <Column id="edct_prgr_stat_cd" type="STRING" size="256"/>
          <Column id="edct_cmcr_scr" type="INT" size="256"/>
          <Column id="user_id" type="STRING" size="256"/>
          <Column id="edct_crs_nm" type="STRING" size="256"/>
          <Column id="edct_trgt_nm" type="STRING" size="256"/>
          <Column id="edct_atnc_hr_new" type="STRING" size="256"/>
          <Column id="teamcount" type="STRING" size="256"/>
          <Column id="edct_cntn" type="STRING" size="256"/>
          <Column id="edct_crs_id" type="STRING" size="256"/>
          <Column id="edct_typ_nm" type="STRING" size="256"/>
          <Column id="tetamgroupcnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/********************************************************************************************/
/* 1. Include Library include, variables Declaration 영역                                  */
/********************************************************************************************/
include "LIB::lib_All.xjs";
include "LIB::lib_TeamUser.xjs";
var totalTime = "";//교육시간 합계tab1
var totalTime2 = "";//교육시간 합계tab2
var xlsYn; 		// 엑셀권한
/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리                                           	*/
/********************************************************************************************/
function PS250300_onload(obj:Form, e:LoadEventInfo)
{
	gfn_getList("cd","EDC020");   //코드조회
	
	gfn_createTeamUserInqDs(obj); // 팀에 따른 사용자 조회를 위한 데이터셋 설정
	gfn_getList("teamCd","", null, null, null, "ds_allTeamCd"); // 팀코드 조회
	
	fn_setAthrPgmBtn();				// 권한에 따른 버튼 설정
	fn_init();
	fn_init2();
	fn_commSearch();
}

/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
function fn_callBack(svcid, errcd, errmsg) 
{
	if (errcd != 0) {
		trace(errcd)
		return false;
	} else {
		switch (svcid) {
			case "selectCode":
				gfn_getCode("EDC020", "ALL", ds_TypCd); //교육유형
				Tab00.tabpage2.cbo_srch_typ_cd.index = 0;
 			break;
 			
			case "selectTeamCode":
				gfn_getTeamCodeLoad("", "ALL", ds_hgrnTeamCd, ds_allTeamCd, "1");
				//fn_init();			
			break;
			
			case "getEdctTrprResult":
				//trace(ds_list_temp.saveXML());
				gfn_appendSearchDs(ds_list_edctTrprResult, ds_list_temp); // 조회된 결과를 실제보여줄 데이타셋으로 Append처리
				
				// 합계 계산
				var sum = 0;
				for (var i=0; i<ds_list_edctTrprResult.rowcount; i++) {
					var nTm = toNumber(ds_list_edctTrprResult.getColumn(i, "edct_atnc_tm"));
					sum += (Math.floor(nTm/100) + (nTm%100)/60);
					var edct_stt_dt = ds_list_edctTrprResult.getColumn(i, "edct_stt_dt");
					edct_stt_dt = edct_stt_dt.substr(0,4)+"-"+edct_stt_dt.substr(4,2)+"-"+edct_stt_dt.substr(6,2);
					ds_list_edctTrprResult.setColumn(i, "edct_stt_dt", edct_stt_dt);
				}
				
				var fSum = Math.floor(sum);
				var lSum = sum - Math.floor(sum);
				totalTime = fSum + "시간"
				if(lSum != 0) {
					totalTime += (" " + Math.round(lSum*60)+"분");
				}
				
				fn_commSearch2();
			break;
			
			case "getUserProcstateList":
				gfn_appendSearchDs(ds_list_processEdctTrprResult, ds_list_temp); // 조회된 결과를 실제보여줄 데이타셋으로 Append처리
				
				// 합계 계산
				var sum = 0;
				for (var i=0; i<ds_list_processEdctTrprResult.rowcount; i++) {
					var nTm = toNumber(ds_list_processEdctTrprResult.getColumn(i, "edct_atnc_tm"));
					sum += (Math.floor(nTm/100) + (nTm%100)/60);
					var edct_stt_dt = ds_list_processEdctTrprResult.getColumn(i, "edct_stt_dt");
					edct_stt_dt = edct_stt_dt.substr(0,4)+"-"+edct_stt_dt.substr(4,2)+"-"+edct_stt_dt.substr(6,2);
					ds_list_processEdctTrprResult.setColumn(i, "edct_stt_dt", edct_stt_dt);
				}
				
				var fSum = Math.floor(sum);
				var lSum = sum - Math.floor(sum);
				totalTime2 = fSum + "시간"
				if(lSum != 0) {
					totalTime2 += (" " + Math.round(lSum*60)+"분");
				}
				
			break;
		}
	}
}	

/********************************************************************************************/
/**   4. Validation 처리                                                                   	*/
/********************************************************************************************/
// 조회 체크tab1
function fn_preSearch()
{
	// 조회조건 및 default 정렬
	ds_list_edctTrprResult.clearData();
	ds_inqCndt.clearData();
	//ds_list_edctTrprResult.keystring = ""; // 정렬컬럼 초기화
	
	var cal_startd = Tab00.tabpage1.cal_startd.value + ""; //String변환
	
	ds_inqCndt.addRow();
	ds_inqCndt.setColumn(0, "startd", cal_startd.substr(0,6));
	ds_inqCndt.setColumn(0, "team1_cd", Tab00.tabpage1.cbo_srch_hgrn_team_cd.value);
	ds_inqCndt.setColumn(0, "team2_cd", Tab00.tabpage1.cbo_srch_team_cd.value);
	
	return true;
}

// 조회 체크tab2
function fn_preSearch2()
{
	// 조회조건 및 default 정렬
	ds_list_processEdctTrprResult.clearData();
	ds_inqCndt.clearData();
	var sCalStartd = Tab00.tabpage1.cal_startd.value + ""; //String변환
	
	ds_inqCndt.addRow();
	ds_inqCndt.setColumn(0, "startd", sCalStartd.substr(0,6));
	ds_inqCndt.setColumn(0, "edct_typ_cd", Tab00.tabpage2.cbo_srch_typ_cd.value);
	
	return true;
}
/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)                                                   	*/
/********************************************************************************************/
//조회tab1
function fn_commSearch()
{
	if (!fn_preSearch()) return false;
	
	var szSvcid       = "getEdctTrprResult";
    var szController  = "/edct-trpr/edct-trpr/eduresult";
    var szInDs        = "ds_input=ds_inqCndt";
    var szOutDs       = "ds_list_temp=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

//조회tab2
function fn_commSearch2()
{
	if (!fn_preSearch2()) return false;
	
	var szSvcid       = "getUserProcstateList";
    var szController  = "/edct-crs/edct-crs/processEdctTrprresult";
    var szInDs        = "ds_input=ds_inqCndt";
    var szOutDs       = "ds_list_temp=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

/********************************************************************************************/
/**   6. 사용자 함수                                                                   	*/
/********************************************************************************************/
// 초기화tab1
function fn_init()
{
	Tab00.tabpage1.cal_startd.value = gfn_getToday();
	var sBzptDiv = gds_UserInfo.getColumn(0, "bzpt_div");
	if ("999999" != sBzptDiv){
		Tab00.tabpage1.cbo_srch_hgrn_team_cd.value = gds_UserInfo.getColumn(0, "hgrn_team_cd");
		gfn_teamUserSelect(Tab00.tabpage1.cbo_srch_hgrn_team_cd, Tab00.tabpage1.cbo_srch_team_cd, "", "1", ds_allTeamCd, ds_teamCd, "ALL");
		Tab00.tabpage1.cbo_srch_hgrn_team_cd.enable = false;
		
		Tab00.tabpage1.cbo_srch_team_cd.value = gds_UserInfo.getColumn(0, "team_cd");
		gfn_teamUserSelect(Tab00.tabpage1.cbo_srch_hgrn_team_cd, Tab00.tabpage1.cbo_srch_team_cd, "", "2", ds_allTeamCd, ds_teamCd, "ALL");
		Tab00.tabpage1.cbo_srch_team_cd.enable = false;
	}else{
		Tab00.tabpage1.cbo_srch_hgrn_team_cd.value = "T20000";
		gfn_teamUserSelect(Tab00.tabpage1.cbo_srch_hgrn_team_cd, Tab00.tabpage1.cbo_srch_team_cd, "", "1", ds_allTeamCd, ds_teamCd, "ALL");
		Tab00.tabpage1.cbo_srch_hgrn_team_cd.enable = false;
	}
}
//초기화tab2
function fn_init2()
{
	Tab00.tabpage2.cal_startd.value = gfn_getToday();
	Tab00.tabpage2.cbo_srch_typ_cd.index = 0;
}

/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
// 조회tab1
function btn_search_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_commSearch();
}

// 조회tab2
function btn_search_onclick2(obj:Button,  e:ClickEventInfo)
{
	fn_commSearch2();
}

// 콤보 값 변경
function cbo_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	if (obj.name == "cbo_srch_hgrn_team_cd") {
		gfn_teamUserSelect(Tab00.tabpage1.cbo_srch_hgrn_team_cd, Tab00.tabpage1.cbo_srch_team_cd, "", "1", ds_allTeamCd, ds_teamCd, "ALL");
	}
}

//초기화tab1
function btn_Init_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_init();
}
//초기화tab2
function btn_Init_onclick2(obj:Button,  e:ClickEventInfo)
{
	fn_init2();
}

//엑셀다운tab1
function btn_excel_onclick(obj:Button,  e:ClickEventInfo)
{
	gfn_exportGridToExcel(Tab00.tabpage1.Grid00, "교육평과관리_"+gfn_getTodayFull()+"");
}
//엑셀다운tab2
function btn_excel_onclick2(obj:Button,  e:ClickEventInfo)
{
	gfn_exportGridToExcel(Tab00.tabpage2.Grid00, "교육평과관리_"+gfn_getTodayFull()+"");
}

//그리드헤더클릭
function Grid_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	gfn_grdHeadClick(obj, e);
}

/********************************************************************************************/
/**   사용자 함수                                                                         	*/
/********************************************************************************************/
// 권한에 따른 버튼 설정
function fn_setAthrPgmBtn()
{
	gfn_athrPgm(gfn_gdsCd_admin());
	
	if (xlsYn == "Y") {
		Tab00.tabpage1.btn_excel.visible = true;
		Tab00.tabpage2.btn_excel2.visible = true;
 	} else {
		Tab00.tabpage1.btn_excel.visible = false;
		Tab00.tabpage2.btn_excel2.visible = false;
 	}
}
]]></Script>
  </Form>
</FDL>
