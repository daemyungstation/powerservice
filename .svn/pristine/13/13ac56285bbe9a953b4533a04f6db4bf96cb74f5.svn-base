<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="MN020107_1" classname="MN010111" inheritanceid="" position="absolute 0 0 767 386" titletext="팝업_행사자 정보 등록 " onload="MN020107_1_onload">
    <Layouts>
      <Layout>
        <Static id="stc_31" class="sta_popupBg1" enable="false" position="absolute 0 1 764 379" onclick="stc_31_onclick"/>
        <Static id="stc_30" text="행사자 정보 등록" class="sta_popupTitle" transparenthittest="true" position="absolute 10 8 185 28"/>
        <Button id="btn_save" taborder="20" tabstop="false" onclick="btn_save_onclick" class="btn_WF_Save" position="absolute 599 45 671 65" tooltiptext="저장" style="padding:0 0 0 0;"/>
        <Button id="btn_init" taborder="21" tabstop="false" text="초기화" onclick="btn_init_onclick" class="btn_WF_Common" position="absolute 522 45 594 65" tooltiptext="초기화" style="border:0 none #000000ff ;padding:0 0 0 0;" visible="false"/>
        <Button id="btn_close" taborder="22" onclick="btn_close_onclick" class="btn_popupClose" position="absolute 731 7 751 26"/>
        <Static id="stc_00" class="sta_workData" position="absolute 9 170 745 196"/>
        <Static id="stc_02" class="sta_workData" position="absolute 9 145 745 171"/>
        <Static id="stc_10" class="sta_workData" position="absolute 9 120 745 146"/>
        <Static id="stc_21" class="sta_workData" position="absolute 9 70 745 96" onclick="stc_21_onclick"/>
        <Static id="stc_04" class="sta_workData" position="absolute 9 95 745 121" style="font:arial,12,bold;"/>
        <Static id="stc_15" text="행사자 정보 " class="sta_workTitle2" position="absolute 9 49 221 69"/>
        <Edit id="edt_evt_mngr_cd" taborder="23" imemode="hangul" lengthunit="utf8" maxlength="4" position="absolute 85 73 215 93" readonly="true" style="border:1 solid darkgray transparent; :disabled {border:1 solid #a9a9a96d transparent;}" enable="false"/>
        <Static id="sta_GrayLine" class="sta_WF_Line1" position="absolute 9 69 744 70" anchor="left top right" onclick="sta_GrayLine_onclick"/>
        <Static id="stc_03" class="sta_workData" position="absolute 9 295 745 341"/>
        <Static id="stc_110" text="비     고" class="sta_workLabel1" position="absolute 9 295 83 341" validate="" style="align:center middle;font:Dotum,8;"/>
        <TextArea id="edt_note" taborder="19" wordwrap="both" position="absolute 85 298 741 338"/>
        <Static id="stc_06" class="sta_workData" position="absolute 9 195 745 221"/>
        <Static id="stc_11" class="sta_workData" position="absolute 9 220 745 246"/>
        <Static id="stc_13" class="sta_workData" position="absolute 9 245 745 271"/>
        <Static id="stc_16" class="sta_workData" position="absolute 9 270 745 296"/>
        <Static id="mem_nm_txt00" text="코   드" class="sta_workLabel1_P" position="absolute 9 70 83 96" validate=""/>
        <Static id="stc_40" text="주 소 지" class="sta_workLabel1" position="absolute 9 145 83 196" validate="" style="align:center middle;"/>
        <Button id="btn_srchAddrPop" taborder="24" tabstop="false" onclick="btn_srchAddrPop_onClick" class="btn_workSrcPop" position="absolute 630 148 650 168"/>
        <Edit id="edt_addr1" taborder="7" enable="false" position="absolute 162 148 627 168"/>
        <Edit id="edt_addr2" taborder="9" imemode="hangul" lengthunit="utf8" maxlength="300" position="absolute 85 173 372 193"/>
        <Static id="stc_07" text="전화번호" class="sta_workLabel1_P" position="absolute 377 95 451 121" validate=""/>
        <Edit id="edt_cell" taborder="2" imemode="alpha" lengthunit="utf8" maxlength="60" position="absolute 453 98 628 118"/>
        <Static id="stc_20" text="주민등록번호" class="sta_workLabel1_P" position="absolute 9 95 106 121" validate="" style="align:left top;"/>
        <Edit id="edt_idn_no" taborder="1" imemode="alpha" lengthunit="utf8" maxlength="13" position="absolute 108 98 198 118"/>
        <Edit id="edt_evt_mngr_nm" taborder="0" lengthunit="utf8" maxlength="13" onkillfocus="phone_onkillfocus" onkeydown="mem_onkeydown" ontextchanged="phone_ontextchanged" position="absolute 453 73 583 93" readonly="false" imemode="hangul"/>
        <Static id="stc_01" text="직   책" class="sta_workLabel1" position="absolute 9 120 83 146" validate=""/>
        <Static id="stc_14" text="사   원" class="sta_workLabel1" position="absolute 377 120 451 146" validate=""/>
        <Edit id="edt_empl_nm" taborder="4" imemode="alpha" lengthunit="utf8" maxlength="60" position="absolute 453 123 628 143"/>
        <Static id="stc_08" text="은행코드" class="sta_workLabel1_P" position="absolute 9 195 83 221" validate=""/>
        <Edit id="edt_bank_cd" taborder="10" imemode="alpha" lengthunit="utf8" maxlength="60" position="absolute 85 198 124 218" enable="false"/>
        <Edit id="edt_bank_nm" taborder="11" imemode="alpha" lengthunit="utf8" maxlength="60" oneditclick="edt_custmr_bank_nm_oneditclick" position="absolute 126 198 260 218" enable="false"/>
        <Button id="btn_srchBank" taborder="25" tabstop="false" onclick="btn_onclick" class="btn_workSrcPop" position="absolute 262 198 282 218"/>
        <Static id="stc_17" text="예 금 주" class="sta_workLabel1" position="absolute 9 220 83 246" validate=""/>
        <Edit id="edt_depr" taborder="13" imemode="alpha" lengthunit="utf8" maxlength="60" position="absolute 85 223 260 243"/>
        <Static id="stc_23" text="계좌번호" class="sta_workLabel1_P" position="absolute 376 195 450 221" validate=""/>
        <Edit id="edt_bank_accnt_no" taborder="12" imemode="alpha" lengthunit="utf8" maxlength="60" position="absolute 452 198 627 218"/>
        <Static id="stc_12" text="창  고" class="sta_workLabel1" position="absolute 9 245 83 271" validate=""/>
        <Edit id="edt_wh_cd" taborder="14" imemode="alpha" lengthunit="utf8" maxlength="60" position="absolute 85 248 139 268" enable="false"/>
        <Static id="stc_19" text="외주업체" class="sta_workLabel1" position="absolute 376 245 450 271" validate="" onclick="stc_19_onclick"/>
        <Edit id="edt_custmr_nm" taborder="16" imemode="alpha" lengthunit="utf8" maxlength="60" position="absolute 452 248 627 268" enable="false"/>
        <Static id="stc_05" text="사원구분" class="sta_workLabel1_P" position="absolute 9 270 83 296" validate=""/>
        <Radio id="rad_enp_gubun" taborder="17" rowcount="0" position="absolute 88 273 238 292" usebitmapcache="true" direction="vertical" columncount="3" codecolumn="codecolumn" datacolumn="datacolumn" onitemchanged="fn_auth_chng" value="0001" index="0">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">0001</Col>
                <Col id="datacolumn">직영</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0002</Col>
                <Col id="datacolumn">외주</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0003</Col>
                <Col id="datacolumn">위촉</Col>
              </Row>
            </Rows>
          </Dataset>
        </Radio>
        <Combo id="cbo_job_duty" taborder="3" codecolumn="cd" datacolumn="cd_nm" position2="absolute l:85 w:131 t:123 h:20" positiontype="position2" innerdataset="@ds_evt_jik" onitemchanged="fn_auth_visible"/>
        <Static id="mem_nm_txt01" text="이    름" class="sta_workLabel1_P" position="absolute 377 70 451 96" validate=""/>
        <Button id="btn_srchWh" taborder="26" tabstop="false" class="btn_workSrcPop" position="absolute 262 248 282 268" onclick="btn_srchWh_onclick"/>
        <Button id="btn_srch_custmr_cd" taborder="27" tabstop="false" class="btn_workSrcPop" position="absolute 630 248 650 268" onclick="btn_srch_custmr_cd_onclick"/>
        <Button id="btn_delete" taborder="28" tabstop="false" text="삭제" onclick="btn_delete_onclick" class="btn_WF_Common" position="absolute 675 45 739 65" tooltiptext="초기화" style="border:0 none #000000ff ;padding:0 0 0 0;"/>
        <Edit id="edt_wh_nm" taborder="15" imemode="alpha" lengthunit="utf8" maxlength="60" position="absolute 141 248 259 268" enable="false"/>
        <Static id="stc_09" text="사용여부" onclick="stc_19_onclick" class="sta_workLabel1" position="absolute 376 270 450 296" validate=""/>
        <Edit id="edt_upd_man" taborder="18" imemode="alpha" lengthunit="utf8" maxlength="60" position="absolute 656 273 740 293" readonly="true" visible="false"/>
        <Button id="btn_accnt_no" taborder="29" onclick="fn_srchEmplePop" class="btn_workSrcPop" position="absolute 630 122 650 142"/>
        <Edit id="edt_zip" taborder="6" enable="false" position="absolute 86 148 158 168"/>
        <Edit id="edt_empl_cd" taborder="5" imemode="alpha" lengthunit="utf8" maxlength="60" position="absolute 661 123 740 143" visible="false"/>
        <Edit id="edt_custmr_cd" taborder="30" imemode="alpha" lengthunit="utf8" maxlength="60" position="absolute 660 248 723 268" visible="false"/>
        <Combo id="cbo_evt_auth" taborder="31" innerdataset="@ds_evt_in" codecolumn="cd" datacolumn="cd_nm" position2="absolute l:243 w:107 t:273 h:20" positiontype="position2"/>
        <Static id="stc_18" text="그룹사번" class="sta_workLabel1" position="absolute 376 170 450 196" validate=""/>
        <Edit id="edt_grp_emple_no" taborder="8" imemode="alpha" lengthunit="utf8" maxlength="8" position="absolute 452 173 627 193"/>
        <Combo id="cbo_use_yn" taborder="32" position="absolute 452 273 552 293" index="0" codecolumn="codecolumn" datacolumn="datacolumn" value="Y" text="사용">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">사용</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">미사용</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item6" compid="edt_evt_mngr_cd" propid="value" datasetid="ds_evt_mana_mng" columnid="evt_mngr_cd"/>
      <BindItem id="item10" compid="edt_evt_mngr_nm" propid="value" datasetid="ds_evt_mana_mng" columnid="evt_mngr_nm"/>
      <BindItem id="item12" compid="edt_addr1" propid="value" datasetid="ds_evt_mana_mng" columnid="addr1"/>
      <BindItem id="item13" compid="edt_addr2" propid="value" datasetid="ds_evt_mana_mng" columnid="addr2"/>
      <BindItem id="item24" compid="edt_note" propid="value" datasetid="ds_evt_mana_mng" columnid="note"/>
      <BindItem id="item15" compid="edt_cell" propid="value" datasetid="ds_evt_mana_mng" columnid="cell"/>
      <BindItem id="item16" compid="edt_idn_no" propid="value" datasetid="ds_evt_mana_mng" columnid="idn_no"/>
      <BindItem id="item2" compid="edt_empl_nm" propid="value" datasetid="ds_evt_mana_mng" columnid="emple_nm"/>
      <BindItem id="item5" compid="edt_bank_cd" propid="value" datasetid="ds_evt_mana_mng" columnid="bank_cd"/>
      <BindItem id="item8" compid="edt_depr" propid="value" datasetid="ds_evt_mana_mng" columnid="depr"/>
      <BindItem id="item18" compid="edt_bank_accnt_no" propid="value" datasetid="ds_evt_mana_mng" columnid="bank_accnt_no"/>
      <BindItem id="item0" compid="edt_wh_cd" propid="value" datasetid="ds_evt_mana_mng" columnid="wh_cd"/>
      <BindItem id="item4" compid="edt_custmr_nm" propid="value" datasetid="ds_evt_mana_mng" columnid="custmr_nm"/>
      <BindItem id="item3" compid="edt_evt_mngr_cd" propid="readonly" datasetid="ds_evt_mana_mng" columnid="wh_cd"/>
      <BindItem id="item1" compid="cbo_job_duty" propid="value" datasetid="ds_evt_mana_mng" columnid="job_duty"/>
      <BindItem id="item7" compid="rad_enp_gubun" propid="value" datasetid="ds_evt_mana_mng" columnid="emp_gubun"/>
      <BindItem id="item9" compid="edt_upd_man" propid="value" datasetid="ds_evt_mana_mng" columnid="rgsr_id"/>
      <BindItem id="item11" compid="edt_zip" propid="value" datasetid="ds_evt_mana_mng" columnid="zip"/>
      <BindItem id="item14" compid="edt_empl_cd" propid="value" datasetid="ds_evt_mana_mng" columnid="emple_no"/>
      <BindItem id="item17" compid="edt_bank_nm" propid="value" datasetid="ds_evt_mana_mng" columnid="bank_nm"/>
      <BindItem id="item19" compid="edt_wh_nm" propid="value" datasetid="ds_evt_mana_mng" columnid="wh_nm"/>
      <BindItem id="item20" compid="edt_custmr_cd" propid="value" datasetid="ds_evt_mana_mng" columnid="custmr_cd"/>
      <BindItem id="item21" compid="cbo_evt_auth" propid="value" datasetid="ds_evt_mana_mng" columnid="admin_auth"/>
      <BindItem id="item22" compid="edt_grp_emple_no" propid="value" datasetid="ds_evt_mana_mng" columnid="grp_emple_no"/>
      <BindItem id="item23" compid="cbo_use_yn" propid="value" datasetid="ds_evt_mana_mng" columnid="use_yn"/>
    </Bind>
    <Objects>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_tmp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="evt_mngr_cd" type="STRING" size="256"/>
          <Column id="job_duty" type="STRING" size="256"/>
          <Column id="evt_mngr_nm" type="STRING" size="256"/>
          <Column id="idn_no" type="STRING" size="256"/>
          <Column id="zip" type="STRING" size="256"/>
          <Column id="addr1" type="STRING" size="256"/>
          <Column id="addr2" type="STRING" size="256"/>
          <Column id="cell" type="STRING" size="256"/>
          <Column id="bank_cd" type="STRING" size="256"/>
          <Column id="bank_accnt_no" type="STRING" size="256"/>
          <Column id="depr" type="STRING" size="256"/>
          <Column id="wh_cd" type="STRING" size="256"/>
          <Column id="branch" type="STRING" size="256"/>
          <Column id="enp_gubun" type="STRING" size="256"/>
          <Column id="custmr_cd" type="STRING" size="256"/>
          <Column id="emple_no" type="STRING" size="256"/>
          <Column id="note" type="STRING" size="256"/>
          <Column id="wh_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_evt_jik" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_evt_mana_mng" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="evt_mngr_cd" type="STRING" size="256"/>
          <Column id="job_duty" type="STRING" size="256"/>
          <Column id="evt_mngr_nm" type="STRING" size="256"/>
          <Column id="idn_no" type="STRING" size="256"/>
          <Column id="zip" type="STRING" size="256"/>
          <Column id="addr1" type="STRING" size="256"/>
          <Column id="addr2" type="STRING" size="256"/>
          <Column id="cell" type="STRING" size="256"/>
          <Column id="bank_cd" type="STRING" size="256"/>
          <Column id="bank_accnt_no" type="STRING" size="256"/>
          <Column id="depr" type="STRING" size="256"/>
          <Column id="wh_cd" type="STRING" size="256"/>
          <Column id="branch" type="STRING" size="256"/>
          <Column id="emp_gubun" type="STRING" size="256"/>
          <Column id="custmr_cd" type="STRING" size="256"/>
          <Column id="emple_no" type="STRING" size="256"/>
          <Column id="note" type="STRING" size="256"/>
          <Column id="job_duty_nm" type="STRING" size="256"/>
          <Column id="branch_nm" type="STRING" size="256"/>
          <Column id="bank_nm" type="STRING" size="256"/>
          <Column id="wh_nm" type="STRING" size="256"/>
          <Column id="emp_gubun_nm" type="STRING" size="256"/>
          <Column id="custmr_nm" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="admin_auth" type="STRING" size="256"/>
          <Column id="grp_emple_no" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="seq" type="STRING" size="6"/>
          <Column id="custmr_cd" type="STRING" size="256"/>
          <Column id="custmr_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_evt_in" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="cd">0001</Col>
            <Col id="cd_nm">지도사(C.P)</Col>
          </Row>
          <Row>
            <Col id="cd">0002</Col>
            <Col id="cd_nm">내근관리직</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_evt_out" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="cd">0001</Col>
            <Col id="cd_nm">지도사(C.P)</Col>
          </Row>
          <Row>
            <Col id="cd">0003</Col>
            <Col id="cd_nm">부 지부장</Col>
          </Row>
          <Row>
            <Col id="cd">0004</Col>
            <Col id="cd_nm">지부장</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_evt_apn" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="cd">0001</Col>
            <Col id="cd_nm">지도사(C.P)</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/********************************************************************************************/
/* 1. Include Library include, variables Declaration 영역                                  */
/********************************************************************************************/
include "LIB::lib_All.xjs";

var gv_jab_sel = "";				// 입력인지 조회인지  입력이면 1  조회면 2
var gv_evt_mngr_cd = "";	

var gv_dpost = "";
var gv_daddr = "";
/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리                                           	*/
/********************************************************************************************/


 function MN020107_1_onload(obj:Form, e:LoadEventInfo)
{
		gv_evt_mngr_cd = p_evt_mngr_cd;
		gfn_getList("dlwCd","0138","fn_callBack",false);   
	
		if ( gv_evt_mngr_cd != ""  && gv_evt_mngr_cd != null ) {
			gv_jab_sel = "2";
			fn_EvtMng("getEvtManaMngList") ;  /// 조회일경우.. 조회함수 바로 고고
 		
    	} else {
			btn_delete.visible= false;
			gv_jab_sel  ="1"; 
			ds_evt_mana_mng.clearData();
			ds_evt_mana_mng.addRow();
			cbo_job_duty.index = 0;
			cbo_use_yn.index = 0;
		}
		
		fn_auth_visible();
		fn_auth_chng();
}


/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
function fn_callBack(svcid, errcd, errmsg)
{
   		switch (svcid) {
		//  공통코드
		case "selectDlwCode": // 대명코드 조회
			gfn_getCode("0138", "SELECT", ds_evt_jik, gds_DmlCd); // 직책
		break;   		
   		// 조회
		case "getEvtManaMngList":
		  	ds_evt_mana_mng.clear();
   			gfn_appendSearchDs(ds_evt_mana_mng, ds_list_tmp);
   			fn_postSearch();
   		break;
		
		//입력
		case "insrtCustmrMng":
			alert("저장하였습니다.");
			//gfn_appendSearchDs(ds_evt_mana_mng, ds_list_tmp);
			
			//trace('********입력='+ds_evt_mana_mng.getColumn(0,"evt_mngr_cd"));	
			fn_postSearch();
			fn_EvtMng("getEvtManaMngList") ;
		break;
		
		
		case "updateEvtManaMng":
			alert("수정하였습니다.");
			fn_postSearch();
			fn_EvtMng("getEvtManaMngList") ;
		break;
		

		case "deleteEvtManaMng":
		    alert("삭제완료했습니다..");
			
			fn_EvtMng("getEvtManaMngList") ;
			close();
		break;

	}
   
   
}

	
/********************************************************************************************/
/**   4. Validation 처리                                                                   	*/
/********************************************************************************************/
// 저장  전
function fn_preEvtManaMngSave(){

	var idn_no = edt_idn_no.value;
	var duty = cbo_job_duty.value;

	if (gfn_isNull(edt_evt_mngr_nm.value)) {		
			alert("행사자 이름을 입력하세요.");
			edt_evt_mngr_nm.setFocus();
			return false;		  
	}			
	
	//if (duty != '0001'){ // CP 아닐경우에만!
	if (duty != '0001' && duty != '0005'){ // CP, 승무원 아닌 경우만
		if (gfn_isNull(edt_idn_no.value)) {		
				alert("주민등록번호를 입력하세요.");
				edt_idn_no.setFocus();
				return false;		  
		}else{
			if(idn_no.length != 13){
				alert("주민등록번호 자리수를 확인하세요!");
				edt_idn_no.setFocus();
				return false;			
			}
			
			if(idn_no_chk() == false){ // 주민번호 체크
				alert("잘못된 주민번호입니다.");
				edt_idn_no.setFocus();
				return false;			
			}
		}
		
		if (gfn_isNull(edt_bank_cd.value)) {		
				alert("은행코드를 입력하세요.");
				edt_bank_cd.setFocus();
				return false;		  
		}		
		
		if (gfn_isNull(edt_bank_accnt_no.value)) {		
				alert("계좌번호를 입력하세요.");
				edt_bank_accnt_no.setFocus();
				return false;		  
		}	
			
	}
	
	if (gfn_isNull(edt_cell.value)) {		
			alert("전화번호를 입력하세요.");
			edt_cell.setFocus();
			return false;		  
	}
	
	//if (gfn_isNull(cbo_evt_auth.value)) {
	// 직책이 CP인 경우, 사원구분, 행사자 구분값 체크
	if(duty == '0001') {
		if(gfn_isNull(rad_enp_gubun.value)) {
			alert("사원 구분값을 넣으세요(CP).");
			return false;
		}
		
		if(gfn_isNull(cbo_evt_auth.value)) {
			alert("행사자 구분값을 넣으세요(CP).");
			cbo_evt_auth.setFocus();
			return false;
		}
	}
	
	//ds_evt_mana_mng.clearData();
	var nRow = ds_evt_mana_mng.addRow();
	var oUser = gfn_getUserInfo();
				
	//ds_evt_mana_mng.setColumn(nRow, "evt_mngr_cd", edt_evt_mngr_cd.value);
	ds_evt_mana_mng.setColumn(nRow, "evt_mngr_nm", edt_evt_mngr_nm.value);
	ds_evt_mana_mng.setColumn(nRow, "idn_no", edt_idn_no.value);
	ds_evt_mana_mng.setColumn(nRow, "cell", edt_cell.value);
	ds_evt_mana_mng.setColumn(nRow, "job_duty", cbo_job_duty.value);
	
	ds_evt_mana_mng.setColumn(nRow, "zip", edt_zip.value);
	ds_evt_mana_mng.setColumn(nRow, "addr1", edt_addr1.value);
	ds_evt_mana_mng.setColumn(nRow, "addr2", edt_addr2.value);
	
	ds_evt_mana_mng.setColumn(nRow, "bank_cd", edt_bank_cd.value);
	ds_evt_mana_mng.setColumn(nRow, "depr", edt_depr.value);
	ds_evt_mana_mng.setColumn(nRow, "bank_accnt_no", edt_bank_accnt_no.value);
	ds_evt_mana_mng.setColumn(nRow, "custmr_cd", edt_custmr_cd.value);
	ds_evt_mana_mng.setColumn(nRow, "emp_gubun", rad_enp_gubun.value);
	ds_evt_mana_mng.setColumn(nRow, "note", edt_note.value);
	
	//alert("로그인 아이디 : " + ds_evt_mana_mng.getColumn);


	return true;
}

// 주민번호 체크
function idn_no_chk()
{
	var idn_no = edt_idn_no.value;
	
	var a1 = idn_no.substr(0,1);
	var a2 = idn_no.substr(1,1);
	var a3 = idn_no.substr(2,1);
	var a4 = idn_no.substr(3,1);
	var a5 = idn_no.substr(4,1);
	var a6 = idn_no.substr(5,1);
	
	var check = a1*2 + a2*3 + a3*4 + a4*5 + a5*6 + a6*7;

	var b1 = idn_no.substring(6,7);
	var b2 = idn_no.substring(7,8);
	var b3 = idn_no.substring(8,9);
	var b4 = idn_no.substring(9,10);
	var b5 = idn_no.substring(10,11);
	var b6 = idn_no.substring(11,12);
	var b7 = idn_no.substring(12,13);

	var check = check + b1*8 + b2*9 + b3*2 + b4*3 + b5*4 + b6*5;

	check  = check % 11;

	check = 11 - check;

	check = check % 10 ;

	if(check != b7) { 
		return false;
	}	
	
	return true;
}


/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)                                                   	*/
/********************************************************************************************/

// 
function fn_EvtMng(svcid)
{

	
    if (svcid =='updateEvtManaMng' || svcid =='insrtEvtManaMng') {  ///  수정&입력시에만 체크
		if (!fn_preEvtManaMngSave(svcid)) return false;
	}
	
	if (svcid =='insrtEvtManaMng') {

		var szSvcid       = "insrtCustmrMng";
		var szController  = "/dlw/basiDataMng/insrtEvtManaMng";
		var szInDs        = "ds_input=ds_evt_mana_mng:U";
		var szOutDs       = "";
		var szParam       = "";
		var szRetCallback = "fn_callBack";
    } 
    if (svcid =='updateEvtManaMng') {
		
		var szSvcid       = "updateEvtManaMng";
		var szController  = "/dlw/basiDataMng/updateEvtManaMng";
		var szInDs        = "ds_input=ds_evt_mana_mng:U";
		var szOutDs       = "";
		var szParam       = "";
		var szRetCallback = "fn_callBack";
		
    } 
    if (svcid =='getEvtManaMngList') {
        ds_evt_mana_mng.clearData();
		var nRow = ds_evt_mana_mng.addRow();
		ds_evt_mana_mng.setColumn(nRow, "evt_mngr_cd", gv_evt_mngr_cd); 
		var szSvcid       = "getEvtManaMngList";
		var szController  = "/dlw/basiDataMng/getEvtManaMngList";
		var szInDs        = "ds_input=ds_evt_mana_mng";
		var szOutDs       = "ds_list_tmp=ds_output";
		var szParam       = "";
		var szRetCallback = "fn_callBack";
	 }
	 
	 if (svcid =='deleteEvtManaMng') {
        ds_evt_mana_mng.clearData();
		var nRow = ds_evt_mana_mng.addRow();
		ds_evt_mana_mng.setColumn(nRow, "evt_mngr_cd", gv_evt_mngr_cd); 
		var szSvcid       = "deleteEvtManaMng";
		var szController  = "/dlw/basiDataMng/deleteEvtManaMng";
		var szInDs        = "ds_input=ds_evt_mana_mng:U";
		var szOutDs       = "";
		var szParam       = "";
		var szRetCallback = "fn_callBack";
		}
		
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback, false);
    //trace(ds_evt_mana_mng.saveXML());
    
    
}


 //조회 결과 
   function fn_postSearch(svcid)
   {
		if(ds_evt_mana_mng.rowcount < 1) {
			alert("조회된 자료가 없습니다.");
			ds_evt_mana_mng.clearData();
	  
		}
   }
   
/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/

//저장
function btn_save_onclick(obj:Button,  e:ClickEventInfo)
{
		if  (gv_jab_sel  =="1") { 
			edt_evt_mngr_cd.readonly = true;
			btn_delete.visible= false;
			fn_EvtMng("insrtEvtManaMng");
			var oUser = gfn_getUserInfo();
		}else{
			edt_evt_mngr_cd.readonly=true;
			fn_EvtMng("updateEvtManaMng");
			var oUser = gfn_getUserInfo();
		}
}

//닫기
function btn_close_onclick(obj:Button,  e:ClickEventInfo)
{
	close();
}

//초기화
function btn_init_onclick(obj:Button,  e:ClickEventInfo)
{
	edt_evt_mngr_cd.value='';
	edt_evt_mngr_nm.value='';
	edt_idn_no.value='';
	edt_cell.value='';
	cbo_job_duty.value='';
	edt_zip.value='';
	edt_addr1.value='';
	edt_addr2.value='';
	edt_bank_cd.value='';
	edt_depr.value='';
	edt_bank_accnt_no.value='';
	edt_custmr_cd.value='';
	rad_enp_gubun.value='0001';
	edt_note.value='';
	
	fn_auth_visible();
}


function btn_srch_onclick(obj:Button,  e:ClickEventInfo)
{

	var reVal = gfn_diaLog("창고 정보 조회", -1, -1, 884, 601, "MN020000::MN020107_2.xfdl", false, sPrmr, false, false, true);
}

//그리드 선택 후 상세 내용 볼 때 해당 그리드값을 가져옴 -- 수정 필요
function fn_setData()
{
	//ds_prodList.addRow();
	ds_evt_mana_mng.setColumn(0, "wh_cd", ds_cnctRtamt_info.getColumn(0, "wh_cd"));
	ds_evt_mana_mng.setColumn(0, "prod_nm", ds_cnctRtamt_info.getColumn(0, "prod_nm"));
	
	var app_day = ds_cnctRtamt_info.getColumn(0, "app_day");
		cal_app_dt.value = app_day.replace("/","");
	
	fn_commSearch(gfn_getCommTypeInit(), "srchModelMstInfo");
}


//창고 찾기
function btn_srchWh_onclick(obj:Button,  e:ClickEventInfo)
{
	var sPrmr ={p_bank_cd:"", p_bank_nm:""}
	var reVal = gfn_diaLog("창고 조회", -1, -1, 884, 601, "MN020000::MN020107_2.xfdl", false, sPrmr, false, false, true);
	

	if (!gfn_isEmpty(reVal)) {
		var sArr = reVal.split("__");
		edt_wh_nm.value = sArr[1];
		edt_wh_cd.value = sArr[0];
		
		
	}
}

// 행사외주업체 팝업
function btn_srch_custmr_cd_onclick(obj:Button,  e:ClickEventInfo){
	var sPrmr = {p_prod_cd:"", p_prod_nm:"", p_mode:"reg"};
	var reVal = gfn_diaLog("거래처 조회", -1, -1, -1, -1, "PS990000::PS992240.xfdl", false, sPrmr, true, false, true, null, null, true);
}
 
// 행사외주업체 팝업
function fn_custOutResl()
{
	// 모델분류 조회
 	var sCustCd = ds_list.getColumn(0, "custmr_cd");
 	if (gfn_isNull(sCustCd)) {
 		alert("거래처코드가 없습니다.");
 		return false;
 	}

 	var sCustNm = ds_list.getColumn(0, "custmr_nm");
 	
 	edt_custmr_cd.value = sCustCd;
 	edt_custmr_nm.value = sCustNm;
}

// 주소 팝업
function btn_srchAddrPop_onClick(obj:Button,  e:ClickEventInfo)
{
 	var sPrmr = {};
 	var reVal = gfn_diaLog("주소 조회", -1, -1, 884, 601, "PS990000::PS992099.xfdl", false, sPrmr, false, false, true);	
}

// 주소 값 등록(팝업창 호출)
function fn_daum_addr()
{
	edt_zip.value = gv_dpost; 
	edt_addr1.value = gv_daddr;	
}

function btn_delete_onclick(obj:Button,  e:ClickEventInfo)
{
		if (gv_jab_sel =="2" ) {
		 fn_EvtMng("deleteEvtManaMng");
	   } else {
		 alert("조회후 삭제가 가능합니다.");
		 return;
	   }	 
	

}

function btn_onclick(obj:Button,  e:ClickEventInfo)
{
		var sPrmr ={p_bank_cd:"", p_bank_nm:""};
	
	var reVal = gfn_diaLog("은행 조회", -1, -1, 884, 601, "PS990000::PS992500.xfdl", false, sPrmr, false, false, true);
	
	
	if( reVal != null )
		{
			
			if(reVal.getColumn(0, "cd") != ""){
				//trace(reVal.getColumn(0, "cd_nm"));
				//ds_list.setColumn(0, "custmr_bank_cd", reVal.getColumn(0, "cd"));
				edt_bank_cd.value = reVal.getColumn(0, "cd");
				edt_bank_nm.value = reVal.getColumn(0, "cd_nm");
			}
		}
}

function fn_srchEmplePop(obj:Button,  e:ClickEventInfo)
{
	var sPrmr = {p_empl_nm:edt_empl_nm.value, p_pageTyp:"MN020107_1", p_typ:"emp"};
	var reVal = gfn_diaLog("담당사원 조회", -1, -1, -1, -1, "PS990000::PS992000.xfdl", false, sPrmr, false, false, true);
	if(reVal != null){
		if(reVal.getColumn(0, "cd") != ""){
				//trace(reVal.getColumn(0, "cd_nm"));
				//ds_list.setColumn(0, "custmr_bank_cd", reVal.getColumn(0, "cd"));
				edt_bank_cd.value = reVal.getColumn(0, "cd");
				edt_bank_nm.value = reVal.getColumn(0, "cd_nm");
			}
	}
}

// 직책 지도사 선택 시 권한 visible 처리
function fn_auth_visible()
{
	var jik = cbo_job_duty.value;
	
	if(jik == "0001"){
		cbo_evt_auth.visible = true;
	}else{
		cbo_evt_auth.visible = false;
	}
}

// 사원구분(직영&외주)에 따른 내부데이터셋 변경처리
function fn_auth_chng(obj:Radio, e:ItemChangeEventInfo)
{
	var jik = cbo_job_duty.value;
	var gubun = rad_enp_gubun.value;
	
	if(jik == "0001"){
		if(gubun == "0001"){
			cbo_evt_auth.innerdataset = ds_evt_in;
		}else if(gubun == "0002"){
			cbo_evt_auth.innerdataset = ds_evt_out;
		}else if(gubun == "0003"){
			cbo_evt_auth.innerdataset = ds_evt_apn;
		}
	}
}

]]></Script>
  </Form>
</FDL>
