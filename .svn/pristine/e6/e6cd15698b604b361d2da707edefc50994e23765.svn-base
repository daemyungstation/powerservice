<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="PS240103" classname="캠페인관리" inheritanceid="" position="absolute 0 0 935 682" titletext="미리보기" onload="PS240103_onload" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="stc_31" class="sta_popupBg1" enable="false" position="absolute 0 0 934 682"/>
        <Button id="btn_Close" taborder="1" onclick="btn_close_onclick" class="btn_popupClose" position="absolute 907 8 927 27"/>
        <Static id="Static_emsh_nm" text="미리보기" class="sta_popupTitle" transparenthittest="true" position="absolute 10 8 185 28"/>
        <Static id="Static04" text="하" position="absolute 226 47 285 64" style="background:#d5e7a3ff;align:center middle;"/>
        <Static id="Static06" text="중" position="absolute 161 47 220 64" style="background:#f3cba4ff;align:center middle;"/>
        <Static id="Static07" text="상" position="absolute 96 47 155 64" style="background:#ecbabaff;border:0 none #808080ff ;color:#333333ff;align:center middle;"/>
        <Static id="Static02" text="문제난이도 " position="absolute 22 44 94 69"/>
        <Div id="Div00" taborder="3" style="" scrollbars="none" position2="absolute l:28 w:884 t:80 b:25" positiontype="position2">
          <Layouts>
            <Layout width="884" height="1168"/>
          </Layouts>
        </Div>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="div_Work.msk_FromDate" propid="value" datasetid="ds_Date" columnid="SDate"/>
      <BindItem id="item2" compid="div_Work.msk_ToDate" propid="value" datasetid="ds_Date" columnid="EDate"/>
    </Bind>
    <Objects>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="emsh_id" type="STRING" size="256"/>
          <Column id="exam_id" type="STRING" size="256"/>
          <Column id="exam_trpr_id" type="STRING" size="256"/>
          <Column id="exam_prbm_typ_cd" type="STRING" size="256"/>
          <Column id="exam_prbm_ids" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_examPrbm" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="amnt_dttm" type="STRING" size="32"/>
          <Column id="exam_prbm_dtsc_vl" type="STRING" size="32"/>
          <Column id="exam_dflv_cd" type="STRING" size="32"/>
          <Column id="amnd_id" type="STRING" size="32"/>
          <Column id="amnd_nm" type="STRING" size="32"/>
          <Column id="exam_prbm_nm" type="STRING" size="32"/>
          <Column id="cntr_cd" type="STRING" size="32"/>
          <Column id="exam_prgr_stat_cd" type="STRING" size="32"/>
          <Column id="expe_sqnc" type="STRING" size="32"/>
          <Column id="exam_prbm_item_list" type="STRING" size="32"/>
          <Column id="emsh_id" type="STRING" size="32"/>
          <Column id="rgsn_dttm" type="STRING" size="32"/>
          <Column id="exam_prbm_typ_cd" type="STRING" size="32"/>
          <Column id="rgsr_id" type="STRING" size="32"/>
          <Column id="exam_dflv_nm" type="STRING" size="32"/>
          <Column id="exam_prbm_fld_nm" type="STRING" size="32"/>
          <Column id="rgsr_nm" type="STRING" size="32"/>
          <Column id="exam_prbm_id" type="STRING" size="32"/>
          <Column id="exam_prbm_expi" type="STRING" size="32"/>
          <Column id="page_indx" type="STRING" size="32"/>
          <Column id="exam_prbm_fld_cd" type="STRING" size="32"/>
          <Column id="exam_prbm_typ_nm" type="STRING" size="32"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tmp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="32"/>
          <Column id="cd_nm" type="STRING" size="32"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_list_examPrbmItemAnsr" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="exam_prbm_item_id" type="STRING" size="256"/>
          <Column id="prbm_ansr_cntn" type="STRING" size="256"/>
          <Column id="exam_prbm_item_cntn" type="STRING" size="256"/>
          <Column id="exam_prbm_id" type="STRING" size="256"/>
          <Column id="cran_yn" type="STRING" size="256"/>
          <Column id="expe_sqnc" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/********************************************************************************************/
/* 1. Include Library include, variables Declaration 영역                                  */
/********************************************************************************************/
include "LIB::lib_All.xjs";

/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리                                           	*/
/********************************************************************************************/
function PS240103_onload(obj:Form, e:LoadEventInfo)
{
	var emsh_nm = opener.ds_list_emsh.getColumn(opener.ds_list_emsh.rowposition, "emsh_nm");
	Static_emsh_nm.text = emsh_nm;
	
	fn_commSearch();
	
}

/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
function fn_callBack(svcid, errcd, errmsg) 
{
	if (errcd != 0) {
		trace(errcd)
		return false;
	} else {
		switch (svcid) {
			case "getEmshPreview":
				//trace(ds_list_examPrbm.saveXML());
				//trace(ds_list_examPrbmItemAnsr.saveXML());
				
				var objParent = Div00;
		
				var nLeft = 0;
				var nTop = 10;
				var nRight = 70;
				var nBottom = 40;
				
				var nLeft2 = 850;
				var nTop2 = 10;
				var nRight2 = 80;
				var nBottom2 = 40;
				
				var nLeft3 = 850;
				var nTop3 = 0;
				var nRight3 = 100;
				var nBottom3 = 0;
				
				var cnt = 0;
					
				for (var i=0; i<ds_list_examPrbm.rowcount; i++) {
					
					var sExamPrbmNm = ds_list_examPrbm.getColumn(i, "exam_prbm_nm");
					var sExamDflvNm = ds_list_examPrbm.getColumn(i, "exam_dflv_nm");
					var sExamPrbmId = ds_list_examPrbm.getColumn(i, "exam_prbm_id");
					var sExamPrbmTypCd = ds_list_examPrbm.getColumn(i, "exam_prbm_typ_cd");
					
					nTop = i * (250 - 1) + 1;
					nBottom = nTop + 30;
					
					// Create Object  
					var objStatic = new Static("Static", nLeft, nTop, nRight, nBottom);
					
					objParent.addChild("Static"+i,objStatic);
					objStatic.show();
					objStatic.text ="문제";
					objStatic.style.border = "1px solid #808080ff ";
					objStatic.style.align = "center middle";
					if(sExamDflvNm == "상"){
						objStatic.style.background = "#ecbabaff";
					}else if(sExamDflvNm == "중"){
						objStatic.style.background = "#f3cba4ff";
					}else{
						objStatic.style.background = "#d5e7a3ff";
					}
					
					
					nTop = i * (250 - 1) + 30;
					nBottom = nTop + 30;
					// Create Object  
					var objStatic = new Static("Static01", nLeft, nTop, nRight, nBottom);
					
					objParent.addChild("Static01"+i,objStatic);
					objStatic.show();
					objStatic.text =i+1;
					objStatic.style.border = "1px solid #808080ff ";
					objStatic.style.align = "center middle";
					
					nTop2 = i * (250 - 1) + 1;
					nBottom2 = nTop2 + 60;
					
					// Create Object (문제항목)
					var objTextArea = new TextArea("Static02", nLeft2, nTop2, nRight2, nBottom2);
					
					objParent.addChild("Static02"+i,objTextArea);
					objTextArea.show();                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
					objTextArea.value = sExamPrbmNm;
					objTextArea.style.border = "1px solid #808080ff ";
					objTextArea.style.align = "left middle";
					objTextArea.readonly = true;
					
					for (var j=0; j<ds_list_examPrbmItemAnsr.rowcount; j++) {
						
						var sExamPrbmItemCntn = ds_list_examPrbmItemAnsr.getColumn(j, "exam_prbm_item_cntn");
						var sExamPrbmId2 = ds_list_examPrbmItemAnsr.getColumn(j, "exam_prbm_id");
						if(sExamPrbmId == sExamPrbmId2){
							//sExamPrbmTypCd 문제유형
							if(sExamPrbmTypCd == "10" || sExamPrbmTypCd == "20" ){//객관식
								if(i != ii)cnt=0;
								var ii = i;
								if(cnt ==0){
									nTop3 = (nTop2 +60);
									cnt++;
								}else{
									//alert(cnt);
									nTop3 = (nTop2 +60)+(cnt*30);
									cnt++;
								}
								
								nBottom3 = nTop3 + 31;
								
								// Create Object  
								var objStatic = new Static("Static03", nLeft3, nTop3, nRight3, nBottom3);
								
								objParent.addChild("Static03"+j,objStatic);
								objStatic.show();
								objStatic.text =sExamPrbmItemCntn;
								//objStatic.style.border = "1px solid #808080ff ";
								objStatic.style.align = "left middle";
								if(sExamPrbmTypCd == "10"){
									//라디오
									var objRadio = new Radio("Radio", 80, nTop3, nRight3, nBottom3);
									objRadio.innerdataset = ds_tmp;
									objRadio.value = "0";
									objRadio.readonly = true;
									objParent.addChild("Radio"+j,objRadio);
									objRadio.show();
								}else{
									//체크박스
									var objCheckBox = new CheckBox("CheckBox", 80, nTop3, nRight3, nBottom3);
									objCheckBox.innerdataset = ds_tmp;
									objCheckBox.readonly = true;
									objParent.addChild("CheckBox"+j,objCheckBox);
									objCheckBox.show();
								}
								
								
							}else{//주관식
								nTop3 = (nTop2 +60);
								nBottom3 = nTop3 + 31;
								
								// Create Object  
								var objEdit = new Static("Edit03", nLeft3, nTop3+10, 80, nBottom3+100);
								
								objParent.addChild("Edit03"+j,objEdit);
								objEdit.show();
								//objEdit.text =sExamPrbmItemCntn;
								objEdit.style.border = "1px solid #808080ff ";
							}
							

						}
					}
					objParent.scrollbars = "autovert";
					
				}	
				
 			break;
 			
 		}	
 	}		
}

/********************************************************************************************/
/**   4. Validation 처리                                                                   	*/
/********************************************************************************************/
// 조회 체크
function fn_preSearch()
{
	// 조회조건 및 default 정렬
	ds_inqCndt.clearData();
	ds_inqCndt.addRow();
	var sEmshId = opener.ds_list_emsh.getColumn(opener.ds_list_emsh.rowposition, "emsh_id");
	
	ds_inqCndt.setColumn(0, "emsh_id", sEmshId);
	
	return true;
}

/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)                                                   	*/
/********************************************************************************************/
//조회
function fn_commSearch()
{
	if (!fn_preSearch()) return false;

	var szSvcid       = "getEmshPreview";
    var szController  = "/exam/emsh/preview";
    var szInDs        = "ds_input=ds_inqCndt";
    var szOutDs       = "ds_list_examPrbm=ds_output ds_list_examPrbmItemAnsr=ds_output2";
    var szParam       = "";
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

function btn_close_onclick(obj:Button,  e:ClickEventInfo)
{
	close();
}
]]></Script>
  </Form>
</FDL>
