<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="SYS0000400102" classname="Work21_1" inheritanceid="" position="absolute 0 0 958 620" titletext="받는사람선택" onload="SYS0000400102_onload">
    <Layouts>
      <Layout>
        <Static id="stc_12" class="sta_popupBg1" enable="false" position="absolute 0 0 948 611"/>
        <Button id="btn_Close" taborder="1" onclick="btn_close_onclick" class="btn_popupClose" position="absolute 921 8 941 27"/>
        <Static id="stc_16" text="받는사람 선택" class="sta_popupTitle" transparenthittest="true" position="absolute 10 8 185 28"/>
        <Static id="stc_05" text="* 받는사람 선택 : (주의)팀 선택시 팀원 및 하위팀까지 모두 발송됩니다." class="sta_workHelpGray" position="absolute 11 41 393 61"/>
        <Button id="btn_commit" taborder="1" text="확인" position="absolute 868 45 937 65" onclick="btn_commit_onclick"/>
        <Tab id="tab_org" taborder="1" tabindex="0" scrollbars="autoboth" anchor="default" position="absolute 11 68 589 599" positiontype="position" onchanged="tab_org_onchanged">
          <Tabpages>
            <Tabpage id="tpg_bonsa" text="본사조직">
              <Layouts>
                <Layout>
                  <Static id="stc_33" class="sta_workSrcBg" position="absolute 10 10 566 52"/>
                  <Button id="btn_search" taborder="1" text="조회" class="btn_WFSA_src" position="absolute 470 21 548 41" onclick="tab_org_tpg_bonsa_btn_search_onclick"/>
                  <Static id="stc_32" text="성명" class="sta_workSrcLabel1" position="absolute 25 21 87 41"/>
                  <Edit id="edt_recpTrgtNm" taborder="1" position="absolute 64 21 134 41" onkeydown="fn_searchBonsa_onkeydown"/>
                  <Edit id="edt_blngOrgzNm" taborder="1" position="absolute 193 21 375 41" onkeydown="fn_searchBonsa_onkeydown"/>
                  <Static id="stc_00" text="부서" class="sta_workSrcLabel1" position="absolute 154 21 216 41"/>
                  <Grid id="grd_treeList" class="grd_Mymenu_tree" taborder="1" binddataset="ds_tree_bonsa" useinputpanel="false" cellsizingtype="col" autofittype="col" treeuseline="false" treeusecheckbox="false" treeinitstatus="expand,all" position="absolute 10 67 254 494" formats="&lt;Formats&gt;&#10;  &lt;Format id=&quot;default&quot;&gt;&#10;    &lt;Columns&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;    &lt;/Columns&gt;&#10;    &lt;Rows&gt;&#10;      &lt;Row band=&quot;head&quot; size=&quot;24&quot;/&gt;&#10;      &lt;Row band=&quot;body&quot; size=&quot;24&quot;/&gt;&#10;    &lt;/Rows&gt;&#10;    &lt;Band id=&quot;head&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;orgzCd&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;hgrnOrgzCd&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;orgzTypDivCd&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;dpthVl&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;crtnDttm&quot;/&gt;&#10;      &lt;Cell col=&quot;5&quot; disptype=&quot;normal&quot; text=&quot;cretId&quot;/&gt;&#10;      &lt;Cell col=&quot;6&quot; disptype=&quot;normal&quot; text=&quot;crtnIp&quot;/&gt;&#10;      &lt;Cell col=&quot;7&quot; disptype=&quot;normal&quot; text=&quot;crtnTrmlId&quot;/&gt;&#10;      &lt;Cell col=&quot;8&quot; disptype=&quot;normal&quot; text=&quot;lastAmntDttm&quot;/&gt;&#10;      &lt;Cell col=&quot;9&quot; disptype=&quot;normal&quot; text=&quot;lastAmndId&quot;/&gt;&#10;      &lt;Cell col=&quot;10&quot; disptype=&quot;normal&quot; text=&quot;lastAmntIp&quot;/&gt;&#10;      &lt;Cell col=&quot;11&quot; disptype=&quot;normal&quot; text=&quot;lastAmntTrmlId&quot;/&gt;&#10;      &lt;Cell col=&quot;12&quot; disptype=&quot;normal&quot; text=&quot;orgzNm&quot;/&gt;&#10;      &lt;Cell col=&quot;13&quot; disptype=&quot;normal&quot; text=&quot;hdqrOrgzYn&quot;/&gt;&#10;      &lt;Cell col=&quot;14&quot; disptype=&quot;normal&quot; text=&quot;_chk&quot;/&gt;&#10;      &lt;Cell col=&quot;15&quot; disptype=&quot;normal&quot; text=&quot;xRowStatusType&quot;/&gt;&#10;    &lt;/Band&gt;&#10;    &lt;Band id=&quot;body&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;bind:orgzCd&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;bind:hgrnOrgzCd&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;bind:orgzTypDivCd&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;bind:dpthVl&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;bind:crtnDttm&quot;/&gt;&#10;      &lt;Cell col=&quot;5&quot; disptype=&quot;normal&quot; text=&quot;bind:cretId&quot;/&gt;&#10;      &lt;Cell col=&quot;6&quot; disptype=&quot;normal&quot; text=&quot;bind:crtnIp&quot;/&gt;&#10;      &lt;Cell col=&quot;7&quot; disptype=&quot;normal&quot; text=&quot;bind:crtnTrmlId&quot;/&gt;&#10;      &lt;Cell col=&quot;8&quot; disptype=&quot;normal&quot; text=&quot;bind:lastAmntDttm&quot;/&gt;&#10;      &lt;Cell col=&quot;9&quot; disptype=&quot;normal&quot; text=&quot;bind:lastAmndId&quot;/&gt;&#10;      &lt;Cell col=&quot;10&quot; disptype=&quot;normal&quot; text=&quot;bind:lastAmntIp&quot;/&gt;&#10;      &lt;Cell col=&quot;11&quot; disptype=&quot;normal&quot; text=&quot;bind:lastAmntTrmlId&quot;/&gt;&#10;      &lt;Cell col=&quot;12&quot; disptype=&quot;normal&quot; text=&quot;bind:orgzNm&quot;/&gt;&#10;      &lt;Cell col=&quot;13&quot; disptype=&quot;normal&quot; text=&quot;bind:hdqrOrgzYn&quot;/&gt;&#10;      &lt;Cell col=&quot;14&quot; disptype=&quot;normal&quot; text=&quot;bind:_chk&quot;/&gt;&#10;      &lt;Cell col=&quot;15&quot; disptype=&quot;normal&quot; text=&quot;bind:xRowStatusType&quot;/&gt;&#10;    &lt;/Band&gt;&#10;  &lt;/Format&gt;&#10;&lt;/Formats&gt;&#10;" oncellclick="tab_org_tpg_bonsa_grd_treeList_oncellclick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="222"/>
                        </Columns>
                        <Rows>
                          <Row size="25"/>
                        </Rows>
                        <Band id="body">
                          <Cell displaytype="tree" edittype="tree" text="bind:orgzNm" treelevel="bind:dpthVl"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="grd_list" taborder="1" useinputpanel="false" position2="absolute l:264 w:302 t:67 h:427" positiontype="position2" binddataset="ds_userlist_bonsa" formats="&lt;Formats&gt;&#10;  &lt;Format id=&quot;default&quot;&gt;&#10;    &lt;Columns&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;    &lt;/Columns&gt;&#10;    &lt;Rows&gt;&#10;      &lt;Row band=&quot;head&quot; size=&quot;24&quot;/&gt;&#10;      &lt;Row band=&quot;body&quot; size=&quot;24&quot;/&gt;&#10;    &lt;/Rows&gt;&#10;    &lt;Band id=&quot;head&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;Column0&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;Column1&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;Column2&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;Column3&quot;/&gt;&#10;    &lt;/Band&gt;&#10;    &lt;Band id=&quot;body&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;bind:Column0&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;bind:Column1&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;bind:Column2&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;bind:Column3&quot;/&gt;&#10;    &lt;/Band&gt;&#10;  &lt;/Format&gt;&#10;&lt;/Formats&gt;&#10;" onheadclick="tab_org_tpg_bonsa_grd_list_onheadclick" oncelldblclick="tab_org_tpg_bonsa_grd_list_oncelldblclick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="25" band="left"/>
                          <Column size="64" band="left"/>
                          <Column size="154"/>
                          <Column size="59"/>
                          <Column size="200"/>
                        </Columns>
                        <Rows>
                          <Row size="25" band="head"/>
                          <Row size="25"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="checkbox" edittype="none"/>
                          <Cell col="1" text="성명"/>
                          <Cell col="2" text="부서"/>
                          <Cell col="3" text="직위"/>
                          <Cell col="4" text="이메일"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="checkbox" edittype="checkbox" text="bind:_chk"/>
                          <Cell col="1" text="bind:recpTrgtNm"/>
                          <Cell col="2" style="align:left;" text="bind:blngorgzNm"/>
                          <Cell col="3" text="bind:jbttNm"/>
                          <Cell col="4" style="align:left;" text="bind:userEmilAddr"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tpg_youngup" text="영업조직">
              <Layouts>
                <Layout>
                  <Static id="stc_33" class="sta_workSrcBg" position="absolute 10 10 566 52"/>
                  <Button id="btn_search" taborder="1" text="조회" class="btn_WFSA_src" position="absolute 470 21 548 41" onclick="tab_org_tpg_youngup_btn_search_onclick"/>
                  <Static id="stc_32" text="성명" class="sta_workSrcLabel1" position="absolute 25 21 87 41"/>
                  <Edit id="edt_recpTrgtNm" taborder="1" position="absolute 64 21 134 41" onkeydown="fn_searchYoungup_onkeydown"/>
                  <Edit id="edt_blngOrgzNm" taborder="1" position="absolute 193 21 375 41" onkeydown="fn_searchYoungup_onkeydown"/>
                  <Static id="stc_00" text="부서" class="sta_workSrcLabel1" position="absolute 154 21 216 41"/>
                  <Grid id="grd_treeList" class="grd_Mymenu_tree" taborder="1" binddataset="ds_tree_youngup" useinputpanel="false" cellsizingtype="col" autofittype="col" treeuseline="false" treeusecheckbox="false" treeinitstatus="expand,all" position="absolute 10 67 254 494" oncellclick="tab_org_tpg_youngup_grd_treeList_oncellclick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="222"/>
                        </Columns>
                        <Rows>
                          <Row size="25"/>
                        </Rows>
                        <Band id="body">
                          <Cell displaytype="tree" edittype="tree" text="bind:orgzNm" treelevel="bind:dpthVl"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="grd_list" taborder="1" binddataset="ds_userlist_youngup" useinputpanel="false" position2="absolute l:264 w:302 t:67 h:427" positiontype="position2" onheadclick="tab_org_tpg_youngup_grd_list_onheadclick" oncelldblclick="tab_org_tpg_youngup_grd_list_oncelldblclick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="64"/>
                          <Column size="154"/>
                          <Column size="59"/>
                        </Columns>
                        <Rows>
                          <Row size="25" band="head"/>
                          <Row size="25"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="checkbox"/>
                          <Cell col="1" text="성명"/>
                          <Cell col="2" text="부서"/>
                          <Cell col="3" text="직위"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="checkbox" edittype="checkbox" text="bind:_chk"/>
                          <Cell col="1" text="bind:recpTrgtNm"/>
                          <Cell col="2" style="align:left;" text="bind:blngorgzNm"/>
                          <Cell col="3" text="bind:jbttNm"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tpg_gongyong" text="공용그룹">
              <Layouts>
                <Layout>
                  <Static id="stc_33" class="sta_workSrcBg" position="absolute 10 10 566 52"/>
                  <Button id="btn_search" taborder="1" text="조회" class="btn_WFSA_src" position="absolute 470 21 548 41" onclick="tab_org_tpg_gongyong_btn_search_onclick"/>
                  <Static id="stc_32" text="성명" class="sta_workSrcLabel1" position="absolute 25 21 87 41"/>
                  <Edit id="edt_recpTrgtNm" taborder="1" position="absolute 64 21 134 41" onkeydown="fn_searchGongyong_onkeydown"/>
                  <Edit id="edt_blngOrgzNm" taborder="1" position="absolute 193 21 375 41" onkeydown="fn_searchGongyong_onkeydown"/>
                  <Static id="stc_00" text="그룹" class="sta_workSrcLabel1" position="absolute 154 21 216 41"/>
                  <Grid id="grd_treeList" class="grd_Mymenu_tree" taborder="1" binddataset="ds_tree_gongyong" useinputpanel="false" cellsizingtype="col" autofittype="col" treeuseline="false" treeusecheckbox="false" treeinitstatus="expand,all" position="absolute 10 83 254 494" oncellclick="tab_org_tpg_gongyong_grd_treeList_oncellclick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="218"/>
                        </Columns>
                        <Rows>
                          <Row size="25"/>
                        </Rows>
                        <Band id="body">
                          <Cell displaytype="image" style="align:right middle;" text="expr:membTypCd=='G'?'theme://images/ico_id.png':''"/>
                          <Cell col="1" displaytype="normal" edittype="none" style="padding:0 10 0 5;" class="cel_Left" text="bind:gropNm" treelevel="bind:dpthVl"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="grd_list" taborder="1" binddataset="ds_userlist_gongyong" useinputpanel="false" position2="absolute l:264 w:302 t:83 h:411" positiontype="position2" oncelldblclick="tab_org_tpg_gongyong_grd_list_oncelldblclick" onheadclick="tab_org_tpg_gongyong_grd_list_onheadclick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="64"/>
                          <Column size="154"/>
                          <Column size="59"/>
                          <Column size="200"/>
                        </Columns>
                        <Rows>
                          <Row size="25" band="head"/>
                          <Row size="25"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="checkbox"/>
                          <Cell col="1" text="성명"/>
                          <Cell col="2" text="부서"/>
                          <Cell col="3" text="직위"/>
                          <Cell col="4" text="이메일"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="checkbox" edittype="checkbox" text="bind:_chk"/>
                          <Cell col="1" text="bind:recpTrgtNm"/>
                          <Cell col="2" style="align:left;" text="bind:blngorgzNm"/>
                          <Cell col="3" text="bind:jbttNm"/>
                          <Cell col="4" style="align:left;" text="bind:userEmilAddr"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="stc_bzdpDivNm" text="L&amp;C" class="sta_workTitle3" position="absolute 10 63 130 83"/>
                  <Button id="btn_groupAdd" taborder="1" text="사용자그룹관리" class="btn_WF_Crud1" position="absolute 151 60 254 80" onclick="tab_org_tpg_gongyong_btn_groupAdd_onclick"/>
                  <Button id="btn_userAdd" taborder="1" text="구성원추가" class="btn_WF_Crud1" position="absolute 393 59 478 79" onclick="tab_org_tpg_gongyong_btn_userAdd_onclick" visible="true" enable="false"/>
                  <Button id="btn_userDel" taborder="1" text="구성원삭제" class="btn_WF_Crud1" position="absolute 481 59 566 79" onclick="tab_org_tpg_gongyong_btn_userDel_onclick" enable="false"/>
                  <Static id="stc_01" text="구성원" class="sta_workTitle3" position="absolute 264 63 384 83"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="Static02" text="Static00" position="absolute 190 599 685 610" style="background:violet;" visible="false"/>
        <Grid id="grd_receiveUserList" taborder="1" binddataset="ds_userlist" useinputpanel="false" position2="absolute l:645 w:292 t:95 h:504" positiontype="position2" onheadclick="grd_receiveUserList_onheadclick" oncelldblclick="grd_receiveUserList_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="25" band="left"/>
                <Column size="64" band="left"/>
                <Column size="154"/>
                <Column size="59"/>
                <Column size="200"/>
              </Columns>
              <Rows>
                <Row size="25" band="head"/>
                <Row size="25"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox"/>
                <Cell col="1" text="성명"/>
                <Cell col="2" text="부서"/>
                <Cell col="3" text="직위"/>
                <Cell col="4" text="이메일"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" text="bind:_chk"/>
                <Cell col="1" text="bind:recpTrgtNm"/>
                <Cell col="2" text="bind:blngorgzNm"/>
                <Cell col="3" text="bind:jbttNm"/>
                <Cell col="4" style="align:left;" text="bind:userEmilAddr"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="stc_17" text="받는사람 리스트" class="sta_workTitle2" position="absolute 645 74 829 94"/>
        <Button id="btn_addUser" taborder="1" class="btn_suttle_S_R" position="absolute 599 286 635 322" onclick="btn_addUser_onclick"/>
        <Button id="btn_delUser" taborder="1" class="btn_suttle_S_L" position="absolute 599 325 635 361" onclick="btn_delUser_onclick"/>
        <Button id="btn_addUserAll" taborder="1" class="btn_suttleR" position="absolute 599 247 635 283" onclick="btn_addUserAll_onclick"/>
        <Button id="btn_delUserAll" taborder="1" class="btn_suttleL" position="absolute 599 364 635 400" onclick="btn_delUserAll_onclick"/>
        <Static id="stc_recpCnt" text="수신자수 : &lt;b v='true'&gt;0&lt;/b&gt; 명" usedecorate="true" position="absolute 841 75 937 95" anchor="top right" style="align:right middle;"/>
        <Grid id="grd_treeList" class="grd_Mymenu_tree" taborder="1" binddataset="ds_tree_gongyong" useinputpanel="false" cellsizingtype="col" autofittype="col" treeuseline="false" treeusecheckbox="false" treeinitstatus="expand,all" oncellclick="tab_org_tpg_gongyong_grd_treeList_oncellclick" position="absolute 20 648 264 1059" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="25"/>
                <Column size="196"/>
                <Column size="25"/>
              </Columns>
              <Rows>
                <Row size="25"/>
              </Rows>
              <Band id="body">
                <Cell displaytype="image" style="align:right middle;" text="expr:membTypCd=='G'?'theme://images/ico_id.png':''"/>
                <Cell col="1" displaytype="normal" edittype="none" style="padding:0 10 0 5;" class="cel_Left" text="bind:gropNm" treelevel="bind:dpthVl"/>
                <Cell col="2" displaytype="image" style="cursor:EXPR(membTypCd=='G'?'hand':'');" text="expr:membTypCd=='G'?'theme://images/btn_WFDA_close_N.png':''"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_input_bonsa" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="orgzTypDivCd" type="STRING" size="256"/>
          <Column id="recpTrgtNm" type="STRING" size="256"/>
          <Column id="blngOrgzNm" type="STRING" size="256"/>
          <Column id="blngOrgzCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="orgzTypDivCd">01</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_input_youngup" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="orgzTypDivCd" type="STRING" size="256"/>
          <Column id="recpTrgtNm" type="STRING" size="256"/>
          <Column id="blngOrgzNm" type="STRING" size="256"/>
          <Column id="blngOrgzCd" type="STRING" size="256"/>
          <Column id="bzdpDivCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="orgzTypDivCd">02</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_input_tree" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="orgzTypDivCd" type="STRING" size="256"/>
          <Column id="bzdpDivCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="orgzTypDivCd"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_tree_bonsa" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="orgzCd" type="STRING" size="255"/>
          <Column id="hgrnOrgzCd" type="STRING" size="255"/>
          <Column id="orgzTypDivCd" type="STRING" size="255"/>
          <Column id="dpthVl" type="STRING" size="255"/>
          <Column id="crtnDttm" type="STRING" size="255"/>
          <Column id="cretId" type="STRING" size="255"/>
          <Column id="crtnIp" type="STRING" size="255"/>
          <Column id="crtnTrmlId" type="STRING" size="255"/>
          <Column id="lastAmntDttm" type="STRING" size="255"/>
          <Column id="lastAmndId" type="STRING" size="255"/>
          <Column id="lastAmntIp" type="STRING" size="255"/>
          <Column id="lastAmntTrmlId" type="STRING" size="255"/>
          <Column id="orgzNm" type="STRING" size="255"/>
          <Column id="hdqrOrgzYn" type="STRING" size="255"/>
          <Column id="_chk" type="STRING" size="1"/>
          <Column id="xRowStatusType" type="STRING" size="1"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tree_youngup" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="orgzCd" type="STRING" size="255"/>
          <Column id="hgrnOrgzCd" type="STRING" size="255"/>
          <Column id="orgzTypDivCd" type="STRING" size="255"/>
          <Column id="dpthVl" type="STRING" size="255"/>
          <Column id="crtnDttm" type="STRING" size="255"/>
          <Column id="cretId" type="STRING" size="255"/>
          <Column id="crtnIp" type="STRING" size="255"/>
          <Column id="crtnTrmlId" type="STRING" size="255"/>
          <Column id="lastAmntDttm" type="STRING" size="255"/>
          <Column id="lastAmndId" type="STRING" size="255"/>
          <Column id="lastAmntIp" type="STRING" size="255"/>
          <Column id="lastAmntTrmlId" type="STRING" size="255"/>
          <Column id="orgzNm" type="STRING" size="255"/>
          <Column id="hdqrOrgzYn" type="STRING" size="255"/>
          <Column id="_chk" type="STRING" size="1"/>
          <Column id="xRowStatusType" type="STRING" size="1"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_userlist_bonsa" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="recpTrgtId" type="STRING" size="255"/>
          <Column id="recpTrgtNm" type="STRING" size="255"/>
          <Column id="blngOrgzCd" type="STRING" size="255"/>
          <Column id="blngorgzNm" type="STRING" size="255"/>
          <Column id="jbttNm" type="STRING" size="255"/>
          <Column id="dtrsNm" type="STRING" size="255"/>
          <Column id="membTypCd" type="STRING" size="255"/>
          <Column id="_chk" type="STRING" size="1"/>
          <Column id="xRowStatusType" type="STRING" size="1"/>
          <Column id="userEmilAddr" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_userlist_youngup" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="recpTrgtId" type="STRING" size="255"/>
          <Column id="recpTrgtNm" type="STRING" size="255"/>
          <Column id="blngOrgzCd" type="STRING" size="255"/>
          <Column id="blngorgzNm" type="STRING" size="255"/>
          <Column id="jbttNm" type="STRING" size="255"/>
          <Column id="dtrsNm" type="STRING" size="255"/>
          <Column id="membTypCd" type="STRING" size="255"/>
          <Column id="_chk" type="STRING" size="1"/>
          <Column id="xRowStatusType" type="STRING" size="1"/>
          <Column id="userEmilAddr" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_userlist" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="recpTrgtId" type="STRING" size="255"/>
          <Column id="recpTrgtNm" type="STRING" size="255"/>
          <Column id="blngOrgzCd" type="STRING" size="255"/>
          <Column id="blngorgzNm" type="STRING" size="255"/>
          <Column id="jbttNm" type="STRING" size="255"/>
          <Column id="dtrsNm" type="STRING" size="255"/>
          <Column id="membTypCd" type="STRING" size="255"/>
          <Column id="_chk" type="STRING" size="1"/>
          <Column id="xRowStatusType" type="STRING" size="1"/>
          <Column id="userEmilAddr" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tree_gongyong" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="gropSrno" type="STRING" size="256"/>
          <Column id="hgrnGropSrno" type="STRING" size="256"/>
          <Column id="dpthVl" type="STRING" size="256"/>
          <Column id="gropNm" type="STRING" size="256"/>
          <Column id="editYn" type="STRING" size="256"/>
          <Column id="membTypCd" type="STRING" size="256"/>
          <Column id="gropLnpNo" type="STRING" size="256"/>
          <Column id="_chk" type="STRING" size="1"/>
          <Column id="xRowStatusType" type="STRING" size="1"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_userlist_gongyong" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="recpTrgtId" type="STRING" size="255"/>
          <Column id="recpTrgtNm" type="STRING" size="255"/>
          <Column id="blngOrgzCd" type="STRING" size="255"/>
          <Column id="blngorgzNm" type="STRING" size="255"/>
          <Column id="jbttNm" type="STRING" size="255"/>
          <Column id="dtrsNm" type="STRING" size="255"/>
          <Column id="membTypCd" type="STRING" size="255"/>
          <Column id="_chk" type="STRING" size="1"/>
          <Column id="xRowStatusType" type="STRING" size="1"/>
          <Column id="userEmilAddr" type="STRING" size="256"/>
          <Column id="persGropSrno" type="STRING" size="256"/>
          <Column id="userId" type="STRING" size="256"/>
          <Column id="membStupSrno" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_input_gongyong" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="orgzTypDivCd" type="STRING" size="256"/>
          <Column id="dpmsUserId" type="STRING" size="256"/>
          <Column id="membTypCd" type="STRING" size="256"/>
          <Column id="gropSrno" type="STRING" size="256"/>
          <Column id="recpTrgtNm" type="STRING" size="256"/>
          <Column id="blngOrgzNm" type="STRING" size="256"/>
          <Column id="bzdpDivCd" type="STRING" size="256"/>
          <Column id="userId" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="orgzTypDivCd">03</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="tab_org.tpg_bonsa.edt_recpTrgtNm" propid="value" datasetid="ds_input_bonsa" columnid="recpTrgtNm"/>
      <BindItem id="item1" compid="tab_org.tpg_bonsa.edt_blngOrgzNm" propid="value" datasetid="ds_input_bonsa" columnid="blngOrgzNm"/>
      <BindItem id="item2" compid="tab_org.tpg_youngup.edt_recpTrgtNm" propid="value" datasetid="ds_input_youngup" columnid="recpTrgtNm"/>
      <BindItem id="item3" compid="tab_org.tpg_youngup.edt_blngOrgzNm" propid="value" datasetid="ds_input_youngup" columnid="blngOrgzNm"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/***************************************************************************
 * Program ID    : SCRIP_GUIDE.xfdl
 * Program Name  : 스크립트 가이드
 * Author        : 홍길동
 * Created On    : 2012.11.05
 * 개    요 	 :
 *
 * =========================================================================
 * 변경일자     수정자    내    용
 * =========================================================================
 * 2012.11.05   홍길동    최초작성
 **************************************************************************/

//**************************************************************************
// [ PART 1 ] Form에서 Include 할 라이브러리(xjs)파일 정의
//**************************************************************************
include "LIB::lib_All.xjs";

function SYS0000400102_onload(obj:Form, e:LoadEventInfo)
{
	// 시스템 공통함수 호출
	//gfn_commInit(obj, true);
	
	fn_Init();
}

function fn_Init()
{
	// 본사조직 조회(탭변경시 해당탭  트리정보 조회)
	fn_searchTreeList("01");		// 본사조직:01, 영업조직:02
	
	var arrUserInfo 		= gfn_getUserInfo();
	tab_org.tpg_gongyong.stc_bzdpDivNm.text = arrUserInfo["bzdpDivCd"];
	ds_input_youngup.setColumn(0, "bzdpDivCd", arrUserInfo["bzdpDivCd"]);
	ds_input_gongyong.setColumn(0, "bzdpDivCd", arrUserInfo["bzdpDivCd"]);
	ds_input_gongyong.setColumn(0, "userId", arrUserInfo["userId"]);
	ds_input_tree.setColumn(0, "bzdpDivCd", arrUserInfo["bzdpDivCd"]);
	
	
	//trace(objects["pv_ObjDsUserlist"]);
	//trace(isValidObject(pv_ObjDsUserlist));
	//trace(pv_ObjDsUserlist.saveXML());
	
	ds_userlist.appendData(pv_ObjDsUserlist, true);
	//trace(ds_userlist.saveXML());
	fn_setReceiveUserCnt();
}

function btn_close_onclick(obj:Button,  e:ClickEventInfo)
{
	close();
}

// 본사조직 처리-----------------------------------------------------------------------------------------------

// 조회버튼 클릭 후 조회
function tab_org_tpg_bonsa_btn_search_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_searchBonsaCall();
}

function fn_searchBonsa_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13) {
		obj.updateToDataset();
		fn_searchBonsaCall();
	}
}

function fn_searchBonsaCall()
{
	var recpTrgtNm = this.tab_org.tpg_bonsa.edt_recpTrgtNm.value;
	var blngOrgzNm = this.tab_org.tpg_bonsa.edt_blngOrgzNm.value;
	
	if(gfn_getLength(recpTrgtNm) <= 0 && gfn_getLength(blngOrgzNm) <= 0) {
		alert("성명 또는 부서를 입력하세요!");
		return false;
	}

	fn_searchBonsa("S");
}

// 트리노드 클릭 후 조회
function tab_org_tpg_bonsa_grd_treeList_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	var objDs = this.objects[obj.binddataset];

	var sOrgzCd = objDs.getColumn(e.row, "orgzCd");
	fn_searchBonsa("T", sOrgzCd);
}

/***************************************************************************
 * 함  수  명		: fn_searchBonsa()
 * Param			: 1. sDiv : 조회구분(조회버튼클릭:S, 트리노드클릭:T) 
 * 기      능		: 본사조직 받는사람 조회
 ***************************************************************************/
function fn_searchBonsa(sDiv, sOrgzCd)
{
	// 초기화
	gfn_clearSortMark(tab_org.tpg_bonsa.grd_list);
	ds_userlist_bonsa.clearData();

	// KWData 설정
	gfn_kwDataInit();
	gfn_setKwData_nameSpace("com.kyowon.krp.sys.dc.generaladmnistrationdc.DCGnrlAdmnSqlMap");
	gfn_setKwData_trscCode("SYS00004R13");
	gfn_setKwData_sqlId("getTrgtUserList");

	if(sDiv == "S") {
		// 초기화
		ds_input_bonsa.setColumn(0, "blngOrgzCd", "");
	} else {
		// 초기화
		ds_input_bonsa.setColumn(0, "recpTrgtNm", "");
		ds_input_bonsa.setColumn(0, "blngOrgzNm", "");
		
		// 트리클릭한 조직정보 설정
		ds_input_bonsa.setColumn(0, "blngOrgzCd", sOrgzCd);
		//trace("sOrgzCd::"+sOrgzCd);
	}
	
	//trace(ds_input_bonsa.saveXML());

	gfn_tranDIS(gfn_getCommTypeAppend()
				, "ds_Input=ds_input_bonsa"
				, "ds_userlist_bonsa=datas"
				, "fn_searchBonsa_callBack");
}


/***************************************************************************
 * 함  수  명		: fn_searchBonsa_callBack()
 * 기      능		: [CallBack함수] Transaction Callback함수
 ***************************************************************************/
function fn_searchBonsa_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	if(nErrorCode != 0) {
		return;
	}
	
	//trace(ds_userlist_bonsa.saveXML());
}	

function tab_org_tpg_bonsa_grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	gfn_grdHeadClick(obj, e);
}

// 그리드 더블클릭시 받을사람 추가
function tab_org_tpg_bonsa_grd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	var objDs = this.objects[obj.binddataset];
	fn_addUser(objDs, e.row);
}


// 영업조직 처리-----------------------------------------------------------------------------------------------

// 조회버튼 클릭 후 조회
function tab_org_tpg_youngup_btn_search_onclick(obj:Button,  e:ClickEventInfo)
{
	//fn_searchYoungup("S");
	fn_searchYoungupCall();
}

function fn_searchYoungup_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13) {
		obj.updateToDataset();
		fn_searchYoungupCall();
	}
}

function fn_searchYoungupCall()
{
	var recpTrgtNm = this.tab_org.tpg_youngup.edt_recpTrgtNm.value;
	var blngOrgzNm = this.tab_org.tpg_youngup.edt_blngOrgzNm.value;
	
	if(gfn_getLength(recpTrgtNm) <= 0 && gfn_getLength(blngOrgzNm) <= 0) {
		alert("성명 또는 부서를 입력하세요!");
		return false;
	}

	fn_searchYoungup("S");
}

// 트리노드 클릭 후 조회
function tab_org_tpg_youngup_grd_treeList_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	var objDs = this.objects[obj.binddataset];

	var sOrgzCd = objDs.getColumn(e.row, "orgzCd");
	fn_searchYoungup("T", sOrgzCd);
}


/***************************************************************************
 * 함  수  명		: fn_searchYoungup()
 * Param			: 1. sDiv : 조회구분(조회버튼클릭:S, 트리노드클릭:T) 
 * 기      능		: 영업조직 받는사람 조회
 ***************************************************************************/
function fn_searchYoungup(sDiv, sOrgzCd)
{
	// 초기화
	gfn_clearSortMark(tab_org.tpg_youngup.grd_list);
	ds_userlist_youngup.clearData();	
	
	// KWData 설정
	gfn_kwDataInit();
	gfn_setKwData_nameSpace("com.kyowon.krp.sys.dc.generaladmnistrationdc.DCGnrlAdmnSqlMap");
	gfn_setKwData_trscCode("SYS00004R13");
	gfn_setKwData_sqlId("getTrgtUserList");

	if(sDiv == "S") {
		// 초기화
		ds_input_youngup.setColumn(0, "blngOrgzCd", "");
	} else {
		// 초기화
		ds_input_youngup.setColumn(0, "recpTrgtNm", "");
		ds_input_youngup.setColumn(0, "blngOrgzNm", "");
		
		// 트리클릭한 조직정보 설정
		ds_input_youngup.setColumn(0, "blngOrgzCd", sOrgzCd);
		//trace("sOrgzCd::"+sOrgzCd);
	}

	gfn_tranDIS(gfn_getCommTypeAppend()
				, "ds_Input=ds_input_youngup"
				, "ds_userlist_youngup=datas"
				, "fn_searchYoungup_callBack");
}


/***************************************************************************
 * 함  수  명		: fn_searchYoungup_callBack()
 * 기      능		: [CallBack함수] Transaction Callback함수
 ***************************************************************************/
function fn_searchYoungup_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	if(nErrorCode != 0) {
		return;
	}
	
	//trace(ds_userlist_youngup.saveXML());
}	

function tab_org_tpg_youngup_grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	gfn_grdHeadClick(obj, e);
}

function tab_org_tpg_youngup_grd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	var objDs = this.objects[obj.binddataset];
	fn_addUser(objDs, e.row);
}



// 공용조직 처리-----------------------------------------------------------------------------------------------

// 그룹추가
function tab_org_tpg_gongyong_btn_groupAdd_onclick(obj:Button,  e:ClickEventInfo)
{
	var strParam = "";
	var reVal = gfn_diaLog("SYS0000400103", -1, -1, 361, 342, "SYS::SYS0000400103.xfdl", false, strParam, false, true, true);
	
	//trace("reVal>>>>>>>>>>>"+reVal);
	
	if(reVal == "OK") {
		fn_searchTreeList("03");
	}
}

// 구성원 추가
function tab_org_tpg_gongyong_btn_userAdd_onclick(obj:Button,  e:ClickEventInfo)
{
	var strParam = {pv_ObjDsUserlist:ds_userlist_gongyong,pv_gropSrno:ds_tree_gongyong.getColumn(ds_tree_gongyong.rowposition, "gropSrno")};
	var reVal = gfn_diaLog("SYS0000400104", -1, -1, 968, 467, "SYS::SYS0000400104.xfdl", false, strParam, false, true, true);
	
	if(reVal == "OK") {
		var sGropSrno 	= ds_tree_gongyong.getColumn(ds_tree_gongyong.rowposition, "gropSrno");
		var sMembTypCd	= ds_tree_gongyong.getColumn(ds_tree_gongyong.rowposition, "membTypCd");
		fn_searchGongyong("T", sGropSrno, sMembTypCd);
	}
	
// 	var strParam = {pv_ObjDsUserlist:ds_sendList};
// 	var reVal = gfn_diaLog("SYS0000400102", -1, -1, 958, 620, "SYS::SYS0000400102.xfdl", false, strParam, false, true, true);
// 	 
// 	if(reVal instanceof Dataset) {
// 		ds_sendList.assign(reVal);
// 		fn_setReceiveUserList(ds_sendList);
// 	}	
}

function tab_org_tpg_gongyong_btn_search_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_searchGongyongCall();
}

function fn_searchGongyong_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13) {
		obj.updateToDataset();
		fn_searchGongyongCall();
	}
}

function fn_searchGongyongCall()
{
	var recpTrgtNm = this.tab_org.tpg_gongyong.edt_recpTrgtNm.value;
	var blngOrgzNm = this.tab_org.tpg_gongyong.edt_blngOrgzNm.value;
	
	if(gfn_getLength(recpTrgtNm) <= 0 && gfn_getLength(blngOrgzNm) <= 0) {
		alert("성명 또는 그룹명을 입력하세요!");
		return false;
	}

	fn_searchGongyong("S");
}


function tab_org_tpg_gongyong_grd_treeList_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	var objDs = this.objects[obj.binddataset];

	var sGropSrno 	= objDs.getColumn(e.row, "gropSrno");
	var sMembTypCd	= objDs.getColumn(e.row, "membTypCd");
	var editYn      = objDs.getColumn(e.row, "editYn");
	//공용그룹의 경우 Editable한 경우 구성원 추가/삭제가 가능하다.
	if (editYn == "N") {
		tab_org.tpg_gongyong.btn_userAdd.enable = false;
		tab_org.tpg_gongyong.btn_userDel.enable = false;
	} else {
		tab_org.tpg_gongyong.btn_userAdd.enable = true;
		tab_org.tpg_gongyong.btn_userDel.enable = true;
	}
	
	fn_searchGongyong("T", sGropSrno, sMembTypCd);
}

/***************************************************************************
 * 함  수  명		: fn_searchGongyong()
 * Param			: 1. sDiv : 조회구분(조회버튼클릭:S, 트리노드클릭:T) 
 * 기      능		: 공용조직 받는사람 조회
 ***************************************************************************/
function fn_searchGongyong(sDiv, sGropSrno, sMembTypCd)
{
	var objUserInfo	= gfn_getUserInfo();

	// 초기화
	gfn_clearSortMark(tab_org.tpg_gongyong.grd_list);
	ds_userlist_gongyong.clearData();	
	
	// KWData 설정
	gfn_kwDataInit();
	gfn_setKwData_nameSpace("com.kyowon.krp.sys.dc.generaladmnistrationdc.DCGnrlAdmnSqlMap");
	gfn_setKwData_trscCode("SYS00002R16");
	gfn_setKwData_sqlId("getGropUserList");

	ds_input_gongyong.setColumn(0, "dpmsUserId", 	objUserInfo.userId);

	if(sDiv == "S") {
		// 초기화
		ds_input_gongyong.setColumn(0, "blngOrgzCd", 	"");
		ds_input_gongyong.setColumn(0, "gropSrno", 		"");
		ds_input_gongyong.setColumn(0, "membTypCd", 	"");
	} else {
		// 초기화
		ds_input_gongyong.setColumn(0, "recpTrgtNm", 	"");
		ds_input_gongyong.setColumn(0, "blngOrgzNm", 	"");
		ds_input_gongyong.setColumn(0, "membTypCd", 	sMembTypCd);
		
		// 트리클릭한 그룹정보 설정
		ds_input_gongyong.setColumn(0, "gropSrno", sGropSrno);
		//trace("sGropSrno::"+sGropSrno);
	}
	
	//trace(ds_input_gongyong.saveXML());

	gfn_tranDIS(gfn_getCommTypeAppend()
				, "ds_Input=ds_input_gongyong"
				, "ds_userlist_gongyong=datas"
				, "fn_searchGongyong_callBack");
}

/***************************************************************************
 * 함  수  명		: fn_searchGongyong_callBack()
 * 기      능		: [CallBack함수] Transaction Callback함수
 ***************************************************************************/
function fn_searchGongyong_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	if(nErrorCode != 0) {
		return;
	}
	
	//trace(ds_userlist_gongyong.saveXML());
}	

function tab_org_tpg_gongyong_grd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	var objDs = this.objects[obj.binddataset];
	fn_addUser(objDs, e.row);
}

function tab_org_tpg_gongyong_grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	gfn_grdHeadClick(obj, e);
}


// 공통 처리-----------------------------------------------------------------------------------------------

/***************************************************************************
 * 함  수  명		: fn_searchTreeList()
 * 기      능		: 본사조직/영업조직 트리리스트 조회
 ***************************************************************************/
function fn_searchTreeList(sDiv)
{
	// KWData 설정
	gfn_kwDataInit();
	gfn_setKwData_nameSpace("com.kyowon.krp.sys.dc.generaladmnistrationdc.DCGnrlAdmnSqlMap");
	

	ds_input_tree.setColumn(0, "orgzTypDivCd", sDiv);
	
	var sOutDatasets = "";
	var sInDatasets = "";
	if(sDiv == "01") {
		gfn_setKwData_trscCode("SYS00004R14");
		gfn_setKwData_sqlId("getTrgtOrgzStrc");
		sInDatasets = "ds_Input=ds_input_tree";
		sOutDatasets = "ds_tree_bonsa=datas";
	} else if(sDiv == "02") {
		gfn_setKwData_trscCode("SYS00004R14");
		gfn_setKwData_sqlId("getTrgtOrgzStrc");
		sInDatasets = "ds_Input=ds_input_tree";
		sOutDatasets = "ds_tree_youngup=datas";
	} else if(sDiv == "03") {
		gfn_setKwData_trscCode("SYS00004R14");
		gfn_setKwData_sqlId("getTrgtGropStrc");
		sInDatasets = "ds_Input=ds_input_gongyong";
		sOutDatasets = "ds_tree_gongyong=datas";
	}

	gfn_tranDIS(gfn_getCommTypeAppend()
				, sInDatasets
				, sOutDatasets
				, "fn_searchTreeList_callBack");
}

/***************************************************************************
 * 함  수  명		: fn_searchTreeList_callBack()
 * 기      능		: [CallBack함수] Transaction Callback함수
 ***************************************************************************/
function fn_searchTreeList_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	if(nErrorCode != 0) {
		return;
	}
	
	trace(ds_tree_gongyong.saveXML());
	
	if(this.tab_org.tabindex == 2) {
		if(ds_tree_gongyong.rowcount > 0) {
			var sGropSrno 	= ds_tree_gongyong.getColumn(ds_tree_gongyong.rowposition, "gropSrno");
			var sMembTypCd	= ds_tree_gongyong.getColumn(ds_tree_gongyong.rowposition, "membTypCd");
			fn_searchGongyong("T", sGropSrno, sMembTypCd);
		}	
	}
	
	//trace(ds_tree_gongyong.saveXML());
}	


function tab_org_onchanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	if(e.postindex == 0) {
		if(ds_tree_bonsa.rowcount <= 0) fn_searchTreeList("01");		// 본사조직:01, 영업조직:02
	} else if(e.postindex == 1) {
		if(ds_tree_youngup.rowcount <= 0) fn_searchTreeList("02");		// 본사조직:01, 영업조직:02
	} else if(e.postindex == 2) {
		if(ds_tree_gongyong.rowcount <= 0) fn_searchTreeList("03");		// 본사조직:01, 영업조직:02, 공용그룹:03
	}
}

// 받는사람 리스트 추가
function btn_addUser_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_addUserCall("S");
}

function btn_addUserAll_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_addUserCall("A");
}

function fn_addUserCall(sGbn)
{
	var objDs;
	var objGrid;
	
	if(tab_org.tabindex == 0) {				// 본사조직
		objDs 	= ds_userlist_bonsa;
		objGrid	= tab_org.tpg_bonsa.grd_list;
	} else if(tab_org.tabindex == 1) {		// 영업조직
		objDs 	= ds_userlist_youngup;
		objGrid	= tab_org.tpg_youngup.grd_list;
	} else if(tab_org.tabindex == 2) {		// 공용조직
		objDs 	= ds_userlist_gongyong;
		objGrid	= tab_org.tpg_gongyong.grd_list;
	}
	
	for(var i=0;i<objDs.rowcount;i++)
	{
		if(sGbn == "A") {
			fn_addUser(objDs, i);
		} else {
			if(objDs.getColumn(i, "_chk") == 1) {
				fn_addUser(objDs, i);
			}
		}	
	}	
	
	objGrid.setCellProperty("head", 0, "text", 0);
	
	fn_setReceiveUserCnt();
}

// 받는사람 리스트 추가
function fn_addUser(objDs, nFromRow)
{
	var nFRow = ds_userlist.findRow("recpTrgtId", objDs.getColumn(nFromRow, "recpTrgtId"));

	if(nFRow == -1) {
		var nRow = ds_userlist.addRow();
		ds_userlist.copyRow(nRow, objDs, nFromRow, "recpTrgtId=recpTrgtId,recpTrgtNm=recpTrgtNm,blngOrgzCd=blngOrgzCd,blngorgzNm=blngorgzNm,jbttNm=jbttNm,dtrsNm=dtrsNm,membTypCd=membTypCd,userEmilAddr=userEmilAddr");
		objDs.setColumn(nFromRow, "_chk", 0);
	}	
}

// 받는사람 리스트 삭제
function btn_delUser_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_delUserCall("S");
}

function btn_delUserAll_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_delUserCall("A");
}

function fn_delUserCall(sGbn)
{
	grd_receiveUserList.setCellProperty("head", 0, "text", 0);
	
	for(var i=ds_userlist.rowcount-1;i>=0;i--)
	{
		if(sGbn == "A") {
			ds_userlist.deleteRow(i);
		} else {
			if(ds_userlist.getColumn(i, "_chk") == 1) {
				ds_userlist.deleteRow(i);
			}		
		}
	}
	
	fn_setReceiveUserCnt();
}

function grd_receiveUserList_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	gfn_grdHeadClick(obj, e);
}

function btn_commit_onclick(obj:Button,  e:ClickEventInfo)
{
	var objDs = this.removeChild("ds_userlist");
	close(objDs);
}

function grd_receiveUserList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	var objDs = this.objects[obj.binddataset];
	objDs.deleteRow(e.row);
}

function fn_setReceiveUserCnt()
{
	var recpCnt = "수신자수 : <b v='true'>"+ds_userlist.rowcount+"</b> 명";
	stc_recpCnt.text = recpCnt;
}

function tab_org_tpg_gongyong_btn_userDel_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_userlist_gongyong.findRow("_chk", 1) == -1) {
		alert("삭제대상 구성원을 선택하세요!!");
		return;
	}

	if(!confirm("구성원삭제를 하시겠습니까?")) return;

	gfn_delGrid(ds_userlist_gongyong);
		
	fn_saveGropMember();
}

function fn_saveGropMember()
{
	// KWData 설정
	gfn_kwDataInit();
	gfn_setKwData_trscCode("SYS00002C32");

	gfn_tranNMCI(gfn_getCommTypeSave()
				, "ds_Input=ds_userlist_gongyong:U"
				, ""
				, "fn_saveGropMember_callBack");
}

/***************************************************************************
 * 함  수  명		: fn_saveGropMember_callBack()
 * 기      능		: [CallBack함수] Transaction Callback함수
 ***************************************************************************/
function fn_saveGropMember_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	if(nErrorCode != 0) {
		return;
	}
	
	var sGropSrno 	= ds_tree_gongyong.getColumn(ds_tree_gongyong.rowposition, "gropSrno");
	var sMembTypCd	= ds_tree_gongyong.getColumn(ds_tree_gongyong.rowposition, "membTypCd");
	fn_searchGongyong("T", sGropSrno, sMembTypCd);	
}	]]></Script>
  </Form>
</FDL>
