<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="DL460200" classname="캠페인관리" inheritanceid="" position="absolute 0 0 989 795" titletext="증서출력 - 일괄출력" onload="DL460300_onload" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="stc_27" class="sta_workSrcBg" position2="absolute l:0 r:0 t:7 h:87" positiontype="position2"/>
        <Edit id="edt_cpdcTitlNm08" taborder="19" position="absolute 756 -531 889 -511"/>
        <Button id="btn_excl" taborder="20" text="엑셀" onclick="btn_export_grid_onclick" class="btn_WF_Common" style="padding:0 0 0 0;" position2="absolute r:0 w:72 t:101 h:20" positiontype="position2" tabstop="false"/>
        <Static id="stc_05" text="상품명" class="sta_workSrcLabel1" position="absolute 15 67 61 87"/>
        <Edit id="edt_prod_cd" taborder="12" position="absolute 79 66 127 87" readonly="false" enable="true" onkeydown="edt_prod_keydown" inputtype="numberandenglish" inputmode="upper" maxlength="4" inputfilter="dot,comma,sign,symbol"/>
        <Edit id="edt_prod_nm" taborder="13" position="absolute 128 66 233 87" readonly="false" enable="true" onkeydown="edt_prod_keydown"/>
        <Button id="btn_01" taborder="14" class="btn_workSrcPop" position="absolute 234 66 254 86" onclick="btn_Prod_onclick"/>
        <Button id="btn_Search" taborder="16" onclick="btn_Search_onclick" class="btn_WF_Search" tooltiptext="조회" style="shadow:drop 0,0 0 #00000033;" position2="absolute r:83 w:72 t:67 h:20" positiontype="position2"/>
        <Button id="btn_Init00" taborder="21" onclick="btn_Init_onclick" class="btn_WF_Return" tooltiptext="초기화" position2="absolute r:9 w:72 t:67 h:20" positiontype="position2" tabstop="false"/>
        <Grid id="grd_list_display" taborder="22" binddataset="ds_list" useinputpanel="false" autofittype="none" onheadclick="grd_onheadclick" autosizingtype="none" cellsizingtype="col" position2="absolute l:0 r:0 t:125 b:4" positiontype="position2" oncelldblclick="grd_list_oncelldbclick" tabstop="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="25"/>
                <Column size="44"/>
                <Column size="235"/>
                <Column size="147"/>
                <Column size="70"/>
                <Column size="100"/>
                <Column size="75"/>
                <Column size="171"/>
                <Column size="100"/>
                <Column size="85"/>
                <Column size="100"/>
                <Column size="319"/>
                <Column size="69"/>
                <Column size="77"/>
                <Column size="74"/>
                <Column size="88"/>
                <Column size="40"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" edittype="checkbox"/>
                <Cell col="1" text="순번"/>
                <Cell col="2" text="담당자소속"/>
                <Cell col="3" text="증서번호"/>
                <Cell col="4" text="주계약"/>
                <Cell col="5" text="회원번호"/>
                <Cell col="6" text="회원명"/>
                <Cell col="7" text="상품명"/>
                <Cell col="8" text="가입일자"/>
                <Cell col="9" text="사원명"/>
                <Cell col="10" text="연락처"/>
                <Cell col="11" text="주소"/>
                <Cell col="12" text="출력구분"/>
                <Cell col="13" text="납입구분"/>
                <Cell col="14" text="승인구분"/>
                <Cell col="15" text="가입경로"/>
                <Cell col="16" text="send_mth"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                <Cell col="1" expr="currow+1"/>
                <Cell col="2" text="bind:dept_nm"/>
                <Cell col="3" displaytype="text" edittype="readonly" text="bind:dlv_id" editdisplay="display"/>
                <Cell col="4" displaytype="combo" text="bind:main_contract" combodataset="ds_main_contract" combocodecol="cd" combodatacol="cd_nm"/>
                <Cell col="5" displaytype="text" edittype="readonly" text="bind:accnt_no" editdisplay="display"/>
                <Cell col="6" text="bind:mem_nm" expr="expr:gfn_SetNameGrdSecu(mem_nm)"/>
                <Cell col="7" text="bind:prod_nm"/>
                <Cell col="8" text="bind:join_dt" mask="####-##-##"/>
                <Cell col="9" text="bind:emple_nm"/>
                <Cell col="10" text="bind:tell" mask="expr:gfn_SetTelNoGrdMaskSecu(tell)"/>
                <Cell col="11" style="align:left middle;" text="bind:addr" expr="expr:addr + ' ' + gfn_SetAddrGrdSecu(addr2)"/>
                <Cell col="12" text="bind:is_prt"/>
                <Cell col="13" text="bind:pay_mthd"/>
                <Cell col="14" text="bind:hp_stat"/>
                <Cell col="15" text="bind:join_cl"/>
                <Cell col="16" text="bind:send_mth"/>
              </Band>
            </Format>
            <Format id="excel">
              <Columns>
                <Column size="140"/>
                <Column size="114"/>
                <Column size="100"/>
                <Column size="82"/>
                <Column size="307"/>
                <Column size="126"/>
                <Column size="92"/>
                <Column size="136"/>
                <Column size="120"/>
                <Column size="153"/>
                <Column size="100"/>
                <Column size="85"/>
                <Column size="100"/>
                <Column size="136"/>
                <Column size="130"/>
                <Column size="100"/>
                <Column size="74"/>
                <Column size="88"/>
                <Column size="82"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="배송아이디"/>
                <Cell col="1" text="고객명"/>
                <Cell col="2" text="회원번호"/>
                <Cell col="3" text="연락처"/>
                <Cell col="4" text="주소"/>
                <Cell col="5" text="발송종류"/>
                <Cell col="6" text="발송유형"/>
                <Cell col="7" text="진행상태"/>
                <Cell col="8" text="사유"/>
                <Cell col="9" text="송장(등기)번호"/>
                <Cell col="10" text="발송일자"/>
                <Cell col="11" text="처리방법"/>
                <Cell col="12" text="처리결과"/>
                <Cell col="13" text="배송종료코드"/>
                <Cell col="14" text="배송유형코드"/>
                <Cell col="15" text="배송상태코드"/>
                <Cell col="16" text="사유코드"/>
                <Cell col="17" text="처리방법코드"/>
                <Cell col="18" text="처리결과코드"/>
              </Band>
              <Band id="body">
                <Cell text="bind:dlv_id"/>
                <Cell col="1" text="bind:mem_nm"/>
                <Cell col="2" displaytype="text" edittype="readonly" text="bind:accnt_no" editdisplay="display"/>
                <Cell col="3" text="bind:tell"/>
                <Cell col="4" text="bind:addr" expr="expr:addr + addr2"/>
                <Cell col="5" text="bind:sndg_kind_nm"/>
                <Cell col="6" text="bind:dlv_type_nm"/>
                <Cell col="7" text="bind:dlv_stat_nm"/>
                <Cell col="8"/>
                <Cell col="9"/>
                <Cell col="10" text="bind:div_dsps_dt" mask="####-##-##"/>
                <Cell col="11"/>
                <Cell col="12"/>
                <Cell col="13" style="align:left middle;" text="bind:sndg_kind_cd"/>
                <Cell col="14" text="bind:dlv_type_cd"/>
                <Cell col="15" text="bind:dlv_stat_cd"/>
                <Cell col="16"/>
                <Cell col="17"/>
                <Cell col="18"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="stc_11" text="검색기간" class="sta_workSrcLabel1" position="absolute 15 18 77 38"/>
        <Static id="sta_Dash00" text="~" position="absolute 179 22 190 37"/>
        <Calendar id="cal_stt_dt" taborder="0" dateformat="yyyy-MM-dd" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" position="absolute 79 18 174 38"/>
        <Calendar id="cal_end_dt" taborder="1" dateformat="yyyy-MM-dd" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" position="absolute 192 18 287 38"/>
        <Static id="sta_TotalCnt" text="검색결과   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt; / 전체   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt;" usedecorate="true" class="sta_workTitle5" position2="absolute l:1 w:186 t:105 h:20" positiontype="position2"/>
        <Static id="stc_00" text="회원번호" class="sta_workSrcLabel1" position="absolute 15 43 75 63"/>
        <Edit id="edt_accnt_no" taborder="6" onkeydown="edt_accnt_onkeydown" position="absolute 79 42 174 62" style="font:Dotum,9;" inputmode="upper" inputtype="numberandenglish" maxlength="12" inputfilter="dot,comma,sign,symbol"/>
        <Button id="btn_accnt_no" taborder="7" onclick="btn_accnt_onclick" class="btn_workSrcPop" position="absolute 175 42 195 62"/>
        <Static id="stc_03" text="발급형태" class="sta_workSrcLabel1" position="absolute 300 17 360 37"/>
        <Combo id="cbo_issue_frm" taborder="2" codecolumn="codecolumn" datacolumn="datacolumn" position="absolute 365 18 460 38">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">전체</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="stc_01" text="승인구분" class="sta_workSrcLabel1" position="absolute 300 42 360 62"/>
        <Combo id="cbo_hp_stat" taborder="8" codecolumn="codecolumn" datacolumn="datacolumn" position="absolute 365 42 460 62" index="0" value="00" text="전체">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">00</Col>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">01</Col>
                <Col id="datacolumn">승인</Col>
              </Row>
              <Row>
                <Col id="codecolumn">011</Col>
                <Col id="datacolumn">재승인</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="stc_02" text="상품구분" class="sta_workSrcLabel1" position="absolute 300 66 360 86"/>
        <Combo id="cbo_prod_cl" taborder="15" innerdataset="@ds_prod_cl" codecolumn="cd" datacolumn="cd_nm" position="absolute 365 66 460 86"/>
        <Static id="stc_04" text="영업소구분" class="sta_workSrcLabel1" position="absolute 476 17 544 37"/>
        <Combo id="cbo_dept_kind" taborder="3" innerdataset="@ds_dept_kind" codecolumn="cd" datacolumn="cd_nm" position="absolute 545 18 640 38"/>
        <Static id="stc_06" text="가입구분" class="sta_workSrcLabel1" position="absolute 476 42 536 62"/>
        <Combo id="cbo_online_gubn" taborder="9" innerdataset="@ds_join_cl" codecolumn="cd" datacolumn="cd_nm" position="absolute 545 42 640 62"/>
        <Static id="stc_08" text="출력구분" class="sta_workSrcLabel1" position="absolute 650 17 710 37"/>
        <Combo id="cbo_hist_ck" taborder="4" codecolumn="codecolumn" datacolumn="datacolumn" position="absolute 715 18 810 38" index="0" value="00" text="전체" onitemchanged="cbo_mem_stat05_onitemchanged">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">00</Col>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">01</Col>
                <Col id="datacolumn">출력</Col>
              </Row>
              <Row>
                <Col id="codecolumn">02</Col>
                <Col id="datacolumn">미출력</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="stc_09" text="납입방법" class="sta_workSrcLabel1" position="absolute 650 42 710 62"/>
        <Combo id="cbo_pay_mthd" taborder="10" innerdataset="@ds_pay_mthd" codecolumn="cd" datacolumn="cd_nm" position="absolute 715 42 810 62"/>
        <Static id="stc_12" text="조회대상" class="sta_workSrcLabel1" position="absolute 820 18 880 38"/>
        <Combo id="cbo_cond1" taborder="5" innerdataset="@ds_cond1" codecolumn="cd" datacolumn="cd_nm" position="absolute 885 18 996 38" onitemchanged="cbo_cond1_onitemchanged"/>
        <Static id="stc_13" text="조회조건" class="sta_workSrcLabel1" position="absolute 820 42 880 62"/>
        <Combo id="cbo_cond2" taborder="11" innerdataset="@ds_cond2" codecolumn="cd" datacolumn="cd_nm" position="absolute 885 42 996 62"/>
        <Button id="btn_certfMember" taborder="65" text="회원증서" class="btn_WF_Common" position2="absolute r:75 w:72 t:101 h:20" positiontype="position2" style="padding:0 0 0 0;" visible="false" onclick="btn_certfMember_onclick" tabstop="false"/>
        <ActiveX id="ActiveX00" progid="{0DEF32F8-170F-46F8-B1FF-4BF7443F5F25}" useautobitmapcache="1" position2="absolute l:1000 r:-272 t:3 b:675" positiontype="position2" taborder="67" visible="false"/>
        <Button id="btn_certfMember00" taborder="68" text="검색범위선택" onclick="btn_select_onclick" class="btn_WF_Common" visible="true" style="padding:0 0 0 0;" position2="absolute r:445 w:82 t:101 h:20" positiontype="position2"/>
        <Edit id="f_cnt" taborder="17" position2="absolute r:595 w:42 t:101 h:20" positiontype="position2" inputtype="digit"/>
        <Edit id="t_cnt" taborder="18" position2="absolute r:531 w:42 t:101 h:20" positiontype="position2" inputtype="digit"/>
        <Static id="Static00" text="~" position2="absolute r:579 w:10 t:101 h:20" positiontype="position2"/>
        <Button id="btn_cancle" taborder="71" text="검색범위취소" onclick="btn_delete_onclick" class="btn_WF_Common" position2="absolute r:359 w:82 t:101 h:20" positiontype="position2" style="padding:0 0 0 0;" tabstop="false"/>
        <Button id="btn_jaebal" taborder="72" text="증서재발행 산출" onclick="btn_jaebal_onclick" class="btn_WF_Common" position2="absolute r:154 w:98 t:101 h:20" positiontype="position2" style="padding:0 0 0 0;" tabstop="false"/>
        <Grid id="grd_list_prt" taborder="73" binddataset="ds_list" useinputpanel="false" cellsizingtype="col" onheadclick="grd_onheadclick" oncelldblclick="grd_list_oncelldbclick" position2="absolute l:1058 r:-1058 t:179 b:-50" positiontype="position2" visible="false" tabstop="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="25"/>
                <Column size="44"/>
                <Column size="235"/>
                <Column size="147"/>
                <Column size="100"/>
                <Column size="75"/>
                <Column size="171"/>
                <Column size="100"/>
                <Column size="85"/>
                <Column size="100"/>
                <Column size="319"/>
                <Column size="69"/>
                <Column size="77"/>
                <Column size="74"/>
                <Column size="88"/>
                <Column size="40"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" edittype="checkbox"/>
                <Cell col="1" text="순번"/>
                <Cell col="2" text="담당자소속"/>
                <Cell col="3" text="증서번호"/>
                <Cell col="4" text="회원번호"/>
                <Cell col="5" text="회원명"/>
                <Cell col="6" text="상품명"/>
                <Cell col="7" text="가입일자"/>
                <Cell col="8" text="사원명"/>
                <Cell col="9" text="연락처"/>
                <Cell col="10" text="주소"/>
                <Cell col="11" text="출력구분"/>
                <Cell col="12" text="납입구분"/>
                <Cell col="13" text="승인구분"/>
                <Cell col="14" text="가입경로"/>
                <Cell col="15" text="send_mth"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                <Cell col="1" expr="currow+1"/>
                <Cell col="2" text="bind:dept_nm"/>
                <Cell col="3" displaytype="text" edittype="readonly" text="bind:dlv_id" editdisplay="display"/>
                <Cell col="4" displaytype="text" edittype="readonly" text="bind:accnt_no" editdisplay="display"/>
                <Cell col="5" text="bind:mem_nm"/>
                <Cell col="6" text="bind:prod_nm"/>
                <Cell col="7" text="bind:join_dt" mask="####-##-##"/>
                <Cell col="8" text="bind:emple_nm"/>
                <Cell col="9" text="bind:tell"/>
                <Cell col="10" style="align:left middle;" text="bind:addr"/>
                <Cell col="11" text="bind:is_prt"/>
                <Cell col="12" text="bind:pay_mthd"/>
                <Cell col="13" text="bind:hp_stat"/>
                <Cell col="14" text="bind:join_cl"/>
                <Cell col="15" text="bind:send_mth"/>
              </Band>
            </Format>
            <Format id="excel">
              <Columns>
                <Column size="140"/>
                <Column size="114"/>
                <Column size="100"/>
                <Column size="126"/>
                <Column size="92"/>
                <Column size="136"/>
                <Column size="120"/>
                <Column size="153"/>
                <Column size="100"/>
                <Column size="85"/>
                <Column size="100"/>
                <Column size="136"/>
                <Column size="130"/>
                <Column size="100"/>
                <Column size="74"/>
                <Column size="88"/>
                <Column size="82"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="배송아이디"/>
                <Cell col="1" text="고객명"/>
                <Cell col="2" text="회원번호"/>
                <Cell col="3" text="발송종류"/>
                <Cell col="4" text="발송유형"/>
                <Cell col="5" text="진행상태"/>
                <Cell col="6" text="사유"/>
                <Cell col="7" text="송장(등기)번호"/>
                <Cell col="8" text="발송일자"/>
                <Cell col="9" text="처리방법"/>
                <Cell col="10" text="처리결과"/>
                <Cell col="11" text="배송종료코드"/>
                <Cell col="12" text="배송유형코드"/>
                <Cell col="13" text="배송상태코드"/>
                <Cell col="14" text="사유코드"/>
                <Cell col="15" text="처리방법코드"/>
                <Cell col="16" text="처리결과코드"/>
              </Band>
              <Band id="body">
                <Cell text="bind:dlv_id"/>
                <Cell col="1" text="bind:mem_nm"/>
                <Cell col="2" displaytype="text" edittype="readonly" text="bind:accnt_no" editdisplay="display"/>
                <Cell col="3" text="bind:sndg_kind_nm"/>
                <Cell col="4" text="bind:div_type_nm"/>
                <Cell col="5" text="bind:div_stat_nm"/>
                <Cell col="6"/>
                <Cell col="7"/>
                <Cell col="8" text="bind:div_dsps_dt" mask="####-##-##"/>
                <Cell col="9"/>
                <Cell col="10"/>
                <Cell col="11" style="align:left middle;" text="bind:sndg_kind_cd"/>
                <Cell col="12" text="bind:div_type_cd"/>
                <Cell col="13" text="bind:dlv_stat_cd"/>
                <Cell col="14"/>
                <Cell col="15"/>
                <Cell col="16"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="grd_list" taborder="74" tabstop="false" binddataset="ds_list" useinputpanel="false" cellsizingtype="col" onheadclick="grd_onheadclick" oncelldblclick="grd_list_oncelldbclick" position2="absolute l:88 r:-88 t:205 b:-76" positiontype="position2" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="25"/>
                <Column size="44"/>
                <Column size="235"/>
                <Column size="147"/>
                <Column size="70"/>
                <Column size="100"/>
                <Column size="75"/>
                <Column size="171"/>
                <Column size="100"/>
                <Column size="85"/>
                <Column size="100"/>
                <Column size="319"/>
                <Column size="69"/>
                <Column size="77"/>
                <Column size="74"/>
                <Column size="88"/>
                <Column size="40"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" edittype="checkbox"/>
                <Cell col="1" text="순번"/>
                <Cell col="2" text="담당자소속"/>
                <Cell col="3" text="증서번호"/>
                <Cell col="4" text="주계약"/>
                <Cell col="5" text="회원번호"/>
                <Cell col="6" text="회원명"/>
                <Cell col="7" text="상품명"/>
                <Cell col="8" text="가입일자"/>
                <Cell col="9" text="사원명"/>
                <Cell col="10" text="연락처"/>
                <Cell col="11" text="주소"/>
                <Cell col="12" text="출력구분"/>
                <Cell col="13" text="납입구분"/>
                <Cell col="14" text="승인구분"/>
                <Cell col="15" text="가입경로"/>
                <Cell col="16" text="send_mth"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                <Cell col="1" expr="currow+1"/>
                <Cell col="2" text="bind:dept_nm"/>
                <Cell col="3" displaytype="text" edittype="readonly" text="bind:dlv_id" editdisplay="display"/>
                <Cell col="4" displaytype="combo" text="bind:main_contract" combodataset="ds_main_contract" combocodecol="cd" combodatacol="cd_nm"/>
                <Cell col="5" displaytype="text" edittype="readonly" text="bind:accnt_no" editdisplay="display"/>
                <Cell col="6" text="bind:mem_nm"/>
                <Cell col="7" text="bind:prod_nm"/>
                <Cell col="8" text="bind:join_dt" mask="####-##-##"/>
                <Cell col="9" text="bind:emple_nm"/>
                <Cell col="10" text="bind:tell"/>
                <Cell col="11" style="align:left middle;" text="bind:addr" expr="expr:addr + ' ' + addr2"/>
                <Cell col="12" text="bind:is_prt"/>
                <Cell col="13" text="bind:pay_mthd"/>
                <Cell col="14" text="bind:hp_stat"/>
                <Cell col="15" text="bind:join_cl"/>
                <Cell col="16" text="bind:send_mth"/>
              </Band>
            </Format>
            <Format id="excel">
              <Columns>
                <Column size="140"/>
                <Column size="114"/>
                <Column size="100"/>
                <Column size="82"/>
                <Column size="307"/>
                <Column size="126"/>
                <Column size="92"/>
                <Column size="136"/>
                <Column size="120"/>
                <Column size="153"/>
                <Column size="100"/>
                <Column size="85"/>
                <Column size="100"/>
                <Column size="136"/>
                <Column size="130"/>
                <Column size="100"/>
                <Column size="74"/>
                <Column size="88"/>
                <Column size="82"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="배송아이디"/>
                <Cell col="1" text="고객명"/>
                <Cell col="2" text="회원번호"/>
                <Cell col="3" text="연락처"/>
                <Cell col="4" text="주소"/>
                <Cell col="5" text="발송종류"/>
                <Cell col="6" text="발송유형"/>
                <Cell col="7" text="진행상태"/>
                <Cell col="8" text="사유"/>
                <Cell col="9" text="송장(등기)번호"/>
                <Cell col="10" text="발송일자"/>
                <Cell col="11" text="처리방법"/>
                <Cell col="12" text="처리결과"/>
                <Cell col="13" text="배송종료코드"/>
                <Cell col="14" text="배송유형코드"/>
                <Cell col="15" text="배송상태코드"/>
                <Cell col="16" text="사유코드"/>
                <Cell col="17" text="처리방법코드"/>
                <Cell col="18" text="처리결과코드"/>
              </Band>
              <Band id="body">
                <Cell text="bind:dlv_id"/>
                <Cell col="1" text="bind:mem_nm"/>
                <Cell col="2" displaytype="text" edittype="readonly" text="bind:accnt_no" editdisplay="display"/>
                <Cell col="3" text="bind:tell"/>
                <Cell col="4" text="bind:addr" expr="expr:addr + addr2"/>
                <Cell col="5" text="bind:sndg_kind_nm"/>
                <Cell col="6" text="bind:dlv_type_nm"/>
                <Cell col="7" text="bind:dlv_stat_nm"/>
                <Cell col="8"/>
                <Cell col="9"/>
                <Cell col="10" text="bind:div_dsps_dt" mask="####-##-##"/>
                <Cell col="11"/>
                <Cell col="12"/>
                <Cell col="13" style="align:left middle;" text="bind:sndg_kind_cd"/>
                <Cell col="14" text="bind:dlv_type_cd"/>
                <Cell col="15" text="bind:dlv_stat_cd"/>
                <Cell col="16"/>
                <Cell col="17"/>
                <Cell col="18"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_clCondData" taborder="75" tabstop="false" text="증서상품등록" class="btn_WF_Common" position2="absolute r:257 w:98 t:101 h:20" positiontype="position2" style="padding:0 0 0 0;" onclick="btn_clCondData_onclick"/>
        <Static id="stc_07" text="주계약" class="sta_workSrcLabel1" position="absolute 1012 42 1072 62"/>
        <Combo id="cbo_main_contract" taborder="76" innerdataset="@ds_main_contract" codecolumn="cd" datacolumn="cd_nm" position="absolute 1077 42 1172 62" enable="true"/>
      </Layout>
    </Layouts>
    <Bind/>
    <Objects>
      <Dataset id="ds_list_tmp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="ded_no" type="STRING" size="256"/>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="expr_dt" type="STRING" size="256"/>
          <Column id="prod_amt" type="STRING" size="256"/>
          <Column id="mon_pay_amt" type="STRING" size="256"/>
          <Column id="new_chan_gunsu" type="STRING" size="256"/>
          <Column id="pay_mthd" type="STRING" size="256"/>
          <Column id="daeche_amt" type="STRING" size="256"/>
          <Column id="prod_cl" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="pay_gigan" type="STRING" size="256"/>
          <Column id="join_pay_count" type="STRING" size="256"/>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="addr" type="STRING" size="256"/>
          <Column id="len" type="STRING" size="256"/>
          <Column id="idn_no" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="join_dt_gbn" type="STRING" size="256"/>
          <Column id="chk_yn" type="STRING" size="256"/>
          <Column id="tell" type="STRING" size="256"/>
          <Column id="cp_cd" type="STRING" size="256"/>
          <Column id="is_prt" type="STRING" size="256"/>
          <Column id="hp_stat" type="STRING" size="256"/>
          <Column id="join_cl" type="STRING" size="256"/>
          <Column id="dlv_id" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="ded_no" type="STRING" size="256"/>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="expr_dt" type="STRING" size="256"/>
          <Column id="prod_amt" type="STRING" size="256"/>
          <Column id="mon_pay_amt" type="STRING" size="256"/>
          <Column id="new_chan_gunsu" type="STRING" size="256"/>
          <Column id="pay_mthd" type="STRING" size="256"/>
          <Column id="daeche_amt" type="STRING" size="256"/>
          <Column id="prod_cl" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="pay_gigan" type="STRING" size="256"/>
          <Column id="join_pay_count" type="STRING" size="256"/>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="addr" type="STRING" size="256"/>
          <Column id="addr2" type="STRING" size="256"/>
          <Column id="len" type="STRING" size="256"/>
          <Column id="idn_no" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="join_dt_gbn" type="STRING" size="256"/>
          <Column id="chk_yn" type="STRING" size="256"/>
          <Column id="tell" type="STRING" size="256"/>
          <Column id="cp_cd" type="STRING" size="256"/>
          <Column id="is_prt" type="STRING" size="256"/>
          <Column id="hp_stat" type="STRING" size="256"/>
          <Column id="join_cl" type="STRING" size="256"/>
          <Column id="dlv_id" type="STRING" size="256"/>
          <Column id="sndg_kind_nm" type="STRING" size="256"/>
          <Column id="dlv_type_nm" type="STRING" size="256"/>
          <Column id="dlv_stat_nm" type="STRING" size="256"/>
          <Column id="dlv_dsps_dt" type="STRING" size="256"/>
          <Column id="sndg_kind_cd" type="STRING" size="256"/>
          <Column id="dlv_type_cd" type="STRING" size="256"/>
          <Column id="dlv_stat_cd" type="STRING" size="256"/>
          <Column id="main_contract" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <ExportObject id="ExportObject00" exporttype="0" exporteventtype="itemrecord" onexport="ExportObject00_onexport"/>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="condQury" type="STRING" size="256"/>
          <Column id="dataAthrQury" type="STRING" size="256"/>
          <Column id="stt_dt" type="STRING" size="256"/>
          <Column id="end_dt" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="issue_frm" type="STRING" size="256"/>
          <Column id="hp_stat" type="STRING" size="256"/>
          <Column id="prod_cl" type="STRING" size="256"/>
          <Column id="dept_kind" type="STRING" size="256"/>
          <Column id="online_gubn" type="STRING" size="256"/>
          <Column id="hist_ck" type="STRING" size="256"/>
          <Column id="pay_mthd" type="STRING" size="256"/>
          <Column id="cond1" type="STRING" size="256"/>
          <Column id="cond2" type="STRING" size="256"/>
          <Column id="dept_cd" type="STRING" size="256"/>
          <Column id="menu_cd" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
          <Column id="send_mth" type="STRING" size="256"/>
          <Column id="main_contract" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_accnt_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="page_indx" type="STRING" size="6"/>
          <Column id="accnt_no" type="STRING" size="100"/>
          <Column id="mem_no" type="STRING" size="100"/>
          <Column id="mem_nm" type="STRING" size="100"/>
          <Column id="home_tel" type="STRING" size="100"/>
          <Column id="cell" type="STRING" size="100"/>
          <Column id="wrpl_tel" type="STRING" size="100"/>
          <Column id="idn_no" type="STRING" size="100"/>
          <Column id="prod_cd" type="STRING" size="100"/>
          <Column id="prod_nm" type="STRING" size="100"/>
          <Column id="prod_amt" type="STRING" size="100"/>
          <Column id="mon_pay_amt" type="STRING" size="100"/>
          <Column id="expr_no" type="STRING" size="100"/>
          <Column id="emple_no" type="STRING" size="100"/>
          <Column id="emple_nm" type="STRING" size="100"/>
          <Column id="appfm_no" type="STRING" size="100"/>
          <Column id="join_dt" type="STRING" size="100"/>
          <Column id="compt_dt" type="STRING" size="100"/>
          <Column id="bef_emple_cd" type="STRING" size="100"/>
          <Column id="pay_perd" type="STRING" size="100"/>
          <Column id="pay_mthd" type="STRING" size="100"/>
          <Column id="join_prod" type="STRING" size="100"/>
          <Column id="new_chan_gunsu" type="STRING" size="100"/>
          <Column id="certf_rcv_chk" type="STRING" size="100"/>
          <Column id="pay_stat_1no" type="STRING" size="100"/>
          <Column id="ichae_dt" type="STRING" size="100"/>
          <Column id="bank_accnt_no" type="STRING" size="100"/>
          <Column id="old_mid" type="STRING" size="100"/>
          <Column id="reg_dm" type="STRING" size="100"/>
          <Column id="reg_man" type="STRING" size="100"/>
          <Column id="upd_dm" type="STRING" size="100"/>
          <Column id="upd_man" type="STRING" size="100"/>
          <Column id="accnt_stat" type="STRING" size="100"/>
          <Column id="total_pay" type="STRING" size="100"/>
          <Column id="last_no" type="STRING" size="100"/>
          <Column id="real_pay_no" type="STRING" size="100"/>
          <Column id="ded_no" type="STRING" size="100"/>
          <Column id="join_cl" type="STRING" size="100"/>
          <Column id="trans_gubun" type="STRING" size="100"/>
          <Column id="brth_mon_day" type="STRING" size="100"/>
          <Column id="pay_mthd" type="STRING" size="100"/>
          <Column id="emp_cell" type="STRING" size="100"/>
          <Column id="join_stat" type="STRING" size="100"/>
          <Column id="pay_stat" type="STRING" size="100"/>
          <Column id="pay_no" type="STRING" size="100"/>
          <Column id="pay_allt_no" type="STRING" size="100"/>
          <Column id="pay_add_no" type="STRING" size="100"/>
          <Column id="pay_amt" type="STRING" size="100"/>
          <Column id="pay_allt_amt" type="STRING" size="100"/>
          <Column id="pay_add_amt" type="STRING" size="100"/>
          <Column id="model_cl_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_prodList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="page_indx" type="STRING" size="6"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="mon_pay_amt" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="prod_amt" type="STRING" size="256"/>
          <Column id="use_cnt" type="STRING" size="256"/>
          <Column id="reg_dm" type="STRING" size="256"/>
          <Column id="prod_cl" type="STRING" size="256"/>
          <Column id="prod_cl_nm" type="STRING" size="256"/>
          <Column id="sale_gubn" type="STRING" size="256"/>
          <Column id="sale_cl" type="STRING" size="256"/>
          <Column id="sale_close_day" type="STRING" size="256"/>
          <Column id="prod_save_point" type="STRING" size="256"/>
          <Column id="pay_type" type="STRING" size="256"/>
          <Column id="pay_type_nm" type="STRING" size="256"/>
          <Column id="join_type" type="STRING" size="256"/>
          <Column id="join_type_nm" type="STRING" size="256"/>
          <Column id="join_gift_card_sort" type="STRING" size="256"/>
          <Column id="join_gift_card_sort_nm" type="STRING" size="256"/>
          <Column id="join_gift_card_amt" type="STRING" size="256"/>
          <Column id="prod_dc_cnt" type="STRING" size="256"/>
          <Column id="membership" type="STRING" size="256"/>
          <Column id="ocb_point" type="STRING" size="256"/>
          <Column id="ocb_fee" type="STRING" size="256"/>
          <Column id="upd_man" type="STRING" size="256"/>
          <Column id="lgbestcl" type="STRING" size="256"/>
          <Column id="order_seq" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_accntInqCndt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srch_typ" type="STRING" size="256"/>
          <Column id="srch_vl" type="STRING" size="256"/>
          <Column id="option" type="STRING" size="256"/>
          <Column id="ns_yn" type="STRING" size="256"/>
          <Column id="popup_yn" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_total" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="ded_no" type="STRING" size="256"/>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="expr_dt" type="STRING" size="256"/>
          <Column id="prod_amt" type="STRING" size="256"/>
          <Column id="mon_pay_amt" type="STRING" size="256"/>
          <Column id="new_chan_gunsu" type="STRING" size="256"/>
          <Column id="pay_mthd" type="STRING" size="256"/>
          <Column id="daeche_amt" type="STRING" size="256"/>
          <Column id="prod_cl" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="pay_gigan" type="STRING" size="256"/>
          <Column id="join_pay_count" type="STRING" size="256"/>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="addr" type="STRING" size="256"/>
          <Column id="len" type="STRING" size="256"/>
          <Column id="idn_no" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="join_dt_gbn" type="STRING" size="256"/>
          <Column id="chk_yn" type="STRING" size="256"/>
          <Column id="tell" type="STRING" size="256"/>
          <Column id="cp_cd" type="STRING" size="256"/>
          <Column id="is_prt" type="STRING" size="256"/>
          <Column id="hp_stat" type="STRING" size="256"/>
          <Column id="join_cl" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_issue_frm" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dept_kind" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_join_cl" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_pay_mthd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_prod_cl" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond_tmp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_basVlInfo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="bas_vl_id" type="STRING" size="256"/>
          <Column id="bas_vl_nm" type="STRING" size="256"/>
          <Column id="bas_vl" type="STRING" size="256"/>
          <Column id="bas_vl_expi" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_print" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="ded_no" type="STRING" size="256"/>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="expr_dt" type="STRING" size="256"/>
          <Column id="prod_amt" type="STRING" size="256"/>
          <Column id="mon_pay_amt" type="STRING" size="256"/>
          <Column id="new_chan_gunsu" type="STRING" size="256"/>
          <Column id="pay_mthd" type="STRING" size="256"/>
          <Column id="daeche_amt" type="STRING" size="256"/>
          <Column id="prod_cl" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="pay_gigan" type="STRING" size="256"/>
          <Column id="join_pay_count" type="STRING" size="256"/>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="addr" type="STRING" size="256"/>
          <Column id="len" type="STRING" size="256"/>
          <Column id="idn_no" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="join_dt_gbn" type="STRING" size="256"/>
          <Column id="chk_yn" type="STRING" size="256"/>
          <Column id="tell" type="STRING" size="256"/>
          <Column id="cp_cd" type="STRING" size="256"/>
          <Column id="is_prt" type="STRING" size="256"/>
          <Column id="hp_stat" type="STRING" size="256"/>
          <Column id="join_cl" type="STRING" size="256"/>
          <Column id="dlv_id" type="STRING" size="256"/>
          <Column id="sndg_kind_nm" type="STRING" size="256"/>
          <Column id="dlv_type_nm" type="STRING" size="256"/>
          <Column id="dlv_stat_nm" type="STRING" size="256"/>
          <Column id="dlv_dsps_dt" type="STRING" size="256"/>
          <Column id="sndg_kind_cd" type="STRING" size="256"/>
          <Column id="dlv_type_cd" type="STRING" size="256"/>
          <Column id="dlv_stat_cd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rgsnCons" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="cons_memo" type="STRING" size="256"/>
          <Column id="cnsl_con" type="STRING" size="256"/>
          <Column id="gubn" type="STRING" size="256"/>
          <Column id="cnsl_cd" type="STRING" size="256"/>
          <Column id="pyin_chng_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rgsnCertf" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="send_mth" type="STRING" size="256"/>
          <Column id="certf_kind" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_excel" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="ded_no" type="STRING" size="256"/>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="expr_dt" type="STRING" size="256"/>
          <Column id="prod_amt" type="STRING" size="256"/>
          <Column id="mon_pay_amt" type="STRING" size="256"/>
          <Column id="new_chan_gunsu" type="STRING" size="256"/>
          <Column id="pay_mthd" type="STRING" size="256"/>
          <Column id="daeche_amt" type="STRING" size="256"/>
          <Column id="prod_cl" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="pay_gigan" type="STRING" size="256"/>
          <Column id="join_pay_count" type="STRING" size="256"/>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="addr" type="STRING" size="256"/>
          <Column id="addr2" type="STRING" size="256"/>
          <Column id="len" type="STRING" size="256"/>
          <Column id="idn_no" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="join_dt_gbn" type="STRING" size="256"/>
          <Column id="chk_yn" type="STRING" size="256"/>
          <Column id="tell" type="STRING" size="256"/>
          <Column id="cp_cd" type="STRING" size="256"/>
          <Column id="is_prt" type="STRING" size="256"/>
          <Column id="hp_stat" type="STRING" size="256"/>
          <Column id="join_cl" type="STRING" size="256"/>
          <Column id="dlv_id" type="STRING" size="256"/>
          <Column id="sndg_kind_nm" type="STRING" size="256"/>
          <Column id="dlv_type_nm" type="STRING" size="256"/>
          <Column id="dlv_stat_nm" type="STRING" size="256"/>
          <Column id="dlv_dsps_dt" type="STRING" size="256"/>
          <Column id="sndg_kind_cd" type="STRING" size="256"/>
          <Column id="dlv_type_cd" type="STRING" size="256"/>
          <Column id="dlv_stat_cd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_main_contract" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[
include "LIB::lib_All.xjs";

var tc_certf = 0;    //전체 건수

var t_gubun = "";

var tc_custAcnt = 0;

//권한
var rgsnYn; //등록권한
var inqYn; //조회권한
var amntYn; //수정권한
var dltnYn; //삭제권한
var pritYn; //출력권한
var xlsYn; //엑셀권한
var athrPpupYn; //팝업오픈권한
var xlsRrnoYn; //엑셀 개인정보 권한 여부

var sOzServerIp = "";
var sOzServerPort = "";

var gvMenuId;   // 프로그램 로그 추가 2018.03.20
/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리                                           	*/
/********************************************************************************************/
function DL460300_onload(obj:Form, e:LoadEventInfo)
{  
	//////////////////////////////////////////////////////////////////////////////////////////
	// 프로그램 로그 추가 2018.03.20 정승철
	gvMenuId = GV_LOGMENUID;
	//////////////////////////////////////////////////////////////////////////////////////////
	
    gfn_initForm(obj);
    //gfn_getList("basVl", "oz_server_ip,oz_server_port", null, null, "BasVl", "ds_basVlInfo");  // 공통코드조회
    gfn_getList("basVl", "oz_server_ip,oz_server_port,open_oz_server_ip,open_oz_server_port,domain_oz_server_ip,domain_oz_server_port", null, null, "BasVl", "ds_basVlInfo");  // 공통코드조회
   
    gfn_getList("dlwCd","01,85,90,95,113,0194","fn_callBack",false);   // 대명코드조회 (01:회원1회분상태,85:상품구분,90:발급형태,95:구분,113:가입구분,0194:주계약구분)

    fn_setAthrPgmBtn();
    gfn_createPagingDataset(obj); // 페이징처리 위한 데이터셋 설정
    cbo_issue_frm.value=""
}

/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
function fn_callBack(svcid, errcd, errmsg)
{
    if (errcd != 0) {
        switch (svcid) {
            // 공통
              case "selectDlwCode":
            alert("코드 적재를 실패하였습니다.");
            break;
        }
        return false;
    } else {
        switch (svcid) {
            // 공통
            case "selectDlwCode": // 공통코드 조회 callBack Service ID
            gfn_getCode("01", "ALL", ds_pay_mthd, gds_DmlCd);
            gfn_getCode("85", "ALL", ds_prod_cl, gds_DmlCd);
           // gfn_getCode("90", "ALL", ds_issue_frm, gds_DmlCd);
            gfn_getCode("95", "ALL", ds_dept_kind, gds_DmlCd);
            gfn_getCode("113", "ALL", ds_join_cl, gds_DmlCd);
            gfn_getCode("0194", "", ds_main_contract, gds_DmlCd);
            fn_init(); // 검색부 초기화
            break;

            case "BasVl":
                var sServiceUrl = application.services["SVC"].url;
                
                 //2017.12.15 김찬영 SSL개발로 인한 수정
                //if (sServiceUrl.indexOf("61.39.175.220") >= 0) { // 외부
                if (sServiceUrl.indexOf("61.39.175.220") >= 0) 
                { // 외부
                    sOzServerIp = ds_basVlInfo.getColumn(ds_basVlInfo.findRow("bas_vl_nm", "open_oz_server_ip"), "bas_vl");
                    sOzServerPort = ds_basVlInfo.getColumn(ds_basVlInfo.findRow("bas_vl_nm", "open_oz_server_port"), "bas_vl");
                    trace("[OZ Report] 외부 : [" + sServiceUrl + "] ==> OzUrl [" + sOzServerIp + ":" + sOzServerPort + "]");
                } 
                 else if (sServiceUrl.indexOf("devdlcc.com") >= 0 || sServiceUrl.indexOf("dmdlcc.com") >= 0) 
				{ 
					// 2017.12.28 김찬영 SSL 추가
					sOzServerIp = ds_basVlInfo.getColumn(ds_basVlInfo.findRow("bas_vl_nm", "domain_oz_server_ip"), "bas_vl");
					sOzServerPort = ds_basVlInfo.getColumn(ds_basVlInfo.findRow("bas_vl_nm", "domain_oz_server_port"), "bas_vl");
					trace("[OZ Report] SSL : [" + sServiceUrl + "] ==> OzUrl [" + sOzServerIp + ":" + sOzServerPort + "]");
				}
                else 
                { // 내부
                    sOzServerIp = ds_basVlInfo.getColumn(ds_basVlInfo.findRow("bas_vl_nm", "oz_server_ip"), "bas_vl");
                    sOzServerPort = ds_basVlInfo.getColumn(ds_basVlInfo.findRow("bas_vl_nm", "oz_server_port"), "bas_vl");
                    trace("[OZ Report] 내부 : [" + sServiceUrl + "] ==> OzUrl [" + sOzServerIp + ":" + sOzServerPort + "]");
                }

				//alert("임시 아이피 주소 isLocal 변수 false로 바꾸세요."); // 디버그용 코드, 테스트 후 이행을 삭제
                var isLocal = false; 
                
                if (isLocal) {
					/********* 로컬호스트 테스트 용 *********/
					sOzServerIp = "http://61.39.175.220"; 
					sOzServerPort = "8080"; // 디버그용 코드, 테스트 후 이행을 삭제
					/********* 로컬호스트 테스트 용 *********/
                }
                    
                trace("[OZ Report] ServiceUrl [" + sServiceUrl + "] ==> OzUrl [" + sOzServerIp + ":" + sOzServerPort + "]");

            break;

            case "srchCertfList":
            //저장 및 수정시 새창 안뜨도록 >> 추후 처리
				gfn_setTotCnt(ds_list, sta_TotalCnt); // Dataset, Static 인자를 받아서 건수 표시
				fn_postSearch();
            break;

            case "srchCertfTotalList":
			var condQury = ds_list_excel.getColumn(0, "condQury");
			var dataAthrQury = ds_list_excel.getColumn(0, "dataAthrQury");
			ds_inqCndt.setColumn(0, "condQury" , condQury);
			ds_inqCndt.setColumn(0, "dataAthrQury" , dataAthrQury);
			
			var colDS = gfn_excelPrepareExcelDS("grd_list");
			/* 상세주소 마스킹 관련하여 엑셀공통함수 변경 - 2018.03.21 */
			//gfn_excelDown("증서출력", "XLS_DLCC", "DlwCertfMap.getCertfList", "DlwCertfMap.getCertfCount", ds_inqCndt, true, colDS, true);
			gfn_exportGridToExcel(grd_list, "증서출력_"+gfn_getTodayFull());
            break;

            case "srchCertfCond1":
            ds_cond1.clearData();
            ds_cond1.addRow();
            ds_cond1.setColumn(0, "cd", "");
            ds_cond1.setColumn(0, "cd_nm", "전체");
            if (ds_cond_tmp.rowcount > 0) {
                for (var i=0; ds_cond_tmp.rowcount>i; i++) {
                    var nRow = ds_cond1.addRow();
                    ds_cond1.setColumn(nRow, "cd", ds_cond_tmp.getColumn(i, "cd"));
                    ds_cond1.setColumn(nRow, "cd_nm", ds_cond_tmp.getColumn(i, "cd_nm"));
                }
            }
            cbo_cond1.index = 0;
            break;

            case "srchCertfCond2":
            ds_cond2.clearData();
            ds_cond2.addRow();
            ds_cond2.setColumn(0, "cd", "");
            ds_cond2.setColumn(0, "cd_nm", "전체");
            if (ds_cond_tmp.rowcount > 0) {
                for (var i=0; ds_cond_tmp.rowcount>i; i++) {
                    var nRow = ds_cond2.addRow();
                    ds_cond2.setColumn(nRow, "cd", ds_cond_tmp.getColumn(i, "cd"));
                    ds_cond2.setColumn(nRow, "cd_nm", ds_cond_tmp.getColumn(i, "cd_nm"));
                }
            }
            
            /*재발행요청 코드 임의 셋팅!! 
            ds_cond2.addRow();
            ds_cond2.setColumn(ds_cond_tmp.rowcount+1, "cd", "9999");
            ds_cond2.setColumn(ds_cond_tmp.rowcount+1, "cd_nm", "재발행");
           */
            cbo_cond2.index = 0;
            break;

            case "selectCustaccntList":
            if(tc_custAcnt == 1) {
                fn_setAccntNo();
            } else if (tc_custAcnt > 1) {
                btn_accnt_onclick(null, "Y");
            } else {
                edt_accnt_no.value = "";
            }
            break;
                        
            case "saveCertfPrintHist":
				fn_postPrint();
				break;
        }
    }
}


/********************************************************************************************/
/**   4. Validation 처리                                                                   	*/
/********************************************************************************************/
function fn_preSearch(sType,svcid, gbn) {
    if (sType == gfn_getCommTypeInit())
    {
        switch(svcid) {
            case "srchCertfList":
            if (cbo_cond1.text != "전체" && (cbo_cond2.text == "" || cbo_cond2.text == "전체")) {
                alert("조회조건 을 선택하세요.");
                return false;
            }

            // 조회조건 및 default 정렬
            ds_inqCndt.keystring = ""; // 정렬컬럼 초기화
            ds_inqCndt.clearData();
            ds_inqCndt.addRow();
            
            var stt_dt = cal_stt_dt.value + "";
            var end_dt = cal_end_dt.value + "";
            
                 
            if  ( gfn_IsNull(stt_dt)  ) {
				 stt_dt = "19000101" ;
            } 
             if  ( gfn_IsNull(end_dt)  ) {
				 end_dt = "20991231" ;
            } 
    
            if ( gfn_isEmpty(stt_dt) || gfn_isEmpty(end_dt) ) {
				alert("검색기간을 입력해 주세요.");
				return false;
            }

            ds_inqCndt.setColumn(0, "stt_dt", stt_dt);
            ds_inqCndt.setColumn(0, "end_dt", end_dt);
            ds_inqCndt.setColumn(0, "accnt_no", edt_accnt_no.value);
            ds_inqCndt.setColumn(0, "prod_cd", edt_prod_cd.value);
            ds_inqCndt.setColumn(0, "prod_nm", edt_prod_nm.value);
            ds_inqCndt.setColumn(0, "issue_frm", cbo_issue_frm.value);
            ds_inqCndt.setColumn(0, "send_mth", cbo_issue_frm.value);
            ds_inqCndt.setColumn(0, "hp_stat", cbo_hp_stat.value);
            ds_inqCndt.setColumn(0, "prod_cl", cbo_prod_cl.value);
            ds_inqCndt.setColumn(0, "dept_kind", cbo_dept_kind.value);
            ds_inqCndt.setColumn(0, "online_gubn", cbo_online_gubn.value);
            ds_inqCndt.setColumn(0, "hist_ck", cbo_hist_ck.value);
            ds_inqCndt.setColumn(0, "pay_mthd", cbo_pay_mthd.value);
            ds_inqCndt.setColumn(0, "cond1", cbo_cond1.value);
            ds_inqCndt.setColumn(0, "main_contract", cbo_main_contract.value);

            var cond2 = "";
            if (cbo_cond2.text != "") {
                cond2 = cbo_cond2.value;
            }
            ds_inqCndt.setColumn(0, "cond2", cond2);
            ds_inqCndt.setColumn(0, "menu_cd", "0038");

            ds_inqCndt.setColumn(0, "dept_cd", "0101");

            ds_inqCndt.setColumn(0, "orderBy", "PROD_NM, ACCNT_NO");
            ds_inqCndt.setColumn(0, "orderDirection", "ASC");
            break;

            case "selectCustaccntList":
            ds_accntInqCndt.keystring = ""; // 정렬컬럼 초기화
            ds_accntInqCndt.clearData();
            ds_accntInqCndt.addRow();

            var srch_typ = ""
            var srch_vl = "";
            var option = "";

            if (gbn == "accnt_no") {
                srch_typ = gbn;
                srch_vl = edt_accnt_no.value;
            }

            ds_accntInqCndt.setColumn(0, "srch_typ", srch_typ);
            ds_accntInqCndt.setColumn(0, "srch_vl", srch_vl);
            ds_accntInqCndt.setColumn(0, "option", option);
            ds_accntInqCndt.setColumn(0, "ns_yn", "N");
            ds_accntInqCndt.setColumn(0, "popup_yn", "N");
            ds_accntInqCndt.setColumn(0, "orderBy", "mem_nm");
            ds_accntInqCndt.setColumn(0, "orderDirection", "asc");
            return_bool = true;
            break;
        }
    }
    return true;
}
/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)                                                   	*/
/********************************************************************************************/
//조회
function fn_commSearch(sType, searchInfo, gbn) {

    var szSvcid       = "";
    var szController  = "";
    var szInDs        = "";
    var szOutDs       = "";
    var szParam       = "";
    var szRetCallback = "";

    switch(searchInfo) {
        case "srchCertfList":
        if (!fn_preSearch(sType,"srchCertfList")) return false;
        if(!gfn_pageSearch(sType, ds_list, sta_TotalCnt, 100, tc_certf)) return;
        szSvcid       = "srchCertfList";
        szController  = "/dlw/certf/list";
        szInDs        = "ds_input=ds_inqCndt";
        szOutDs       = "ds_list=ds_output";
        szParam       = "";
        szRetCallback = "fn_callBack";
        break;
        grd_list.formatid

        case "srchCertfTotalList":
        if (!fn_preSearch(sType,"srchCertfList")) return false;
        szSvcid       = "srchCertfTotalList";
        szController  = "/dlw/certf/list";
        szInDs        = "ds_input=ds_inqCndt";
        szOutDs       = "ds_list_excel=ds_output_excel";
        szParam       = "excel_fg=Y";
        szRetCallback = "fn_callBack";
        break;

        case "srchCertfCond":
        if (!fn_preSearch(sType,"srchCertfCond")) return false;
        szController  = "/dlw/cond/cbo-certf";
        szInDs        = "";
        szOutDs       = "ds_cond_tmp=ds_output";
        if (gbn == "1") {
            szSvcid       = "srchCertfCond1";
            szParam       = "menu_cd=0038 lvl="+gbn+" high_cl_cd=";
        }
        if (gbn == "2") {
            szSvcid       = "srchCertfCond2";
            szParam       = "menu_cd=0038 lvl="+gbn+" high_cl_cd="+cbo_cond1.value;
        }
        szRetCallback = "fn_callBack";
        break;

        case "selectCustaccntList":
        if (!fn_preSearch(sType,"selectCustaccntList", gbn)) return false;
        szSvcid       = "selectCustaccntList";
        szController  = "/dlw/cust/cust-acnt/list";
        szInDs        = "ds_input=ds_accntInqCndt";
        szOutDs       = "ds_accnt_info=ds_output";
        szParam       = "";
        szRetCallback = "fn_callBack";
        break;
    }
    // 트랜젝션 공통함수 호출
    if(searchInfo == "srchCertfList")
		gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,"","","S",gvMenuId);
	else
		gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}


/********************************************************************************************/
/**   6. 사용자 함수                                                                   	*/
/********************************************************************************************/
//초기화
function fn_init()
{
    fn_commSearch(gfn_getCommTypeInit(), "srchCertfCond", 1); // 조회

    cal_stt_dt.value = gfn_getToday();
    cal_end_dt.value = gfn_getToday();

    edt_accnt_no.value = "";
    edt_prod_cd.value = "";
    edt_prod_nm.value = "";

    cbo_issue_frm.index = 1;
    cbo_hp_stat.index = 0;
    cbo_prod_cl.index = 0;

    cbo_dept_kind.index = 0;
    cbo_online_gubn.index = 0;

    cbo_hist_ck.index = 0;
    cbo_pay_mthd.index = 0;

    cbo_cond1.index = 0;
    cbo_cond2.index = 0;
    
    cbo_main_contract.index = 0;
}

//조회 결과
function fn_postSearch()
{
    if(ds_list.rowcount < 1) {
        //alert("조회된 자료가 없습니다.");
        ds_list.clearData();
    }
}


/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
//조회 버튼 이벤트
function btn_Search_onclick(obj:Button,  e:ClickEventInfo)
{
	// 조회 시 검색기간 설정 2017.09.07
	var sttDt = cal_stt_dt.value;
	var endDt = cal_end_dt.value;  
	var accnt_no = edt_accnt_no.value;
	var checkDt = gfn_getDayDiff(sttDt,endDt);

	if (accnt_no == "" && (sttDt == "" || endDt == "" || sttDt == null || endDt == null ) )
	{
		alert("회원번호 또는 검색기간를 입력해 주세요!\n검색기간은 최대 31일만 검색 가능합니다!");
		return false;
	}
	else if (accnt_no == "" && checkDt > 31 )
	{
		alert("회원번호 또는 검색기간를 입력해 주세요!\n검색기간은 최대 31일만 검색 가능합니다!");
		return false;
	}

	else if (checkDt < 0)
	{
		alert("검색 기간을 확인 해 주세요!");
		return false;
	}

	else if ((accnt_no != "" && (sttDt == "" && endDt != "") || (sttDt == null && endDt != null)) || 
	         (accnt_no != "" && (sttDt != "" && endDt == "") || (sttDt != null && endDt == null))
	         )
	{         
		alert("검색 기간을 확인 해 주세요!");
		return false;
	}
	
    t_gubun ="1";
    fn_commSearch(gfn_getCommTypeInit(), "srchCertfList"); // 조회

	
}

//초기화 버튼 이벤트
function btn_Init_onclick(obj:Button,  e:ClickEventInfo)
{
    fn_init();
}

// 스크롤 페이징
function fn_Grid_onvscrolllastover(obj:Grid, e:ScrollEventInfo)
{
    fn_commSearch(gfn_getCommTypeAppend(),"srchCertfList");
}

// 그리드 헤더 클릭
function grd_onheadclick(obj:Grid, e:GridClickEventInfo)
{
    gfn_grdHeadClick(obj, e);
}

//엑셀버튼 클릭 시
function btn_export_grid_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_list.rowcount > 0 ) {
	   if (t_gubun =="1") {
		  fn_commSearch(gfn_getCommTypeInit(), "srchCertfTotalList"); // 조회
	    } else {
	   	  		grd_list.formatid = "excel";
	   	  		
				gfn_exportGridToExcel(grd_list, "증서재발행_"+gfn_getTodayFull()+"");
				grd_list.formatid = "default";
				//trace(ds_list.saveXML());
	   	}
	} else {
		alert("엑셀다운로드 가능한 목록이 없습니다.");
		return false;
	}
}


/********************************************************************************************/
/**   8. 팝업 관련 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
// 상품 조회 버튼 클릭
function btn_Prod_onclick()
{
    var sPrmr = {"p_prod_nm":edt_prod_nm.value, "p_prod_cd":edt_prod_cd.value, "p_mode":"set"};
    var reVal = gfn_diaLog("상품 조회", -1, -1, 884, 601, "PS990000::PS992200.xfdl", false, sPrmr, true, false, true, null, null, true);
}
function fn_prodSetInfo()
{
    if (ds_prodList.rowcount > 0) {
        edt_prod_cd.value = ds_prodList.getColumn(0, "prod_cd");
        edt_prod_nm.value = ds_prodList.getColumn(0, "prod_nm");
    }
}
function edt_prod_keydown(obj:Edit, e:KeyEventInfo)
{
    if (e.keycode == 13) {
        btn_Prod_onclick();
    }
}

// 담당사원조회 팝업
function fn_srchEmplePop()
{
    var sPrmr = {p_empl_nm:edt_emple_nm.value, p_pageTyp:"DL460100", p_typ:""};
    var reVal = gfn_diaLog("담당사원 조회", -1, -1, -1, -1, "PS990000::PS992000.xfdl", false, sPrmr, false, false, true);
}
function edt_emple_nm_onkeydown(obj:Edit, e:KeyEventInfo)
{
    if (e.keycode == 13) {
        fn_srchEmplePop();
    }
}
// 추천사원조회 팝업
function fn_srchReComEmplePop(obj:Button,  e:ClickEventInfo)
{
    var sPrmr = {p_empl_nm:edt_recom_emple_nm.value, p_pageTyp:"DL460100", p_typ:"recom"};
    var reVal = gfn_diaLog("담당사원 조회", -1, -1, -1, -1, "PS990000::PS992000.xfdl", false, sPrmr, false, false, true);
}
function edt_recom_emple_nm_onkeydown(obj:Edit, e:KeyEventInfo)
{
    if (e.keycode == 13) {
        fn_srchReComEmplePop();
    }
}

function btn_srchB2bComp_onclick(obj:Button,  e:ClickEventInfo)
{
    var sPrmr = {p_com_nm:edt_b2b_comp_nm.value};
    var reVal = gfn_diaLog("B2B회사 조회", -1, -1, -1, -1, "PS990000::PS993400.xfdl", false, sPrmr, true, false, true, null, null, true);
}

function edt_b2b_comp_nm_onkeydown(obj:Edit, e:KeyEventInfo)
{
    if (e.keycode == 13) {
        btn_srchB2bComp_onclick();
    }
}

// 회원 조회 버튼 클릭
function btn_accnt_onclick (obj, typ) {
    var srch_typ = "";
    var option = "";
    var gubun_mode = "";
    var srch_vl = "";
    if (obj != null) {
        if ("btn_mem_nm" == obj.name || "edt_mem_nm" == obj.name) { // 회원명
            srch_typ = "mem_nm";
        } else if ("btn_accnt_no" == obj.name || "edt_accnt_no" == obj.name){ // 회원번호
            srch_typ = "accnt_no";
        }
    }

    if (typ == "Y") {
        srch_typ = ds_accntInqCndt.getColumn(0,"srch_typ");
        srch_vl = ds_accntInqCndt.getColumn(0,"srch_vl");
    }

    var sPrmr = {p_srch_typ:srch_typ, p_srch_vl:srch_vl, p_gubun_mode:gubun_mode, p_option:option};
    gfn_diaLog("회원 조회", -1, -1, 884, 601, "PS990000::PS992400.xfdl", false, sPrmr, true, false, true, null, null, true);
}
function fn_setAccntNo(){
    if(ds_accnt_info.getColumn(ds_accnt_info.rowcount-1, "accnt_no") != ""){
        var accnt_no = ds_accnt_info.getColumn(0, "accnt_no");
        edt_accnt_no.value = accnt_no;
    }
}
function edt_accnt_onkeydown(obj:Edit, e:KeyEventInfo)
{
    if (e.keycode == "13") {
        if (obj.value == "") {
            btn_accnt_onclick(obj);
        } else {
            var srch_typ = "";
            if (obj.name == "edt_accnt_no") {
                srch_typ = "accnt_no";
            } else if (obj.name == "edt_mem_nm"){
                srch_typ = "mem_nm"
            }
            fn_commSearch(gfn_getCommTypeInit(), "selectCustaccntList", srch_typ); // 조회
        }
    }
}


function cbo_cond1_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
    if (obj.value == "") {
        ds_cond2.clearData();
    } else {
        fn_commSearch(gfn_getCommTypeInit(), "srchCertfCond", 2); // 조회
    }
}

// 권한에 따른 버튼 설정
function fn_setAthrPgmBtn()
{
    gfn_athrPgm(gfn_gdsCd_admin());

    if (inqYn == "N") {
        btn_Search.visible = false;
    }
    if (xlsYn == "N") {
        btn_excl.visible = false;
        
        // 해당 라인 컴포넌트 위치조정
        f_cnt.position2 = "absolute r:410 w:41 t:101 h:20";
        Static00.position2 = "absolute r:395 w:10 t:101 h:20";
        t_cnt.position2 = "absolute r:350 w:41 t:101 h:20";
        btn_certfMember00.position2 = "absolute r:262 w:82 t:101 h:20";
        btn_cancle.position2 = "absolute r:176 w:82 t:101 h:20";
        btn_jaebal.position2 = "absolute r:75 w:98 t:101 h:20";
        btn_certfMember.position2 = "absolute r:0 w:72 t:101 h:20";
    }

    for (var i=0; i<ds_indvFnctAthrPgmFilter.rowcount; i++) {
        if (ds_indvFnctAthrPgmFilter.getColumn(i, "cnpn_id") == "certfMember") {
            if (ds_indvFnctAthrPgmFilter.getColumn(i, "amnt_yn") == "1") {
                btn_certfMember.visible = true;
            }
        }
    }
    
    //회원증서 출력 버튼 보이게 추가 2018.01.02 김찬영
    var sUserId = gds_UserInfo.getColumn(0, "user_id");
    if (sUserId == "2017080003" || sUserId == "2017080004")
    {
		btn_certfMember.visible = true;
    }
    
}

function btn_certfMember_onclick(obj:Button,  e:ClickEventInfo)
{
    fn_print();
}

function fn_prePrint() {

	var cnt = ds_list.getCaseCount("chk == '1'");
	if (cnt < 1) {
        alert("출력할 항목을 선택해주세요.");
        return false;
    }
    
    ds_list_print.clearData();
    ds_list.filter("chk == '1'");
    var nRow = ds_list_print.copyData(ds_list, true);
    ds_list.filter("");
    
    ds_list_print.enableevent = false;
    ds_list_print.updatecontrol = false;
    for (var i=0; i<ds_list_print.rowcount; ++i) {
		ds_list_print.setRowType(i, Dataset.ROWTYPE_INSERT);
    }
    ds_list_print.updatecontrol = true;
    ds_list_print.enableevent = true;
    
    return true;
}

function fn_print() {
	// 유효성 체크
	if ( !fn_prePrint() ) {
		return;
	}
	
	var ss = cbo_issue_frm.value;
	if (gfn_isEmpty(ss)) {
		ss = "";
	}
	
	var szSvcid       = "saveCertfPrintHist";
    var szController  = "/dlw/certf/saveCertfPrintHist";
    var szInDs        = "ds_input=ds_list_print:U";
    var szOutDs       = "";
    var szParam       = "send_mth="+ss;
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

function fn_postPrint() {
    
	var nTot = ds_list_print.rowcount - 1;
	var ozSep = "^";
	var sUrl = "";
	var sMemGnbOzr = ""; 	// 전환여부 (상조, 상조외) DESINER
	var sMemGnbOdi = ""; 	// 전환여부 (상조, 상조외) QUERY
	
	//회원 정보 중 권리계약이 상조냐 상조가 아니냐에 따라 증서 파일 구분
	
	trace(cbo_main_contract.value == '01');
	
	if(cbo_main_contract.value == '01'){
		sMemGnbOzr = "MemberCrtfNewTypeS";    // 상조외		
	} else {
		sMemGnbOzr = "MemberCrtfNewType";    // 상조외		
	}		        
	sMemGnbOdi = "MemberCrtfNewType";    // 상조외
    if (nTot > 0) {
        sUrl += "viewer.childcount=" + nTot+"" + ozSep;
//		sUrl += "viewer.printcommand=true"+ ozSep;
//		sUrl += "viewer.print.usedialogopt=false"+ ozSep;
        sUrl += "global.concatpage=true"+ ozSep;
    }
     
     // alert("sOzServerIp : " + sOzServerIp); // http://192.168.15.166
     
     for (var i=0;i<ds_list_print.rowcount;i++){
        if (i == 0) {
            sUrl += "connection.servlet="+sOzServerIp+":"+sOzServerPort+"/oz70/server" + ozSep; // 서버
            //sUrl = "connection.servlet=http://61.39.175.220:8080/oz70/server" + ozSep; // 로컬
            sUrl += "connection.reportname=/"+sMemGnbOzr+".ozr" + ozSep;
            sUrl += "information.debug=true" + ozSep;
            sUrl += "viewer.isframe=false" + ozSep;
            sUrl += "viewer.namespace=oz70\ozviewer" + ozSep;
//			sUrl += "viewer.mode=print" + ozSep;
//			sUrl += "viewer.ismultidocassub=true" + ozSep;
//			sUrl += "print.alldocument=true" + ozSep;
//			sUrl += "print.mode=true" + ozSep;
            sUrl += "connection.pcount=1" + ozSep;
            sUrl += "connection.args1=formparam=1234567890" + ozSep;
            sUrl += "odi.odinames="+sMemGnbOdi+"" + ozSep;
            sUrl += "odi."+sMemGnbOdi+".pcount=1" + ozSep;
            sUrl += "odi."+sMemGnbOdi+".args1=accnt_no="+ds_list_print.getColumn(i, "accnt_no")+""  + ozSep;
        } else {
            sUrl += "child"+i+".connection.servlet="+sOzServerIp+":"+sOzServerPort+"/oz70/server" + ozSep;
            sUrl += "child"+i+".connection.reportname=/"+sMemGnbOzr+".ozr" + ozSep;
            sUrl += "child"+i+".information.debug=true" + ozSep;
            sUrl += "child"+i+".viewer.isframe=false" + ozSep;
            sUrl += "child"+i+".viewer.namespace=oz70\ozviewer" + ozSep;
//			sUrl += "child"+i+".viewer.mode=print" + ozSep;
//			sUrl += "child"+i+".print.mode=false" + ozSep;
//			sUrl += "child"+i+".print.alldocument=true" + ozSep;
            //sUrl += "child"+i+".viewer.ismultidocassub=true" + ozSep;
            sUrl += "child"+i+".connection.pcount=1" + ozSep;
            sUrl += "child"+i+".connection.args1=formparam=1234567890" + ozSep;
            sUrl += "child"+i+".odi.odinames="+sMemGnbOdi+"" + ozSep;
            sUrl += "child"+i+".odi."+sMemGnbOdi+".pcount=1" + ozSep;
            sUrl += "child"+i+".odi."+sMemGnbOdi+".args1=accnt_no="+ds_list_print.getColumn(i, "accnt_no")+""  + ozSep;
        }
     }
     /*this.ActiveX00.CreateReportEx(sUrl,ozSep);*/

    /**********************************************/
    var sFormId = "DL450300";
    var sPrmr = {form_id:sFormId, pUrl:sUrl};
    trace(sUrl);
    var reVal = gfn_diaLog("OZ레포팅팝업", -1, -1, 884, 601, "PS990000::PS994500.xfdl", false, sPrmr, true, false, true);
    // fn_commSearch(gfn_getCommTypeInit(), "srchCertfList"); // 조회

    /**********************************************/
}


// 상담 저장
function fn_commSaveCons(psMemNo, psAccntNo, i) {

	ds_rgsnCons.clearData();
	ds_rgsnCons.addRow();
	ds_rgsnCons.setColumn(0, "accnt_no", psAccntNo);
	ds_rgsnCons.setColumn(0, "mem_no", psMemNo);
	ds_rgsnCons.setColumn(0, "cons_memo", "증서발급 정보");
	ds_rgsnCons.setColumn(0, "cnsl_con", "증서출력");
	ds_rgsnCons.setColumn(0, "gubn", "80");
	ds_rgsnCons.setColumn(0, "cnsl_cd", "01");
	ds_rgsnCons.setColumn(0, "pyin_chng_yn", "N");
	
	var szSvcid       = "saveCons"+i;
	var szController  = "/dlw/cms/save-cons";
	var szInDs        = "ds_input=ds_rgsnCons";
	var szOutDs       = "";
	var szParam       = "";
	var szRetCallback = "fn_callBack";  
 
	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback, true);
}

// 증서발급 저장
function fn_commSaveCertf(psAccntNo, i) {
	ds_rgsnCertf.clearData();
	ds_rgsnCertf.addRow();
	ds_rgsnCertf.setColumn(0, "accnt_no", psAccntNo);
	ds_rgsnCertf.setColumn(0, "send_mth", cbo_issue_frm.value);
	ds_rgsnCertf.setColumn(0, "certf_kind", "0004");

	var szSvcid       = "saveCertf"+i;
	var szController  = "/dlw/certf/save-print";
	var szInDs        = "ds_input=ds_rgsnCertf";
	var szOutDs       = "";
	var szParam       = "";
	var szRetCallback = "fn_callBack";  
 
	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback, true);
}

/// 검색범위 선택
function btn_select_onclick(obj:Button,  e:ClickEventInfo)
{
	 var fcnt =parseInt(f_cnt.value  - 1);
	 var tcnt =parseInt(t_cnt.value  - 1) ;
	 
	 if  ( gfn_IsNull(tcnt)  ||gfn_IsNull(fcnt)  ) {
		alert("검색범위를 입력해주세요");
		return ;
	 } 
	
	 grd_list.enableevent = false;
	 ds_list.enableevent = false;
	
	 
	for (i=0; i< ds_list.rowcount; ++i) {
	    if ( i >= parseInt(fcnt) && i <= parseInt(tcnt)  ) {
			ds_list.setColumn(i, "chk", "1");
		}	
	}
	ds_list.enableevent = true;
	grd_list.enableevent = true;
	}

/// 검색범위 취소 
function btn_delete_onclick(obj:Button,  e:ClickEventInfo)
{
	 var tcnt = ds_list.rowcount;

	 grd_list.enableevent = false;
	 ds_list.enableevent = false;
	 
	for (i=0; i< tcnt; ++i) {
			ds_list.setColumn(i, "chk", "0");
	}
	ds_list.enableevent = true;
	grd_list.enableevent = true;
	
	
}
//증서재발행
function btn_jaebal_onclick(obj:Button,  e:ClickEventInfo)
{
	t_gubun ="2";    /// 증서재발행인경우..엑셀 증서재발으로 엑셀 변환 
	var sPrmr = {"p_mode":"popup", "p_gubun":"cms"};
	gfn_diaLog("증서재발행List", -1, -1, 989, 795, "PS990000::PS999994.xfdl", false, sPrmr, true, false, true, null, null, true);
	
}

function btn_clCondData_onclick(obj:Button,  e:ClickEventInfo)
{
	var sCond1 = cbo_cond1.value;
	var sCond2 = cbo_cond2.value;

	var sPrmr = {"pCond1" : "0038", "pCond2" : sCond2};
	        
	gfn_diaLog("장례이행보증현황", -1, -1, 500, 500, "DL450000::DL450300_01.xfdl", false, sPrmr, true, false, true, null, null, true);
}
]]></Script>
  </Form>
</FDL>
