<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="PS450400" classname="물류현황" inheritanceid="" position="absolute 0 0 989 795" onload="PS450400_onload" titletext="연체대상제외 관리">
    <Layouts>
      <Layout>
        <Static id="stc_dtl_00" class="sta_workData" position2="absolute l:342 r:0 b:35 h:27" positiontype="position2"/>
        <Static id="stc_sch_background" class="sta_workSrcBg" position2="absolute l:0 r:0 t:7 h:42" positiontype="position2"/>
        <Static id="stc_sch_01" text="구분" class="sta_workSrcLabel1" position="absolute 36 18 93 38"/>
        <Combo id="cbo_excpGbnCd_sch" innerdataset="@ds_excpGbnCd_sch" codecolumn="cd" datacolumn="cd_nm" class="cbo_srch" position="absolute 83 18 178 38"/>
        <Static id="stc_sch_02" text="회원/상품 명" class="sta_workSrcLabel1" position="absolute 228 18 312 38"/>
        <Edit id="edt_excpNm_sch" onkeydown="sch_onKeyDown" class="edt_srch" position="absolute 312 18 408 38"/>
        <Button id="btn_init" onclick="btn_onclick" class="btn_WF_Return" tooltiptext="초기화" position2="absolute r:21 w:72 t:17px h:20" positiontype="position2"/>
        <Button id="btn_search" onclick="btn_onclick" class="btn_WF_Search" tooltiptext="조회" style="padding:0 0 0 0;" position2="absolute r:95 w:72 t:17px h:20" positiontype="position2"/>
        <!--
        목록
        -->
        <Static id="sta_TotalCnt" text="검색결과   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt; / 전체   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt;" usedecorate="true" class="sta_workTitle5" position="absolute -1 64 215 84"/>
        <Grid id="grd_list" taborder="0" binddataset="ds_trgtExcpList" useinputpanel="false" position2="absolute l:0 r:0 t:83 b:167" positiontype="position2" onheadclick="grd_trgtExcpList_onheadclick" cellsizingtype="col" autofittype="none" onselectchanged="grd_trgtExcpList_onselectchanged" onvscrolllastover="grd_trgtExcpList_onvscroll">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="80"/>
                <Column size="120"/>
                <Column size="250"/>
                <Column size="263"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="80"/>
                <Column size="110"/>
                <Column size="130"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox"/>
                <Cell col="1" text="NO"/>
                <Cell col="2" text="구분" id="excp_gbn_cd"/>
                <Cell col="3" text="예외 ID" id="excp_id"/>
                <Cell col="4" text="회원/상품명" id="excp_nm"/>
                <Cell col="5" text="제외사유"/>
                <Cell col="6" text="사용자정의 1"/>
                <Cell col="7" text="사용자정의 2"/>
                <Cell col="8" text="사용자정의 3"/>
                <Cell col="9" text="사용여부" id="use_yn"/>
                <Cell col="10" text="수정자" id="amnd_id"/>
                <Cell col="11" text="수정일시" id="amnt_dttm"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                <Cell col="1" style="color:expr:(page_indx ==&quot;New&quot;?&quot;red&quot;:&quot;black&quot;);color2:expr:(page_indx ==&quot;New&quot;?&quot;red&quot;:&quot;black&quot;);font:expr:(page_indx ==&quot;New&quot;?&quot;Dotum,8,blod&quot;:&quot;Dotum,8&quot;);selectcolor:expr:(page_indx ==&quot;New&quot;?&quot;red&quot;:&quot;black&quot;);selectfont:expr:(page_indx ==&quot;New&quot;?&quot;Dotum,8,blod&quot;:&quot;Dotum,8&quot;);" text="expr:(page_indx==&quot;New&quot;?&quot;New&quot;:currow+1)"/>
                <Cell col="2" text="bind:excp_gbn_nm"/>
                <Cell col="3" text="bind:excp_id"/>
                <Cell col="4" style="align:left middle;" text="bind:excp_nm" expr="expr:gfn_SetNameGrdSecu(excp_nm)"/>
                <Cell col="5" style="align:left;" text="bind:excp_expi" tooltiptype="mouse,mouseleave" tooltiptext="bind:excp_expi"/>
                <Cell col="6" text="bind:user_defn1_cntn"/>
                <Cell col="7" displaytype="combo" text="bind:user_defn2_cntn" combodataset="ds_excpType" combocodecol="cd" combodatacol="cd_nm"/>
                <Cell col="8" text="bind:user_defn3_cntn"/>
                <Cell col="9" style="color:EXPR(use_yn==&quot;Y&quot; ? &quot;&quot; : &quot;red&quot;);" text="expr:use_yn==&quot;Y&quot; ? &quot;사용&quot; : &quot;사용안함&quot;"/>
                <Cell col="10" text="bind:amnd_nm"/>
                <Cell col="11" displaytype="date" text="bind:amnt_dttm" mask="yyyy-MM-dd HH:mm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="stc_dtl_tit" text="제외대상 상세정보" class="sta_workTitle2" position2="absolute l:0 w:151 b:137 h:20" positiontype="position2"/>
        <Static id="sta_GrayLine" class="sta_WF_Line1" position2="absolute l:0 r:0 b:136 h:1" positiontype="position2"/>
        <Button id="btn_save" onclick="btn_onclick" class="btn_WF_Save" visible="false" position2="absolute r:76 w:72 b:139 h:20" positiontype="position2" style="padding:0 0 0 0;"/>
        <Button id="btn_cancel" text="취소" onclick="btn_onclick" class="btn_WF_Common" visible="false" position2="absolute r:2 w:72 b:139 h:20" positiontype="position2" style="padding:0 0 0 0;"/>
        <Button id="btn_create" onclick="btn_onclick" class="btn_WF_New" visible="true" position2="absolute r:2 w:72 b:139 h:20" positiontype="position2" tooltiptext="신규등록" style="padding:0 0 0 0;"/>
        <Button id="btn_update" onclick="btn_onclick" class="btn_WF_Modif" visible="false" position2="absolute r:77 w:72 b:139 h:20" positiontype="position2" tooltiptext="수정" style="padding:0 0 0 0;"/>
        <Static id="stc_dtl_01" class="sta_workData" position2="absolute l:0 w:989 b:110 h:26" positiontype="position2"/>
        <Static id="stc_dtl_02" class="sta_workData" position2="absolute l:0 w:263 b:60 h:51" positiontype="position2"/>
        <Static id="stc_dtl_03" class="sta_workData" position2="absolute l:328 r:0 b:59 h:77" positiontype="position2"/>
        <Static id="stc_dtl_04" class="sta_workData" position2="absolute l:0 w:263 b:35 h:26" positiontype="position2"/>
        <Static id="stc_dtl_05" class="sta_workData" position2="absolute l:0 r:0 b:10 h:26" positiontype="position2"/>
        <Static id="stc_dtl_01_01" text="구분" class="sta_workLabel1_P" position2="absolute l:0 w:96 b:110 h:26" positiontype="position2" validate=""/>
        <Static id="stc_dtl_01_02" text="제외사유" class="sta_workLabel1" position2="absolute l:247 w:96 b:60 h:76" positiontype="position2" validate=""/>
        <Static id="stc_dtl_02_01" text="제외대상명" class="sta_workLabel1_P" position2="absolute l:0 w:96 b:84 h:27" positiontype="position2" validate="" style="padding:6 0 0 15;"/>
        <Static id="stc_dtl_04_01" text="사용여부" class="sta_workLabel1_P" position2="absolute l:0 w:96 b:35 h:26" positiontype="position2" validate=""/>
        <Static id="stc_dtl_05_01" text="등록자" class="sta_workLabel1" position2="absolute l:0 b:10 w:96 h:26" positiontype="position2" validate=""/>
        <Static id="stc_dtl_05_02" text="등록일시" class="sta_workLabel1" position2="absolute l:247 w:96 b:10 h:26" positiontype="position2" validate=""/>
        <Static id="stc_dtl_05_03" text="수정자" class="sta_workLabel1" position2="absolute l:494 b:10 w:96 h:26" positiontype="position2" validate=""/>
        <Static id="stc_dtl_05_04" text="수정일시" class="sta_workLabel1" position2="absolute l:741 b:10 w:96 h:26" positiontype="position2" validate=""/>
        <Combo id="cbo_excpGbnCd_dtl" innerdataset="@ds_excpGbnCd_dtl" codecolumn="cd" datacolumn="cd_nm" class="cbo_srch" position2="absolute l:98 b:113 w:147 h:21" positiontype="position2" enable="false" onitemchanged="cbo_excpGbnCd_dtl_onitemchanged"/>
        <Edit id="edt_excpNm_dtl" class="" position2="absolute l:98 b:86 w:123 h:21" positiontype="position2" enable="false"/>
        <Edit id="edt_excpId_dtl" class="" position2="absolute l:98 b:63 w:147 h:21" positiontype="position2" enable="false"/>
        <Button id="btn_excpIdSch" onclick="btn_onclick" class="btn_workSrcPop" position2="absolute l:222 w:20 b:86 h:20" positiontype="position2" enable="true" visible="false"/>
        <Static id="stc_rgsr_nm" position2="absolute l:98 w:123 b:13 h:21" positiontype="position2" style="border:0 none #808080ff;"/>
        <MaskEdit id="Mask_rgsn_dttm" readonly="true" type="string" mask="####-##-## ##:##" autoselect="true" position2="absolute l:345 b:13 w:123 h:21" positiontype="position2" style="align:left middle;" tabstop="false"/>
        <Static id="stc_amnd_nm" position2="absolute l:592 b:13 w:123 h:21" positiontype="position2" style="border:0 none #808080ff;"/>
        <MaskEdit id="Mask_amnt_dttm" readonly="true" type="string" mask="####-##-## ##:##" autoselect="true" position2="absolute l:839 b:13 w:123 h:21" positiontype="position2" style="align:left middle;" tabstop="false"/>
        <TextArea id="tta_excpExpi_dtl" taborder="1" position2="absolute l:345 r:3 b:62 h:71" positiontype="position2" enable="false" wordwrap="both"/>
        <Radio id="rdi_use_yn_dtl" taborder="2" columncount="0" rowcount="0" codecolumn="codecolumn" datacolumn="datacolumn" direction="vertical" position2="absolute l:98 w:143 b:35 h:26" positiontype="position2" enable="false" enableevent="true">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">사용</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">사용안함</Col>
              </Row>
            </Rows>
          </Dataset>
        </Radio>
        <Button id="btn_gdInit" onclick="btn_gdInit_onclick" class="btn_grd_Change" position2="absolute r:82 w:16 t:66 h:16" positiontype="position2" tooltiptext="다중정렬"/>
        <Button id="btn_excel" text="엑셀" onclick="btn_onclick" class="btn_WF_Common" visible="false" position2="absolute r:2 w:72 t:60 h:21" positiontype="position2" style="padding:0 0 0 0;"/>
        <Static id="Static00" text="연체대상 제외(회원/상품/채널)은 (월마감/업무마감)이후에 등록(수정) 하시기 바랍니다." position2="absolute l:406 r:98 t:62 h:24" positiontype="position2" style="color:red;"/>
        <Static id="stc_dtl_02_00" text="제외대상ID" class="sta_workLabel1_P" position2="absolute l:0 w:96 b:60 h:27" positiontype="position2" style="padding:6 0 0 15;" validate=""/>
        <Static id="stc_dtl_05_00" text="기존사용여부" class="sta_workLabel1" position2="absolute l:247 w:96 b:35 h:26" positiontype="position2" validate=""/>
        <Static id="stc_dtl_05_05" text="제외구분" class="sta_workLabel1" position2="absolute l:494 w:96 b:35 h:26" positiontype="position2" validate=""/>
        <Static id="stc_dtl_05_06" text="사용자정의3" class="sta_workLabel1" position2="absolute l:741 w:96 b:35 h:26" positiontype="position2" validate=""/>
        <Static id="stc06" text="사용여부" class="sta_workSrcLabel1" position2="absolute l:444 w:71 t:19 h:20" positiontype="position2"/>
        <CheckBox id="chk_use_yn" taborder="3" truevalue="Y" onchanged="chk_total_fg_onchanged" position="absolute 517 20 540 39" value="false" falsevalue="N"/>
        <Edit id="edt_user1" taborder="4" enable="true" position2="absolute l:344 w:148 b:38 h:20" positiontype="position2" readonly="true"/>
        <Edit id="edt_user2" taborder="5" enable="true" position2="absolute l:600 w:149 b:73 h:20" positiontype="position2" readonly="true" visible="false"/>
        <Edit id="edt_user3" taborder="6" enable="true" position2="absolute l:838 w:149 b:38 h:20" positiontype="position2" readonly="true"/>
        <Button id="btn_allcreate" taborder="7" onclick="btn_onclick" position2="absolute r:150 w:72 b:139 h:20" positiontype="position2" tooltiptext="신규등록" style="padding:0 0 0 0;" text="일괄업로드"/>
        <Grid id="Gridlist" taborder="8" useinputpanel="false" position="absolute 169 136 709 378" binddataset="ds_alllist" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" displaytype="normal" text="xRowStatusType"/>
                <Cell col="1" displaytype="normal" text="excp_id"/>
                <Cell col="2" displaytype="normal" text="excp_nm"/>
                <Cell col="3" displaytype="normal" text="excp_expi"/>
                <Cell col="4" displaytype="normal" text="excp_gbn_cd"/>
                <Cell col="5" displaytype="normal" text="user_defn1_cntn"/>
                <Cell col="6" displaytype="normal" text="user_defn2_cntn"/>
                <Cell col="7" displaytype="normal" text="user_defn3_cntn"/>
              </Band>
              <Band id="body">
                <Cell col="0" displaytype="normal" text="bind:xRowStatusType"/>
                <Cell col="1" displaytype="normal" text="bind:excp_id"/>
                <Cell col="2" displaytype="normal" text="bind:excp_nm"/>
                <Cell col="3" displaytype="normal" text="bind:excp_expi"/>
                <Cell col="4" displaytype="normal" text="bind:excp_gbn_cd"/>
                <Cell col="5" displaytype="normal" text="bind:user_defn1_cntn"/>
                <Cell col="6" displaytype="normal" text="bind:user_defn2_cntn"/>
                <Cell col="7" displaytype="normal" text="bind:user_defn3_cntn"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="Grid_list_sample" taborder="9" binddataset="ds_alllist" useinputpanel="false" visible="false" position="absolute 232 190 772 432">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="normal" text="예외 ID"/>
                <Cell col="1" displaytype="normal" text="회원/상품명"/>
                <Cell col="2" displaytype="normal" text="제외사유"/>
                <Cell col="3" displaytype="normal" text="제외코드"/>
                <Cell col="4" displaytype="normal" text="사용자정의1"/>
                <Cell col="5" displaytype="normal" text="사용자정의2"/>
                <Cell col="6" displaytype="normal" text="사용자정의3"/>
              </Band>
              <Band id="body">
                <Cell displaytype="normal" text="bind:excp_id"/>
                <Cell col="1" displaytype="normal" text="bind:excp_nm"/>
                <Cell col="2" displaytype="normal" text="bind:excp_expi"/>
                <Cell col="3" displaytype="normal" text="bind:excp_gbn_cd"/>
                <Cell col="4" displaytype="normal" text="bind:user_defn1_cntn"/>
                <Cell col="5" displaytype="normal" text="bind:user_defn2_cntn"/>
                <Cell col="6" displaytype="normal" text="bind:user_defn3_cntn"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_file_sample" taborder="10" text="파일양식" onclick="btn_onclick" position2="absolute r:224 w:72 b:139 h:20" positiontype="position2" tooltiptext="신규등록" style="padding:0 0 0 0;"/>
        <Combo id="cbo_ExcpGbn" taborder="11" codecolumn="cd" datacolumn="cd_nm" class="cbo_srch" enable="true" position2="absolute l:591 w:147 b:37 h:21" positiontype="position2" innerdataset="@ds_excpType"/>
        <Grid id="grd_list_excel" taborder="12" binddataset="ds_trgtExcpList" useinputpanel="false" cellsizingtype="col" onvscrolllastover="grd_trgtExcpList_onvscroll" onheadclick="grd_trgtExcpList_onheadclick" onselectchanged="grd_trgtExcpList_onselectchanged" position2="absolute l:819 r:-131 t:144 b:416" positiontype="position2" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="80"/>
                <Column size="120"/>
                <Column size="250"/>
                <Column size="263"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="80"/>
                <Column size="110"/>
                <Column size="130"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="NO"/>
                <Cell col="1" text="구분" id="excp_gbn_cd"/>
                <Cell col="2" text="예외 ID" id="excp_id"/>
                <Cell col="3" text="회원/상품명" id="excp_nm"/>
                <Cell col="4" text="제외사유"/>
                <Cell col="5" text="사용자정의 1"/>
                <Cell col="6" text="사용자정의 2"/>
                <Cell col="7" text="사용자정의 3"/>
                <Cell col="8" text="사용여부" id="use_yn"/>
                <Cell col="9" text="수정자" id="amnd_id"/>
                <Cell col="10" text="수정일시" id="amnt_dttm"/>
              </Band>
              <Band id="body">
                <Cell style="color:expr:(page_indx ==&quot;New&quot;?&quot;red&quot;:&quot;black&quot;);color2:expr:(page_indx ==&quot;New&quot;?&quot;red&quot;:&quot;black&quot;);font:expr:(page_indx ==&quot;New&quot;?&quot;Dotum,8,blod&quot;:&quot;Dotum,8&quot;);selectcolor:expr:(page_indx ==&quot;New&quot;?&quot;red&quot;:&quot;black&quot;);selectfont:expr:(page_indx ==&quot;New&quot;?&quot;Dotum,8,blod&quot;:&quot;Dotum,8&quot;);" text="expr:(page_indx==&quot;New&quot;?&quot;New&quot;:currow+1)"/>
                <Cell col="1" text="bind:excp_gbn_nm"/>
                <Cell col="2" text="bind:excp_id"/>
                <Cell col="3" style="align:left middle;" text="bind:excp_nm" expr="expr:gfn_SetNameGrdSecu(excp_nm)"/>
                <Cell col="4" style="align:left;" text="bind:excp_expi" tooltiptype="mouse,mouseleave" tooltiptext="bind:excp_expi"/>
                <Cell col="5" text="bind:user_defn1_cntn"/>
                <Cell col="6" text="bind:user_defn2_cntn"/>
                <Cell col="7" text="bind:user_defn3_cntn"/>
                <Cell col="8" style="color:EXPR(use_yn==&quot;Y&quot; ? &quot;&quot; : &quot;red&quot;);" text="expr:use_yn==&quot;Y&quot; ? &quot;사용&quot; : &quot;사용안함&quot;"/>
                <Cell col="9" text="bind:amnd_nm"/>
                <Cell col="10" displaytype="date" text="bind:amnt_dttm" mask="yyyy-MM-dd HH:mm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_delete" taborder="13" text="삭제" onclick="btn_onclick" position2="absolute r:320 w:72 b:139 h:20" positiontype="position2" enable="false"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cdSet" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="6"/>
          <Column id="cd_nm" type="STRING" size="100"/>
          <Column id="adtl_cd" type="STRING" size="100"/>
          <Column id="adtl_cd_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excpGbnCd_sch" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="6"/>
          <Column id="cd_nm" type="STRING" size="100"/>
          <Column id="adtl_cd" type="STRING" size="100"/>
          <Column id="adtl_cd_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excpGbnCd_dtl" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="6"/>
          <Column id="cd_nm" type="STRING" size="100"/>
          <Column id="adtl_cd" type="STRING" size="100"/>
          <Column id="adtl_cd_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="excp_gbn_cd" type="STRING" size="256"/>
          <Column id="excp_id" type="STRING" size="256"/>
          <Column id="excp_nm" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_trgtExcpList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="trgt_excp_id" type="STRING" size="256"/>
          <Column id="excp_gbn_cd" type="STRING" size="256"/>
          <Column id="excp_gbn_nm" type="STRING" size="256"/>
          <Column id="excp_id" type="STRING" size="256"/>
          <Column id="excp_nm" type="STRING" size="256"/>
          <Column id="excp_expi" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
          <Column id="cntr_cd" type="STRING" size="256"/>
          <Column id="rgsr_id" type="STRING" size="256"/>
          <Column id="rgsr_nm" type="STRING" size="256"/>
          <Column id="amnt_dttm" type="STRING" size="256"/>
          <Column id="amnd_id" type="STRING" size="256"/>
          <Column id="amnd_nm" type="STRING" size="256"/>
          <Column id="rgsn_dttm" type="STRING" size="256"/>
          <Column id="user_defn2_cntn" type="STRING" size="256"/>
          <Column id="user_defn1_cntn" type="STRING" size="256"/>
          <Column id="user_defn3_cntn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_tmp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="_chk" type="STRING" size="256"/>
          <Column id="xRowStatusType" type="STRING" size="256"/>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="trgt_excp_id" type="STRING" size="256"/>
          <Column id="excp_gbn_cd" type="STRING" size="256"/>
          <Column id="excp_gbn_nm" type="STRING" size="256"/>
          <Column id="excp_id" type="STRING" size="256"/>
          <Column id="excp_nm" type="STRING" size="256"/>
          <Column id="excp_expi" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
          <Column id="cntr_cd" type="STRING" size="256"/>
          <Column id="rgsr_id" type="STRING" size="256"/>
          <Column id="rgsr_nm" type="STRING" size="256"/>
          <Column id="amnt_dttm" type="STRING" size="256"/>
          <Column id="amnd_id" type="STRING" size="256"/>
          <Column id="amnd_nm" type="STRING" size="256"/>
          <Column id="rgsn_dttm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_accnt_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="page_indx" type="STRING" size="6"/>
          <Column id="accnt_no" type="STRING" size="100"/>
          <Column id="mem_no" type="STRING" size="100"/>
          <Column id="mem_nm" type="STRING" size="100"/>
          <Column id="home_tel" type="STRING" size="100"/>
          <Column id="cell" type="STRING" size="100"/>
          <Column id="wrpl_tel" type="STRING" size="100"/>
          <Column id="idn_no" type="STRING" size="100"/>
          <Column id="prod_cd" type="STRING" size="100"/>
          <Column id="prod_nm" type="STRING" size="100"/>
          <Column id="prod_amt" type="STRING" size="100"/>
          <Column id="mon_pay_amt" type="STRING" size="100"/>
          <Column id="expr_no" type="STRING" size="100"/>
          <Column id="emple_no" type="STRING" size="100"/>
          <Column id="emple_nm" type="STRING" size="100"/>
          <Column id="appfm_no" type="STRING" size="100"/>
          <Column id="join_dt" type="STRING" size="100"/>
          <Column id="compt_dt" type="STRING" size="100"/>
          <Column id="bef_emple_cd" type="STRING" size="100"/>
          <Column id="pay_perd" type="STRING" size="100"/>
          <Column id="pay_mthd" type="STRING" size="100"/>
          <Column id="join_prod" type="STRING" size="100"/>
          <Column id="new_chan_gunsu" type="STRING" size="100"/>
          <Column id="certf_rcv_chk" type="STRING" size="100"/>
          <Column id="pay_stat_1no" type="STRING" size="100"/>
          <Column id="ichae_dt" type="STRING" size="100"/>
          <Column id="bank_accnt_no" type="STRING" size="100"/>
          <Column id="old_mid" type="STRING" size="100"/>
          <Column id="reg_dm" type="STRING" size="100"/>
          <Column id="reg_man" type="STRING" size="100"/>
          <Column id="upd_dm" type="STRING" size="100"/>
          <Column id="upd_man" type="STRING" size="100"/>
          <Column id="accnt_stat" type="STRING" size="100"/>
          <Column id="total_pay" type="STRING" size="100"/>
          <Column id="last_no" type="STRING" size="100"/>
          <Column id="real_pay_no" type="STRING" size="100"/>
          <Column id="ded_no" type="STRING" size="100"/>
          <Column id="join_cl" type="STRING" size="100"/>
          <Column id="trans_gubun" type="STRING" size="100"/>
          <Column id="brth_mon_day" type="STRING" size="100"/>
          <Column id="pay_mthd" type="STRING" size="100"/>
          <Column id="emp_cell" type="STRING" size="100"/>
          <Column id="join_stat" type="STRING" size="100"/>
          <Column id="pay_stat" type="STRING" size="100"/>
          <Column id="pay_no" type="STRING" size="100"/>
          <Column id="pay_allt_no" type="STRING" size="100"/>
          <Column id="pay_add_no" type="STRING" size="100"/>
          <Column id="pay_amt" type="STRING" size="100"/>
          <Column id="pay_allt_amt" type="STRING" size="100"/>
          <Column id="pay_add_amt" type="STRING" size="100"/>
          <Column id="model_cl_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_prodList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="page_indx" type="STRING" size="6"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="mon_pay_amt" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="prod_amt" type="STRING" size="256"/>
          <Column id="use_cnt" type="STRING" size="256"/>
          <Column id="reg_dm" type="STRING" size="256"/>
          <Column id="prod_cl" type="STRING" size="256"/>
          <Column id="prod_cl_nm" type="STRING" size="256"/>
          <Column id="sale_gubn" type="STRING" size="256"/>
          <Column id="sale_cl" type="STRING" size="256"/>
          <Column id="sale_close_day" type="STRING" size="256"/>
          <Column id="prod_save_point" type="STRING" size="256"/>
          <Column id="pay_type" type="STRING" size="256"/>
          <Column id="pay_type_nm" type="STRING" size="256"/>
          <Column id="join_type" type="STRING" size="256"/>
          <Column id="join_type_nm" type="STRING" size="256"/>
          <Column id="join_gift_card_sort" type="STRING" size="256"/>
          <Column id="join_gift_card_sort_nm" type="STRING" size="256"/>
          <Column id="join_gift_card_amt" type="STRING" size="256"/>
          <Column id="prod_dc_cnt" type="STRING" size="256"/>
          <Column id="membership" type="STRING" size="256"/>
          <Column id="ocb_point" type="STRING" size="256"/>
          <Column id="ocb_fee" type="STRING" size="256"/>
          <Column id="upd_man" type="STRING" size="256"/>
          <Column id="lgbestcl" type="STRING" size="256"/>
          <Column id="order_seq" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_trgtExcp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="trgt_excp_id" type="STRING" size="256"/>
          <Column id="excp_gbn_cd" type="STRING" size="256"/>
          <Column id="excp_gbn_nm" type="STRING" size="256"/>
          <Column id="excp_id" type="STRING" size="256"/>
          <Column id="excp_nm" type="STRING" size="256"/>
          <Column id="excp_expi" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
          <Column id="cntr_cd" type="STRING" size="256"/>
          <Column id="rgsr_id" type="STRING" size="256"/>
          <Column id="rgsr_nm" type="STRING" size="256"/>
          <Column id="amnt_dttm" type="STRING" size="256"/>
          <Column id="amnd_id" type="STRING" size="256"/>
          <Column id="amnd_nm" type="STRING" size="256"/>
          <Column id="rgsn_dttm" type="STRING" size="256"/>
          <Column id="user_defn2_cntn" type="STRING" size="256"/>
          <Column id="user_defn1_cntn" type="STRING" size="256"/>
          <Column id="user_defn3_cntn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_alllist" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="xRowStatusType" type="STRING" size="256"/>
          <Column id="excp_id" type="STRING" size="256"/>
          <Column id="excp_nm" type="STRING" size="256"/>
          <Column id="excp_expi" type="STRING" size="256"/>
          <Column id="excp_gbn_cd" type="STRING" size="256"/>
          <Column id="user_defn1_cntn" type="STRING" size="256"/>
          <Column id="user_defn2_cntn" type="STRING" size="256"/>
          <Column id="user_defn3_cntn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_del_trgtExcp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="trgt_excp_id" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excpType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="cd">01</Col>
            <Col id="cd_nm">대상제외</Col>
          </Row>
          <Row>
            <Col id="cd">02</Col>
            <Col id="cd_nm">제외</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="cbo_excpGbnCd_dtl" propid="value" datasetid="ds_trgtExcp" columnid="excp_gbn_cd"/>
      <BindItem id="item1" compid="edt_excpNm_dtl" propid="value" datasetid="ds_trgtExcp" columnid="excp_nm"/>
      <BindItem id="item2" compid="edt_excpId_dtl" propid="value" datasetid="ds_trgtExcp" columnid="excp_id"/>
      <BindItem id="item3" compid="tta_excpExpi_dtl" propid="value" datasetid="ds_trgtExcp" columnid="excp_expi"/>
      <BindItem id="item4" compid="stc_rgsr_nm" propid="text" datasetid="ds_trgtExcp" columnid="rgsr_nm"/>
      <BindItem id="item5" compid="Mask_rgsn_dttm" propid="value" datasetid="ds_trgtExcp" columnid="rgsn_dttm"/>
      <BindItem id="item6" compid="stc_amnd_nm" propid="text" datasetid="ds_trgtExcp" columnid="amnd_nm"/>
      <BindItem id="item7" compid="Mask_amnt_dttm" propid="value" datasetid="ds_trgtExcp" columnid="amnt_dttm"/>
      <BindItem id="item8" compid="rdi_use_yn_dtl" propid="value" datasetid="ds_trgtExcp" columnid="use_yn"/>
      <BindItem id="item9" compid="edt_user1" propid="value" datasetid="ds_trgtExcp" columnid="user_defn1_cntn"/>
      <BindItem id="item10" compid="edt_user2" propid="value" datasetid="ds_trgtExcp" columnid="user_defn2_cntn"/>
      <BindItem id="item11" compid="edt_user3" propid="value" datasetid="ds_trgtExcp" columnid="user_defn3_cntn"/>
      <BindItem id="item12" compid="cbo_ExcpGbn" propid="value" datasetid="ds_trgtExcp" columnid="user_defn2_cntn"/>
    </Bind>
    <InitValue>
      <CheckBox id="chk_use_yn" truevalue="Y"/>
    </InitValue>
    <Script type="xscript4.0"><![CDATA[/***************************************************************************
 * Program ID    : PS450400.xfdl
 * Program Name  : 택배관리
 * Author        : 정용재
 * Created On    : 2016.02]6.27
 * 개    요 	 :
 *
 * =========================================================================
 * 변경일자     수정자       내    용
 * =========================================================================
 * 2016.06.27    정용재       최초작성

 **************************************************************************/

/********************************************************************************************/
/* 1. Include Library include, variables Declaration 영역                                  */
/********************************************************************************************/
include "LIB::lib_All.xjs";

/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리,
  전역변수, 초기화
/********************************************************************************************/
//전역변수
var total_count = 0;
var bRgsn = false;
var bAmnt = false;
var bDltn = false;
var bXls = false;
var chkDelCnt = 0;

//프로그램 파라미터
var oParameter;

var gvMenuId;  // 프로그램 로그 추가 2017.12.04
/********************************************************************************************/
//폼온로드
function PS450400_onload(obj:Form, e:LoadEventInfo)
{
	///////////////////////////////////////////////////////////////////////////////////////////
	// 프로그램 로그 추가 2017.12.26 정승철
	gvMenuId = GV_LOGMENUID;
	///////////////////////////////////////////////////////////////////////////////////////////	
	
    oParameter = parent.pv_usrParameter.oParameter; //프로그램 파라미터 조회
    // trace("oParameter >> " + oParameter);
    gfn_getList("cd","CUS180","fn_callBack",null,"srchCdSet","ds_cdSet");   // 코드셋
    gfn_createPagingDataset(obj);
    gfn_athrPgm(gfn_gdsCd_admin()); //권한조회
	bRgsn = "Y" == ds_athrPgmFilter.getColumn(0, 'rgsn_yn');
	bAmnt = "Y" == ds_athrPgmFilter.getColumn(0, 'amnt_yn');
	bDltn = "Y" == ds_athrPgmFilter.getColumn(0, 'dltn_yn');
	bXls = "Y" == ds_athrPgmFilter.getColumn(0, 'xls_yn');
	
	
	btn_create.visible = bRgsn;
	btn_excel.visible = bXls;
	 fn_init();
    fn_commSearch(gfn_getCommTypeInit()); // 조회
}

//검색조건 초기화
function fn_init()
{
    ds_accnt_info.clearData();

    this.edt_excpNm_sch.value = "";
    this.cbo_excpGbnCd_sch.index = 0;
    chk_use_yn.value = 'Y';
}

//일괄엑셀업로드
function fn_excelupload()
{
    ds_alllist.clearData();
   	gfn_importExcelToDataset(Gridlist.binddataset);
	
	///  데이터 저장
	fn_allaveData();
	
	//trace(this.ds_MenuReview.saveXML());
}

/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
//콜백
function fn_callBack(svcid, errcd, errmsg) {
    if (errcd < 0) {
        trace("errcd  :   " +errcd +"   \n errmsg   :   "+ errmsg +"    \n svcid   :   "+ svcid)
        return false;
    } else {
        switch(svcid){
        case "srchCdSet" :		// 코드셋
            gfn_getCode("CUS180", "ALL", ds_excpGbnCd_sch, ds_cdSet);
            gfn_getCode("CUS180", "SELECT", ds_excpGbnCd_dtl, ds_cdSet);
            this.cbo_excpGbnCd_sch.index = 0;
            this.cbo_excpGbnCd_dtl.index = 0;
            break;

        case "searchTrgtExcp" :		// 조회 콜백
            gfn_appendSearchDs(ds_trgtExcpList, ds_list_tmp); // 조회된 결과를 실제보여줄 데이타셋으로 Append처리
            gfn_setTotalRowCount(ds_trgtExcpList, sta_TotalCnt, total_count); // 페이지건수 표출
            fn_postSearch(ds_trgtExcpList);
            grd_list.setCellProperty("head", "chk", "text", '0'); // 그리드 체크박스 초기화
            break;
        case "saveTrgtExcp" :
            fn_commSearch(gfn_getCommTypeInit());
            break;

        case "delTrgtExcp":		// 삭제 콜백
			alert("삭제 완료");
            fn_commSearch(gfn_getCommTypeInit()); // 재조회
            break;
        }
    }
}

/********************************************************************************************/
/**   4. Validation 처리                                                                   	*/
/********************************************************************************************/
//조회전 처리 조회조건셋팅
function fn_preSearch(sType)
{
    if (sType == gfn_getCommTypeInit())
    {
        ds_inqCndt.clearData();
        ds_inqCndt.addRow();

        ds_inqCndt.setColumn(0, "excp_gbn_cd", this.cbo_excpGbnCd_sch.value);
        ds_inqCndt.setColumn(0, "excp_nm", this.edt_excpNm_sch.value);
        ds_inqCndt.setColumn(0, "use_yn", this.chk_use_yn.value);
        ds_inqCndt.setColumn(0, "excp_gbn_cd", this.cbo_excpGbnCd_sch.value);
        
    }
    return true;
}

// 저장 전
function fn_preSave()
{
    var bResult = true;

    if (gfn_isNull(ds_trgtExcp.getColumn(0, "excp_gbn_cd"))){
        alert("구분을 선택하세요.");
        bResult = false;
    }else if (gfn_isNull(ds_trgtExcp.getColumn(0, "excp_nm"))){
        alert("제외대상 명 을 입력/선택하세요.");
        bResult = false;
    }else if (gfn_isNull(ds_trgtExcp.getColumn(0, "excp_id"))){
        alert("제외대상 ID 을 입력/선택하세요.");
        bResult = false;
    } else if (gfn_isNull(ds_trgtExcp.getColumn(0, "use_yn"))){
        alert("사용여부를 선택하세요.");
        bResult = false;
    }

    return bResult;
}

/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)조회,수정,삭제                                   	*/
/********************************************************************************************/
//조회
function fn_commSearch(sType) {
    if (!fn_preSearch(sType)) return false;
    // 호출 건수 설정 및 조회여부 설정
    if(!gfn_pageSearch(sType, ds_trgtExcpList, sta_TotalCnt, 50, total_count)) return;

    var szSvcid       = "searchTrgtExcp";
    var szController  = "/cons/trgt-excp/list";
    var szInDs        = "ds_input=ds_inqCndt";
    var szOutDs       = "ds_list_tmp=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";
    
  

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,"","","S",gvMenuId);
}

function fn_saveData()
{
    if (!fn_preSave()) return false;
    if(confirm("저장하시겠습니까?")) {
        var szSvcid       = "saveTrgtExcp";
        var szController  = "/cons/trgt-excp/save";
        var szInDs        = "ds_input=ds_trgtExcp";
        var szOutDs       = "ds_list_tmp=ds_output";
        var szParam       = "indx=" + ds_trgtExcp.rowposition;
        var szRetCallback = "fn_callBack";
		
		
		  //trace(ds_trgtExcp.saveXML());
        // 트랜젝션 공통함수 호출
        gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,"","","I",gvMenuId);
    }
}


function fn_allaveData()
{
	// 엑셀업로드시 회원/상품명에 공백이 들어가지 않도록 수정
	for(var i=0; i<ds_alllist.rowcount; i++)
	{
		ds_alllist.setColumn(i, "excp_nm", ds_alllist.getColumn(i, "excp_nm").trim());
	}

   // if (!fn_preSave()) return false;
   // if(confirm("저장하시겠습니까?")) {
        var szSvcid       = "saveTrgtExcp";
        var szController  = "/cons/trgt-excp/allsave";
        var szInDs        = "ds_input=ds_alllist";
        var szOutDs       = "";
        var szParam       = "";
        var szRetCallback = "fn_callBack";
		
		
		  //trace(ds_trgtExcp.saveXML());
        // 트랜젝션 공통함수 호출
        gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
 //   }
}

/********************************************************************************************/
/**   6. 사용자 함수                                                                   	*/
/********************************************************************************************/
//처리결과
function fn_postSearch(obj_ds)
{
    if(obj_ds.rowcount < 1) {
        ds_trgtExcp.clearData();
        btn_update.visible = false;
        sta_TotalCnt.text = "조회 결과가 없습니다.";
    } else {
		if(chk_use_yn.value == "Y") 
			btn_delete.enable = true;
		else 
			btn_delete.enable = false;
    }

    return;
}

/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
// 선택이 바뀔 시 버튼 재설정
function grd_trgtExcpList_onselectchanged(obj:Grid, e:GridSelectEventInfo)
{
    ds_trgtExcp.clearData();
    ds_trgtExcp.addRow();
    ds_trgtExcp.copyRow(0, ds_trgtExcpList, ds_trgtExcpList.rowposition);

    setMode("R");
}

//스크롤시 append
function grd_trgtExcpList_onvscroll(obj:Grid, e:ScrollEventInfo)
{
    fn_commSearch(gfn_getCommTypeAppend());
}

// 그리드 헤더 클릭 이벤트 - 정렬
function grd_trgtExcpList_onheadclick(obj:Grid, e:GridClickEventInfo)
{
    if (!fn_preSearch()) return false;

    ds_inqCndt.setColumn(0, "sController", "/cons/trgt-excp/list");
    ds_inqCndt.setColumn(0, "dsName", "ds_output");

    if(!gfn_pageSearch(gfn_getCommTypeOrderBy(), ds_trgtExcpList, sta_TotalCnt, 50, total_count)) return;
    gfn_grdHeadClick(obj, e, ds_inqCndt);
    gfn_setTotalRowCount(ds_trgtExcpList, sta_TotalCnt, total_count); // 페이지건수 표출
}

//버튼클릭 이벤트
function btn_onclick(obj:Button,  e:ClickEventInfo)
{
    switch(obj){
    // 조회버튼
    case btn_search:
        fn_commSearch(gfn_getCommTypeInit()); // 조회
        break;

    // 초기화
    case btn_init:
        fn_init();
        break;

    // 신규
    case btn_create:
        setMode("C");
        break;
     //일괄업로드
    case btn_allcreate:
    
    if(!confirm("일괄업로드 하시겠습니까?")) return false;
		fn_excelupload();
       
     //   setMode("A");
     break;    
     
     case btn_file_sample:
    
    if(!confirm("파일양식을 다운로드 하시겠습니까?")) return false;
		 var ss = gfn_ExportMultSheet("연체제외대상LIST","Grid_list_sample::연체대상제외관리");
		if(!ss){return;} // 엑셀 취소시 리턴
       
     //   setMode("A");
     break;  
     

    // 수정
    case btn_update:
        setMode("U");
        break;

    // 저장
    case btn_save:
        fn_saveData();
        break;

    // 취소
    case btn_cancel:
        ds_trgtExcp.copyRow(0, ds_trgtExcpList, ds_trgtExcpList.rowposition);

        setMode("R");
        break;
        
    // 엑셀다운로드
    case btn_excel:
		// gfn_excelDown(파일명, XLS아이디, 리스트맵, 카운트맵, 파라미터 데이터셋);
		//var colDS = gfn_excelPrepareExcelDS("grd_list");
		var colDS = gfn_excelPrepareExcelDS("grd_list_excel");
		gfn_excelDown("연체대상제외", "XLS_TRGTEXCP", "TrgtExcpMap.getTrgtExcpList", "TrgtExcpMap.getTrgtExcpCount", ds_inqCndt , true, colDS);
		break;

    case btn_excpIdSch :
        if (ds_trgtExcp.getColumn(ds_trgtExcp.rowposition, "excp_gbn_cd") == "10") {
            fn_srchAccntNoPop();
        } else if (ds_trgtExcp.getColumn(ds_trgtExcp.rowposition, "excp_gbn_cd") == "20") {
            fn_openProdPopup("btn");
        } else {
            alert("구분을 먼저 선택하여 주십시요!");
        }
        break;
        
    // 삭제
    case btn_delete:
        fn_delData();
        break;
    }
}

// 회원조회 팝업
function fn_srchAccntNoPop() {
    var sSrchTyp = "mem_nm";

    var sPrmr = {p_srch_typ:sSrchTyp, p_srch_vl:"", p_gubun_mode:"", p_option:""};
    var reVal = gfn_diaLog("회원조회", -1, -1, -1, -1, "PS990000::PS992400.xfdl", false, sPrmr, true, false, true, null, null, true);
}
// 상품정보 팝업
function fn_openProdPopup(sType)
{
    var sPrmr;
    if (sType == "btn") {
        sPrmr = {p_prod_cd:"", p_prod_nm:"", p_mode:"set"};
    } else if (sType == "cd") {
        sPrmr = {p_prod_cd:edt_srch_prod_cd.value, p_prod_nm:"", p_mode:"set"};
    } else {
        sPrmr = {p_prod_cd:"", p_prod_nm:edt_srch_prod_nm.value, p_mode:"set"};
    }
    var reVal = gfn_diaLog("상품조회", -1, -1, -1, -1, "PS990000::PS992200.xfdl", false, sPrmr, true, false, true, null, null, true);
}

// 회원정보 선택시
function fn_setAccntNo() {
    edt_excpId_dtl.value = ds_accnt_info.getColumn(0, "accnt_no");
    edt_excpNm_dtl.value = ds_accnt_info.getColumn(0, "mem_nm");
}
// 상품 선택시
function fn_prodSetInfo()
{
    edt_excpId_dtl.value = ds_prodList.getColumn(0, "prod_cd");
    edt_excpNm_dtl.value = ds_prodList.getColumn(0, "prod_nm");
}

function sch_onKeyDown(obj:Edit, e:KeyEventInfo)
{
    if (e.keycode == 13) {
        fn_commSearch(gfn_getCommTypeInit()); // 조회
    }
}


function fn_openPop(sTitle, sPgm, sPrmr) {
    if(sPrmr == null) sPrmr = "";

    var reVal = gfn_diaLog(sTitle, -1, -1, 673,655, sPgm, false, sPrmr, false, false, true, null, null, true);

    return reVal;
}



function setMode(sMode) {
    switch(sMode) {
    case "C" :		// 신규등록
        ds_trgtExcp.clearData();
        ds_trgtExcp.addRow();
		
        ds_trgtExcp.setColumn(0, "use_yn", "Y");
        this.cbo_excpGbnCd_dtl.enable = true;
        this.btn_excpIdSch.visible = true;
		edt_user1.readonly = false;
		//edt_user2.readonly = false;
		cbo_ExcpGbn.readonly = false;
		edt_user3.readonly = false;
		
        cbo_excpGbnCd_dtl.index = 0;
    case "U" :		// 수정
        this.tta_excpExpi_dtl.enable = true;
        this.rdi_use_yn_dtl.enable = true;

        this.btn_create.visible = bRgsn & false;
        this.btn_update.visible = bAmnt & false;
		edt_excpId_dtl.enable = true;
        this.btn_save.visible = true;
        this.btn_cancel.visible = true;
        edt_user1.readonly = false;
		//edt_user2.readonly = false;
		cbo_ExcpGbn.readonly = false;
		edt_user3.readonly = false;
        break;

    case "R" :		// 읽기
        this.cbo_excpGbnCd_dtl.enable = false;
        this.btn_excpIdSch.visible = false;
        this.tta_excpExpi_dtl.enable = false;
        this.rdi_use_yn_dtl.enable = false;
        edt_excpId_dtl.enable = false;
        edt_excpNm_dtl.enable = false;
		edt_user1.readonly = true;
		//edt_user2.readonly = true;
		cbo_ExcpGbn.readonly = true;
		edt_user3.readonly = true;

        this.btn_create.visible = bRgsn & true;
        if (gfn_isNull(ds_trgtExcp.getColumn(ds_trgtExcp.rowposition, "trgt_excp_id"))) {
            this.btn_update.visible = bAmnt & false;
        } else {
            this.btn_update.visible = bAmnt & true;
        }
        
        this.btn_save.visible = false;
        this.btn_cancel.visible = false;
        break;
    }
}

function cbo_excpGbnCd_dtl_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
    if (e.preindex != e.postindex) {
        ds_trgtExcp.setColumn(ds_trgtExcp.rowposition, "excp_id", null);
        ds_trgtExcp.setColumn(ds_trgtExcp.rowposition, "excp_nm", null);
    }

    ds_trgtExcp.setColumn(ds_trgtExcp.rowposition, "excp_gbn_nm", ds_excpGbnCd_dtl.getColumn(ds_excpGbnCd_dtl.findRow("cd", ds_trgtExcp.getColumn(ds_trgtExcp.rowposition, "excp_gbn_cd")), "cd_nm"));
	
	if((obj.value == '30') || (obj.value == '40')){
		btn_excpIdSch.visible = false;
		edt_excpNm_dtl.enable = true;
		edt_excpId_dtl.enable = true;
	}else{
		btn_excpIdSch.visible = true;
		edt_excpNm_dtl.enable = false;
		edt_excpId_dtl.enable = false;
	}
}

function btn_gdInit_onclick(obj:Button,  e:ClickEventInfo)
{
    gfn_resetColsize(grd_list);
}

// 삭제 전
function fn_preDelete()
{
    var bResult = true;
    
    chkDelCnt = ds_trgtExcpList.getCaseCount("chk == true");
	if(chkDelCnt == 0) {
		alert("삭제대상을 체크해주세요.");
		bResult = false;
	}

    return bResult;
}

// 삭제처리
function fn_delData()
{	
	// 유효성 체크
	if(!fn_preDelete()) return false;
	
	if(!confirm(chkDelCnt + "건 삭제하시겠습니까?")) return false;
	ds_del_trgtExcp.clearData();
	
	// 삭제체크 행 복사
	for(var i=0; i<ds_trgtExcpList.rowcount; i++) {
		if(ds_trgtExcpList.getColumn(i, "chk") == true) {
			var nRow = ds_del_trgtExcp.addRow();
			ds_del_trgtExcp.copyRow(nRow, ds_trgtExcpList, i);
		}
	}
	
	for(var i=0; i<ds_del_trgtExcp.rowcount; i++) {
		ds_del_trgtExcp.setColumn(i, "use_yn", "N"); // 사용안함
	}
		
	var szSvcid       = "delTrgtExcp";
	var szController  = "/cons/trgt-excp/delete";
	var szInDs        = "ds_input=ds_del_trgtExcp";
	var szOutDs       = "";
	var szParam       = "";
	var szRetCallback = "fn_callBack";
	
	// 트랜젝션 공통함수 호출
	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,"","","I",gvMenuId);
}
]]></Script>
  </Form>
</FDL>
