<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="PS22080001" classname="캠페인관리" inheritanceid="" position="absolute 0 0 988 794" titletext="캠페인 할당관리(대상고객)" scrollbars="none" onload="PS22080001_onload">
    <Layouts>
      <Layout>
        <Static id="stc_31" class="sta_popupBg1" enable="false" position="absolute 0 0 988 794"/>
        <Static id="sta_totalCnt_alct" text="검색결과   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt; / 전체   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt;" usedecorate="true" class="sta_workTitle5" position="absolute 16 171 365 191"/>
        <Static id="stc_02" text="상담사" class="sta_workSrcLabel1" position2="absolute r:316 w:61 t:170 h:20" positiontype="position2"/>
        <Combo id="cbo_user_nm" taborder="20" innerdataset="@ds_userCd_select" codecolumn="user_id" datacolumn="user_nm" onitemchanged="div_Search_cbo_areaType_onitemchanged" oncloseup="Tab00_tabpage1_cbo_prdtDiv_oncloseup" position2="absolute r:244 w:88 t:170 h:20" positiontype="position2" displayrowcount="15"/>
        <Button id="btn_alct" taborder="23" text="선택할당" onclick="btn_onclick" class="btn_WF_Common" position2="absolute r:16 w:56 t:170 h:20" positiontype="position2" style="padding:0 0 0 0;"/>
        <Static id="Static01" usedecorate="true" style="align:right middle;font:Dotum,9;" anchor="default" position="absolute 611 62 992 81" positiontype="position"/>
        <Static id="stc_05" class="sta_workSrcBg" position="absolute 12 45 975 160" anchor="default" positiontype="position"/>
        <Button id="btn_Init" taborder="18" onclick="btn_onclick" class="btn_WF_Return" position="absolute 819 131 891 151" tooltiptext="초기화" anchor="default" positiontype="position"/>
        <Button id="btn_search" taborder="17" onclick="btn_onclick" class="btn_WF_Search" position="absolute 745 131 817 151" tooltiptext="조회" style="shadow:drop 0,0 0 #00000033;" anchor="default" positiontype="position"/>
        <Static id="stc_00" text="할당여부" class="sta_workSrcLabel1" anchor="default" position="absolute 420 56 498 76" positiontype="position"/>
        <Combo id="cbo_srch_alct_yn" taborder="3" text="전체" codecolumn="codecolumn" datacolumn="datacolumn" index="0" anchor="default" position="absolute 480 56 577 76" positiontype="position" onkeydown="cbo_onkeydown">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">할당</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">미할당</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="stc_01" text="처리상태" class="sta_workSrcLabel1" anchor="default" position="absolute 324 81 385 101" positiontype="position"/>
        <Combo id="cbo_srch_dpms_stat_cd" taborder="8" innerdataset="ds_dpmsStatCdList_srch" codecolumn="cd" datacolumn="cd_nm" anchor="default" position="absolute 385 81 473 101" positiontype="position" onitemchanged="cbo_onitemchanged" onkeydown="cbo_onkeydown"/>
        <Static id="stc_30" text="고객별 할당" class="sta_popupTitle" transparenthittest="true" position="absolute 16 8 783 28"/>
        <Button id="btn_Close" taborder="25" onclick="btn_close_onclick" class="btn_popupClose" position="absolute 951 8 971 27"/>
        <Static id="stc_03" text="고객명" class="sta_workSrcLabel1" anchor="default" position="absolute 593 56 671 76" positiontype="position"/>
        <Edit id="edt_srch_mem_nm" taborder="4" position="absolute 640 56 729 76" anchor="default" positiontype="position" onkeydown="edt_onkeydown" imemode="hangul"/>
        <Static id="stc_04" text="통화결과" class="sta_workSrcLabel1" anchor="default" position="absolute 496 81 557 101" positiontype="position"/>
        <Combo id="cbo_srch_resl_stat_cd" taborder="9" innerdataset="@ds_dpmsReslCdList_srch" codecolumn="cd" datacolumn="cd_nm" anchor="default" position="absolute 558 81 646 101" positiontype="position" onitemchanged="cbo_onitemchanged" onkeydown="cbo_onkeydown"/>
        <Static id="stc_06" text="전화번호" class="sta_workSrcLabel1" anchor="default" position="absolute 661 81 739 101" positiontype="position"/>
        <Edit id="edt_srch_tlno" taborder="10" position="absolute 721 81 810 101" anchor="default" positiontype="position" onkeydown="edt_onkeydown" inputtype="number"/>
        <Static id="stc_07" text="상담사" class="sta_workSrcLabel1" anchor="default" position="absolute 742 56 820 76" positiontype="position"/>
        <Button id="btn_numAlct" taborder="22" text="수치할당" onclick="btn_onclick" class="btn_WF_Common" position2="absolute r:79 w:56 t:170 h:20" positiontype="position2" style="padding:0 0 0 0;"/>
        <Edit id="edt_srch_alctnum" taborder="21" position="absolute 762 170 851 190" inputtype="number"/>
        <Static id="stc_08" text="등록일자" class="sta_workSrcLabel1" anchor="default" position="absolute 25 81 103 101" positiontype="position"/>
        <Calendar id="cal_srch_startd" taborder="6" displaynulltext="____-__-__" dateformat="yyyy-MM-dd" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" anchor="default" position="absolute 108 81 197 101" positiontype="position"/>
        <Calendar id="cal_srch_endd" taborder="7" displaynulltext="____-__-__" dateformat="yyyy-MM-dd" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" anchor="default" position="absolute 212 81 301 101" positiontype="position"/>
        <Static id="Static06" text="~" anchor="default" position="absolute 200 84 208 99" positiontype="position"/>
        <Static id="stc_sub_trgt_list" text="서브 대상 고객" class="sta_workSrcLabel1" position="absolute 25 56 158 76" anchor="default" positiontype="position"/>
        <Edit id="edt_sub_trgt_list_nm" taborder="0" autoselect="true" autoskip="true" onkeydown="common_onkeydown" enable="false" anchor="default" position="absolute 120 55 327 75" positiontype="position"/>
        <Button id="btn_open_sub_trgt_list_Pop" taborder="1" onclick="btn_onclick" class="btn_workSrcPop" visible="true" anchor="default" position="absolute 328 55 348 75" positiontype="position"/>
        <Static id="stc06" text="전체" class="sta_workSrcLabel1" anchor="default" position="absolute 356 56 395 76" positiontype="position"/>
        <CheckBox id="chk_total_fg" taborder="2" onchanged="chk_total_fg_onchanged" position="absolute 396 57 419 76" anchor="default" positiontype="position" value="false" truevalue="Y"/>
        <Static id="stc_09" text="사용자정의1" class="sta_workSrcLabel1" position="absolute 25 106 114 126"/>
        <Edit id="edt_srch_user1" taborder="11" position="absolute 108 106 197 126" onkeydown="edt_onkeydown" imemode="hangul"/>
        <Static id="stc_10" text="사용자정의2" class="sta_workSrcLabel1" position="absolute 209 106 298 126"/>
        <Edit id="edt_srch_user2" taborder="12" position="absolute 292 106 381 126" onkeydown="edt_onkeydown" imemode="hangul"/>
        <Static id="stc_11" text="사용자정의3" class="sta_workSrcLabel1" position="absolute 393 106 482 126"/>
        <Edit id="edt_srch_user3" taborder="13" position="absolute 471 106 560 126" onkeydown="edt_onkeydown" imemode="hangul"/>
        <Static id="stc_12" text="사용자정의4" class="sta_workSrcLabel1" position="absolute 577 106 666 126"/>
        <Edit id="edt_srch_user4" taborder="14" position="absolute 655 106 744 126" onkeydown="edt_onkeydown" imemode="hangul"/>
        <Static id="stc_13" text="사용자정의5" class="sta_workSrcLabel1" position="absolute 761 106 850 126"/>
        <Edit id="edt_srch_user5" taborder="15" position="absolute 839 106 928 126" onkeydown="edt_onkeydown" imemode="hangul"/>
        <Edit id="edt_srch_sub_trgt_list_id" taborder="19" position="absolute 416 171 505 191" visible="false"/>
        <Combo id="cbo_srch_cnsr_id" taborder="5" innerdataset="@ds_userCd_srch" codecolumn="user_id" datacolumn="user_nm" displayrowcount="15" position2="absolute r:109 w:88 t:56 h:20" positiontype="position2" onkeydown="cbo_onkeydown"/>
        <Static id="stc_14" text="상담메모" class="sta_workSrcLabel1" position="absolute 25 130 114 150"/>
        <Edit id="edt_srch_dpms_cntn" taborder="16" imemode="hangul" onkeydown="edt_onkeydown" position="absolute 108 130 381 150"/>
        <Button id="btn_dupAlct" taborder="26" text="중복할당제거" onclick="btn_onclick" class="btn_WF_Common" position2="absolute r:620 w:91 t:170 h:20" positiontype="position2" style="padding:0 0 0 0;"/>
        <Button id="btn_excl" taborder="27" text="엑셀" onclick="btn_export_grid_onclick" class="btn_WF_Common" style="padding:0 0 0 0;" anchor="default" position="absolute 892 131 964 151" positiontype="position"/>
        <Grid id="grd_list_trgtCust" taborder="28" binddataset="ds_list_trgtCustAlct" useinputpanel="false" cellsizingtype="col" onvscrolllastover="grd_onvscrolllastover" onheadclick="grd_onheadclick" position2="absolute l:13 r:16 t:194 b:13" positiontype="position2" onmousemove="grd_list_trgtCust_onmousemove">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="164"/>
                <Column size="115"/>
                <Column size="89"/>
                <Column size="115"/>
                <Column size="115"/>
                <Column size="132"/>
                <Column size="94"/>
                <Column size="152"/>
                <Column size="129"/>
                <Column size="271"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="195"/>
                <Column size="137"/>
                <Column size="126"/>
                <Column size="115"/>
                <Column size="115"/>
                <Column size="115"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" edittype="checkbox"/>
                <Cell col="1" text="NO"/>
                <Cell col="2" text="서브타겟명" id="sub_trgt_list_nm"/>
                <Cell col="3" text="등록일시" id="rgsn_dttm"/>
                <Cell col="4" text="고객명" id="cust_nm"/>
                <Cell col="5" text="일반전화" id="home_tlno"/>
                <Cell col="6" text="휴대전화" id="clph_tlno"/>
                <Cell col="7" text="담당자" id="user_nm"/>
                <Cell col="8" text="할당여부" id="alct_yn"/>
                <Cell col="9" text="처리상태" id="dpms_stat_cd"/>
                <Cell col="10" text="통화결과" id="dpms_resl_cd"/>
                <Cell col="11" text="상담메모"/>
                <Cell col="12" text="사용자 정의 1" id="user_defn1_cntn"/>
                <Cell col="13" text="사용자 정의 2" id="user_defn2_cntn"/>
                <Cell col="14" text="사용자 정의 3" id="user_defn3_cntn"/>
                <Cell col="15" text="사용자 정의 4" id="user_defn4_cntn"/>
                <Cell col="16" text="사용자 정의 5" id="user_defn5_cntn"/>
                <Cell col="17" text="사용자 정의 6" id="user_defn6_cntn"/>
                <Cell col="18" text="사용자 정의 7" id="user_defn7_cntn"/>
                <Cell col="19" text="사용자 정의 8" id="user_defn8_cntn"/>
                <Cell col="20" text="사용자 정의 9" id="user_defn9_cntn"/>
                <Cell col="21" text="사용자 정의 10" id="user_defn10_cntn"/>
                <Cell col="22" text="상담메모"/>
                <Cell col="23" text="고객번호" id="mem_no"/>
                <Cell col="24" text="회원번호" id="accnt_no"/>
                <Cell col="25" text="회사전화" id="comp_tlno"/>
                <Cell col="26" text="기타전화" id="etc_tlno"/>
                <Cell col="27" text="등록자" id="rgsr_id"/>
              </Band>
              <Band id="body">
                <Cell displaytype="expr:dpms_stat_cd == '40' || dpms_stat_nm == '30' ? 'normal' : 'checkbox' " edittype="expr:dpms_stat_cd == '40' || dpms_stat_nm == '30' ? 'none' : 'checkbox'" text="bind:_chk"/>
                <Cell col="1" expr="currow+1"/>
                <Cell col="2" style="align:left;" text="bind:sub_trgt_list_nm"/>
                <Cell col="3" displaytype="expr:expr:gfn_isNull(rgsn_dttm) ? &quot;nomal&quot; : &quot;date&quot;" text="bind:rgsn_dttm" mask="expr:rgsn_dttm == null? '' : 'yyyy-MM-dd HH:mm'"/>
                <Cell col="4" displaytype="text" edittype="readonly" text="bind:cust_nm" expr="expr:gfn_SetNameGrdSecu(cust_nm)" editdisplay="display"/>
                <Cell col="5" displaytype="expr:gfn_isNull(home_tlno) ? &quot;nomal&quot; : &quot;mask&quot;" edittype="readonly" text="bind:home_tlno" expr="gfn_isNull(home_tlno) ? &quot;&quot; : home_tlno" mask="expr:gfn_SetTelNoGrdMaskSecu(home_tlno)" editdisplay="display"/>
                <Cell col="6" displaytype="expr:gfn_isNull(clph_tlno) ? &quot;nomal&quot; : &quot;mask&quot;" edittype="readonly" text="bind:clph_tlno" expr="expr:gfn_isNull(clph_tlno) ? &quot;&quot; : clph_tlno" mask="expr:gfn_SetTelNoGrdMaskSecu(clph_tlno)" editdisplay="display"/>
                <Cell col="7" style="color:EXPR(user_nm == null ? 'red' : '');color2:EXPR(user_nm == null ? 'red' : '');selectcolor:EXPR(user_nm == null ? 'red' : '');" text="bind:user_nm" expr="user_nm == null ? '미정' : user_nm"/>
                <Cell col="8" text="bind:alct_yn" expr="alct_yn =='Y' ?'할당' :'미할당'"/>
                <Cell col="9" style="color:EXPR(dpms_stat_cd == &quot;10&quot; ? &quot;red&quot; : dpms_stat_cd == &quot;20&quot; ? &quot;blue&quot;: &quot;&quot;);color2:EXPR(dpms_stat_cd == &quot;10&quot; ? &quot;red&quot; : dpms_stat_cd == &quot;20&quot; ? &quot;blue&quot;: &quot;&quot;);selectcolor:EXPR(dpms_stat_cd == &quot;10&quot; ? &quot;red&quot; : dpms_stat_cd == &quot;20&quot; ? &quot;blue&quot;: &quot;&quot;);" text="bind:dpms_stat_nm"/>
                <Cell col="10" text="bind:dpms_resl_nm"/>
                <Cell col="11" style="align:left;" text="bind:dpms_resl_cntn" tooltiptype="mouse,mouseleave" tooltiptext="bind:dpms_resl_cntn"/>
                <Cell col="12" style="align:left;" text="bind:user_defn1_cntn"/>
                <Cell col="13" style="align:left;" text="bind:user_defn2_cntn"/>
                <Cell col="14" style="align:left;" text="bind:user_defn3_cntn"/>
                <Cell col="15" style="align:left;" text="bind:user_defn4_cntn"/>
                <Cell col="16" style="align:left;" text="bind:user_defn5_cntn"/>
                <Cell col="17" style="align:left;" text="bind:user_defn6_cntn" expr="expr:trgt_list_id =='TAR99999999999999'? (user_defn6_cntn =='1' ?'온라인' :(user_defn6_cntn =='2' ?'홈쇼핑':( user_defn6_cntn=='3'?'가전':(user_defn6_cntn=='4' ? '모바일' :(gfn_isNull(user_defn6_cntn) ? &quot;&quot; : user_defn6_cntn))))) :(gfn_isNull(user_defn6_cntn) ? &quot;&quot; : user_defn6_cntn)"/>
                <Cell col="18" style="align:left;" text="bind:user_defn7_cntn"/>
                <Cell col="19" style="align:left;" text="bind:user_defn8_cntn"/>
                <Cell col="20" style="align:left;" text="bind:user_defn9_cntn"/>
                <Cell col="21" style="align:left;" text="bind:user_defn10_cntn"/>
                <Cell col="22" style="align:left;" text="bind:dpms_resl_cntn" tooltiptype="mouse,mouseleave" tooltiptext="bind:dpms_resl_cntn"/>
                <Cell col="23" displaytype="text" edittype="readonly" text="bind:mem_no" editdisplay="display"/>
                <Cell col="24" displaytype="text" edittype="readonly" text="bind:accnt_no" editdisplay="display"/>
                <Cell col="25" displaytype="expr:expr:gfn_isNull(comp_tlno) ? &quot;nomal&quot; : &quot;mask&quot;" edittype="readonly" style="align: ;" text="bind:comp_tlno" expr="expr:gfn_isNull(comp_tlno) ? &quot;&quot; : comp_tlno" mask="expr:gfn_SetTelNoGrdMaskSecu(comp_tlno)" editdisplay="display"/>
                <Cell col="26" displaytype="expr:expr:gfn_isNull(etc_tlno) ? &quot;nomal&quot; : &quot;mask&quot;" edittype="readonly" text="bind:etc_tlno" expr="expr:gfn_isNull(etc_tlno) ? &quot;&quot; : etc_tlno" mask="expr:expr:gfn_SetTelNoGrdMaskSecu(etc_tlno)" editdisplay="display"/>
                <Cell col="27" text="bind:rgsr_nm"/>
              </Band>
            </Format>
            <Format id="sdp">
              <Columns>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="100"/>
                <Column size="115"/>
                <Column size="89"/>
                <Column size="115"/>
                <Column size="115"/>
                <Column size="132"/>
                <Column size="94"/>
                <Column size="152"/>
                <Column size="129"/>
                <Column size="271"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" edittype="checkbox"/>
                <Cell col="1" text="NO"/>
                <Cell col="2" text="채널" id="user_defn6_cntn"/>
                <Cell col="3" text="등록일시" id="rgsn_dttm"/>
                <Cell col="4" text="고객명" id="cust_nm"/>
                <Cell col="5" text="일반전화" id="home_tlno"/>
                <Cell col="6" text="휴대전화" id="clph_tlno"/>
                <Cell col="7" text="담당자" id="user_nm"/>
                <Cell col="8" text="할당여부" id="alct_yn"/>
                <Cell col="9" text="처리상태" id="dpms_stat_cd"/>
                <Cell col="10" text="통화결과" id="dpms_resl_cd"/>
                <Cell col="11" text="상담메모"/>
                <Cell col="12" text="사용자 정의 7" id="user_defn7_cntn"/>
                <Cell col="13" text="사용자 정의 1" id="user_defn1_cntn"/>
                <Cell col="14" text="사용자 정의 2" id="user_defn2_cntn"/>
                <Cell col="15" text="사용자 정의 5" id="user_defn5_cntn"/>
                <Cell col="16" text="사용자 정의 3" id="user_defn3_cntn"/>
                <Cell col="17" text="사용자 정의 4" id="user_defn4_cntn"/>
                <Cell col="18" text="사용자 정의 8" id="user_defn8_cntn"/>
                <Cell col="19" text="사용자 정의 10" id="user_defn10_cntn"/>
              </Band>
              <Band id="body">
                <Cell displaytype="expr:dpms_stat_cd == '40' || dpms_stat_nm == '30' ? 'normal' : 'checkbox' " edittype="expr:dpms_stat_cd == '40' || dpms_stat_nm == '30' ? 'none' : 'checkbox'" text="bind:_chk"/>
                <Cell col="1" expr="currow+1"/>
                <Cell col="2" style="align:left;" text="bind:user_defn6_cntn" expr="expr:trgt_list_id =='TAR99999999999999'? (user_defn6_cntn =='1' ?'온라인' :(user_defn6_cntn =='2' ?'홈쇼핑':( user_defn6_cntn=='3'?'가전':(user_defn6_cntn=='4' ? '모바일' :(gfn_isNull(user_defn6_cntn) ? &quot;&quot; : user_defn6_cntn))))) :(gfn_isNull(user_defn6_cntn) ? &quot;&quot; : user_defn6_cntn)"/>
                <Cell col="3" displaytype="expr:expr:gfn_isNull(rgsn_dttm) ? &quot;nomal&quot; : &quot;date&quot;" text="bind:rgsn_dttm" mask="expr:rgsn_dttm == null? '' : 'yyyy-MM-dd HH:mm'"/>
                <Cell col="4" displaytype="text" edittype="readonly" text="bind:cust_nm" expr="expr:gfn_SetNameGrdSecu(cust_nm)" editdisplay="display"/>
                <Cell col="5" displaytype="expr:gfn_isNull(home_tlno) ? &quot;nomal&quot; : &quot;mask&quot;" edittype="readonly" text="bind:home_tlno" expr="gfn_isNull(home_tlno) ? &quot;&quot; : home_tlno" mask="expr:gfn_SetTelNoGrdMaskSecu(home_tlno)" editdisplay="display"/>
                <Cell col="6" displaytype="expr:gfn_isNull(clph_tlno) ? &quot;nomal&quot; : &quot;mask&quot;" edittype="readonly" text="bind:clph_tlno" expr="expr:gfn_isNull(clph_tlno) ? &quot;&quot; : clph_tlno" mask="expr:gfn_SetTelNoGrdMaskSecu(clph_tlno)" editdisplay="display"/>
                <Cell col="7" style="color:EXPR(user_nm == null ? 'red' : '');color2:EXPR(user_nm == null ? 'red' : '');selectcolor:EXPR(user_nm == null ? 'red' : '');" text="bind:user_nm" expr="user_nm == null ? '미정' : user_nm"/>
                <Cell col="8" text="bind:alct_yn" expr="alct_yn =='Y' ?'할당' :'미할당'"/>
                <Cell col="9" style="color:EXPR(dpms_stat_cd == &quot;10&quot; ? &quot;red&quot; : dpms_stat_cd == &quot;20&quot; ? &quot;blue&quot;: &quot;&quot;);color2:EXPR(dpms_stat_cd == &quot;10&quot; ? &quot;red&quot; : dpms_stat_cd == &quot;20&quot; ? &quot;blue&quot;: &quot;&quot;);selectcolor:EXPR(dpms_stat_cd == &quot;10&quot; ? &quot;red&quot; : dpms_stat_cd == &quot;20&quot; ? &quot;blue&quot;: &quot;&quot;);" text="bind:dpms_stat_nm"/>
                <Cell col="10" text="bind:dpms_resl_nm"/>
                <Cell col="11" style="align:left;" text="bind:dpms_resl_cntn" tooltiptype="mouse,mouseleave" tooltiptext="bind:dpms_resl_cntn"/>
                <Cell col="12" style="align:left;" text="bind:user_defn7_cntn"/>
                <Cell col="13" style="align:left;" text="bind:user_defn1_cntn"/>
                <Cell col="14" style="align:left;" text="bind:user_defn2_cntn"/>
                <Cell col="15" style="align:left;" text="bind:user_defn5_cntn"/>
                <Cell col="16" style="align:left;" text="bind:user_defn3_cntn"/>
                <Cell col="17" style="align:left;" text="bind:user_defn4_cntn"/>
                <Cell col="18" style="align:left;" text="bind:user_defn8_cntn"/>
                <Cell col="19" style="align:left;" text="bind:user_defn10_cntn"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="grd_list_trgtCust_excel" taborder="24" binddataset="ds_list_trgtCustAlct" useinputpanel="false" onvscrolllastover="grd_onvscrolllastover" onheadclick="grd_onheadclick" position2="absolute l:72 r:-43 t:264 b:-57" positiontype="position2" cellsizingtype="col" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="164"/>
                <Column size="115"/>
                <Column size="89"/>
                <Column size="115"/>
                <Column size="115"/>
                <Column size="132"/>
                <Column size="94"/>
                <Column size="152"/>
                <Column size="129"/>
                <Column size="271"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="151"/>
                <Column size="195"/>
                <Column size="137"/>
                <Column size="126"/>
                <Column size="115"/>
                <Column size="115"/>
                <Column size="115"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" edittype="checkbox"/>
                <Cell col="1" text="NO"/>
                <Cell col="2" text="서브타겟명" id="sub_trgt_list_nm"/>
                <Cell col="3" text="등록일시" id="rgsn_dttm"/>
                <Cell col="4" text="고객명" id="cust_nm"/>
                <Cell col="5" text="일반전화" id="home_tlno"/>
                <Cell col="6" text="휴대전화" id="clph_tlno"/>
                <Cell col="7" text="담당자" id="user_nm"/>
                <Cell col="8" text="할당여부" id="alct_yn"/>
                <Cell col="9" text="처리상태" id="dpms_stat_cd"/>
                <Cell col="10" text="통화결과" id="dpms_resl_cd"/>
                <Cell col="11" text="상담메모"/>
                <Cell col="12" text="사용자 정의 1" id="user_defn1_cntn"/>
                <Cell col="13" text="사용자 정의 2" id="user_defn2_cntn"/>
                <Cell col="14" text="사용자 정의 3" id="user_defn3_cntn"/>
                <Cell col="15" text="사용자 정의 4" id="user_defn4_cntn"/>
                <Cell col="16" text="사용자 정의 5" id="user_defn5_cntn"/>
                <Cell col="17" text="사용자 정의 6" id="user_defn6_cntn"/>
                <Cell col="18" text="사용자 정의 7" id="user_defn7_cntn"/>
                <Cell col="19" text="사용자 정의 8" id="user_defn8_cntn"/>
                <Cell col="20" text="사용자 정의 9" id="user_defn9_cntn"/>
                <Cell col="21" text="사용자 정의 10" id="user_defn10_cntn"/>
                <Cell col="22" text="상담메모"/>
                <Cell col="23" text="고객번호" id="mem_no"/>
                <Cell col="24" text="회원번호" id="accnt_no"/>
                <Cell col="25" text="회사전화" id="comp_tlno"/>
                <Cell col="26" text="기타전화" id="etc_tlno"/>
                <Cell col="27" text="등록자" id="rgsr_id"/>
              </Band>
              <Band id="body">
                <Cell displaytype="expr:dpms_stat_cd == '40' || dpms_stat_nm == '30' ? 'normal' : 'checkbox' " edittype="expr:dpms_stat_cd == '40' || dpms_stat_nm == '30' ? 'none' : 'checkbox'" text="bind:_chk"/>
                <Cell col="1" expr="currow+1"/>
                <Cell col="2" style="align:left;" text="bind:sub_trgt_list_nm"/>
                <Cell col="3" displaytype="expr:expr:gfn_isNull(rgsn_dttm) ? &quot;nomal&quot; : &quot;date&quot;" text="bind:rgsn_dttm" mask="expr:rgsn_dttm == null? '' : 'yyyy-MM-dd HH:mm'"/>
                <Cell col="4" displaytype="text" edittype="readonly" text="bind:cust_nm" editdisplay="display"/>
                <Cell col="5" displaytype="expr:gfn_isNull(home_tlno) ? &quot;nomal&quot; : &quot;mask&quot;" edittype="readonly" text="bind:home_tlno" expr="gfn_isNull(home_tlno) ? &quot;&quot; : home_tlno" mask="expr:gfn_SetTelNoGrdMask(home_tlno)" editdisplay="display"/>
                <Cell col="6" displaytype="expr:gfn_isNull(clph_tlno) ? &quot;nomal&quot; : &quot;mask&quot;" edittype="readonly" text="bind:clph_tlno" expr="expr:gfn_isNull(clph_tlno) ? &quot;&quot; : clph_tlno" mask="expr:gfn_SetTelNoGrdMask(clph_tlno)" editdisplay="display"/>
                <Cell col="7" style="color:EXPR(user_nm == null ? 'red' : '');color2:EXPR(user_nm == null ? 'red' : '');selectcolor:EXPR(user_nm == null ? 'red' : '');" text="bind:user_nm" expr="user_nm == null ? '미정' : user_nm"/>
                <Cell col="8" text="bind:alct_yn" expr="alct_yn =='Y' ?'할당' :'미할당'"/>
                <Cell col="9" style="color:EXPR(dpms_stat_cd == &quot;10&quot; ? &quot;red&quot; : dpms_stat_cd == &quot;20&quot; ? &quot;blue&quot;: &quot;&quot;);color2:EXPR(dpms_stat_cd == &quot;10&quot; ? &quot;red&quot; : dpms_stat_cd == &quot;20&quot; ? &quot;blue&quot;: &quot;&quot;);selectcolor:EXPR(dpms_stat_cd == &quot;10&quot; ? &quot;red&quot; : dpms_stat_cd == &quot;20&quot; ? &quot;blue&quot;: &quot;&quot;);" text="bind:dpms_stat_nm"/>
                <Cell col="10" text="bind:dpms_resl_nm"/>
                <Cell col="11" style="align:left;" text="bind:dpms_resl_cntn" tooltiptype="mouse,mouseleave" tooltiptext="bind:dpms_resl_cntn"/>
                <Cell col="12" style="align:left;" text="bind:user_defn1_cntn"/>
                <Cell col="13" style="align:left;" text="bind:user_defn2_cntn"/>
                <Cell col="14" style="align:left;" text="bind:user_defn3_cntn"/>
                <Cell col="15" style="align:left;" text="bind:user_defn4_cntn"/>
                <Cell col="16" style="align:left;" text="bind:user_defn5_cntn"/>
                <Cell col="17" style="align:left;" text="bind:user_defn6_cntn" expr="expr:trgt_list_id =='TAR99999999999999'? (user_defn6_cntn =='1' ?'온라인' :(user_defn6_cntn =='2' ?'홈쇼핑':( user_defn6_cntn=='3'?'가전':(user_defn6_cntn=='4' ? '모바일' :(gfn_isNull(user_defn6_cntn) ? &quot;&quot; : user_defn6_cntn))))) :(gfn_isNull(user_defn6_cntn) ? &quot;&quot; : user_defn6_cntn)"/>
                <Cell col="18" style="align:left;" text="bind:user_defn7_cntn"/>
                <Cell col="19" style="align:left;" text="bind:user_defn8_cntn"/>
                <Cell col="20" style="align:left;" text="bind:user_defn9_cntn"/>
                <Cell col="21" style="align:left;" text="bind:user_defn10_cntn"/>
                <Cell col="22" style="align:left;" text="bind:dpms_resl_cntn" tooltiptype="mouse,mouseleave" tooltiptext="bind:dpms_resl_cntn"/>
                <Cell col="23" displaytype="text" edittype="readonly" text="bind:mem_no" editdisplay="display"/>
                <Cell col="24" displaytype="text" edittype="readonly" text="bind:accnt_no" editdisplay="display"/>
                <Cell col="25" displaytype="expr:expr:gfn_isNull(comp_tlno) ? &quot;nomal&quot; : &quot;mask&quot;" edittype="readonly" style="align: ;" text="bind:comp_tlno" expr="expr:gfn_isNull(comp_tlno) ? &quot;&quot; : comp_tlno" mask="expr:gfn_SetTelNoGrdMask(comp_tlno)" editdisplay="display"/>
                <Cell col="26" displaytype="expr:expr:gfn_isNull(etc_tlno) ? &quot;nomal&quot; : &quot;mask&quot;" edittype="readonly" text="bind:etc_tlno" expr="expr:gfn_isNull(etc_tlno) ? &quot;&quot; : etc_tlno" mask="expr:gfn_SetTelNoGrdMask(etc_tlno)" editdisplay="display"/>
                <Cell col="27" text="bind:rgsr_nm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_pdsIntr" taborder="29" text="PDS연동" onclick="btn_onclick" class="btn_WF_Common" position2="absolute r:388 w:67 t:170 h:20" positiontype="position2" style="padding:0 0 0 0;" visible="false"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item1" compid="cal_srch_startd" propid="value" datasetid="ds_cmpg" columnid="cmpg_stt_dt"/>
      <BindItem id="item6" compid="cal_srch_endd" propid="value" datasetid="ds_cmpg" columnid="cmpg_end_dt"/>
      <BindItem id="item12" compid="edt_sub_trgt_list_nm" propid="value" datasetid="ds_list_subTrgtList" columnid="sub_trgt_list_nm"/>
      <BindItem id="item0" compid="edt_srch_sub_trgt_list_id" propid="value" datasetid="ds_list_subTrgtList" columnid="sub_trgt_list_id"/>
    </Bind>
    <Objects>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cdSet" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="6"/>
          <Column id="cd_nm" type="STRING" size="100"/>
          <Column id="adtl_cd" type="STRING" size="100"/>
          <Column id="adtl_cd_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_trgtCustAlct" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="_chk" type="INT" size="1"/>
          <Column id="xRowStatusType" type="STRING" size="1"/>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="dpms_resl_cntn" type="STRING" size="256"/>
          <Column id="cmpg_invt_mthd_nm" type="STRING" size="256"/>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="cntr_cd" type="STRING" size="256"/>
          <Column id="dpms_resl_cd" type="STRING" size="256"/>
          <Column id="dpms_stat_cd" type="STRING" size="256"/>
          <Column id="dpms_resl_nm" type="STRING" size="256"/>
          <Column id="dpms_tmcnt" type="STRING" size="256"/>
          <Column id="cnsr_id" type="STRING" size="256"/>
          <Column id="trgt_list_id" type="STRING" size="256"/>
          <Column id="user_nm" type="STRING" size="256"/>
          <Column id="cust_div_cd" type="STRING" size="256"/>
          <Column id="trgt_cust_dtpt_id" type="STRING" size="256"/>
          <Column id="dpms_stat_nm" type="STRING" size="256"/>
          <Column id="dpms_dttm" type="STRING" size="256"/>
          <Column id="cmpg_id" type="STRING" size="256"/>
          <Column id="alct_yn" type="STRING" size="256"/>
          <Column id="home_tlno" type="STRING" size="256"/>
          <Column id="cust_nm" type="STRING" size="256"/>
          <Column id="clph_tlno" type="STRING" size="256"/>
          <Column id="comp_tlno" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="user_defn1_cntn" type="STRING" size="256"/>
          <Column id="user_defn16_cntn" type="STRING" size="256"/>
          <Column id="prmv_id" type="STRING" size="256"/>
          <Column id="etc_tlno" type="STRING" size="256"/>
          <Column id="rgsr_nm" type="STRING" size="256"/>
          <Column id="rgsn_dttm" type="STRING" size="256"/>
          <Column id="rgsr_id" type="STRING" size="256"/>
          <Column id="user_id" type="STRING" size="256"/>
          <Column id="sub_trgt_list_nm" type="STRING" size="256"/>
          <Column id="user_defn2_cntn" type="STRING" size="256"/>
          <Column id="user_defn3_cntn" type="STRING" size="256"/>
          <Column id="user_defn4_cntn" type="STRING" size="256"/>
          <Column id="user_defn5_cntn" type="STRING" size="256"/>
          <Column id="user_defn6_cntn" type="STRING" size="256"/>
          <Column id="user_defn7_cntn" type="STRING" size="256"/>
          <Column id="user_defn8_cntn" type="STRING" size="256"/>
          <Column id="user_defn10_cntn" type="STRING" size="256"/>
          <Column id="user_defn9_cntn" type="STRING" size="256"/>
          <Column id="sub_trgt_list_id" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt_alct" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cmpg_id" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
          <Column id="alct_yn" type="STRING" size="256"/>
          <Column id="dpms_stat_cd" type="STRING" size="256"/>
          <Column id="sub_trgt_list_id" type="STRING" size="256"/>
          <Column id="dpms_resl_cd" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="total_tlno" type="STRING" size="256"/>
          <Column id="user_nm" type="STRING" size="256"/>
          <Column id="cnsr_id" type="STRING" size="256"/>
          <Column id="stt_dt" type="STRING" size="256"/>
          <Column id="end_dt" type="STRING" size="256"/>
          <Column id="user_defn1_cntn" type="STRING" size="256"/>
          <Column id="user_defn2_cntn" type="STRING" size="256"/>
          <Column id="user_defn3_cntn" type="STRING" size="256"/>
          <Column id="user_defn4_cntn" type="STRING" size="256"/>
          <Column id="user_defn5_cntn" type="STRING" size="256"/>
          <Column id="cnsr_nm" type="STRING" size="256"/>
          <Column id="dpms_resl_cntn" type="STRING" size="256"/>
          <Column id="cmpg_prfm_team_cd" type="STRING" size="256"/>
          <Column id="cmpg_day" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_tmp_alct" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_dpmsStatCdList_srch" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="6"/>
          <Column id="cd_nm" type="STRING" size="100"/>
          <Column id="adtl_cd" type="STRING" size="100"/>
          <Column id="adtl_cd_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_tmp_assign" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="_chk" type="INT" size="1"/>
          <Column id="xRowStatusType" type="STRING" size="1"/>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="cmpg_id" type="STRING" size="256"/>
          <Column id="team_nm" type="STRING" size="256"/>
          <Column id="team_cd" type="STRING" size="256"/>
          <Column id="cnsr_id" type="STRING" size="256"/>
          <Column id="user_nm" type="STRING" size="256"/>
          <Column id="assignnum" type="STRING" size="256"/>
          <Column id="st10" type="STRING" size="256"/>
          <Column id="st20" type="STRING" size="256"/>
          <Column id="st30" type="STRING" size="256"/>
          <Column id="cust_data_extc_cnt" type="STRING" size="256"/>
          <Column id="totalassignnum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt_assign" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cmpg_id" type="STRING" size="256"/>
          <Column id="sub_trgt_list_id" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_assign" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="_chk" type="INT" size="1"/>
          <Column id="xRowStatusType" type="STRING" size="1"/>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="cmpg_id" type="STRING" size="256"/>
          <Column id="team_nm" type="STRING" size="256"/>
          <Column id="team_cd" type="STRING" size="256"/>
          <Column id="cnsr_id" type="STRING" size="256"/>
          <Column id="user_nm" type="STRING" size="256"/>
          <Column id="assignnum" type="STRING" size="256"/>
          <Column id="st10" type="STRING" size="256"/>
          <Column id="st20" type="STRING" size="256"/>
          <Column id="st30" type="STRING" size="256"/>
          <Column id="cust_data_extc_cnt" type="STRING" size="256"/>
          <Column id="totalassignnum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_save_trgtCustAlct" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="_chk" type="INT" size="1"/>
          <Column id="xRowStatusType" type="STRING" size="1"/>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="home_tel" type="STRING" size="256"/>
          <Column id="dpms_resl_cntn" type="STRING" size="256"/>
          <Column id="cmpg_invt_mthd_nm" type="STRING" size="256"/>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="home_addr2" type="STRING" size="256"/>
          <Column id="cntr_cd" type="STRING" size="256"/>
          <Column id="dpms_resl_cd" type="STRING" size="256"/>
          <Column id="dpms_stat_cd" type="STRING" size="256"/>
          <Column id="dpms_resl_nm" type="STRING" size="256"/>
          <Column id="trgt_list_extc_typ_cd" type="STRING" size="256"/>
          <Column id="home_zip" type="STRING" size="256"/>
          <Column id="fax_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="dpms_tmcnt" type="STRING" size="256"/>
          <Column id="cust_typ_cd" type="STRING" size="256"/>
          <Column id="cnsr_id" type="STRING" size="256"/>
          <Column id="trgt_list_id" type="STRING" size="256"/>
          <Column id="user_nm" type="STRING" size="256"/>
          <Column id="cust_div_cd" type="STRING" size="256"/>
          <Column id="trgt_cust_dtpt_id" type="STRING" size="256"/>
          <Column id="dpms_stat_nm" type="STRING" size="256"/>
          <Column id="cell" type="STRING" size="256"/>
          <Column id="cmpg_invt_mthd_cd" type="STRING" size="256"/>
          <Column id="invt_cnts_id" type="STRING" size="256"/>
          <Column id="dpms_dttm" type="STRING" size="256"/>
          <Column id="cmpg_id" type="STRING" size="256"/>
          <Column id="email" type="STRING" size="256"/>
          <Column id="home_addr" type="STRING" size="256"/>
          <Column id="alct_yn" type="STRING" size="256"/>
          <Column id="prmv_id" type="STRING" size="256"/>
          <Column id="sub_trgt_list_id" type="STRING" size="256"/>
          <Column id="cust_nm" type="STRING" size="256"/>
          <Column id="clph_tlno" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt_assignum" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="sub_trgt_list_id" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_tmp_assignum" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_onrowposchanged"/>
      <Dataset id="ds_list_assignum" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="xRowStatusType" type="STRING" size="256"/>
          <Column id="cust_data_extc_cnt" type="STRING" size="256"/>
          <Column id="assignum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_subTrgtList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="_chk" type="STRING" size="256"/>
          <Column id="xRowStatusType" type="STRING" size="256"/>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="cntr_cd" type="STRING" size="256"/>
          <Column id="sub_trgt_list_id" type="STRING" size="256"/>
          <Column id="trgt_list_id" type="STRING" size="256"/>
          <Column id="sub_trgt_list_nm" type="STRING" size="256"/>
          <Column id="extc_dttm" type="STRING" size="256"/>
          <Column id="sub_trgt_list_file_nm" type="STRING" size="256"/>
          <Column id="cust_data_extc_cnt" type="STRING" size="256"/>
          <Column id="dfct_data_cnt" type="STRING" size="256"/>
          <Column id="rgsr_id" type="STRING" size="256"/>
          <Column id="rgsn_dttm" type="STRING" size="256"/>
          <Column id="amnd_id" type="STRING" size="256"/>
          <Column id="amnt_dttm" type="STRING" size="256"/>
          <Column id="rgsr_nm" type="STRING" size="256"/>
          <Column id="amnd_nm" type="STRING" size="256"/>
          <Column id="delete_fg" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt_sub" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="trgt_list_id" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_tmp_sub" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_onrowposchanged"/>
      <Dataset id="ds_dpmsReslCdList_srch" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="6"/>
          <Column id="cd_nm" type="STRING" size="100"/>
          <Column id="adtl_cd" type="STRING" size="100"/>
          <Column id="adtl_cd_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_srch_list_assign" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="_chk" type="INT" size="1"/>
          <Column id="xRowStatusType" type="STRING" size="1"/>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="cmpg_id" type="STRING" size="256"/>
          <Column id="team_nm" type="STRING" size="256"/>
          <Column id="team_cd" type="STRING" size="256"/>
          <Column id="cnsr_id" type="STRING" size="256"/>
          <Column id="user_nm" type="STRING" size="256"/>
          <Column id="assignnum" type="STRING" size="256"/>
          <Column id="st10" type="STRING" size="256"/>
          <Column id="st20" type="STRING" size="256"/>
          <Column id="st30" type="STRING" size="256"/>
          <Column id="cust_data_extc_cnt" type="STRING" size="256"/>
          <Column id="totalassignnum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_userCd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="user_nm" type="STRING" size="256"/>
          <Column id="user_id" type="STRING" size="256"/>
          <Column id="hgrn_team_cd" type="STRING" size="256"/>
          <Column id="athr_cd" type="STRING" size="256"/>
          <Column id="team_cd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt_dmnrId" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="team_cd" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
          <Column id="user_stat_cd" type="STRING" size="256"/>
          <Column id="authoritycds" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_userCd_srch" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="user_nm" type="STRING" size="256"/>
          <Column id="user_id" type="STRING" size="256"/>
          <Column id="hgrn_team_cd" type="STRING" size="256"/>
          <Column id="athr_cd" type="STRING" size="256"/>
          <Column id="team_cd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_userCd_select" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="user_nm" type="STRING" size="256"/>
          <Column id="user_id" type="STRING" size="256"/>
          <Column id="hgrn_team_cd" type="STRING" size="256"/>
          <Column id="athr_cd" type="STRING" size="256"/>
          <Column id="team_cd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <InitValue>
      <CheckBox id="chk_total_fg" truevalue="Y"/>
    </InitValue>
    <Script type="xscript4.0"><![CDATA[/***************************************************************************
 * Program ID    : PS220800.xfdl
 * Program Name  : 캠페인 할당관리
 * Author        : 정 훈
 * Created On    : 2016.04.26
 * 개    요 	 :
 *
 * =========================================================================
 * 변경일자     수정자       내    용
 * =========================================================================
 * 2016.04.26    정   훈      최초작성
 
 **************************************************************************/


/********************************************************************************************/
/* 1. Include Library include                                                               */
/********************************************************************************************/
include "LIB::lib_All.xjs";

var xlsYn; //엑셀권한
/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트,전역변수,초기화) 처리                         	*/
/********************************************************************************************/
//전역변수
var total_count = 0;
var total_count_alct = 0;

var gv_totalassignnum = 0;

var gvMenuId;  // 프로그램 로그 추가 2017.12.21

var fv_pdsGubun = "";
///////////////////////////////////////////////////////////////////////////////////////////
// 프로그램 로그 추가 2017.12.21 정승철
gvMenuId = "CM000330";
///////////////////////////////////////////////////////////////////////////////////////////
/********************************************************************************************/
//온로드
function PS22080001_onload(obj:Form, e:LoadEventInfo)
{
	fn_setAthrPgmBtn();
	stc_30.text = "고객별 할당 ("+ cmpg_nm + ")"; 
	gfn_getList("cd","CAM100,CAM090","fn_callBack",null,"srchCdSet","ds_cdSet");   // 코드셋
	gfn_createPagingDataset(obj); // 페이징처리 위한 데이터셋 설정
	
	if(fn_preSrchDmnrId()){
		gfn_getList("userCd", "", "fn_callBack", null, "selectUserCd", "ds_userCd", "ds_inqCndt_dmnrId"); //상담사조회
	}
	
	var vTeamCd = gds_UserInfo.getColumn(gds_UserInfo.rowposition,'team_cd');
	
	 var sUserAthrCd =gds_UserInfo.getColumn(gds_UserInfo.rowposition,'athr_cd');
	if( sUserAthrCd=='AT01' || vTeamCd == 'T20300' || vTeamCd == 'T20100' || vTeamCd == 'T20900'){ // 비투, 윌앤비전, 리딩만 보이기
		btn_dupAlct.visible = true;
	}else{
		btn_dupAlct.visible = false;
	}
	
	if(gds_UserInfo.getColumn(gds_UserInfo.rowposition,'excel_yn') == "Y") {
		btn_excl.visible = true;
	} else {
		btn_excl.visible = false;
	}
	
	chk_total_fg.value = 'Y';
	//fn_commSearch_alct(gfn_getCommTypeInit());//조회
	//fn_commSearch_assign(gfn_getCommTypeInit());//조회
	
	var sCmpgNm = cmpg_nm;
	if(sCmpgNm.indexOf("해약방어") > 0 && cmpg_div_cd == "1000") {
		//pds연동구분 해약방어
		btn_pdsIntr.visible = true;
		fv_pdsGubun = "CD";
	} 
	if(sCmpgNm.indexOf("해약방어") < 0 && cmpg_div_cd == "1000") {
		//pds연동구분 해피콜
		btn_pdsIntr.visible = true;
		fv_pdsGubun = "HC";
	}
	if(cmpg_div_cd == "3000") {
		//pds연동구분 미납
		btn_pdsIntr.visible = true;
		fv_pdsGubun = "DF";
	}
	
	if(cmpg_id == "TAR99999999999999" 
	   || cmpg_id == "CMP202202223900650" 
	   || cmpg_id == "CMP202202223900655"
	   || cmpg_id == "CMP202202243722708"
	   || cmpg_id == "CMP202204013724184") {
		grd_list_trgtCust.formatid = "sdp";
	}
}


//초기화
function fn_init()
{
	edt_sub_trgt_list_nm.value = null;
	chk_total_fg.value = 'Y';
	cbo_srch_alct_yn.index = 0;
	edt_srch_mem_nm.value = null;
	cbo_srch_cnsr_id.index = 0;
	cal_srch_startd.value = null;
	cal_srch_endd.value = null;
	cbo_srch_resl_stat_cd.index =0;
	cbo_srch_dpms_stat_cd.index = 0;
	edt_srch_tlno.value = null;
	edt_srch_user1.value = null;
	edt_srch_user2.value = null;
	edt_srch_user3.value = null;
	edt_srch_user4.value = null;
	edt_srch_user5.value = null;
	edt_srch_dpms_cntn.value = null;
}


/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
//콜백
function fn_callBack(svcid, errcd, errmsg) {
    if (errcd != 0) {
		trace("errcd  :   " +errcd +"   \n errmsg   :   "+ errmsg +"    \n svcid   :   "+ svcid)
		return false;
	} else {
		switch (svcid) {
		    case "srchCdSet": //코드셋
				gfn_getCode("CAM100", "ALL", ds_dpmsStatCdList_srch,ds_cdSet); //진행상태
				gfn_getCode("CAM090", "ALL", ds_dpmsReslCdList_srch,ds_cdSet); //통화결과
				cbo_srch_dpms_stat_cd.index = 0;
				cbo_srch_resl_stat_cd.index = 0;
		    break;
		    
		    case "selectUserCd": //사용자 조회
				gfn_getUserCdLoad(null,null ,"ALL", ds_userCd_srch, ds_userCd);
				gfn_getUserCdLoad(null,null ,"SELECT", ds_userCd_select, ds_userCd);
				cbo_user_nm.index = 0;
				cbo_srch_cnsr_id.index = 0;
		    break;

		    case "srchMember": // 캠페인 추출 고객 조회
				gfn_appendSearchDs(ds_list_trgtCustAlct, ds_list_tmp_alct); // 조회된 결과를 실제보여줄 데이타셋으로 Append처리
				gfn_setTotalRowCount(ds_list_trgtCustAlct, sta_totalCnt_alct, total_count_alct); // 페이지건수 표출
				fn_postSearch();
		
		    break;
		    
		    case "srchAssign" : //상담사 
				ds_list_assign.clearData();
				gfn_appendSearchDs(ds_list_assign, ds_list_tmp_assign); // 조회된 결과를 실제보여줄 데이타셋으로 Append처리
				
				ds_srch_list_assign.assign(ds_list_assign);
				
				ds_srch_list_assign.insertRow(0);
				ds_list_assign.insertRow(0);
				ds_srch_list_assign.setColumn(0,'user_nm','전체');
				ds_list_assign.setColumn(0,'user_nm','선택');
				cbo_user_nm.index = 0;
				cbo_srch_cnsr_id.index = 0;
		    break;
		    
		    case "saveAlctData" : //할당
				fn_commSearch_alct(gfn_getCommTypeInit());
				opener.fn_changeComponent("R"); //컴포넌트 셋팅
				opener.ds_list_subTrgtList.clearData();
				opener.ds_list_assign.clearData();
				opener.fn_changeComponent_assign();
		    break;
			
			case "srchAssignCnt" : // 할당 카운트 조회 (대상 , 배정)
				gfn_appendSearchDs(ds_list_assignum, ds_list_tmp_assignum); // 조회된 결과를 실제보여줄 데이타셋으로 Append처리
				fn_setAssignumCnt(ds_list_assignum.rowcount);
			break;
			
			case "saveNumAlctData" ://수치할당
				fn_commSearch_alct(gfn_getCommTypeInit());
				opener.fn_changeComponent("R"); //컴포넌트 셋팅
				opener.ds_list_subTrgtList.clearData();
				opener.ds_list_assign.clearData();
				opener.fn_changeComponent_assign();
			break;
		    
		    default :
				alert("svcid 를 확인하세요 \n svcid : "+svcid);
		    break;
		}
	}
}

/********************************************************************************************/
/**   4. Validation 처리                                                                   	*/
/********************************************************************************************/


//조회전 처리 조회조건셋팅
function fn_preSearch_alct(sType)
{
	if (sType == gfn_getCommTypeInit())
	{
		ds_list_trgtCustAlct.keystring = ""; // 정렬컬럼 초기화

		ds_inqCndt_alct.clearData();
		ds_inqCndt_alct.addRow();
		ds_inqCndt_alct.setColumn(0, "cmpg_id", cmpg_id);
		if(chk_total_fg.value != 'Y'){
			ds_inqCndt_alct.setColumn(0, "sub_trgt_list_id", edt_srch_sub_trgt_list_id.value);
		}
		ds_inqCndt_alct.setColumn(0, "alct_yn", cbo_srch_alct_yn.value);
		ds_inqCndt_alct.setColumn(0, "dpms_stat_cd", cbo_srch_dpms_stat_cd.value);
		ds_inqCndt_alct.setColumn(0, "dpms_resl_cd", cbo_srch_resl_stat_cd.value);
		ds_inqCndt_alct.setColumn(0, "mem_nm", edt_srch_mem_nm.value);
		ds_inqCndt_alct.setColumn(0, "total_tlno", edt_srch_tlno.value);
		ds_inqCndt_alct.setColumn(0, "cnsr_id", cbo_srch_cnsr_id.value);
		ds_inqCndt_alct.setColumn(0, "stt_dt", cal_srch_startd.value);
		ds_inqCndt_alct.setColumn(0, "end_dt", cal_srch_endd.value);
		ds_inqCndt_alct.setColumn(0, "user_defn1_cntn", edt_srch_user1.value);
		ds_inqCndt_alct.setColumn(0, "user_defn2_cntn", edt_srch_user2.value);
		ds_inqCndt_alct.setColumn(0, "user_defn3_cntn", edt_srch_user3.value);
		ds_inqCndt_alct.setColumn(0, "user_defn4_cntn", edt_srch_user4.value);
		ds_inqCndt_alct.setColumn(0, "user_defn5_cntn", edt_srch_user5.value);
		ds_inqCndt_alct.setColumn(0, "dpms_resl_cntn", edt_srch_dpms_cntn.value);
		//CMP202204013724184
		if(cmpg_id == "TAR99999999999999" 
		   || cmpg_id == "CMP202202223900650" 
		   || cmpg_id == "CMP202202223900655"
		   || cmpg_id == "CMP202202243722708"
		   || cmpg_id == "CMP202204013724184") {
			ds_inqCndt_alct.setColumn(0, "cmpg_prfm_team_cd", cmpg_prfm_team_cd); //협력업체별 조건
			//ds_inqCndt_alct.setColumn(0, "cmpg_day", "20220303"); //분할 날짜
			ds_inqCndt_alct.setColumn(0, "cmpg_day", "20220501"); //분할 날짜 기준변경
		}
	}
	 
	return true;
}

//조회전 처리 조회조건셋팅
function fn_preSearch_assign(sType)
{
	if (sType == gfn_getCommTypeInit())
	{
		ds_inqCndt_assign.clearData();
		ds_inqCndt_assign.addRow();
		
		//나중에 변경
		ds_inqCndt_assign.setColumn(0, "cmpg_id", cmpg_id);
		ds_inqCndt_assign.setColumn(0, "sub_trgt_list_id", sub_trgt_list_id);
	}
	
	return true;
}

//조회전 처리 조회조건셋팅 할당건수 (대상, 배정)
function fn_preSearch_assignum(sType){
	if (sType == gfn_getCommTypeInit())
		{
		ds_inqCndt_assignum.clearData();
		ds_inqCndt_assignum.addRow();
		ds_inqCndt_assignum.setColumn(0, "sub_trgt_list_id", cbo_sub_trgt_list.value);
	}
	return true;
}

function fn_preSrchDmnrId()
{
	ds_inqCndt_dmnrId.clearData();
	ds_inqCndt_dmnrId.addRow();
	ds_inqCndt_dmnrId.setColumn(0, "use_yn", "Y");
	ds_inqCndt_dmnrId.setColumn(0, "user_stat_cd", "10");
	ds_inqCndt_dmnrId.setColumn(0, "team_cd", cmpg_prfm_team_cd);
	ds_inqCndt_dmnrId.setColumn(0, "orderBy", "user_nm");
	ds_inqCndt_dmnrId.setColumn(0, "orderDirection", "ASC");

	return true;
}


/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)                                                   	*/
/********************************************************************************************/

//캠페인 할당 목록 조회
function fn_commSearch_alct(sType)
{	
    if (!fn_preSearch_alct(sType)) return false;
	
	// 호출 건수 설정 및 조회여부 설정
	if(!gfn_pageSearch(sType, ds_list_trgtCustAlct, sta_totalCnt_alct, 500, total_count_alct)) return; 
	
	var szSvcid       = "srchMember";
    var szController  = "/cmpg/trgt-cust-alct/alct/list";
    var szInDs        = "ds_input=ds_inqCndt_alct";
    var szOutDs       = "ds_list_tmp_alct=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,"","","S",gvMenuId);
}

//상담사 배정리스트 조회
function fn_commSearch_assign(sType)
{	
    if (!fn_preSearch_assign(sType)) return false;
	
	var szSvcid       = "srchAssign";
    var szController  = "/cmpg/cmpg-alct/list";
    var szInDs        = "ds_input=ds_inqCndt_assign";
    var szOutDs       = "ds_list_tmp_assign=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,false);
}

//할당
function fn_saveAlctData(){
	ds_save_trgtCustAlct.clearData();
	for(var i = 0 ;ds_list_trgtCustAlct.rowcount> i ; i++){
		if(ds_list_trgtCustAlct.getColumn(i,'_chk') == 1){
			ds_save_trgtCustAlct.addRow();
			ds_save_trgtCustAlct.copyRow(ds_save_trgtCustAlct.rowposition,ds_list_trgtCustAlct,i);
			
			if(ds_list_trgtCustAlct.getColumn(i,'cnsr_id') == "9999999999") {
				alert("PDS연동된 회원이 있습니다.\nPDS등록화면에서 삭제후 진행하시기바랍니다.");
				return;
			}
		}
	}
	
	var szSvcid       = "saveAlctData";
    var szController  = "/cmpg/trgt-cust-alct/save/alct";
    var szInDs        = "ds_input=ds_save_trgtCustAlct";
    var szOutDs       = "";
    var szParam       = "user_id="+cbo_user_nm.value+" cmpg_id="+cmpg_id
                       + " cmpg_typ_cd="+cmpg_typ_cd+" cmpg_div_cd="+cmpg_div_cd;
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,"","","I",gvMenuId);
}

//수치할당
function fn_saveNumAlctData(){
	ds_save_trgtCustAlct.clearData();
	for(var i = 0 ;ds_list_trgtCustAlct.rowcount> i ; i++){
		if(ds_list_trgtCustAlct.getColumn(i,'cnsr_id') != cbo_user_nm.value && (ds_list_trgtCustAlct.getColumn(i,'adtl_cd') != '1' || ds_list_trgtCustAlct.getColumn(i,'adtl_cd') == null)){
		 //처리완료가 아니고 자기 자신꺼 아닐때 
		 //PDS연동 제외
			if(ds_list_trgtCustAlct.getColumn(i,'cnsr_id') != "9999999999") {
				ds_save_trgtCustAlct.addRow();
				ds_save_trgtCustAlct.copyRow(ds_save_trgtCustAlct.rowposition,ds_list_trgtCustAlct,i);
			}
		}
	}
	
	var nAlctNum = edt_srch_alctnum.value;
	var szSvcid       = "saveNumAlctData";
    var szController  = "/cmpg/trgt-cust-alct/save/numalct";
    var szInDs        = "ds_input=ds_save_trgtCustAlct";
    var szOutDs       = "";
    var szParam       = "user_id="+cbo_user_nm.value+" cmpg_id="+cmpg_id
                       + " cmpg_typ_cd="+cmpg_typ_cd+" cmpg_div_cd="+cmpg_div_cd+" nAlctNum="+nAlctNum;
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,"","","I",gvMenuId);
}


//서브대상 고객 콤보리스트 검색
function fn_commSearch_subTrgtListCombo(sType){
	if (!fn_preSearch_subTrgtListCombo(sType)) return false;
	
	ds_list_subTrgtList.clearData();
	
	var szSvcid       = "srchSubTrgtList";
    var szController  = "/cmpg/sub-trgt-list/list";
    var szInDs        = "ds_input=ds_inqCndt_sub";
    var szOutDs       = "ds_list_tmp_sub=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,false);   
}

//카운트 조회 (대상, 배정, 미배정수)
function fn_commSearch_assignum(sType){
	if (!fn_preSearch_assignum(sType)) return false;
	
	ds_list_assignum.clearData();

	var szSvcid       = "srchAssignCnt";
    var szController  = "/cmpg/sub-trgt-list/assigncnt";
    var szInDs        = "ds_input=ds_inqCndt_assignum";
    var szOutDs       = "ds_list_tmp_assignum=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,false);   
}

//PDS 연동
function fn_savePdsIntr(){
	ds_save_trgtCustAlct.clearData();
	for(var i = 0 ;ds_list_trgtCustAlct.rowcount> i ; i++){
		if(ds_list_trgtCustAlct.getColumn(i,'_chk') == 1){
			ds_save_trgtCustAlct.addRow();
			ds_save_trgtCustAlct.copyRow(ds_save_trgtCustAlct.rowposition,ds_list_trgtCustAlct,i);
			if(ds_list_trgtCustAlct.getColumn(i,'cnsr_id') == '9999999999') {
				alert("체크된 고객중 PDS연동된 고객이 존재합니다.");
				return;
			}
		}
	}
	
	var szSvcid       = "saveAlctData";
    var szController  = "/cmpg/trgt-cust-alct/save/pdsIntr";
    var szInDs        = "ds_input=ds_save_trgtCustAlct";
    var szOutDs       = "";
    var szParam       = "user_id=9999999999 cmpg_id="+cmpg_id
                       + " cmpg_typ_cd="+cmpg_typ_cd+" cmpg_div_cd="+cmpg_div_cd+" pdsGubun="+fv_pdsGubun;
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,"","","I",gvMenuId);
}
/********************************************************************************************/
/**   6. 사용자 함수                                                                   	*/
/********************************************************************************************/
//조회 결과 
function fn_postSearch()
{

}

/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
//페이징
function grd_onvscrolllastover(obj:Grid, e:ScrollEventInfo)
{
	switch(obj){
		case grd_list_trgtCust:
			fn_commSearch_alct(gfn_getCommTypeAppend());
		break;
		
		default :
			alert("obj를 확인하세요");
		break;
	}
}

//버튼클릭 이벤트
function btn_onclick(obj:Button,  e:ClickEventInfo)
{
	switch(obj){
		case btn_search : //조회
			if(chk_total_fg.value != 'Y' && edt_srch_sub_trgt_list_id.value == null){
				alert("서브 대상 고객을 선택하세요");
				return;
			}else{
				fn_commSearch_alct(gfn_getCommTypeInit());//조회
			}
		break;
		case btn_Init: //초기화
			 fn_init();
		break;
		
		case btn_alct: //할당
			if(cbo_user_nm.index == 0){
				alert("할당할 상담사를 선택하세요");
				return false;
			}
			if(!gfn_chkSelectValidation(ds_list_trgtCustAlct)){ 
				alert("할당할 고객을 선택하세요");
				return false;
			}else{
				fn_saveAlctData();
			}
		break;
		
		case btn_open_sub_trgt_list_Pop : // 서브대상고객 팝업 선택 
			var sPrmr = {trgt_list_id:trgt_list_id,page_url:"PS22080001"};	
			gfn_diaLog("서브타겟리스트 선택", -1, -1, 719, 388, "PS220000::PS220101_01.xfdl", false, sPrmr, false, true, true, null ,null ,true);
		break;
		
		case btn_dupAlct ://중복할당제거
		    var sub_trgt_list_id;
			if(chk_total_fg.value != 'Y'){
				sub_trgt_list_id = edt_srch_sub_trgt_list_id.value;
			}else{
				sub_trgt_list_id = null;
			}
			var sPrmr = {cmpg_id:cmpg_id,trgt_list_id:trgt_list_id,page_url:"PS22080001",sub_trgt_list_id:sub_trgt_list_id};	
			gfn_diaLog("중복데이터 삭제", -1, -1, 719, 388, "PS220000::PS221300.xfdl", false, sPrmr, false, true, true, null ,null ,true);
		break;
		
		case btn_numAlct: // 수치할당
		if(ds_list_trgtCustAlct.rowcount <1){
			alert("할당할 고객을 조회하세요");
			return false;
		}
		if(cbo_user_nm.index == 0){
			alert("할당할 상담사를 선택하세요");
			return false;
		}
		if(edt_srch_alctnum.value == null){
			alert("수치를 입력하세요");
			return;
		}
		if(confirm("조회된 고객목록중 수치할당 합니다. 할당 하시겠습니까? \n\n 제외 대상) 처리완료인 건(장기부재취소 재외), 선택된 상담사건"))
		{	fn_saveNumAlctData()};
		break;
		
		case btn_pdsIntr:
			if(!gfn_chkSelectValidation(ds_list_trgtCustAlct)){ 
				alert("할당할 고객을 선택하세요");
				return false;
			}else{
				fn_savePdsIntr();
			}
			
		break;
	}
}

//해더클릭이벤트
function grd_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	if (!fn_preSearch_alct()) return false;
	ds_inqCndt_alct.setColumn(0, "sController", "/cmpg/trgt-cust-alct/alct/list");
	ds_inqCndt_alct.setColumn(0, "dsName", "ds_output");
	
	if(!gfn_pageSearch(gfn_getCommTypeOrderBy(), ds_list_trgtCustAlct, sta_totalCnt_alct, 500, total_count_alct)) return;
	gfn_grdHeadClick(obj, e, ds_inqCndt_alct, null,ds_list_tmp_alct);
	gfn_setTotalRowCount(ds_list_trgtCustAlct, sta_totalCnt_alct, total_count_alct); // 페이지건수 표출
}

function btn_close_onclick(obj:Button,  e:ClickEventInfo)
{
	close();
}


//콤보 박스 변환시 
function cbo_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	switch(obj){
		case cbo_srch_dpms_stat_cd : //처리상태 변경시 
			if(obj.value == 10){	// 미처리
				gfn_getCode("CAM090", "ALL", ds_dpmsReslCdList_srch,ds_cdSet,"2000,2001,2002,3000,3001,3002,3003,3004,3005,3006,3007,3008,3009,3010,3011,3012"); //통화결과
				if(cbo_srch_resl_stat_cd.value >= 2000){
					cbo_srch_resl_stat_cd.index = 0;
				}
			}else if(obj.value == 20){ //진행중
				gfn_getCode("CAM090", "ALL", ds_dpmsReslCdList_srch,ds_cdSet,"1000,1001,3000,3001,3002,3003,3004,3005,3006,3007,3008,3009,3010,3011,3012"); //통화결과
				if(cbo_srch_resl_stat_cd.value < 2000 ||cbo_srch_resl_stat_cd.value  >= 3000){
					cbo_srch_resl_stat_cd.index = 0;
				}
			}else if(obj.value == 30){ //처리와료
				gfn_getCode("CAM090", "ALL", ds_dpmsReslCdList_srch,ds_cdSet,"1000,1001,2000,2001,2002"); //통화결과
				if(cbo_srch_resl_stat_cd.value < 3000){
					cbo_srch_resl_stat_cd.index = 0;
				}
			}else if(obj.index == 0){
				gfn_getCode("CAM090", "ALL", ds_dpmsReslCdList_srch,ds_cdSet); //통화결과
				cbo_srch_resl_stat_cd.index = 0;
			}
		break;
		
		case cbo_srch_resl_stat_cd : //통화결과 변경시 
			if(gfn_isNull(obj.value)){
				//cbo_srch_dpms_stat_cd.index = 0;
			}else if (obj.value >= 1000 && obj.value < 2000){ // 미처리
				cbo_srch_dpms_stat_cd.index = 1;
			}else if (obj.value >= 2000 && obj.value < 3000){ //  처리중
				cbo_srch_dpms_stat_cd.index = 2;
			}else if (obj.value >= 3000 && obj.value < 4000){ // 처리완료
				cbo_srch_dpms_stat_cd.index = 3;
			}
		break;
	}
}

//체크박스 변경시
function chk_total_fg_onchanged(obj:CheckBox, e:CheckBoxChangeEventInfo)
{
	if(obj.value =='Y'){
		ds_list_subTrgtList.clearData();
	}
}


//키이벤트
function edt_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13) { // 엔터
		if(chk_total_fg.value != 'Y' && edt_srch_sub_trgt_list_id.value == null){
			alert("서브 대상 고객을 선택하세요");
			return;
		}else{
			fn_commSearch_alct(gfn_getCommTypeInit());//조회
		}
	}
}



function cbo_onkeydown(obj:Combo, e:KeyEventInfo)
{
	if (e.keycode == 13) { // 엔터
		if(chk_total_fg.value != 'Y' && edt_srch_sub_trgt_list_id.value == null){
			alert("서브 대상 고객을 선택하세요");
			return;
		}else{
			fn_commSearch_alct(gfn_getCommTypeInit());//조회
		}
	}
}

// 엑셀반출
function btn_export_grid_onclick(obj:Button,  e:ClickEventInfo)
{
	var objDate = new Date();
	var ymd = objDate.toFormatString("%Y%m%d");
	var subTg = edt_sub_trgt_list_nm.value;
	if(gfn_isNull(subTg) == true) {
		subTg = '전체';
	}
	if (ds_list_trgtCustAlct.rowcount > 0) {
		//gfn_ExportMultSheet("고객별할당_"+subTg,"grd_list_trgtCust::01");
		//grid = grd_list_trgtCust;
		grid = grd_list_trgtCust_excel;   // 엑셀용 그리드 추가 (마스킹 작업전 기존 그리드) - 2017.12.28 정승철
		text = "고객별할당_" + ymd ;
		//gfn_exportGridToExcel(grid, text);
		
		var colDS = fn_excelPrepareExcelDS("grd_list_trgtCust");
		//gfn_excelDown(text, "XLS_DLCC", "TrgtCustAlctMap.getTrgtAlctCustListExcel", "TrgtCustAlctMap.getTrgtAlctCustCount", ds_inqCndt_alct, true, colDS, true);
		//gfn_excelDown("추출고객 대상리스트(GRID)", "XLS_DLCC", "UnpyMngeMap.getSmsUnpy", "UnpyMngeMap.getSmsUnpyCount", ds_inqCndt_alct, true, colDS);
		fn_excelDown(text, "XLS_DLCC", "TrgtCustAlctMap.getTrgtAlctCustListExcel", "TrgtCustAlctMap.getTrgtAlctCustCount", ds_inqCndt_alct, true, colDS);
	}else{
		alert('조회 후 엑셀 반출하시기 바랍니다.');
		return;
	}	
}

/*
 * 엑셀 다운로드 요청
 * gfn_excelDown(파일명, XLS아이디, 리스트쿼리ID, 건수쿼리ID, 파라미터데이터셋);
 */
function fn_excelDown(psFileNm:String, psXlsId:String, psListQuery, psCountQuery, dsParam:Dataset, bBigGrid:Boolean, dsColumn:Dataset, bMsSqlYn:Boolean) {
    
    bBigGrid = bBigGrid != undefined ? bBigGrid : false;
    bMsSqlYn = bMsSqlYn != undefined ? bMsSqlYn : false;
    if (bBigGrid && dsColumn == undefined) {
		alert("대용량 다운로드의 경우 컬럼셋을 셋팅해 주셔야 합니다.");
		return; 
    }
    
    // 다운로드 엑셀 파일명 저장
    _gsSaveExcelFileNm = psFileNm;
	
	// 엑셀 파일 생성 요청
	var szSvcid       = "commonExcelDown";
    var szController  = "/syst/xls/request";
    var szInDs        = "ds_input=" + dsParam.name;
    var szOutDs       = "";
    var szParam       = "xls_id=" + psXlsId + " list_query=" + psListQuery + " cnt_query=" + psCountQuery + " bigGrid_yn=" + (bBigGrid ? "Y":"N") + " msSql_yn=" + (bMsSqlYn ? "Y":"N");
    var szRetCallback = "fn_ExcelDownCallBack";
    
    if (bBigGrid) {
		szInDs += (" ds_column=" + dsColumn.name);
    }

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback, true);
}

function fn_excelPrepareExcelDS(grdNM:String) {
	var colDS:Dataset = null;
	if (this["ds_tempExcelDown"]) {
		colDS = this["ds_tempExcelDown"];
	} else {
		colDS = new Dataset;
		colDS.name = "ds_tempExcelDown";
		this.addChild(colDS.name, colDS);
	}
	
	colDS.addColumn("xls_colm_id", "string", 256);
	colDS.addColumn("xls_colm_nm", "string", 256);
	colDS.addColumn("xls_colm_type_cd", "string", 256);
	
	for (var i=0; i< this[grdNM].getCellCount("Head"); i++) {
		var colId = this[grdNM].getCellProperty("Body", i, "text")
		if (colId==null || colId.search("expr") > -1)
			continue;
			
		colId = colId.replace("bind:", "");
		colDS.addRow();
		colDS.setColumn(colDS.rowposition, "xls_colm_id", colId);
		colDS.setColumn(colDS.rowposition, "xls_colm_nm", this[grdNM].getCellProperty("Head", i, "text"));
		colDS.setColumn(colDS.rowposition, "xls_colm_type_cd", "10");
	}
	
	return colDS;
}

/*
 * 엑셀 다운로드 요청 콜백
 */
var _gsSaveExcelFileNm = ""; // 다운로드 엑셀 파일명
var _gsServerExcelFileNm = ""; // 서버 엑셀 파일명
function fn_ExcelDownCallBack(psSvcId, psErrCd, psErrMsg) {
	if (psErrCd != 0) {
	    return;
	}
	
	// 반환 서버 엑셀 파일명이 없는 경우 종료
	if (gfn_isNull(_gsServerExcelFileNm)) {
	    return;
	}
	
	var bZipFile = (_gsServerExcelFileNm.indexOf(".zip") > 0) ? true : false;
	
	// 다운로드 엑셀 파일명 시간 조합
	_gsSaveExcelFileNm += "_" + gfn_getTodayFull() + (bZipFile ? ".zip" : ".xlsx");
	
	// HttpObject 컴포넌트 생성
	var sDownloadUrl = gfn_getServiceUrl("fileUrl") + "syst/xls/download?file_path=" + _gsServerExcelFileNm;
	var oHttpObject:HttpObject = objects["httpObject"] != null ? objects["httpObject"] : new HttpObject();
	oHttpObject.timeout = 3600;
	oHttpObject.onload.setHandler(function(obj:HttpObject, e:HttpObjLoadEventInfo) {
		gfn_setWaitCursor(false);
		if (e.errorcode < 0) {
			alert("엑셀파일 다운로드가 실패 하였습니다.");
		} else {
			alert("엑셀파일 다운로드가 완료 되었습니다.");
		}
	});
	
	// 엑셀파일 다운로드
	var sFileFilter = parent.parent.form.div_Comm.FileDialog.filter;
	parent.parent.form.div_Comm.FileDialog.filter = bZipFile ? "Zip (*.zip)|*.zip|" : "Excel (*.xlsx)|*.xlsx|";
	var oFileDialog = parent.parent.form.div_Comm.FileDialog.open("file download", FileDialog.SAVE, "%MYDOCUMENT%", _gsSaveExcelFileNm);
	parent.parent.form.div_Comm.FileDialog.filter = sFileFilter; // 공통필터 복구
	if (!gfn_isNull(oFileDialog)) {
		gfn_setWaitCursor(true);
		oHttpObject.download(sDownloadUrl, oFileDialog, false);
	
	    oFileDialog.close();
	}
}

// 권한에 따른 버튼 설정
function fn_setAthrPgmBtn()
{
	gfn_athrPgm(gfn_gdsCd_admin());
	
	if (xlsYn == "N") {
		btn_excl.visible = false;
	}
}

function grd_list_trgtCust_onmousemove(obj:Grid, e:GridMouseEventInfo)
{
	if(cmpg_id == "TAR99999999999999" 
	   || cmpg_id == "CMP202202223900650" 
	   || cmpg_id == "CMP202202223900655"
	   || cmpg_id == "CMP202202243722708"
	   || cmpg_id == "CMP202204013724184") {
		
		obj.tooltiptext = "";
		if (e.row < 0) {
			return;
		}
		var sConsMemoCntn = "";
		
		if(e.col == 18) {
			sConsMemoCntn = ds_list_trgtCustAlct.getColumn(e.row, "user_defn7_cntn");
		}
		
		if (gfn_isNull(sConsMemoCntn)) {
			return;
		}
		
		// 1 라인이 100 바이트 이상인 경우 줄넘김 추가
		var nBytes = 0;
		var sNewConsMemoCntn = "";
		for (var i = 0; i < sConsMemoCntn.length; i++) {
			// 문자 복사
			sNewConsMemoCntn += sConsMemoCntn.charAt(i);
			// 내용에 줄넘김이 있는 경우 바이트 초기화
			if (i + 1 < sConsMemoCntn.length &&
				sConsMemoCntn.charAt(i) + sConsMemoCntn.charAt(i + 1) == "\r\n") {
				i++;
				sNewConsMemoCntn += sConsMemoCntn.charAt(i);
				nBytes = 0;
				continue;
			} else if (sConsMemoCntn.charAt(i) == "\n") {
				nBytes = 0;
				continue;
			}
			// 바이트 계산 및 줄넘김 추가
			nBytes += (sConsMemoCntn.charCodeAt(i) > 127) ? 2 : 1;
			if (nBytes >= 100) {
				sNewConsMemoCntn += "\r\n";
				nBytes = 0;
			}
		}
		obj.tooltiptext = sNewConsMemoCntn;
		
	}
}
]]></Script>
  </Form>
</FDL>
