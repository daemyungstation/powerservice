<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="PS994000" classname="팝업가이드" inheritanceid="" position="absolute 0 0 950 514" titletext="가상계좌문자메시지전송(알림톡)" onload="PS994000_onload">
    <Layouts>
      <Layout>
        <Static id="stc_31" class="sta_popupBg1" enable="false" onclick="stc_31_onclick" position2="absolute l:0 w:950 t:0 h:512" positiontype="position2"/>
        <Button id="btn_Close" taborder="1" onclick="btn_close_onclick" class="btn_popupClose" position2="absolute l:923 w:20 t:10 h:19" positiontype="position2"/>
        <Static id="stc_30" text="가상계좌 SMS 전송(알림톡)" class="sta_popupTitle" transparenthittest="true" position2="absolute l:9 w:311 t:10 h:20" positiontype="position2"/>
        <Calendar id="msk_resr_dt" taborder="2" displaynulltext="____-__-__" dateformat="yyyy-MM-dd" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" class="cal_srch" enable="false" anchor="default" position="absolute 79 47 175 67" positiontype="position"/>
        <Combo id="cbo_resr_tm" taborder="3" codecolumn="codecolumn" datacolumn="datacolumn" onitemchanged="tab_tabpage1_cbo_city_onitemchanged" enable="false" position2="absolute l:255 w:96 t:47 h:20" positiontype="position2">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">0000</Col>
                <Col id="datacolumn">00:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0030</Col>
                <Col id="datacolumn">00:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0100</Col>
                <Col id="datacolumn">01:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0130</Col>
                <Col id="datacolumn">01:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0200</Col>
                <Col id="datacolumn">02:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0230</Col>
                <Col id="datacolumn">02:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0300</Col>
                <Col id="datacolumn">03:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0330</Col>
                <Col id="datacolumn">03:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0400</Col>
                <Col id="datacolumn">04:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0430</Col>
                <Col id="datacolumn">04:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0500</Col>
                <Col id="datacolumn">05:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0530</Col>
                <Col id="datacolumn">05:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0600</Col>
                <Col id="datacolumn">06:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0630</Col>
                <Col id="datacolumn">06:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0700</Col>
                <Col id="datacolumn">07:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0730</Col>
                <Col id="datacolumn">07:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0800</Col>
                <Col id="datacolumn">08:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0830</Col>
                <Col id="datacolumn">08:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0900</Col>
                <Col id="datacolumn">09:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">0930</Col>
                <Col id="datacolumn">09:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1000</Col>
                <Col id="datacolumn">10:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1030</Col>
                <Col id="datacolumn">10:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1100</Col>
                <Col id="datacolumn">11:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1130</Col>
                <Col id="datacolumn">11:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1200</Col>
                <Col id="datacolumn">12:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1230</Col>
                <Col id="datacolumn">12:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1300</Col>
                <Col id="datacolumn">13:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1330</Col>
                <Col id="datacolumn">13:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1400</Col>
                <Col id="datacolumn">14:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1430</Col>
                <Col id="datacolumn">14:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1500</Col>
                <Col id="datacolumn">15:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1530</Col>
                <Col id="datacolumn">15:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1600</Col>
                <Col id="datacolumn">16:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1630</Col>
                <Col id="datacolumn">16:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1700</Col>
                <Col id="datacolumn">17:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1730</Col>
                <Col id="datacolumn">17:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1800</Col>
                <Col id="datacolumn">18:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1830</Col>
                <Col id="datacolumn">18:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1900</Col>
                <Col id="datacolumn">19:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1930</Col>
                <Col id="datacolumn">19:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2000</Col>
                <Col id="datacolumn">20:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2030</Col>
                <Col id="datacolumn">20:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2100</Col>
                <Col id="datacolumn">21:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2130</Col>
                <Col id="datacolumn">21:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2200</Col>
                <Col id="datacolumn">22:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2230</Col>
                <Col id="datacolumn">22:30</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2300</Col>
                <Col id="datacolumn">23:00</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2330</Col>
                <Col id="datacolumn">23:30</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Button id="btn_Send" taborder="4" text="보내기" onclick="btn_Send_onclick" position2="absolute r:18 w:72 t:47 h:20" positiontype="position2" tooltiptext="초기화" style="padding:0 0 0 0;"/>
        <Static id="stc_07" text="예약시간" class="sta_workSrcLabel1" position2="absolute l:192 w:62 t:47 h:20" positiontype="position2"/>
        <Static id="stc_06" text="예약일자" class="sta_workSrcLabel1" position2="absolute l:16 w:62 t:47 h:20" positiontype="position2"/>
        <CheckBox id="chk_rightfg" taborder="5" text="즉시발송" value="true" onclick="chk_rightfg_onclick" position="absolute 363 47 433 67"/>
        <Edit id="edt_cntr_rprs_tlno" taborder="6" value="1588-8511" inputtype="number" lengthunit="utf8" maxlength="13" onkillfocus="edt_cntr_rprs_tlno_onkillfocus" position2="absolute l:737 w:96 t:48 h:20" positiontype="position2"/>
        <Static id="stc_22" text="발신번호" class="sta_workSrcLabel1" position2="absolute l:674 w:62 t:48 h:20" positiontype="position2"/>
        <Static id="stc_00" text="업체명" class="sta_workSrcLabel1" position2="absolute l:486 w:62 t:48 h:20" positiontype="position2"/>
        <Edit id="edt_cntr_rprs_tlno00" taborder="7" value="(주)대명스테이션" inputtype="number" lengthunit="utf8" maxlength="13" onkillfocus="edt_cntr_rprs_tlno_onkillfocus" position2="absolute l:540 w:120 t:48 h:20" positiontype="position2"/>
        <Grid id="grd_list" taborder="8" binddataset="ds_list" useinputpanel="false" autofittype="col" oncellclick="grd_list_oncellclick" position2="absolute l:9 r:13 t:82 b:17" positiontype="position2" onheadclick="tab_tabpage2_Grid00_onheadclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="44"/>
                <Column size="147"/>
                <Column size="148"/>
                <Column size="384"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="138"/>
              </Rows>
              <Band id="head">
                <Cell text="NO"/>
                <Cell col="1" text="회원명"/>
                <Cell col="2" text="연락처"/>
                <Cell col="3" text="문자내용"/>
              </Band>
              <Band id="body">
                <Cell expr="currow+1"/>
                <Cell col="1" displaytype="text" text="bind:mem_nm"/>
                <Cell col="2" displaytype="text" edittype="text" editfilter="digit" text="bind:clph_no" mask="expr:gfn_SetTelNoGrdMask(clph_no)" editlimit="12" editdisplay="display" editlimitbymask="integer"/>
                <Cell col="3" displaytype="decoratetext" style="align:left;" text="bind:content"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <CheckBox id="chk_kakao" taborder="9" text="카카오알림톡" value="true" onclick="chk_kakao_onclick" position="absolute 249 9 349 29" style="color:white;"/>
        <CheckBox id="chk_lms" taborder="10" text="L M S" onclick="chk_lms_onclick" position="absolute 361 9 461 29" style="color:white;"/>
      </Layout>
    </Layouts>
    <Bind/>
    <Objects>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chat_msg_typ_cd" type="STRING" size="256"/>
          <Column id="chat_msg_titl" type="STRING" size="256"/>
          <Column id="chat_msg_cntn" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_tmp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_list_chatCnts" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chat_msg_lngt" type="STRING" size="256"/>
          <Column id="amnt_dttm" type="STRING" size="256"/>
          <Column id="chat_dpms_div_nm" type="STRING" size="256"/>
          <Column id="file_flag" type="STRING" size="256"/>
          <Column id="img_url_addr" type="STRING" size="256"/>
          <Column id="amnd_id" type="STRING" size="256"/>
          <Column id="amnd_nm" type="STRING" size="256"/>
          <Column id="cntr_cd" type="STRING" size="256"/>
          <Column id="chat_msg_typ_nm" type="STRING" size="256"/>
          <Column id="dpms_tlno" type="STRING" size="256"/>
          <Column id="chat_msg_typ_cd" type="STRING" size="256"/>
          <Column id="chat_cnts_div_nm" type="STRING" size="256"/>
          <Column id="chat_dpms_div_cd" type="STRING" size="256"/>
          <Column id="rgsr_id" type="STRING" size="256"/>
          <Column id="rgsn_dttm" type="STRING" size="256"/>
          <Column id="chat_msg_cntn" type="STRING" size="256"/>
          <Column id="rgsr_nm" type="STRING" size="256"/>
          <Column id="file_id" type="STRING" size="256"/>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="chat_msg_titl" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
          <Column id="chat_cnts_id" type="STRING" size="256"/>
          <Column id="chat_cnts_div_cd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_chat_msg_typ_cd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <FileDialog id="FileDialog00" filter="All(*.*)|*.*|" filterindex="0" defaultextention="false"/>
      <Dataset id="ds_list_tmp2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_list_excel" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="rowCheck" type="STRING" size="256"/>
          <Column id="cust_id" type="STRING" size="256"/>
          <Column id="cust_nm" type="STRING" size="256"/>
          <Column id="clph_no" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqSend" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="service_type" type="STRING" size="256"/>
          <Column id="recipient_num" type="STRING" size="256"/>
          <Column id="callback" type="STRING" size="256"/>
          <Column id="subject" type="STRING" size="256"/>
          <Column id="content" type="STRING" size="256"/>
          <Column id="broadcast_yn" type="STRING" size="256"/>
          <Column id="reserve_yn" type="STRING" size="256"/>
          <Column id="reserve_date" type="STRING" size="256"/>
          <Column id="attach_file_name" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_attachFile" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="fileName" type="STRING" size="32"/>
          <Column id="fileSize" type="BIGDECIMAL" size="8"/>
          <Column id="fileType" type="STRING" size="32"/>
          <Column id="filePath" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="fileName"/>
            <Col id="fileType">1</Col>
            <Col id="filePath"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="content" type="STRING" size="256"/>
          <Column id="clph_no" type="STRING" size="256"/>
          <Column id="service_type" type="STRING" size="256"/>
          <Column id="recipient_num" type="STRING" size="256"/>
          <Column id="callback" type="STRING" size="256"/>
          <Column id="subject" type="STRING" size="256"/>
          <Column id="content" type="STRING" size="256"/>
          <Column id="broadcast_yn" type="STRING" size="256"/>
          <Column id="reserve_yn" type="STRING" size="256"/>
          <Column id="reserve_date" type="STRING" size="256"/>
          <Column id="attach_file_name" type="STRING" size="256"/>
          <Column id="chat_msg_typ_cd" type="STRING" size="256"/>
          <Column id="tmp_cd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_send_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="content" type="STRING" size="256"/>
          <Column id="clph_no" type="STRING" size="256"/>
          <Column id="service_type" type="STRING" size="256"/>
          <Column id="recipient_num" type="STRING" size="256"/>
          <Column id="callback" type="STRING" size="256"/>
          <Column id="subject" type="STRING" size="256"/>
          <Column id="content" type="STRING" size="256"/>
          <Column id="broadcast_yn" type="STRING" size="256"/>
          <Column id="reserve_yn" type="STRING" size="256"/>
          <Column id="reserve_date" type="STRING" size="256"/>
          <Column id="attach_file_name" type="STRING" size="256"/>
          <Column id="chat_msg_typ_cd" type="STRING" size="256"/>
          <Column id="tmp_cd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/********************************************************************************************/
/* 1. Include Library include, variables Declaration 영역                                  */
/********************************************************************************************/
include "LIB::lib_All.xjs";
var sendmode = "multi";
var fv_svcPath;
var total_count = 0; // 전체건수
var fv_svcPath = gfn_getServiceUrl("fileUrl");
var arrFiles = new Array();	// FileDialog 선택을 통한 File Array

/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리                                           	*/
/********************************************************************************************/
function PS994000_onload(obj:Form, e:LoadEventInfo)
{		
	// 중복회원 제거 추가..
	ds_list.clearData();
	opener.ds_list.filter("_chk == '1'");
	ds_list.copyData(opener.ds_list, true);
	opener.ds_list.filter("");	
	for (var i=0;i<ds_list.rowcount;i++) {
		var dup_chk = true;
		for (var j=0;j<ds_send_list.rowcount;j++) {
			if (ds_list.getColumn(i,"mem_no") == ds_send_list.getColumn(j,"mem_no")) {
				dup_chk = false;
				break;
			}
		}
		if (dup_chk) {
			var nRow = ds_send_list.addRow();
			ds_send_list.copyRow(nRow, ds_list, i);
		}
	}
	
	ds_list.copyData(ds_send_list);	
}

/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
function fn_callBack(svcid, errcd, errmsg) 
{
	if (errcd != 0) {
		trace(errcd)
		return false;
	} else {
		switch (svcid) {
			case "sendMsg":
				alert("발송되었습니다.");
			break;
 		}
 	}
} 		

/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)                                                   	*/
/********************************************************************************************/
//조회
function fn_commSearch(sType)
{
	var szSvcid       = "getChatCntsList";
    var szController  = "/knowledge/chat-cnts/list";
    var szInDs        = "ds_input=ds_inqCndt";
    var szOutDs       = "ds_list_tmp=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

//메시지 전송
function fn_send()
{

	/*알림톡인지 일반문자인지.체크...  알림톡 = 'KAKAO'  문자 LMS*/
		var ls_gubun_sms = ''
		if (chk_kakao.value == true  ){
		    ls_gubun_sms = 'KAKAO'
		}
		
		if (chk_lms.value == true  ){
		    ls_gubun_sms = 'LMS'
		}
		/*알림톡 컬럼*/
		//if 
		
		trace(ls_gubun_sms);
		
	for (var i=0;i<ds_list.rowcount;i++) {		
		var callback = edt_cntr_rprs_tlno.value;
		ds_list.setColumn(i, "callback", callback.replace("-",""));//발신번호
		ds_list.setColumn(i, "subject", "[대명라이프웨이]");//메시지제목
		ds_list.setColumn(i, "broadcast_yn", "N");//동보발송유무
		
		if(chk_rightfg.value == false){
			ds_list.setColumn(i, "reserve_yn", "Y");//예약발송 유무
			ds_list.setColumn(i, "reserve_date", msk_resr_dt.value + cbo_resr_tm.value);//예약발송 시각
		}else{
			ds_list.setColumn(i, "reserve_yn", "N");//예약발송 유무
		}
		if(toNumber(gfn_getLengthB(ds_list.getColumn(i, "content"))) <= 80){//SMS
			ds_list.setColumn(i, "service_type", "0");//메시지전송타입
		}else{//LMS
			ds_list.setColumn(i, "service_type", "3");//메시지전송타입
		}
		
		ds_list.setColumn(i, "chat_msg_typ_cd", ls_gubun_sms);//메시지 전송구분  (카카오톡  &   LMS)
		ds_list.setColumn(i, "tmp_cd", "CS0006"); // 템플릿 코드  가상계
		
	}

	var szSvcid       = "sendMsg";
	var szController  = "/chnl/chat-sndg/vrtl-newsend";
	var szInDs        = "ds_input=ds_list";
	var szOutDs       = "";
	var szParam       = "";
	var szRetCallback = "fn_callBack";
	
//	trace(ds_list.saveXML());

	// 트랜젝션 공통함수 호출
	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);

}

/********************************************************************************************/
/**   6. 사용자 함수                                                                   	*/
/********************************************************************************************/
// 초기화
function fn_init()
{

}

/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
function btn_Search_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_commSearch(gfn_getCommTypeInit());
}

//즉시발송 체크클릭
function chk_rightfg_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	//체크상태
	if(obj.value == true){
		msk_resr_dt.value = "";
		cbo_resr_tm.value = "";
		msk_resr_dt.enable = false;
		cbo_resr_tm.enable = false;
	}else{
		msk_resr_dt.enable = true;
		cbo_resr_tm.enable = true;
	}
}

//헤더클릭
function tab_tabpage2_Grid00_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	gfn_grdHeadClick(obj, e);
}

//보내기버튼클릭
function btn_Send_onclick(obj:Button,  e:ClickEventInfo)
{
	//ds_inqSend.clearData();
	//	ds_inqSend.addRow();
	if(sendmode == "single"){//단건(개별)
		//발송 전 체크
		if (fn_checkBefore(sendmode) == false) {
			return false;
		}
		//ds_inqSend.setColumn(0, "broadcast_yn", "N");//동보발송유무
	}else{//일괄(동보)
		//발송 전 체크
		if (fn_checkBefore(sendmode) == false) {
			return false;
		}
		//var nCnt = ds_list.getCaseCount("rowCheck=='1'");		
		
		//if(nCnt ==1){
			//ds_inqSend.setColumn(0, "broadcast_yn", "N");//동보발송유무
		//}else{
			//ds_inqSend.setColumn(0, "broadcast_yn", "Y");//동보발송유무
		//}
	}
	fn_send();
}

//발송전 체크
function fn_checkBefore(sendmode)
{
// 	if(gfn_isNull(TextArea_chat_msg_cntn.value)){
// 		alert("메시지 내용을 입력하세요");
// 		TextArea_chat_msg_cntn.setFocus();
// 		return false;
// 	}
	
	if(gfn_isNull(edt_cntr_rprs_tlno.value)){
		alert("발신번호를 입력하세요");
		edt_cntr_rprs_tlno.setFocus();
		return false;
	}
	
	if(chk_rightfg.value == false){//예약발송일때
		if(gfn_isNull(msk_resr_dt.value)){
			alert("예약일자를 입력하세요");
			msk_resr_dt.setFocus();
			return false;
		}
		if(gfn_isNull(cbo_resr_tm.value)){
			alert("예약시간을 입력하세요");
			cbo_resr_tm.setFocus();
			return false;
		}
	}
	
	if(sendmode == "single"){//단건
		if(gfn_isNull(edt_clph_no.value)){//수신번호
			alert("수신번호를 입력하세요");
			edt_clph_no.setFocus();
			return false;
		}
	}else{//일괄(동보)
		if(ds_list.rowcount > 0){
			var nCnt = ds_list.rowcount;		
			if(nCnt == 0){
				alert("일괄 발송할 목록을 선택하세요")
				return false;
			}
		}else{
			alert("일괄 발송할 목록을 업로드하세요")
			return false;	
		}
	}
	
	
	
	
var ls_kako="";
	if (chk_kakao.value ==true) {
		ls_kako = "알림톡";
	}else{
		ls_kako = "문자";
	}

	if (!confirm(ls_kako +" 메시지를 발송하시겠습니까?")) {
		return false;
	}
}

//닫기버튼
function btn_close_onclick(obj:Button,  e:ClickEventInfo)
{
	close();
}


function chk_kakao_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	if  (chk_kakao.value ==true)  { 
		chk_lms.value =false;
	}else {
		chk_lms.value =true;
	}
}

function chk_lms_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	if (chk_lms.value == true ) {
		chk_kakao.value = false;
	} else {
		chk_kakao.value = true;
	}
}
]]></Script>
  </Form>
</FDL>
