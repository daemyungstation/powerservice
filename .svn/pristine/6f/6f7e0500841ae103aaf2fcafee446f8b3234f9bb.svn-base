<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="DL440600" classname="frm" inheritanceid="" position="absolute 0 0 989 795" titletext="회원별매입현황(작업자용)" onload="frm_onload" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="stc_03" class="sta_workSrcBg" position2="absolute l:-32 r:9 t:7 h:42" positiontype="position2"/>
        <Tab id="tab_main" taborder="0" position2="absolute l:6 r:9 t:72 b:23" positiontype="position2" onchanged="Tab_Main_onchanged" tabindex="0" scrollbars="autoboth" style="font:Dotum,9;">
          <Tabpages>
            <Tabpage id="tab_main" text="매출입현황">
              <Layouts>
                <Layout width="987" height="671">
                  <Grid id="grd_list_t1" taborder="0" binddataset="ds_pur_list" useinputpanel="false" position2="absolute l:3 r:3 t:4 b:16" positiontype="position2" onvscrolllastover="grd_list_t1_onvscrolllastover">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="56"/>
                          <Column size="90"/>
                          <Column size="171"/>
                          <Column size="86"/>
                          <Column size="150"/>
                          <Column size="0"/>
                          <Column size="150"/>
                          <Column size="150"/>
                          <Column size="0"/>
                          <Column size="150"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="normal" text="순번"/>
                          <Cell col="1" text="기준월"/>
                          <Cell col="2" displaytype="normal" text="매입처"/>
                          <Cell col="3" displaytype="normal" text="건수"/>
                          <Cell col="4" displaytype="normal" text="매입액"/>
                          <Cell col="5" text="T1"/>
                          <Cell col="6" displaytype="normal" text="매입취소액"/>
                          <Cell col="7" displaytype="normal" text="매출액"/>
                          <Cell col="8" text="T2"/>
                          <Cell col="9" displaytype="normal" text="매출취소액"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="normal" expr="currow+1"/>
                          <Cell col="1" text="bind:pur_dt"/>
                          <Cell col="2" displaytype="normal" text="bind:pur_comp" expr="expr:gfn_isNull(pur_comp) == true ? &quot;미정의&quot; : pur_comp"/>
                          <Cell col="3" displaytype="number" style="align:right;" text="bind:pur_cnt"/>
                          <Cell col="4" displaytype="number" style="align:right;" text="bind:pur_amt"/>
                          <Cell col="5" displaytype="number" style="align:right;" text="bind:t1"/>
                          <Cell col="6" displaytype="number" style="align:right;" text="bind:pur_cnl_amt"/>
                          <Cell col="7" displaytype="number" style="align:right;" text="bind:sale_amt"/>
                          <Cell col="8" displaytype="number" style="align:right;" text="bind:t2"/>
                          <Cell col="9" displaytype="number" style="align:right;" text="bind:sale_cnl_amt"/>
                        </Band>
                        <Band id="summary" style="background:gainsboro;cellbackground:gainsboro;cellbackground2:gainsboro;">
                          <Cell text="합계"/>
                          <Cell col="1"/>
                          <Cell col="2"/>
                          <Cell col="3" expr="expr:gfn_commaStr(getSum(&quot;pur_cnt&quot;))"/>
                          <Cell col="4" displaytype="number" expr="expr:getSum(&quot;pur_amt&quot;)"/>
                          <Cell col="5" displaytype="number" expr="expr:gfn_commaStr(getSum(&quot;t1&quot;))"/>
                          <Cell col="6" displaytype="number" expr="expr:getSum(&quot;pur_cnl_amt&quot;)"/>
                          <Cell col="7" displaytype="number" expr="expr:getSum(&quot;sale_amt&quot;)"/>
                          <Cell col="8" displaytype="number" expr="expr:gfn_commaStr(getSum(&quot;t2&quot;))"/>
                          <Cell col="9" displaytype="number" expr="expr:getSum(&quot;sale_cnl_amt&quot;)"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage2" text="회원별매출입">
              <Layouts>
                <Layout>
                  <Grid id="grd_dtl" taborder="0" binddataset="ds_mem_list" useinputpanel="false" position2="absolute l:3 r:3 t:4 b:14" positiontype="position2" autoenter="select" areaselecttype="limitband" autofittype="col" autosizingtype="none" cellsizingtype="col">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="56"/>
                          <Column size="90"/>
                          <Column size="93"/>
                          <Column size="80"/>
                          <Column size="187"/>
                          <Column size="150"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="0"/>
                          <Column size="90"/>
                          <Column size="100"/>
                          <Column size="0"/>
                          <Column size="90"/>
                          <Column size="100"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="100"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="기준월"/>
                          <Cell col="2" displaytype="normal" text="회원번호"/>
                          <Cell col="3" displaytype="normal" text="이름"/>
                          <Cell col="4" displaytype="normal" text="상품명"/>
                          <Cell col="5" text="모델분류명"/>
                          <Cell col="6" text="모델명"/>
                          <Cell col="7" displaytype="normal" text="가입일"/>
                          <Cell col="8" displaytype="normal" text="가입상태"/>
                          <Cell col="9" displaytype="normal" text="해약처리"/>
                          <Cell col="10" displaytype="normal" text="실납입회차"/>
                          <Cell col="11" displaytype="normal" text="매입금액"/>
                          <Cell col="12" text="T1"/>
                          <Cell col="13" displaytype="normal" text="매입취소금액"/>
                          <Cell col="14" displaytype="normal" text="매출금액"/>
                          <Cell col="15" text="T2"/>
                          <Cell col="16" displaytype="normal" text="매출취소금액"/>
                          <Cell col="17" text="매입처"/>
                          <Cell col="18" displaytype="normal" text="제품납입금액"/>
                          <Cell col="19" displaytype="normal" text="제품잔여금액"/>
                          <Cell col="20" displaytype="normal" text="1년잔여"/>
                          <Cell col="21" displaytype="normal" text="2년잔여"/>
                          <Cell col="22" displaytype="normal" text="3년잔여"/>
                          <Cell col="23" text="장기할부여부"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" text="bind:pur_dt"/>
                          <Cell col="2" displaytype="normal" text="bind:accnt_no"/>
                          <Cell col="3" displaytype="normal" text="bind:mem_nm"/>
                          <Cell col="4" displaytype="normal" style="align:left;" text="bind:prod_nm"/>
                          <Cell col="5" style="align:left;" text="bind:model_cl_nm"/>
                          <Cell col="6" style="align:left;" text="bind:model_nm"/>
                          <Cell col="7" displaytype="normal" text="bind:join_dt" mask="####-##-##"/>
                          <Cell col="8" displaytype="normal" text="bind:kstbit"/>
                          <Cell col="9" displaytype="normal" text="bind:resn_proc_yn"/>
                          <Cell col="10" displaytype="normal" text="bind:true_cnt"/>
                          <Cell col="11" displaytype="number" edittype="expr:expr:vFinalMgCnt2 &gt; 0 ? &quot;none&quot; : &quot;masknumber&quot;" style="align:right;padding:0 4 0 4;" text="bind:pur_amt"/>
                          <Cell col="12" displaytype="number" text="bind:t1"/>
                          <Cell col="13" displaytype="number" edittype="expr:expr:vFinalMgCnt2 &gt; 0 ? &quot;none&quot; : &quot;masknumber&quot;" style="align:right;padding:0 4 0 4;" text="bind:pur_cnl_amt"/>
                          <Cell col="14" displaytype="number" edittype="expr:expr:vFinalMgCnt2 &gt; 0 ? &quot;none&quot; : &quot;masknumber&quot;" style="align:right;padding:0 4 0 4;" text="bind:sale_amt"/>
                          <Cell col="15" displaytype="number" text="bind:t2"/>
                          <Cell col="16" displaytype="number" edittype="expr:expr:vFinalMgCnt2 &gt; 0 ? &quot;none&quot; : &quot;masknumber&quot;" style="align:right;padding:0 4 0 4;" text="bind:sale_cnl_amt"/>
                          <Cell col="17" text="bind:pur_comp_nm"/>
                          <Cell col="18" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:rel_amt"/>
                          <Cell col="19" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:remain_amt"/>
                          <Cell col="20" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:1y_remain"/>
                          <Cell col="21" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:2y_remain"/>
                          <Cell col="22" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:3y_remain"/>
                          <Cell col="23" text="bind:prod_longterm_yn"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1"/>
                          <Cell col="2"/>
                          <Cell col="3"/>
                          <Cell col="4"/>
                          <Cell col="5"/>
                          <Cell col="6"/>
                          <Cell col="7"/>
                          <Cell col="8"/>
                          <Cell col="9"/>
                          <Cell col="10"/>
                          <Cell col="11" displaytype="number" style="align:right;padding:0 4 0 4;" expr="expr:getSum(&quot;pur_amt&quot;)"/>
                          <Cell col="12" expr="expr:gfn_commaStr(getSum(&quot;t1&quot;))"/>
                          <Cell col="13" displaytype="number" style="align:right;padding:0 4 0 4;" expr="expr:getSum(&quot;pur_cnl_amt&quot;)"/>
                          <Cell col="14" displaytype="number" style="align:right;padding:0 4 0 4;" expr="expr:getSum(&quot;sale_amt&quot;)"/>
                          <Cell col="15" expr="expr:gfn_commaStr(getSum(&quot;t2&quot;))"/>
                          <Cell col="16" displaytype="number" style="align:right;padding:0 4 0 4;" expr="expr:getSum(&quot;sale_cnl_amt&quot;)"/>
                          <Cell col="17"/>
                          <Cell col="18" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;rel_amt&quot;))"/>
                          <Cell col="19" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;remain_amt&quot;))"/>
                          <Cell col="20" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;1y_remain&quot;))"/>
                          <Cell col="21" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;2y_remain&quot;))"/>
                          <Cell col="22" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;3y_remain&quot;))"/>
                          <Cell col="23"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="stc_27" class="sta_workSrcBg" position2="absolute l:-857 r:857 t:-50 h:42" positiontype="position2"/>
        <Edit id="edt_cpdcTitlNm08" taborder="1" position="absolute 756 -531 889 -511"/>
        <Button id="btn_Search" taborder="2" onclick="btn_Search_onclick" class="btn_WF_Search" position2="absolute r:91 w:72 t:17 h:20" positiontype="position2" tooltiptext="조회" style="shadow:drop 0,0 0 #00000033;"/>
        <Button id="btn_Init00" taborder="3" onclick="fn_init" class="btn_WF_Return" position2="absolute r:17 w:72 t:17 h:20" positiontype="position2" tooltiptext="초기화"/>
        <Calendar id="cal_stt_dt" taborder="4" dateformat="yyyy-MM" position="absolute 74 18 145 38" value="null" editformat="yyyy-MM" type="normal" readonly="false" usecontextmenu="true" useinputpanel="true" usebitmapcache="false" transparenthittest="false" tabstop="true" autoskip="false" autoselect="true" enable="true" enableevent="false"/>
        <Static id="Static02" text="11px" visible="false" position="absolute 30 8 280 19" style="background:#ff9900ff;"/>
        <Static id="Static08" text="11px" visible="false" position="absolute 38 38 288 49" style="background:#ff9900ff;"/>
        <Static id="Static00" text="H18" visible="false" position="absolute 15 49 195 67" style="background:#ff9900ff;"/>
        <Static id="Static09" text="w25" visible="false" position="absolute 680 69 706 94" style="background:#ff9900ff;"/>
        <Static id="Static10" text="10" visible="false" position="absolute 64 16 74 32" style="background:#ff9900ff;"/>
        <Button id="btn_excel" taborder="6" text="엑셀" onclick="fn_excel" class="btn_WF" position2="absolute r:13 w:72 t:71 h:20" positiontype="position2" tooltiptext="엑셀" style="padding:0 0 0 0;"/>
        <Static id="stc_00" text="작업월" class="sta_workSrcLabel1" position="absolute 15 18 66 38"/>
        <Static id="sta_Dash00" text="~" position="absolute 1051 32 1064 47" visible="false"/>
        <Static id="stc_01" text="반품월" class="sta_workSrcLabel1" position="absolute 1366 120 1415 140" visible="false"/>
        <Calendar id="cal_bp_dt" taborder="10" dateformat="yyyy-MM" editformat="yyyy-MM" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" position="absolute 1417 120 1488 140" visible="false"/>
        <Edit id="edt_pur_comp_nm" taborder="11" onkeydown="srch_onkeydown" oneditclick="edt_srch_accnt_no_oneditclick" enable="false" position="absolute 251 17 373 37" visible="true"/>
        <Button id="btn_srchAccntNo00" taborder="12" onclick="fn_srchpurCompPop" class="btn_workSrcPop" position="absolute 374 17 394 37" visible="true"/>
        <Grid id="grd_pur_excel" taborder="13" binddataset="ds_pur_list" useinputpanel="false" oncelldblclick="fn_srchBuyDtl" position2="absolute l:11 r:9 t:804 b:-141" positiontype="position2" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="56"/>
                <Column size="171"/>
                <Column size="86"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="150"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="normal" text="순번"/>
                <Cell col="1" displaytype="normal" text="매입처"/>
                <Cell col="2" displaytype="normal" text="건수"/>
                <Cell col="3" displaytype="normal" text="매입액"/>
                <Cell col="4" displaytype="normal" text="매입취소액"/>
                <Cell col="5" displaytype="normal" text="매출액"/>
                <Cell col="6" displaytype="normal" text="매출취소액"/>
              </Band>
              <Band id="body">
                <Cell displaytype="normal" expr="currow+1"/>
                <Cell col="1" displaytype="normal" text="bind:pur_comp" expr="expr:gfn_isNull(pur_comp) == true ? &quot;미정의&quot; : pur_comp"/>
                <Cell col="2" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:pur_cnt"/>
                <Cell col="3" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:pur_amt"/>
                <Cell col="4" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:pur_cnl_amt"/>
                <Cell col="5" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:sale_amt"/>
                <Cell col="6" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:sale_cnl_amt"/>
              </Band>
              <Band id="summary" style="background:gainsboro;cellbackground:gainsboro;cellbackground2:gainsboro;">
                <Cell/>
                <Cell col="1"/>
                <Cell col="2" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;pur_cnt&quot;))"/>
                <Cell col="3" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;pur_amt&quot;))"/>
                <Cell col="4" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;pur_cnl_amt&quot;))"/>
                <Cell col="5" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;sale_amt&quot;))"/>
                <Cell col="6" style="align:right;padding:0 4 0 4;" text="expr:gfn_commaStr(getSum(&quot;parseInt(sale_cnl_amt)&quot;))"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="stc_04" text="입금일" class="sta_workSrcLabel1" position="absolute 1200 18 1251 38" visible="false"/>
        <Calendar id="cal_stt_pay" taborder="14" dateformat="yyyy-MM-dd" editformat="yyyy-MM-dd" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" position="absolute 1259 18 1352 38" value="null" visible="false"/>
        <Static id="sta_Dash01" text="~" visible="false" position="absolute 1357 22 1370 37"/>
        <Calendar id="cal_end_pay" taborder="15" dateformat="yyyy-MM-dd" editformat="yyyy-MM-dd" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" visible="false" position="absolute 1373 18 1464 38" value="null"/>
        <Static id="sta_TotalCnt" text="검색결과   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt; / 전체   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt;" usedecorate="true" class="sta_workTitle5" position2="absolute l:230 w:266 t:80 h:20" positiontype="position2" visible="false"/>
        <Grid id="grd_mem_excel" taborder="16" binddataset="ds_mem_list" useinputpanel="false" position2="absolute l:6 r:0 t:997 b:-977" positiontype="position2">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="56"/>
                <Column size="90"/>
                <Column size="93"/>
                <Column size="80"/>
                <Column size="187"/>
                <Column size="150"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="0"/>
                <Column size="90"/>
                <Column size="100"/>
                <Column size="0"/>
                <Column size="90"/>
                <Column size="100"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell text="순번"/>
                <Cell col="1" text="기준월"/>
                <Cell col="2" displaytype="normal" text="회원번호"/>
                <Cell col="3" displaytype="normal" text="이름"/>
                <Cell col="4" displaytype="normal" text="상품명"/>
                <Cell col="5" text="모델분류명"/>
                <Cell col="6" text="모델명"/>
                <Cell col="7" displaytype="normal" text="가입일"/>
                <Cell col="8" displaytype="normal" text="가입상태"/>
                <Cell col="9" displaytype="normal" text="해약처리"/>
                <Cell col="10" displaytype="normal" text="실납입회차"/>
                <Cell col="11" displaytype="normal" text="매입금액"/>
                <Cell col="12" text="T1"/>
                <Cell col="13" displaytype="normal" text="매입취소금액"/>
                <Cell col="14" displaytype="normal" text="매출금액"/>
                <Cell col="15" text="T2"/>
                <Cell col="16" displaytype="normal" text="매출취소금액"/>
                <Cell col="17" text="매입처"/>
                <Cell col="18" displaytype="normal" text="제품납입금액"/>
                <Cell col="19" displaytype="normal" text="제품잔여금액"/>
                <Cell col="20" displaytype="normal" text="1년잔여"/>
                <Cell col="21" displaytype="normal" text="2년잔여"/>
                <Cell col="22" displaytype="normal" text="3년잔여"/>
              </Band>
              <Band id="body">
                <Cell expr="currow+1"/>
                <Cell col="1" text="bind:pur_dt"/>
                <Cell col="2" displaytype="normal" text="bind:accnt_no"/>
                <Cell col="3" displaytype="normal" text="bind:mem_nm"/>
                <Cell col="4" displaytype="normal" style="align:left;" text="bind:prod_nm"/>
                <Cell col="5" style="align:left;" text="bind:model_cl_nm"/>
                <Cell col="6" style="align:left;" text="bind:model_nm"/>
                <Cell col="7" displaytype="normal" text="bind:join_dt" mask="####-##-##"/>
                <Cell col="8" displaytype="normal" text="bind:kstbit"/>
                <Cell col="9" displaytype="normal" text="bind:resn_proc_yn"/>
                <Cell col="10" displaytype="normal" text="bind:true_cnt"/>
                <Cell col="11" displaytype="number" edittype="expr:expr:vFinalMgCnt2 &gt; 0 ? &quot;none&quot; : &quot;masknumber&quot;" style="align:right;padding:0 4 0 4;" text="bind:pur_amt"/>
                <Cell col="12" displaytype="number" text="bind:t1"/>
                <Cell col="13" displaytype="number" edittype="expr:expr:vFinalMgCnt2 &gt; 0 ? &quot;none&quot; : &quot;masknumber&quot;" style="align:right;padding:0 4 0 4;" text="bind:pur_cnl_amt"/>
                <Cell col="14" displaytype="number" edittype="expr:expr:vFinalMgCnt2 &gt; 0 ? &quot;none&quot; : &quot;masknumber&quot;" style="align:right;padding:0 4 0 4;" text="bind:sale_amt"/>
                <Cell col="15" displaytype="number" text="bind:t2"/>
                <Cell col="16" displaytype="number" edittype="expr:expr:vFinalMgCnt2 &gt; 0 ? &quot;none&quot; : &quot;masknumber&quot;" style="align:right;padding:0 4 0 4;" text="bind:sale_cnl_amt"/>
                <Cell col="17" text="bind:pur_comp_nm"/>
                <Cell col="18" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:rel_amt"/>
                <Cell col="19" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:remain_amt"/>
                <Cell col="20" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:1y_remain"/>
                <Cell col="21" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:2y_remain"/>
                <Cell col="22" displaytype="number" style="align:right;padding:0 4 0 4;" text="bind:3y_remain"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1"/>
                <Cell col="2"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5"/>
                <Cell col="6"/>
                <Cell col="7"/>
                <Cell col="8"/>
                <Cell col="9"/>
                <Cell col="10"/>
                <Cell col="11" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;pur_amt&quot;))"/>
                <Cell col="12" expr="expr:gfn_commaStr(getSum(&quot;t1&quot;))"/>
                <Cell col="13" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;pur_cnl_amt&quot;))"/>
                <Cell col="14" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;sale_amt&quot;))"/>
                <Cell col="15" expr="expr:gfn_commaStr(getSum(&quot;t2&quot;))"/>
                <Cell col="16" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;sale_cnl_amt&quot;))"/>
                <Cell col="17"/>
                <Cell col="18" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;rel_amt&quot;))"/>
                <Cell col="19" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;remain_amt&quot;))"/>
                <Cell col="20" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;1y_remain&quot;))"/>
                <Cell col="21" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;2y_remain&quot;))"/>
                <Cell col="22" style="align:right;padding:0 4 0 4;" expr="expr:gfn_commaStr(getSum(&quot;3y_remain&quot;))"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_save2" taborder="17" text="1차 마감" position="absolute 1074 151 1154 171" visible="false"/>
        <Button id="btn_cancel" taborder="18" text="1차 마감취소" position="absolute 1162 151 1242 171" visible="false"/>
        <Button id="btn_update" taborder="19" text="저장" position="absolute 1250 151 1330 171" visible="false"/>
        <Button id="btn_mg" taborder="20" text="최종마감" position="absolute 490 71 570 91" onclick="btn_mg_onclick" visible="false"/>
        <Button id="btn_save" taborder="21" text="저장" position="absolute 786 71 866 91" onclick="btn_save_onclick" visible="false"/>
        <Button id="btn_delete" taborder="22" text="삭제" position="absolute 874 71 954 91" onclick="btn_delete_onclick" visible="false"/>
        <Button id="btn_insert" taborder="23" text="입력" visible="false" position="absolute 962 71 1042 91" onclick="btn_insert_onclick"/>
        <Static id="stc_05" text="회원번호" onclick="stc_31_onclick" class="sta_workSrcLabel1" position="absolute 1081 73 1138 93" visible="false"/>
        <Edit id="edt_accnt_no" taborder="24" onkeydown="edt_accnt_onkeydown" class="edt_clssEnable" enable="false" position="absolute 1150 73 1271 95" visible="false"/>
        <Button id="btn_accnt_no" taborder="25" onclick="btn_accnt_onclick" class="btn_workSrcPop" position="absolute 1276 73 1298 93" visible="false"/>
        <Static id="stc_accnt_no" text="회원번호" class="sta_workSrcLabel1" position="absolute 405 17 465 37" visible="false"/>
        <Edit id="edt_srch_accnt_no" taborder="26" inputmode="upper" inputfilter="dot,comma,sign,symbol" inputtype="numberandenglish" maxlength="12" onkeydown="srch_onkeydown" position="absolute 469 17 598 38" visible="false"/>
        <Button id="btn_accntNo" taborder="27" onclick="fn_srchAccntNoPop" class="btn_workSrcPop" position="absolute 599 17 619 37" visible="false"/>
        <Calendar id="cal_end_dt" taborder="28" autoselect="true" dateformat="yyyy-MM" editformat="yyyy-MM" enableevent="false" position="absolute 166 18 237 38" visible="false"/>
        <Calendar id="cal_end_dt_tmp" taborder="29" dateformat="yyyy-MM" editformat="yyyy-MM" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" visible="false" position="absolute 1075 28 1146 48"/>
        <Static id="sta_Dash02" text="~" visible="false" position="absolute 149 22 162 37" style="align:center middle;"/>
        <Static id="stc_Mgdt" position="absolute 490 80 765 100" visible="false" usedecorate="true" style="color:red;font:Dotum,9,bold;"/>
        <Static id="stc_02" text="매입업체" onclick="stc_31_onclick" class="sta_workSrcLabel1" position="absolute 185 17 242 37"/>
        <Static id="stc_Mgdt2" usedecorate="true" visible="false" position="absolute 490 80 765 100" style="color:red;font:Dotum,9,bold;"/>
        <Static id="stc_09" text="장기할부여부" class="sta_workSrcLabel1" position="absolute 627 16 711 36" visible="false"/>
        <Combo id="cbo_ltPur_yn" taborder="30" text="전체" codecolumn="codecolumn" datacolumn="datacolumn" index="0" position="absolute 715 16 784 36" visible="false">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">Y</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">N</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="edt_accnt_no" propid="value" datasetid="ds_accnt_info" columnid="accnt_no"/>
    </Bind>
    <Objects>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="pur_dt" type="STRING" size="256"/>
          <Column id="end_pur_dt" type="STRING" size="256"/>
          <Column id="bef_pur_dt_start" type="STRING" size="256"/>
          <Column id="bef_pur_dt_end" type="STRING" size="256"/>
          <Column id="pur_comp" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="stt_pay_dt" type="STRING" size="256"/>
          <Column id="end_pay_dt" type="STRING" size="256"/>
          <Column id="prod_longterm_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_mem_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="kstbit" type="STRING" size="256"/>
          <Column id="resn_proc_yn" type="STRING" size="256"/>
          <Column id="true_cnt" type="STRING" size="256"/>
          <Column id="pur_amt" type="BIGDECIMAL" size="256"/>
          <Column id="pur_cnl_amt" type="BIGDECIMAL" size="256"/>
          <Column id="sale_amt" type="BIGDECIMAL" size="256"/>
          <Column id="sale_cnl_amt" type="BIGDECIMAL" size="256"/>
          <Column id="rel_amt" type="BIGDECIMAL" size="256"/>
          <Column id="remain_amt" type="BIGDECIMAL" size="256"/>
          <Column id="1y_remain" type="BIGDECIMAL" size="256"/>
          <Column id="2y_remain" type="BIGDECIMAL" size="256"/>
          <Column id="3y_remain" type="BIGDECIMAL" size="256"/>
          <Column id="pur_comp" type="STRING" size="256"/>
          <Column id="pur_comp_nm" type="STRING" size="256"/>
          <Column id="pur_dt" type="STRING" size="256"/>
          <Column id="model_cl_nm" type="STRING" size="256"/>
          <Column id="model_nm" type="STRING" size="256"/>
          <Column id="delivery_dt" type="STRING" size="256"/>
          <Column id="prod_longterm_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_tmp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="pur_dt" type="STRING" size="256"/>
          <Column id="pur_cnt" type="STRING" size="256"/>
          <Column id="pur_comp" type="STRING" size="256"/>
          <Column id="pur_amt" type="STRING" size="256"/>
          <Column id="pur_cnl_amt" type="STRING" size="256"/>
          <Column id="sale_amt" type="STRING" size="256"/>
          <Column id="sale_cnl_amt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cdSet" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="6"/>
          <Column id="cd_nm" type="STRING" size="100"/>
          <Column id="adtl_cd" type="STRING" size="100"/>
          <Column id="adtl_cd_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_pur_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="pur_dt" type="STRING" size="256"/>
          <Column id="pur_comp" type="STRING" size="256"/>
          <Column id="pur_cnt" type="BIGDECIMAL" size="256"/>
          <Column id="pur_amt" type="BIGDECIMAL" size="256"/>
          <Column id="pur_cnl_amt" type="BIGDECIMAL" size="256"/>
          <Column id="sale_amt" type="BIGDECIMAL" size="256"/>
          <Column id="sale_cnl_amt" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_mem_tmp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="kstbit" type="STRING" size="256"/>
          <Column id="resn_proc_yn" type="STRING" size="256"/>
          <Column id="true_cnt" type="STRING" size="256"/>
          <Column id="pur_amt" type="BIGDECIMAL" size="256"/>
          <Column id="pur_cnl_amt" type="BIGDECIMAL" size="256"/>
          <Column id="sale_amt" type="BIGDECIMAL" size="256"/>
          <Column id="sale_cnl_amt" type="BIGDECIMAL" size="256"/>
          <Column id="rel_amt" type="BIGDECIMAL" size="256"/>
          <Column id="remain_amt" type="BIGDECIMAL" size="256"/>
          <Column id="1y_remain" type="BIGDECIMAL" size="256"/>
          <Column id="2y_remain" type="BIGDECIMAL" size="256"/>
          <Column id="3y_remain" type="BIGDECIMAL" size="256"/>
          <Column id="pur_comp" type="STRING" size="256"/>
          <Column id="pur_dt" type="STRING" size="256"/>
          <Column id="prod_longterm_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_magam" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="pur_dt" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="pur_comp" type="STRING" size="256"/>
          <Column id="pur_amt" type="STRING" size="256"/>
          <Column id="pur_cnl_amt" type="STRING" size="256"/>
          <Column id="sale_amt" type="STRING" size="256"/>
          <Column id="sale_cnl_amt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt00" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="dlv_type_cd" type="STRING" size="256"/>
          <Column id="dlv_stat_cd" type="STRING" size="256"/>
          <Column id="dsps_mthd_cd" type="STRING" size="256"/>
          <Column id="dlv_no" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
          <Column id="stt_dt" type="STRING" size="256"/>
          <Column id="end_dt" type="STRING" size="256"/>
          <Column id="b2bcd" type="STRING" size="256"/>
          <Column id="stt_pay_dt" type="STRING" size="256"/>
          <Column id="end_pay_dt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_mem_list_del" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="kstbit" type="STRING" size="256"/>
          <Column id="resn_proc_yn" type="STRING" size="256"/>
          <Column id="true_cnt" type="STRING" size="256"/>
          <Column id="pur_amt" type="BIGDECIMAL" size="256"/>
          <Column id="pur_cnl_amt" type="BIGDECIMAL" size="256"/>
          <Column id="sale_amt" type="BIGDECIMAL" size="256"/>
          <Column id="sale_cnl_amt" type="BIGDECIMAL" size="256"/>
          <Column id="rel_amt" type="BIGDECIMAL" size="256"/>
          <Column id="remain_amt" type="BIGDECIMAL" size="256"/>
          <Column id="1y_remain" type="BIGDECIMAL" size="256"/>
          <Column id="2y_remain" type="BIGDECIMAL" size="256"/>
          <Column id="3y_remain" type="BIGDECIMAL" size="256"/>
          <Column id="pur_comp" type="STRING" size="256"/>
          <Column id="pur_dt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_accnt_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="page_indx" type="STRING" size="6"/>
          <Column id="accnt_no" type="STRING" size="100"/>
          <Column id="mem_no" type="STRING" size="100"/>
          <Column id="mem_nm" type="STRING" size="100"/>
          <Column id="home_tel" type="STRING" size="100"/>
          <Column id="cell" type="STRING" size="100"/>
          <Column id="wrpl_tel" type="STRING" size="100"/>
          <Column id="idn_no" type="STRING" size="100"/>
          <Column id="prod_cd" type="STRING" size="100"/>
          <Column id="prod_nm" type="STRING" size="100"/>
          <Column id="prod_amt" type="STRING" size="100"/>
          <Column id="mon_pay_amt" type="STRING" size="100"/>
          <Column id="expr_no" type="STRING" size="100"/>
          <Column id="emple_no" type="STRING" size="100"/>
          <Column id="emple_nm" type="STRING" size="100"/>
          <Column id="appfm_no" type="STRING" size="100"/>
          <Column id="join_dt" type="STRING" size="100"/>
          <Column id="compt_dt" type="STRING" size="100"/>
          <Column id="bef_emple_cd" type="STRING" size="100"/>
          <Column id="pay_perd" type="STRING" size="100"/>
          <Column id="pay_mthd" type="STRING" size="100"/>
          <Column id="join_prod" type="STRING" size="100"/>
          <Column id="new_chan_gunsu" type="STRING" size="100"/>
          <Column id="certf_rcv_chk" type="STRING" size="100"/>
          <Column id="pay_stat_1no" type="STRING" size="100"/>
          <Column id="ichae_dt" type="STRING" size="100"/>
          <Column id="bank_accnt_no" type="STRING" size="100"/>
          <Column id="old_mid" type="STRING" size="100"/>
          <Column id="reg_dm" type="STRING" size="100"/>
          <Column id="reg_man" type="STRING" size="100"/>
          <Column id="upd_dm" type="STRING" size="100"/>
          <Column id="upd_man" type="STRING" size="100"/>
          <Column id="accnt_stat" type="STRING" size="100"/>
          <Column id="total_pay" type="STRING" size="100"/>
          <Column id="last_no" type="STRING" size="100"/>
          <Column id="real_pay_no" type="STRING" size="100"/>
          <Column id="ded_no" type="STRING" size="100"/>
          <Column id="join_cl" type="STRING" size="100"/>
          <Column id="trans_gubun" type="STRING" size="100"/>
          <Column id="brth_mon_day" type="STRING" size="100"/>
          <Column id="pay_mthd" type="STRING" size="100"/>
          <Column id="emp_cell" type="STRING" size="100"/>
          <Column id="join_stat" type="STRING" size="100"/>
          <Column id="pay_stat" type="STRING" size="100"/>
          <Column id="pay_no" type="STRING" size="100"/>
          <Column id="pay_allt_no" type="STRING" size="100"/>
          <Column id="pay_add_no" type="STRING" size="100"/>
          <Column id="pay_amt" type="STRING" size="100"/>
          <Column id="pay_allt_amt" type="STRING" size="100"/>
          <Column id="pay_add_amt" type="STRING" size="100"/>
          <Column id="model_cl_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*********************************************
 * 화면명 : 회원별 매입현황
 * 작성자 : 임동진
 * 작성일 : 2018.05.11 
 * 변경이력 : 
 * ASIS      : MontrRptAnalysisList.mxml
*/

/********************************************************************************************/
/* 1. Include Library include, variables Declaration 영역                                  */
/********************************************************************************************/
include "LIB::lib_All.xjs";

var tc_log = 0; // ds_mem_list 페이징 관련 전체데이터 건수

//권한
var rgsnYn; 				//등록권한
var inqYn; 					//조회권한
var amntYn; 				//수정권한
var dltnYn; 				//삭제권한
var pritYn; 				//출력권한
var xlsYn; 					//엑셀권한
var athrPpupYn; 			//팝업오픈권한
var xlsRrnoYn; 				//엑셀 개인정보 권한 여부 
var gv_pur_comp_cd = "";    //매입처 코드

var fv_a_cnt = "";
var fv_searchCallback = null;

var vGubun = ""; // 조회구분 (** 기초데이터 조회 또는 중간데이터 조회 )
var saveGb; // 저장구분 ( 입력 또는 수정 )
var vFinalMgCnt = 0; // 최종마감 건수
var vFinalMgCnt2 = 0; // 최종마감 건수
var vFinalMgDt; // 최종마감일

/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리                                           	*/
/********************************************************************************************/
function frm_onload(obj:Form, e:LoadEventInfo)
{
	gfn_createPagingDataset(obj); 		// 페이징처리 위한 데이터셋 설정
	gfn_getList("dlwCd","02","fn_callBack",false);   // 대명코드조회		
	fn_init(); // 검색부 초기화
}


/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
function fn_callBack(svcid, errcd, errmsg) 
{
	if (errcd != 0) {
	    switch (svcid) {
	        // 공통
  			case "selectDlwCode":
				alert("코드 적재를 실패하였습니다.");
			break;
	    }
		return false;
	} 
	
	switch (svcid) {
		// 공통
		case "dlwCd": // 공통코드 조회 callBack Service ID
		break;
		
		// (탭 1) 매출입현황 조회
		case "searchBuyList":
			ds_pur_list.deleteAll();
			gfn_appendSearchDs(ds_pur_list, ds_list_tmp); // 조회된 결과를 실제보여줄 데이타셋으로 Append처리			
			if(ds_pur_list.rowcount < 1) {
				alert("조회된 자료가 없습니다.");
				ds_pur_list.clearData();
			}
			
			// 최종마감처리가 됐으면 최종마감일 표시
			if(vFinalMgCnt > 0) {
				if(!gfn_isEmpty(vFinalMgDt)) {
					stc_Mgdt.text = vFinalMgDt.substr(0,4) + "년 " + vFinalMgDt.substr(4,2) + "월 " + vFinalMgDt.substr(6,2) + "일에 최종마감 되었습니다.";
					stc_Mgdt.visible = true;
				} else {
					stc_Mgdt.visible = false;
				}
			} 
			else {
				stc_Mgdt.text = "";
			}
			
		break;
		
		// (탭 2) 회원별매출입 조회
		case "searchMemList": 
			ds_mem_list.deleteAll();
			gfn_appendSearchDs(ds_mem_list, ds_mem_tmp); // 조회된 결과를 실제보여줄 데이타셋으로 Append처리
			gfn_setTotalRowCount(ds_mem_list, sta_TotalCnt, tc_log); // 페이지건수 표출
			
			//trace("vFinalMgCnt2 : " + vFinalMgCnt2);
			
			// 최종마감처리가 되면 다른 작업 못하도록 버튼 숨김
			if(vFinalMgCnt2 > 0) {
				btn_mg.visible = false;
				btn_save.visible = false;
				btn_delete.visible = false;
				btn_insert.visible = false;
				
				// 최종마감일 표시
				if(!gfn_isEmpty(vFinalMgDt)) {
					stc_Mgdt2.text = vFinalMgDt.substr(0,4) + "년 " + vFinalMgDt.substr(4,2) + "월 " + vFinalMgDt.substr(6,2) + "일에 최종마감 되었습니다.";
					stc_Mgdt2.visible = true;
				} else {
					stc_Mgdt2.visible = false;
				}
				
			} else if(vGubun == "basic_data"){ // 기본 데이터 조회시 저장작업 가능
			
			    alert("매입매출 기초 자료에 통해 데이터를 생성합니다.");
				
				// 기본 데이터 조회건이 있을 경우 저장버튼 VISIBLE
				if(ds_mem_list.rowcount > 0) btn_save.visible = true;
				
				btn_mg.visible = false;
				btn_delete.visible = false;
				btn_insert.visible = false;
				btn_save.text = "저장";
				stc_Mgdt2.text = "";
				
			} else if(vGubun == "middle_data"){ // 1차 저장데이터 조회시 수정(저장) 및 삭제, 최종마감처리 가능
				btn_mg.visible = true;
				btn_save.visible = true;
				btn_delete.visible = true;
				btn_insert.visible = true;
				btn_save.text = "수정";
				stc_Mgdt2.text = "";
			}
			
			if(ds_mem_list.rowcount < 1) {
				alert("조회된 자료가 없습니다.");
				ds_mem_list.clearData();
			}
			
		break;
		
		case "saveAccntPurSale": // 1차 저장
			alert("저장되었습니다.");
			
			// 처음 저장시에만 재조회
			if(saveGb == "INSERT") fn_commSearch(gfn_getCommTypeInit(), 'srchCustBasi'); // 재조회
		break;
		
		case "saveAccntPurSaleMg": // 마감
			alert("최종마감 되었습니다.");
			fn_commSearch(gfn_getCommTypeInit(), 'srchCustBasi'); // 재조회
		break;
		
		case "srchCntAccntPurSaleMg": // 마감카운트 체크
			//alert("mListCnt : " + mListCnt);
		break;
		
		case "updateAccntPurSale": // 최종마감 전 매입 또는 매출금 수정
			alert("수정되었습니다.");
		break;
		
		case "deleteAccntPurSale": // 삭제처리
			alert("삭제되었습니다.");
			fn_commSearch(gfn_getCommTypeInit(), 'srchCustBasi'); // 재조회
		break;
		

	}
}

/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)                                                   	*/
/********************************************************************************************/
//조회전 처리 조회조건셋팅
function fn_preSearch()
{
	ds_inqCndt.clearData();
	ds_inqCndt.addRow();
	
	var vMonth = cal_stt_dt.value; // 작업월(시작)
	ds_inqCndt.setColumn(0, "pur_dt", vMonth);
	
	var vMonth2 = gfn_addMonth(vMonth, 0);  // 작업월(종료)
	ds_inqCndt.setColumn(0, "end_pur_dt", gfn_getLastDay(vMonth2.substr(0,6)));
	
	// 조회조건 체크
	if(gfn_isNull(vMonth)) {
		alert("작업월을 입력하십시요");
		cal_stt_dt.setFocus();
		return;
	}
	
	/*
	if(vMonth2 =="" || vMonth2 == null){
		alert("종료기준월을 입력하십시요");
		cal_end_dt.setFocus();
		return;
	}
	
	if(vMonth > vMonth2) {
		alert("시작기준월이 종료기준월보다 더 큽니다.");
		cal_stt_dt.setFocus();
		return;
	}
	*/
	
	// 전월조건 구하기
	var vMonth3 = gfn_addMonth(vMonth, -1);  // 기준월의 전월 첫 날짜
	var vMonth4 = gfn_getLastDay(vMonth3.substr(0,6)); // 기준월의 전월 마지막 날짜
	ds_inqCndt.setColumn(0, "bef_pur_dt_start", vMonth3);
	ds_inqCndt.setColumn(0, "bef_pur_dt_end", vMonth4);
	
	//trace("gv_pur_comp_cd : " + gv_pur_comp_cd);
	// 매입업체 조건
	ds_inqCndt.setColumn(0, "pur_comp", gv_pur_comp_cd);
	
	// 회원번호 조건
	ds_inqCndt.setColumn(0, "accnt_no", edt_srch_accnt_no.value);
	
	// 입금일 조건
	ds_inqCndt.setColumn(0, "stt_pay_dt", cal_stt_pay.value);
	ds_inqCndt.setColumn(0, "end_pay_dt", cal_end_pay.value);
	
	// 회원번호 조건
	ds_inqCndt.setColumn(0, "prod_longterm_yn", cbo_ltPur_yn.value);
	
	
	if (tab_main.tabindex == 0) ds_pur_list.clearData();
	else if (tab_main.tabindex == 1) ds_mem_list.clearData();
	
	return true;
}

//조회
function fn_commSearch(sType, searchInfo)
{	
	// 호출 건수 설정 및 조회여부 설정
	if ( !fn_preSearch() ) {
		return;
	}
		
	if (tab_main.tabindex == 0) {
		var szSvcid       = "searchBuyList";    
		var szController  = "/dlw/resn/accpur-list"; // 매출입현황
		var szInDs        = "ds_input=ds_inqCndt";
		var szOutDs       = "ds_list_tmp=ds_output";
		var szParam       = "";
		var szRetCallback = "fn_callBack";
	} else if(tab_main.tabindex == 1){	
	    //if(!gfn_pageSearch(sType, ds_mem_list, sta_TotalCnt, 500, tc_log)) return;
	    
		var szSvcid       = "searchMemList";    
		var szController  = "/dlw/resn/mem-list"; // 회원별매출입 조회
		var szInDs        = "ds_input=ds_inqCndt";
		var szOutDs       = "ds_mem_tmp=ds_output";
		var szParam       = "";
		var szRetCallback = "fn_callBack";
	}
		
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback, false);
}

/********************************************************************************************/
/**   6. 사용자 함수                                                                   	*/
/********************************************************************************************/
//초기화
function fn_init()
{
	var objDate = new Date();	
	strMonth = objDate.toFormatString("%Y%m");
	endMonth = objDate.toFormatString("%Y%m");
		
	cal_stt_dt.value = strMonth;
	cal_end_dt.value = endMonth;
	
	cal_bp_dt.value = "";
	
	gv_pur_comp_cd = "";
	edt_pur_comp_nm.value = "";
	cal_stt_pay.value = "";
	cal_end_pay.value = "";
	edt_srch_accnt_no.value = "";
}

/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
//조회 버튼 이벤트
function btn_Search_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_commSearch(gfn_getCommTypeInit(), 'srchCustBasi'); // 조회
}

// 그리드 헤더 클릭
function grd_onheadclick(obj:Grid, e:GridClickEventInfo)
{ 
	gfn_grdHeadClick(obj, e);
}

/********************************************************************************************/
/**   8. 팝업 관련 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
// 매입상세현황 팝업
function fn_srchBuyDtl()
{
	var row = 0;
	
	var stt_dt = gfn_getCalVal(cal_stt_dt);
	var end_dt = gfn_getCalVal(cal_end_dt);
	var bp_dt = gfn_getCalVal(cal_bp_dt);
	
	stt_dt = stt_dt.substring(0,6);
	end_dt = end_dt.substring(0,6);
	bp_dt = bp_dt.substring(0,6);
	
	row = ds_mem_list.rowposition;
	
	var b2bCd = ds_mem_list.getColumn(row, "b2bcompcd");
	var b2bNm = ds_mem_list.getColumn(row, "b2bcompnm");

	var sPrmr = {p_stt_dt:stt_dt, p_end_dt:end_dt, p_bp_dt:bp_dt, p_b2b_cd:b2bCd, p_b2b_nm:b2bNm};
	var reVal = gfn_diaLog("매입현황상세조회", -1, -1, -1, -1, "DL440000::DL440501.xfdl", false, sPrmr, true, false, true, null, null, true);
}

// 매입처 팝업
function fn_srchpurCompPop()
{
	var sPrmr = {p_com_nm:"", p_srch_vl:"pur"};
	var reVal = gfn_diaLog("매입처 조회", -1, -1, -1, -1, "PS990000::PS993402.xfdl", false, sPrmr, true, false, true, null, null, true);
}

// 권한에 따른 버튼 설정
function fn_setAthrPgmBtn()
{
	gfn_athrPgm(gfn_gdsCd_admin());
	
	if (rgsnYn == "N") {
		btn_save.visible = false;
	}
	if (inqYn == "N") {
		btn_Search.visible = false;
	}
	if (xlsYn == "N") {
		btn_excel.visible = false;
	}
}

function fn_excel(obj:Button,  e:ClickEventInfo)
{
	if (tab_main.tabindex == 0) {
		if (ds_pur_list.rowcount > 0) {
			gfn_exportGridToExcel(grd_pur_excel, "매입처별 매입매출현황_"+gfn_getTodayFull()+"");
		} else {
			alert("엑셀다운로드 할 항목이 없습니다.");
		}
	}
	else{
		if (ds_mem_list.rowcount > 0) {
			gfn_exportGridToExcel(grd_mem_excel, "회원별 매입매출현황_"+gfn_getTodayFull()+"");
		} else {
			alert("엑셀다운로드 할 항목이 없습니다.");
		}
	}
}

function Tab_Main_onchanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	// (탭 1) 매출입현황
	if(obj.tabindex == "0"){
		sta_TotalCnt.visible = false;
		stc_accnt_no.visible = false;
		edt_srch_accnt_no.visible = false;
		btn_accntNo.visible = false;
		btn_mg.visible = false;
		btn_save.visible = false;
		btn_delete.visible = false;
		btn_insert.visible = false;
		stc_Mgdt.visible = true;
		stc_Mgdt2.visible = false;
		
		stc_09.visible = false;
		cbo_ltPur_yn.visible = false;
	}
	
	// (탭 2) 회원별매출입
	else if(obj.tabindex == "1"){
	
		// 회원번호 조회조건 및 검색결과 건수 VISIBLE
		sta_TotalCnt.visible = true;
		stc_accnt_no.visible = true;
		edt_srch_accnt_no.visible = true;
		btn_accntNo.visible = true;
		stc_Mgdt.visible = false;
		stc_Mgdt2.visible = true;
		
		stc_09.visible = true;
		cbo_ltPur_yn.visible = true;
		
		// 기초 데이터 생성시 저장버튼만 VISIBLE
		//if(vGubun == "basic_data") {
		// 회원별매출입 탭으로 변경시 최종마감데이터가 있어도 저장버튼 보여지는 것 수정 - 2018.08.21
		if(vFinalMgCnt2 == 0 && vGubun == "basic_data") {
			btn_save.visible = true;
		}
		
		// 최종마감 전에는 데이터 조작 및 최종마감처리 가능
		if(vFinalMgCnt2 == 0 && vGubun == "middle_data") {
			btn_mg.visible = true;
			btn_save.visible = true;
			btn_delete.visible = true;
			btn_insert.visible = true;
		}
	} 
}

// 기초 데이터 입력 또는 
// 중간마감 데이터 수정   (** 매입(취소)금액 또는 매출(취소)금액 수정가능) 
function btn_save_onclick(obj:Button,  e:ClickEventInfo)
{
	var szSvcid       = "saveAccntPurSale";    
	var szController  = "/dlw/resn/accnt_pursale_save"; // 저장
	
	var szInDs;
	if (vGubun == "basic_data") 
		szInDs        = "ds_input=ds_mem_list";
	else 
		szInDs        = "ds_input=ds_mem_list:U";
		
	var szOutDs       = "";
	var szParam       = "vGubun=" + vGubun;
	var szRetCallback = "fn_callBack";
	
	// 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback, false);
}


// 최종마감처리
function btn_mg_onclick(obj:Button,  e:ClickEventInfo)
{
	if(!confirm("최종마감처리 하겠습니까?")) return false;

	var szSvcid       = "saveAccntPurSaleMg";    
	var szController  = "/dlw/resn/accnt_pursale_mg_save"; // 최종마감
	var szInDs        = "ds_input=ds_inqCndt";
	var szOutDs       = "";
	var szParam       = "";
	var szRetCallback = "fn_callBack";
	
	// 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback, false);
}


// 해당 데이터 삭제
function btn_delete_onclick(obj:Button,  e:ClickEventInfo)
{
	var delAccntNo = ds_mem_list.getColumn(ds_mem_list.rowposition, "accnt_no");
	var delMemNm = ds_mem_list.getColumn(ds_mem_list.rowposition, "mem_nm");

	if(!confirm("해당 회원 : " + delAccntNo + " / " + delMemNm + " 을 삭제하시겠습니까?")) return false;
	
	ds_mem_list_del.clearData();
	ds_mem_list_del.addRow();
	ds_mem_list_del.copyRow(0, ds_mem_list, ds_mem_list.rowposition);
	
	var szSvcid       = "deleteAccntPurSale";    
	var szController  = "/dlw/resn/accnt_pursale_delete"; // 삭제처리 (del_fg = 'Y' UPDATE)
	var szInDs        = "ds_input=ds_mem_list_del";
	var szOutDs       = "";
	var szParam       = "";
	var szRetCallback = "fn_callBack";
	
	// 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback, false);
}


// 수동 입력
function btn_insert_onclick(obj:Button,  e:ClickEventInfo)
{
	if(gfn_isNull(cal_stt_dt.value)) {
		alert("기준월을 입력하세요.");
		cal_stt_dt.setFocus();
		return false;
	}
	
	// 전월 구하기
	var vBaseMonth = gfn_addMonth(cal_stt_dt.value, -1); 
	
	//var sPrmr = {p_stt_dt:cal_stt_dt.value};
	var sPrmr = {p_stt_dt:vBaseMonth};
	var reVal = gfn_diaLog("회원 매입매출가 등록", -1, -1, -1, -1, "DL440000::DL440600P01.xfdl", false, sPrmr, true, false, true, null, null, true);
}


// 회원조회 팝업
function fn_srchAccntNoPop()
{
	var sSrchTyp = "mem_nm";
	if (!gfn_isNull(edt_srch_accnt_no.value)) {
		sSrchTyp = "accnt_no";
	}
	
	var sPrmr = {p_srch_typ:sSrchTyp, p_srch_vl:edt_srch_accnt_no.value, p_gubun_mode:"", p_option:""};
	var reVal = gfn_diaLog("회원조회", -1, -1, -1, -1, "PS990000::PS992400.xfdl", false, sPrmr, true, false, true, null, null, true);
}


function fn_setAccntNo()
{
	//trace("==================회원번호 조회");
	edt_srch_accnt_no.value = ds_accnt_info.getColumn(0, "accnt_no");
}


// onkeydown
function srch_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13) { // 엔터
		if (obj.name == "edt_srch_accnt_no") {
			fn_srchAccntNoPop();
		}
	}
}
]]></Script>
  </Form>
</FDL>
