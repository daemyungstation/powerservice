<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="N112737" classname="N112737" inheritanceid="" position="absolute 0 0 1024 768" titletext="New Form">
    <Layouts>
      <Layout>
        <Grid id="Grid00" taborder="0" useinputpanel="false" position="absolute 16 13 522 344" binddataset="Dataset00" formats="&lt;Formats&gt;&#10;  &lt;Format id=&quot;default&quot;&gt;&#10;    &lt;Columns&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;    &lt;/Columns&gt;&#10;    &lt;Rows&gt;&#10;      &lt;Row band=&quot;head&quot; size=&quot;24&quot;/&gt;&#10;      &lt;Row band=&quot;body&quot; size=&quot;24&quot;/&gt;&#10;    &lt;/Rows&gt;&#10;    &lt;Band id=&quot;head&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;AA&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;BB&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;CC&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;DD&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;EE&quot;/&gt;&#10;    &lt;/Band&gt;&#10;    &lt;Band id=&quot;body&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;bind:AA&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;bind:BB&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;bind:CC&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;bind:DD&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;bind:EE&quot;/&gt;&#10;    &lt;/Band&gt;&#10;  &lt;/Format&gt;&#10;&lt;/Formats&gt;&#10;" onheadclick="Grid00_onheadclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="AA"/>
                <Cell col="1" text="BB"/>
                <Cell col="2" text="CC"/>
                <Cell col="3" text="DD"/>
                <Cell col="4" text="EE"/>
              </Band>
              <Band id="body">
                <Cell style="background:EXPR(getRowLevel(currow)==1?&quot;yellow&quot;:getRowLevel(currow)==2?&quot;pink&quot;:&quot;&quot;);background2:EXPR(getRowLevel(currow)==1?&quot;yellow&quot;:getRowLevel(currow)==2?&quot;pink&quot;:&quot;&quot;);" text="bind:AA" subsumtext="expr:getRowLevel(currow)==1?&quot;소계&quot;:&quot;합계&quot;" suppress="1" suppressalign="middle,over"/>
                <Cell col="1" style="background:EXPR(getRowLevel(currow)==1?&quot;yellow&quot;:getRowLevel(currow)==2?&quot;pink&quot;:&quot;&quot;);background2:EXPR(getRowLevel(currow)==1?&quot;yellow&quot;:getRowLevel(currow)==2?&quot;pink&quot;:&quot;&quot;);" text="bind:BB"/>
                <Cell col="2" style="background:EXPR(getRowLevel(currow)==1?&quot;yellow&quot;:getRowLevel(currow)==2?&quot;pink&quot;:&quot;&quot;);background2:EXPR(getRowLevel(currow)==1?&quot;yellow&quot;:getRowLevel(currow)==2?&quot;pink&quot;:&quot;&quot;);" text="bind:CC"/>
                <Cell col="3" style="background:EXPR(getRowLevel(currow)==1?&quot;yellow&quot;:getRowLevel(currow)==2?&quot;pink&quot;:&quot;&quot;);background2:EXPR(getRowLevel(currow)==1?&quot;yellow&quot;:getRowLevel(currow)==2?&quot;pink&quot;:&quot;&quot;);" text="bind:DD"/>
                <Cell col="4" style="background:EXPR(getRowLevel(currow)==1?&quot;yellow&quot;:getRowLevel(currow)==2?&quot;pink&quot;:&quot;&quot;);background2:EXPR(getRowLevel(currow)==1?&quot;yellow&quot;:getRowLevel(currow)==2?&quot;pink&quot;:&quot;&quot;);" text="bind:EE"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="Dataset00" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" keystring="G:FF,AA">
        <ColumnInfo>
          <Column id="AA" type="STRING" size="256"/>
          <Column id="BB" type="STRING" size="256"/>
          <Column id="CC" type="INT" size="256"/>
          <Column id="DD" type="INT" size="256"/>
          <Column id="EE" type="INT" size="256"/>
          <Column id="FF" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="AA">가</Col>
            <Col id="BB">b</Col>
            <Col id="CC">1</Col>
            <Col id="DD">5</Col>
            <Col id="EE">1</Col>
            <Col id="FF">A</Col>
          </Row>
          <Row>
            <Col id="AA">가</Col>
            <Col id="BB">b</Col>
            <Col id="CC">20</Col>
            <Col id="DD">0</Col>
            <Col id="EE">2</Col>
            <Col id="FF">A</Col>
          </Row>
          <Row>
            <Col id="AA">가</Col>
            <Col id="BB">b</Col>
            <Col id="CC">12</Col>
            <Col id="DD">1</Col>
            <Col id="EE">3</Col>
            <Col id="FF">A</Col>
          </Row>
          <Row>
            <Col id="AA">나</Col>
            <Col id="BB">b</Col>
            <Col id="CC">4</Col>
            <Col id="DD">4</Col>
            <Col id="EE">1</Col>
            <Col id="FF">A</Col>
          </Row>
          <Row>
            <Col id="FF">A</Col>
            <Col id="BB">b</Col>
            <Col id="AA">나</Col>
            <Col id="CC">42</Col>
            <Col id="DD">2</Col>
            <Col id="EE">4</Col>
          </Row>
          <Row>
            <Col id="FF">A</Col>
            <Col id="BB">b</Col>
            <Col id="AA">나</Col>
            <Col id="CC">1</Col>
            <Col id="DD">1</Col>
            <Col id="EE">3</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[function Grid00_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	gf_GridSort(obj,e);
}


/*******************************************************************************
 * 그리드의 Sort를 처리한다.
 * 			// e.col : 바인드된 컬럼.
 * 			// e.cell : band가 가지고 있는 셀..
 * parameter : object Grid / GridClickEventInfo e
 * return None
******************************************************************************/ 
var strGroupKey;
var CONST_ASC_MARK = "↑";
var CONST_DESC_MARK = "↓";
var CONST_SORT_FLAG = false;
function gf_GridSort(obj:Grid, e:GridClickEventInfo)
{
	// 컬럼의 정렬방식을 'head'의 text에 "↑,↓"여부로 판단.
	// 이미지로 대체 가능.
	
	
	var bindDs = eval(obj.binddataset);
	if (bindDs.rowcount == 0) return false;
	
	var CONST_SORT_MARK = "";
	var BodyColId = (obj.getCellProperty("body", e.col,"text")).toString().split(":");	// e.col : 바인드된 컬럼.
	
	//Dataset00.keystring = "";																			
	for (var i = 0; i < obj.getCellCount("head"); i++) {
		if(obj.getCellText(-1, i)=="undefined")
			continue;
		
		var strHeadText = obj.getCellText(-1, i);	
		
		if(i==e.cell){
			//trace("		Event["+e.cell+"]="+obj.getCellText(-1, e.cell));	
			if (strHeadText.substr(strHeadText.length-1) == CONST_ASC_MARK) {
				obj.setCellProperty( "head", i, "text", strHeadText.substr(0, strHeadText.length - 1)+CONST_DESC_MARK);
				bindDs.keystring = "S:-"+BodyColId[1];
			}
			else if (strHeadText.substr(strHeadText.length-1) == CONST_DESC_MARK) {
				obj.setCellProperty( "head", i, "text", strHeadText.substr(0, strHeadText.length - 1)+CONST_ASC_MARK);
				bindDs.keystring = "S:+"+BodyColId[1];
			}
			else {
				obj.setCellProperty( "head", i, "text", strHeadText+CONST_ASC_MARK);
				bindDs.keystring = "S:+"+BodyColId[1];
			}
		}
		else	// 정렬표시 삭제
		{
			if (strHeadText.substr(strHeadText.length-1) == CONST_ASC_MARK || strHeadText.substr(strHeadText.length-1) == CONST_DESC_MARK) {
				obj.setCellProperty( "head", i, "text", strHeadText.substr(0, strHeadText.length - 1));
			}
		}
	}
		//trace(bindDs.keystring);
		//Dataset00.updateSortGroup("G:FF,AA");
		bindDs.keystring = "G:FF,AA,"+bindDs.keystring;
		trace(bindDs.keystring);
}
]]></Script>
  </Form>
</FDL>
