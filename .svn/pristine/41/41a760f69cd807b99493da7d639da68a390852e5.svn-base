<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="grid_calendar" classname="sample_grid_calendar" inheritanceid="" position="absolute 0 0 1036 600" titletext="스케줄 조회(달력형)" onload="grid_calendar_onload" style="font:arial,11;" scrollbars="autoboth">
    <Layouts>
      <Layout>
        <Div id="div_moreLinkBoard" taborder="1" position2="absolute l:849 w:19 t:547 h:20" positiontype="position2" style="border:2px solid #b8b8b8ff ;bordertype:round 8 8 ;font:나눔고딕,9,bold antialias;" scrollbars="none" visible="false"/>
        <Grid id="grd_calendar" taborder="7" binddataset="ds_calendar" useinputpanel="false" selecttype="cell" autofittype="col" onheadclick="Grid_calendar_onheadclick" oncellclick="Grid_calendar_oncellclick" onsize="Grid_calendar_onsize" scrollbars="autoboth" position2="absolute l:0 r:0 t:32 h:564" positiontype="position2" useselcolor="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="32"/>
                <Column size="116"/>
                <Column size="32"/>
                <Column size="116"/>
                <Column size="32"/>
                <Column size="116"/>
                <Column size="32"/>
                <Column size="116"/>
                <Column size="32"/>
                <Column size="116"/>
                <Column size="32"/>
                <Column size="116"/>
                <Column size="32"/>
                <Column size="116"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="85"/>
              </Rows>
              <Band id="head">
                <Cell colspan="2" displaytype="normal" style="cursor:hand;" text="◀"/>
                <Cell col="2" colspan="10" style="font:굴림,10,bold;"/>
                <Cell col="12" colspan="2" style="cursor:hand;" text="▶"/>
                <Cell row="1" colspan="2" style="background:#efefefff;background2:#efefef;color:#ed4105ff;font:굴림,8,bold;" text="일"/>
                <Cell row="1" col="2" colspan="2" style="background:#efefefff;background2:#efefef;font:굴림,8,bold;" text="월"/>
                <Cell row="1" col="4" colspan="2" style="background:#efefefff;background2:#efefef;font:굴림,8,bold;" text="화"/>
                <Cell row="1" col="6" colspan="2" style="background:#efefefff;background2:#efefef;font:굴림,8,bold;" text="수"/>
                <Cell row="1" col="8" colspan="2" style="background:#efefefff;background2:#efefef;font:굴림,8,bold;" text="목"/>
                <Cell row="1" col="10" colspan="2" style="background:#efefefff;background2:#efefef;font:굴림,8,bold;" text="금"/>
                <Cell row="1" col="12" colspan="2" style="background:#efefefff;background2:#efefef;color:#61acd3ff;font:굴림,8,bold;" text="토"/>
              </Band>
              <Band id="body">
                <Cell style="align:top;background:EXPR(grid_today_expr(day0));background2:EXPR(grid_today_expr(day0));color:#ed4105ff;color2:#ed4105ff;font:tahoma,8,bold;" class="noborder" text="bind:day0"/>
                <Cell col="1" style="align:left top;padding:3 0 3 0;background:EXPR(grid_today_expr(day0));background2:EXPR(grid_today_expr(day0));font:돋움,8;" text="bind:hol0"/>
                <Cell col="2" style="align:top;linetype:nocross;background:EXPR(grid_today_expr(day1));background2:EXPR(grid_today_expr(day1));color:EXPR(hol1 != null ? 'red' : '');color2:EXPR(hol1 != null ? 'red' : '');font:tahoma,8,bold;" class="noborder" text="bind:day1"/>
                <Cell col="3" style="align:left top;padding:3 0 3 0;background:EXPR(grid_today_expr(day1));background2:EXPR(grid_today_expr(day1));font:돋움,8;" text="bind:hol1"/>
                <Cell col="4" style="align:top;background:EXPR(grid_today_expr(day2));background2:EXPR(grid_today_expr(day2));color:EXPR(hol2 != null ? 'red' : '');color2:EXPR(hol2 != null ? 'red' : '');font:tahoma,8,bold;" class="noborder" text="bind:day2"/>
                <Cell col="5" style="align:left top;padding:3 0 3 0;background:EXPR(grid_today_expr(day2));background2:EXPR(grid_today_expr(day2));font:돋움,8;" text="bind:hol2"/>
                <Cell col="6" style="align:top;background:EXPR(grid_today_expr(day3));background2:EXPR(grid_today_expr(day3));color:EXPR(hol3 != null ? 'red' : '');color2:EXPR(hol3 != null ? 'red' : '');font:tahoma,8,bold;" class="noborder" text="bind:day3"/>
                <Cell col="7" style="align:left top;padding:3 0 3 0;background:EXPR(grid_today_expr(day3));background2:EXPR(grid_today_expr(day3));font:돋움,8;" text="bind:hol3"/>
                <Cell col="8" style="align:top;background:EXPR(grid_today_expr(day4));background2:EXPR(grid_today_expr(day4));color:EXPR(hol4 != null ? 'red' : '');color2:EXPR(hol4 != null ? 'red' : '');font:tahoma,8,bold;" class="noborder" text="bind:day4"/>
                <Cell col="9" style="align:left top;padding:3 0 3 0;background:EXPR(grid_today_expr(day4));background2:EXPR(grid_today_expr(day4));font:돋움,8;" text="bind:hol4"/>
                <Cell col="10" style="align:top;background:EXPR(grid_today_expr(day5));background2:EXPR(grid_today_expr(day5));color:EXPR(hol5 != null ? 'red' : '');color2:EXPR(hol5 != null ? 'red' : '');font:tahoma,8,bold;" class="noborder" text="bind:day5"/>
                <Cell col="11" style="align:left top;padding:3 0 3 0;background:EXPR(grid_today_expr(day5));background2:EXPR(grid_today_expr(day5));font:돋움,8;" text="bind:hol5"/>
                <Cell col="12" style="align:top;background:EXPR(grid_today_expr(day6));background2:EXPR(grid_today_expr(day6));color:EXPR(hol6 != null ? '#ed4105ff' : '#61acd3ff');color2:EXPR(hol6 != null ? '#ed4105ff' : '#61acd3ff');font:tahoma,8,bold;" class="noborder" text="bind:day6"/>
                <Cell col="13" style="align:left top;padding:3 0 3 0;background:EXPR(grid_today_expr(day6));background2:EXPR(grid_today_expr(day6));font:돋움,8;" text="bind:hol6"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static09" text="2015.9" class="portlet_date" position2="absolute l:20 w:78 t:0 h:28" positiontype="position2" style="color:#565656ff;align:center middle;font:tahoma,9;"/>
        <Static id="Static04" text="5px" visible="false" position="absolute 0 27 1107 32" style="background:#00bfff46;"/>
        <Button id="Button32" taborder="8" onclick="btn_monNext_onclick" position2="absolute l:98 w:20 t:4 h:20" positiontype="position2" text="&gt;"/>
        <Button id="btn_monPrev" taborder="9" onclick="btn_monPrev_onclick" position2="absolute l:0 w:20 t:4 h:20" positiontype="position2" text="&lt;"/>
        <Button id="btn_toDay" taborder="10" text="오늘" onclick="btn_toDay_onclick" class="btn_sub_white" position2="absolute l:123 w:60 t:4 h:20" positiontype="position2"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_calendar" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true">
        <ColumnInfo>
          <Column type="STRING" size="256" id="day0"/>
          <Column type="STRING" size="256" id="day1"/>
          <Column type="STRING" size="256" id="day2"/>
          <Column type="STRING" size="256" id="day3"/>
          <Column type="STRING" size="256" id="day4"/>
          <Column type="STRING" size="256" id="day5"/>
          <Column type="STRING" size="256" id="day6"/>
          <Column type="STRING" size="256" id="hol0"/>
          <Column type="STRING" size="256" id="hol1"/>
          <Column type="STRING" size="256" id="hol2"/>
          <Column type="STRING" size="256" id="hol3"/>
          <Column type="STRING" size="256" id="hol4"/>
          <Column type="STRING" size="256" id="hol5"/>
          <Column type="STRING" size="256" id="hol6"/>
        </ColumnInfo>
        <Rows>
        </Rows>
      </Dataset>
      <Dataset id="ds_schedules" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="VENDOR_NAME" type="STRING" size="256"/>
          <Column id="REQ_FRDT" type="STRING" size="256"/>
          <Column id="REQ_TODT" type="STRING" size="256"/>
          <Column id="REQ_FRTODT" type="STRING" size="256"/>
          <Column id="RID" type="STRING" size="256"/>
          <Column id="ALTKEY_PC5" type="STRING" size="256"/>
          <Column id="PAR_RID" type="STRING" size="256"/>
          <Column id="ALTKEY_ECO" type="STRING" size="256"/>
          <Column id="SALES_ORG_CD" type="STRING" size="256"/>
          <Column id="DISTR_CHAN_CD" type="STRING" size="256"/>
          <Column id="ITEM_GRP_CD" type="STRING" size="256"/>
          <Column id="SALES_OFF_CD" type="STRING" size="256"/>
          <Column id="SALES_GRP_CD" type="STRING" size="256"/>
          <Column id="SALES_GRP_NM" type="STRING" size="256"/>
          <Column id="SALES_GRP_ADDR" type="STRING" size="256"/>
          <Column id="VENDOR_CODE" type="STRING" size="256"/>
          <Column id="CONTRACT_NO" type="STRING" size="256"/>
          <Column id="TEAM_CODE" type="STRING" size="256"/>
          <Column id="TEAM_NAME" type="STRING" size="256"/>
          <Column id="BRANCH_CODE" type="STRING" size="256"/>
          <Column id="REQ_TYPE_CD" type="STRING" size="256"/>
          <Column id="REQ_TIME_CD" type="STRING" size="256"/>
          <Column id="ASSIGN_FRDT" type="STRING" size="256"/>
          <Column id="ASSIGN_TODT" type="STRING" size="256"/>
          <Column id="TOT_DAYCNT" type="STRING" size="256"/>
          <Column id="FREE_DAYCNT" type="STRING" size="256"/>
          <Column id="PAY_DAYCNT" type="STRING" size="256"/>
          <Column id="REG_EMP_CD" type="STRING" size="256"/>
          <Column id="REG_EMP_CD_NM" type="STRING" size="256"/>
          <Column id="REG_DT" type="STRING" size="256"/>
          <Column id="BRANCH_PRSN_TELNUM" type="STRING" size="256"/>
          <Column id="YES_PRSN_NAME" type="STRING" size="256"/>
          <Column id="YES_PRSN_TELNUM" type="STRING" size="256"/>
          <Column id="BRANCH_PRSN_SMS" type="STRING" size="256"/>
          <Column id="MARKETOR_SMS_YN" type="STRING" size="256"/>
          <Column id="STATUS" type="STRING" size="256"/>
          <Column id="STATUS_NM" type="STRING" size="256"/>
          <Column id="STATUS_DATE" type="STRING" size="256"/>
          <Column id="REQ_REASON_MEMO" type="STRING" size="256"/>
          <Column id="REQ_ETC_MEMO" type="STRING" size="256"/>
          <Column id="HAPPY_CALL_SCORE" type="STRING" size="256"/>
          <Column id="ACT_TYPE_CD" type="STRING" size="256"/>
          <Column id="ACT_TYPE_CD_NM" type="STRING" size="256"/>
          <Column id="FEE_TYPE_CD" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="VENDOR_NAME">테스트</Col>
            <Col id="REQ_FRDT">20150919</Col>
            <Col id="REQ_TODT">20150919</Col>
            <Col id="RID">1</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트2</Col>
            <Col id="REQ_FRDT">20150919</Col>
            <Col id="REQ_TODT">20150920</Col>
            <Col id="RID">2</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트3</Col>
            <Col id="REQ_FRDT">20150919</Col>
            <Col id="REQ_TODT">20150923</Col>
            <Col id="RID">3</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트4</Col>
            <Col id="REQ_FRDT">20150920</Col>
            <Col id="REQ_TODT">20150921</Col>
            <Col id="RID">4</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트5</Col>
            <Col id="REQ_FRDT">20150918</Col>
            <Col id="REQ_TODT">20150925</Col>
            <Col id="RID">5</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트6</Col>
            <Col id="REQ_FRDT">20150921</Col>
            <Col id="REQ_TODT">20150923</Col>
            <Col id="RID">6</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트7</Col>
            <Col id="REQ_FRDT">20150915</Col>
            <Col id="REQ_TODT">20150918</Col>
            <Col id="RID">7</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트8</Col>
            <Col id="REQ_FRDT">20150930</Col>
            <Col id="REQ_TODT">20151002</Col>
            <Col id="RID">8</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트9</Col>
            <Col id="REQ_FRDT">20150911</Col>
            <Col id="REQ_TODT">20150918</Col>
            <Col id="RID">9</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트11</Col>
            <Col id="REQ_FRDT">20150819</Col>
            <Col id="REQ_TODT">20150904</Col>
            <Col id="RID">11</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트12</Col>
            <Col id="REQ_FRDT">20150901</Col>
            <Col id="REQ_TODT">20150905</Col>
            <Col id="RID">12</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트13</Col>
            <Col id="REQ_FRDT">20150901</Col>
            <Col id="REQ_TODT">20150906</Col>
            <Col id="RID">13</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트14</Col>
            <Col id="REQ_FRDT">20150928</Col>
            <Col id="REQ_TODT">20151003</Col>
            <Col id="RID">14</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트10</Col>
            <Col id="REQ_FRDT">20150820</Col>
            <Col id="REQ_TODT">20150901</Col>
            <Col id="RID">10</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트15</Col>
            <Col id="REQ_FRDT">20150901</Col>
            <Col id="REQ_TODT">20150907</Col>
            <Col id="RID">15</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트16</Col>
            <Col id="REQ_FRDT">20150902</Col>
            <Col id="REQ_TODT">20150906</Col>
            <Col id="RID">16</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트17</Col>
            <Col id="REQ_FRDT">20150905</Col>
            <Col id="REQ_TODT">20150905</Col>
            <Col id="RID">17</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트18</Col>
            <Col id="REQ_FRDT">20150905</Col>
            <Col id="REQ_TODT">20150905</Col>
            <Col id="RID">18</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트19</Col>
            <Col id="REQ_FRDT">20150905</Col>
            <Col id="REQ_TODT">20150907</Col>
            <Col id="RID">19</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
          <Row>
            <Col id="VENDOR_NAME">테스트20</Col>
            <Col id="REQ_FRDT">20150901</Col>
            <Col id="REQ_TODT">20150930</Col>
            <Col id="RID">20</Col>
            <Col id="TEAM_NAME">팀</Col>
          </Row>
        </Rows>
      </Dataset>
      <FilteredDataset id="FilteredDataset" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_scheduleDepth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="REQ_FRDT" type="STRING" size="256"/>
          <Column id="REQ_TODT" type="STRING" size="256"/>
          <Column id="VENDOR_NAME" type="STRING" size="256"/>
          <Column id="BTWEEN_DAY" type="STRING" size="256"/>
          <Column id="DEPTH" type="STRING" size="256"/>
          <Column id="HIDDEN" type="STRING" size="256"/>
          <Column id="RID" type="STRING" size="256"/>
          <Column id="ALTKEY_PC5" type="STRING" size="256"/>
          <Column id="PAR_RID" type="STRING" size="256"/>
          <Column id="ALTKEY_ECO" type="STRING" size="256"/>
          <Column id="SALES_ORG_CD" type="STRING" size="256"/>
          <Column id="DISTR_CHAN_CD" type="STRING" size="256"/>
          <Column id="ITEM_GRP_CD" type="STRING" size="256"/>
          <Column id="SALES_OFF_CD" type="STRING" size="256"/>
          <Column id="SALES_GRP_CD" type="STRING" size="256"/>
          <Column id="VENDOR_CODE" type="STRING" size="256"/>
          <Column id="CONTRACT_NO" type="STRING" size="256"/>
          <Column id="TEAM_CODE" type="STRING" size="256"/>
          <Column id="BRANCH_CODE" type="STRING" size="256"/>
          <Column id="REQ_TYPE_CD" type="STRING" size="256"/>
          <Column id="REQ_TIME_CD" type="STRING" size="256"/>
          <Column id="ASSIGN_FRDT" type="STRING" size="256"/>
          <Column id="ASSIGN_TODT" type="STRING" size="256"/>
          <Column id="FREE_DAYCNT" type="STRING" size="256"/>
          <Column id="PAY_DAYCNT" type="STRING" size="256"/>
          <Column id="REG_EMP_CD" type="STRING" size="256"/>
          <Column id="REG_DT" type="STRING" size="256"/>
          <Column id="BRANCH_PRSN_TELNUM" type="STRING" size="256"/>
          <Column id="YES_PRSN_NAME" type="STRING" size="256"/>
          <Column id="YES_PRSN_TELNUM" type="STRING" size="256"/>
          <Column id="BRANCH_PRSN_SMS" type="STRING" size="256"/>
          <Column id="MARKETOR_SMS_YN" type="STRING" size="256"/>
          <Column id="STATUS" type="STRING" size="256"/>
          <Column id="STATUS_DATE" type="STRING" size="256"/>
          <Column id="REQ_REASON_MEMO" type="STRING" size="256"/>
          <Column id="HAPPY_CALL_SCORE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_scheduleHidden" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="REQ_FRDT" type="STRING" size="256"/>
          <Column id="REQ_TODT" type="STRING" size="256"/>
          <Column id="VENDOR_NAME" type="STRING" size="256"/>
          <Column id="DEPTH" type="STRING" size="256"/>
          <Column id="BTWEEN_DAY" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind/>
    <Script type="xscript4.0"><![CDATA[/**
 * Program ID  		: 
 * Program Name    	: 
 * Author          	: hyeonsuk.Ryu
 * Created On      	: 
 * Description      : 
 */
/********************************************************************************************/
/* 1. Include Library include, variables Declaration 영역                                  */
/********************************************************************************************/
include "LIB::lib_All.xjs";  
include "LIB::lib_String.xjs";  


// Grid Calendar Cell Size
var fv_colHeadHeight, fv_colBodyWidth, fv_colBodyHeight, fv_colBodyTopMargin;
// Grid Calendar Cell Selection( or Cell Duration )
var fv_selectionHeight, fv_selectionTopPadding=1, fv_selectionLeftPadding=3, fv_selectionRightPadding=3;

// limiting the number events for a given day
var fv_depth, fv_maxDepth = 3;

var fv_calendarYYYYMM;

// Dataset Component
var fv_dsSchedule       = ds_schedules;			// transation dataset
var fv_dsScheduleDepth  = ds_scheduleDepth;		// render master dataset for the grid
var fv_dsScheduleHidden = ds_scheduleHidden;	// render sub dataset for the grid ( for '+more' link )

// Dataset RowCount
var fv_RowCnt

// Dataset Col Value
var fv_StartDt, fv_EndDt, fv_Title, fv_titleFormat, fv_Rid;
// Dataset ColID
var fv_strStartParamColID  ="REQ_FRDT";
var fv_strEndParamColID    ="REQ_TODT";
var fv_strTitleParamColID  ="VENDOR_NAME";
var fv_strTeamParamColID   ="TEAM_NAME";
var fv_strActTypeParamColID="ACT_TYPE_CD_NM";
var fv_strFeeTypeParamColID="FEE_TYPE_CD";
var fv_strTotalParamColID  ="TOT_DAYCNT";
var fv_strRidParamColID    ="RID";
var fv_strDepthParamColID  ="DEPTH";
var fv_strDiffParamColID   ="BTWEEN_DAY";
var fv_strHiddenParamColID ="HIDDEN";

var frmUuid = "Home_Calendar";


/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리                                           	*/
/********************************************************************************************/
function grid_calendar_onload(obj:Form, e:LoadEventInfo)
{
	//그리드 형태로 calendar를 생성한다. 
	DrawCalendar(ds_calendar, grd_calendar, gfn_getToday().substr(0,6));
}

function fn_init(){
	fn_clearDataset();
	fn_destroyScheduleDivComponents();
}

function fn_refresh(){
	fn_init();
	fn_sort();
	fn_setCellResize();
	
	fn_scheduleDepthMake();	
	hiddenScheduleMake();	
}

function btnSearch_onclick(obj:Button,  e:ClickEventInfo)
{
	//fn_search();
	fn_refresh();
}




/********************************************************************************************/
/**   4. Validation 처리                                                                   	*/
/********************************************************************************************/



/********************************************************************************************/
/**   5. 서비스 호출함수											                   		*/
/********************************************************************************************/	
function fn_getRequestForm( reqRid, reqDate){
	// 팝업 호출
 	var inParam0 = reqRid
 	var inParam1 = reqDate;
 	var inParam2 = frmUuid;

    var strName			= "getYESRequestModalForm";					//생성될 ChildFrame의 이름
    var strFormURL		= "ys::UI_YS_P02.xfdl";				//로딩한 폼의 URL
    var objParentFrame	= this.getOwnerFrame();						//ParentFrame
    var objArgumentList = {inParam0:inParam0, inParam1:inParam1, inParam2:inParam2};	//ChildFrame에 추가될 변수 리스트 {변수명:변수값, 변수명:변수값} 형식으로 입력합니다.
    var strOpenStyle	= "showtitlebar=true showstatusbar=false openalign='center middle'";	//ChildFrame에 설정할 속성 리스트 a=b b='c' 형식으로 입력합니다.
    var nLeft			= 400;										//ChildFrame의 position 중 left 값
    var nTop			= 50;										//ChildFrame의 position 중 top 값
    var nRight			= -1;										//ChildFrame의 position 중 right 값 Default : 0
    var nBottom			= -1;										//ChildFrame의 position 중 bottom 값 Default : 0
    
    //var varRet = dialog( strName,strFormURL,objParentFrame, objArgumentList, strOpenStyle, nLeft, nTop, nRight, nBottom );
    var varRet = gfn_ModalPopup(strName, '', '', '', '', strFormURL, objParentFrame, objArgumentList);    
    //팝업에서 리턴 받은 값
    if( varRet != "" ||  varRet != null){
        //trace("varRet : "+ varRet[0]);   
        //div00.Div00.CheckBox02.value = varRet[0];
        //trace("dsInfo : "+ varRet.saveXML());   
		//div00.Div00.CheckBox02.value = varRet.getColumn(0,3);
    }

    this.parent.fn_search();
}



/********************************************************************************************/
/**   6. Callback(gfn_Transaction 호출 후 처리내용)                                  		*/
/********************************************************************************************/
function fn_Callback(psSvcId, pnErrorCode, psErrorMessage) {
	if (pnErrorCode != 0){
		gfn_AlertMsg(psErrorMessage, constant.messagetype.ERROR);	//처리를 완료하였습니다.
	}else {
		switch (psSvcId) {
			case "getYESRequestForm":
				gfn_AlertMsg("MSG_00010", constant.messagetype.QUEST);
			break;
		}
	}
}


/********************************************************************************************/
/**   7. 사용자 정의함수											                   		*/
/********************************************************************************************/
function IsHoliday(sDate, aHolidays){
	var i;
	for( i = 0 ; i < aHolidays.length ; i++ ){
		if( aHolidays[i].substr(0,8) == sDate ) return aHolidays[i].substr(8);
	}
	return "";	
}

// Grid Expression - Today
function grid_today_expr(sDate)
{
	var yyyymmdd = grd_calendar.UserData+Right("0"+sDate,  2);

	if( gfn_getToday() == yyyymmdd )
		return "lightsteelblue";
	else
		return "white";
}

// Draw yyyymm Calendar 
function DrawCalendar(ds_calendar_obj, grid_obj, yyyymm){
	var i, day, row, colid;
	var start_day, end_date, lunar;
	var holiday, aHolidays;
	
	// init
	fv_calendarYYYYMM        = yyyymm;
	//fv_RowCnt                = fv_dsSchedule.rowcount;
//	fn_setCellResize();
// 	fv_colHeadHeight         = grid_obj.getFormatRowSize(0) + grid_obj.getFormatRowSize(1);
// 	fv_colBodyWidth          = grid_obj.getRealColFullSize()/7; //grid_obj.getFormatColSize(0) + grid_obj.getFormatColSize(1);
// 	fv_colBodyHeight         = grid_obj.getFormatRowSize(2);
// 	fv_colBodyTopMargin      = parseInt(fv_colBodyHeight/(fv_maxDepth+1))-fv_selectionTopPadding;
// 	fv_selectionHeight       = Math.ceil((fv_colBodyHeight-fv_colBodyTopMargin)/(fv_maxDepth+1));
	
	grid_obj.UserData = yyyymm;
	aHolidays = gfn_GetHolidays(parseInt(yyyymm.substr(0,4), 10));
	
	// Setting Grid Header
	grid_obj.setCellProperty("Head",1,"text", yyyymm.substr(0, 4) + "년 " + parseInt(yyyymm.substr(4,2)) + "월");
	Static09.text = yyyymm.substr(0, 4) + ". " + parseInt(yyyymm.substr(4,2));

	// Make Dataset 
	ds_calendar_obj.clearData();
	start_day = gfn_getDay(yyyymm+"01");
	last_date = gfn_LastDateNum(yyyymm+"01");
	row = ds_calendar_obj.addRow();
	for( i = 1, day = start_day ; i <= last_date ; i++ ){
		// Setting Calendar Data
		ds_calendar_obj.setColumn(row, "day"+day, i);
		
		// Holiday
		holiday = IsHoliday(yyyymm+Right("0"+i, 2), aHolidays);
		// Setting lunar
		lunar = null;
		if( i%10 == 1 ){
			lunar = gfn_Solar2Lunar( yyyymm + Right("0"+i,2) );
			if( lunar != null ) lunar = "(" + parseInt(lunar.substr(5,2)) + "," + parseInt(lunar.substr(7,2)) + ")";
		}
		if( holiday != "" ) ds_calendar_obj.setColumn(row, "hol"+day, holiday); 
		else ds_calendar_obj.setColumn(row, "hol"+day, lunar); 
			
		// addRow Calendar Data Row
		day = (day+1)%7;
		if( day == 0 && i != last_date ) row = ds_calendar_obj.addRow();
	}
}
//Dataset Sorting
function fn_sort()
{	
	fv_dsSchedule.keystring = "S:+"+fv_strStartParamColID+"-"+fv_strEndParamColID;
	fv_dsSchedule.updateSortGroup();	
}


function fn_setCellResize(){
// 	fv_colHeadHeight         = Grid_calendar.getFormatRowSize(0) + Grid_calendar.getFormatRowSize(1);
// 	fv_colBodyWidth          = Grid_calendar.getRealColFullSize()/7; //grid_obj.getFormatColSize(0) + grid_obj.getFormatColSize(1);	//onsize 이벤트 시 시점 차이로 사용 안함
// 	fv_colBodyHeight         = Grid_calendar.getFormatRowSize(2);
// 	fv_colBodyTopMargin      = parseInt(fv_colBodyHeight/(fv_maxDepth+1))-fv_selectionTopPadding;
// 	fv_selectionHeight       = Math.ceil((fv_colBodyHeight-fv_colBodyTopMargin)/(fv_maxDepth+1));
	
	//jji 테스트 
	fv_colHeadHeight         = grd_calendar.getFormatRowSize(0) + grd_calendar.getFormatRowSize(1);
 	fv_colBodyWidth          = grd_calendar.position.width /7; //grid_obj.getFormatColSize(0) + grid_obj.getFormatColSize(1);
 	fv_colBodyHeight         = grd_calendar.getFormatRowSize(2);
 	fv_colBodyTopMargin      = parseInt(fv_colBodyHeight/(fv_maxDepth+1))-fv_selectionTopPadding;
 	fv_selectionHeight       = Math.ceil((fv_colBodyHeight-fv_colBodyTopMargin)/(fv_maxDepth+1));
		
	//trace("그리드 크기 : "+ grd_calendar.position.width );	
}

function fn_isHiddenDepth(){
	return fv_depth > fv_maxDepth;
}

// Computes the number of depth a schedule(or 'fv_StratDt' ~ 'fv_EndDt' ) will accomodate without going outside its bounds.
// Make 'ds_scheduleDepth' & 'ds_scheduleHidden'
function fn_scheduleDepthMake(){
	fv_RowCnt            = fv_dsSchedule.rowcount;
	//var strCurrentMonth  = parseInt(fv_calendarYYYYMM.substr(4,2));	//Compare MM 
	var strCurrentMonth  = parseInt(fv_calendarYYYYMM.substr(0,6));		//Compare YYYYMM 
	for(var i=0; i<fv_RowCnt; i++){
		fv_StartDt = fv_dsSchedule.getColumn(i, fv_strStartParamColID);
		fv_EndDt   = fv_dsSchedule.getColumn(i, fv_strEndParamColID);
		
		fv_Title   = fv_dsSchedule.getColumn(i, fv_strTeamParamColID).replace("팀","")
				   +"-"+fv_dsSchedule.getColumn(i, fv_strTitleParamColID).replace("주유소","")
				   +"/"+fv_dsSchedule.getColumn(i, fv_strActTypeParamColID)
				   +fv_dsSchedule.getColumn(i, fv_strTotalParamColID);
		
		fv_Rid     = fv_dsSchedule.getColumn(i, fv_strRidParamColID);
				
		//if( (strCurrentMonth!=fv_StartDt.substr(4,2)) && (strCurrentMonth!=fv_EndDt.substr(4,2)) ) continue;	//Compare MM 
		if( (strCurrentMonth!=fv_StartDt.substr(0,6)) && (strCurrentMonth!=fv_EndDt.substr(0,6)) ) continue;	//Compare YYYYMM 
		
		fn_computeDepth();
		fn_containDepth();
		if(fn_isHiddenDepth()) fn_containHiddenDepth();
		else scheduleMake();
	}
}

function scheduleMake(){
	var strColNm;
	var nFromRow, nFromCol, nToRow, nToCol;
	
	var strCurrent       = fv_calendarYYYYMM;
	var strCurrentMonth  = parseInt(strCurrent.substr(4,2));
	var strFindMonthFrom = parseInt(fv_StartDt.substr(4, 2));
	var strFindMonthTO   = parseInt(fv_EndDt.substr(4, 2));
	
	//Compare Month :: requare Compare Year??? 
	if(strFindMonthFrom!=strCurrentMonth){
		fv_StartDt = strCurrent.substr(0,6)+"01";
	}else if(strFindMonthTO!=strCurrentMonth){
		fv_EndDt = strCurrent.substr(0,6)+gfn_LastDateNum(strCurrent.substr(0,6)+"01");
	}
		
	for(var i = 0; i < 7; i++ ) {
		strColNm = "day" + i;
		nFromRow = ds_calendar.findRow(strColNm, parseInt(fv_StartDt.substr(6, 8)));
		nFromCol = i;
		if( nFromRow != -1 ) break;
	}
	for(var i = 0; i < 7; i++ ) {
		strColNm = "day" + i;
		nToRow = ds_calendar.findRow(strColNm, parseInt(fv_EndDt.substr(6, 8)));
		nToCol = i;
		if( nToRow != -1 ) break;
	}

	var nBetweenDay = 0;	
	
	if( nFromRow == nToRow ) nBetweenDay = fv_EndDt - fv_StartDt + 1;
	else                     nBetweenDay = 7 - nFromCol;
	
	fn_renderScheduleDiv(nFromCol, nFromRow, nBetweenDay, fv_titleFormat);
		
	var nRowTerm = 0;
	
	if( nFromRow != nToRow ) {
		nRowTerm = nToRow - nFromRow;
		
		for( var i = 0; i < nRowTerm; i++ ) {
			if( (i + 1) == nRowTerm ) fn_renderScheduleDiv(0, nToRow, nToCol + 1, fv_titleFormat);
			else                      fn_renderScheduleDiv(0, nFromRow + i + 1, 7, fv_titleFormat);
		}
	}
}

//Computes the number of depth a schedule(or 'fv_StratDt' ~ 'fv_EndDt' ) will accomodate without going outside its bounds.
function fn_computeDepth()
{	
	var strFilter = fv_strStartParamColID+"<='" + fv_StartDt + "' && "+fv_strEndParamColID+">='"+fv_StartDt+"'";
		
	FilteredDataset.filterstr = strFilter;
	FilteredDataset.binddataset = fv_dsScheduleDepth;
	FilteredDataset.updateSortGroup("S:+"+fv_strDepthParamColID);
	
	var vMaxValue = FilteredDataset.getMax(fv_strDepthParamColID);
	var vCountValue = FilteredDataset.rowcount;
	
	if( !vCountValue ) fv_depth = 1;
	else if(vMaxValue!=vCountValue){ 
		for(var i=0; i<vMaxValue; i++){
			 if(toNumber(FilteredDataset.getColumn(i, fv_strDepthParamColID))!=i+1) {
				fv_depth = i+1;
				break;
			}
		}
	}
	else fv_depth = toNumber(vMaxValue) + 1;
	//FilteredDataset init
	FilteredDataset.filterstr = "";
}

// Make 'ds_scheduleDepth'
function fn_containDepth()
{
	var nIdx = fv_dsScheduleDepth.addRow();
	//Formatting String for 'TITLE'
	fv_titleFormat= fv_Title;
	
	fv_dsScheduleDepth.setColumn(nIdx, fv_strStartParamColID, fv_StartDt);
	fv_dsScheduleDepth.setColumn(nIdx, fv_strEndParamColID,   fv_EndDt);
	fv_dsScheduleDepth.setColumn(nIdx, fv_strTitleParamColID, fv_Title);
	fv_dsScheduleDepth.setColumn(nIdx, fv_strRidParamColID,   fv_Rid);
	fv_dsScheduleDepth.setColumn(nIdx, fv_strDiffParamColID,  fv_EndDt - fv_StartDt);
	fv_dsScheduleDepth.setColumn(nIdx, fv_strDepthParamColID, fv_depth);
	// '0' when not visible, '1' when visible
	if(fn_isHiddenDepth()) fv_dsScheduleDepth.setColumn(nIdx, fv_strHiddenParamColID, 0);
	else fv_dsScheduleDepth.setColumn(nIdx, fv_strHiddenParamColID, 1);
}

// Make 'ds_scheduleHidden' 
function fn_containHiddenDepth()
{
	var nIdx = fv_dsScheduleHidden.addRow();
	
	fv_titleFormat = fv_Title;
	
	fv_dsScheduleHidden.setColumn(nIdx, fv_strStartParamColID, fv_StartDt);
	fv_dsScheduleHidden.setColumn(nIdx, fv_strEndParamColID,   fv_EndDt);
	fv_dsScheduleHidden.setColumn(nIdx, fv_strTitleParamColID, fv_Title);
	fv_dsScheduleHidden.setColumn(nIdx, fv_strDiffParamColID,  fv_EndDt - fv_StartDt);
	fv_dsScheduleHidden.setColumn(nIdx, fv_strDepthParamColID, fv_depth);
}

//Render Basic Div Component for the grid
function fn_renderScheduleDiv(nCol, nRow, nBetweenDay, nTitle)
{
	var objDate  = new Date();
	var strScrId = objDate.toFormatString("%H%M%S") + "_" + objDate.getMilliseconds();

	var name    = "div_schedule_" + strScrId+"_"+nRow+"_"+nCol+"_"+fv_Rid;
	//var name    = "div_schedule_" + strScrId;
 	var nLeft   = grd_calendar.position.left + (fv_colBodyWidth * nCol) + fv_selectionLeftPadding;
 	var nTop    = grd_calendar.position.top + fv_colHeadHeight + (fv_colBodyHeight * nRow) + (fv_selectionHeight* fv_depth);
 	var nRight  = nLeft + (fv_colBodyWidth * nBetweenDay)-fv_selectionRightPadding ;
 	var nBottom = nTop + fv_selectionHeight-fv_selectionTopPadding;
		
	var oDiv = new Div(name, nLeft, nTop, nRight, nBottom);
	    oDiv.style.background = "#4dbc85";
	    oDiv.text = nTitle;
	    oDiv.style.color = "#ffffff";
	    
	this.addChild(name, oDiv);

	oDiv.onlbuttonup.addHandler(fn_popScheduleDetail);
	oDiv.show();
}

function fn_popScheduleDetail(obj:Div, e:MouseEventInfo){
var idx = obj.name.lastIndexOf("_")+1;
// 	var objChildFrame = new ChildFrame();
// 	var crect_window = this.canvas.getClientRect(Canvas.COORD_SCREEN);
// 	objChildFrame.init("pop", crect_window.left, crect_window.top, crect_window.right, crect_window.bottom );
// 	//var rtn = objChildFrame.showModeless(this.getOwnerFrame());
// 	var rtn = objChildFrame.showModal(this.getOwnerFrame());
	// 팝업 호출
	var inParam1 = obj.name.substr(idx);

    var strName			= "modalPop";								//생성될 ChildFrame의 이름
    var strFormURL		= "ys::UI_YS_P01.xfdl";						//로딩한 폼의 URL
    var objParentFrame	= this.getOwnerFrame();						//ParentFrame
    var objArgumentList = {inParam1:inParam1};	//ChildFrame에 추가될 변수 리스트 {변수명:변수값, 변수명:변수값} 형식으로 입력합니다.
    var strOpenStyle	= "showtitlebar=true showstatusbar=false openalign='center middle'";	//ChildFrame에 설정할 속성 리스트 a=b b='c' 형식으로 입력합니다.
    var nLeft			= 400;										//ChildFrame의 position 중 left 값
    var nTop			= 50;										//ChildFrame의 position 중 top 값
    var nRight			= -1;										//ChildFrame의 position 중 right 값 Default : 0
    var nBottom			= -1;										//ChildFrame의 position 중 bottom 값 Default : 0
    
    //var vReturn = dialog( strName,strFormURL,objParentFrame, objArgumentList, strOpenStyle, nLeft, nTop, nRight, nBottom );
    var varRet = gfn_ModalPopup(strName, '', '', '', '', strFormURL, objParentFrame, objArgumentList);
		
//     if(!gfn_IsNull(vReturn)){
// 		var vActTypeCd = vReturn.getColumn(0,"ACT_TYPE_CD");
// 		var nRow = ds_yesReqAct.findRow("ACT_TYPE_CD", vActTypeCd );
// 		if(vReturn.getColumn(0,"REQ_YN")){
// 			Div00.Div00.CheckBox03.value=true;
// 			ds_yesReqAct.setColumn(nRow, "REQ_YN", 1);
// 		}
//         else{
// 			Div00.Div00.CheckBox03.value=false;
// 			ds_yesReqAct.setColumn(nRow, "REQ_YN", 0);
// 		}
//     }
}

//Render "+ more" link Div Component for the grid
function fn_renderScheduleHiddenDiv(nCol, nRow, nBetweenDay, nTitle)
{
	var objDate  = new Date();
	var strScrId = objDate.toFormatString("%H%M%S") + "_" + objDate.getMilliseconds();

	var name    = "div_hiddenSchedule_" + fv_StartDt + strScrId;

 	var nLeft   = grd_calendar.position.left + (fv_colBodyWidth * nCol) + fv_selectionLeftPadding;
 	var nTop    = grd_calendar.position.top + fv_colHeadHeight + (fv_colBodyHeight * nRow) + (fv_selectionHeight * (fv_maxDepth+1));
 	var nRight  = nLeft + (fv_colBodyWidth * nBetweenDay) - fv_selectionRightPadding ;
 	var nBottom = nTop + fv_selectionHeight - fv_selectionTopPadding;
	 	
	var oDiv = new Div(name, nLeft, nTop, nRight, nBottom);
	    oDiv.style.background = "#transparent";
	    oDiv.text = "+"+nTitle+"more";
	    oDiv.style.color = "#4dbc85";
	    
	addChild(name, oDiv);
	
	//oDiv.onlbuttondown.addHandler(fn_removeMoreLink);	
	oDiv.onlbuttonup.addHandler(fn_renderMoreLink);	
	//this.onlbuttondown.addHandler(fn_removeMoreLink);
	var componentsCnt = this.components.length;
 	for(var i=0; i<componentsCnt; i++){
		this.components[i].onlbuttondown.addHandler(fn_eventHandler);
 	}
		
	oDiv.show();
}



//Render the Popover Div Component for the "+ more" link events that can't fit in a cell.
function fn_renderMoreLinkBoard(nCol, nRow, yyyymmdd)
{
	if(!div_moreLinkBoard.visible){
		var nLeft   = grd_calendar.position.left + (fv_colBodyWidth * nCol);
		var nTop    = grd_calendar.position.top + fv_colHeadHeight + (fv_colBodyHeight * nRow);
		var nRight  = nLeft + (fv_colBodyWidth * 1.8);
		var nBottom = nTop + (fv_selectionHeight * (FilteredDataset.rowcount+2)) - fv_selectionTopPadding;
		
		if(nCol==6){
			nLeft = nLeft - (fv_colBodyWidth * 0.8);
			nRight = nRight - (fv_colBodyWidth * 0.8);
		}
		
		div_moreLinkBoard.position="absolute "+nLeft+"px "+nTop+"px "+nRight+"px "+nBottom+"px";
		div_moreLinkBoard.style.margin = "1px 1px 1px 1px";
		
		
		div_moreLinkBoard.visible=true;
		div_moreLinkBoard.bringToFront();
		//Title Div
		var objStatic = new Static("div_schedule_title", 0, 0, nRight, fv_selectionHeight);
		objStatic.style.background = "#0px solid #b1b5b9b3";
		objStatic.text =  yyyymmdd.substr(4, 2) + "월 " + parseInt(yyyymmdd.substr(6,2)) + "일";
		div_moreLinkBoard.addChild("div_schedule_title", objStatic);
		objStatic.show(); 
	}
}

//Render hidden Schedule Div Component for the grid
function fn_renderMoreLinkScheduleDiv(nCol, nRow, nBetweenDay, nTitle)
{
	var objDate  = new Date();
	var strScrId = objDate.toFormatString("%H%M%S") + "_" + objDate.getMilliseconds();

	var name    = "div_schedule_" + strScrId+"_"+fv_Rid;
	var nLeft   = fv_selectionLeftPadding + 5;
	//var nTop    = div_moreLinkBoard.position.top + fv_colHeadHeight + (fv_colBodyHeight * nRow) + (fv_colBodyTopMargin * fv_depth);
	var nTop    = fv_selectionHeight * fv_depth+ fv_selectionTopPadding + 5;
	var nRight  = nLeft + (fv_colBodyWidth * (nBetweenDay*1.6)) ;
	var nBottom = nTop + fv_selectionHeight-fv_selectionTopPadding;
	
	var oDiv = new Div(name, nLeft, nTop, nRight, nBottom);
	    oDiv.style.background = "#4dbc85";
	    oDiv.text = nTitle;
	    oDiv.style.color = "#ffffff";
	
	//this.addChild(name, oDiv);
	div_moreLinkBoard.addChild(name, oDiv);
	
	oDiv.onlbuttonup.addHandler(fn_popScheduleDetail);
	oDiv.bringToFront();
	oDiv.show();
}

function hiddenScheduleMake()
{
	var nFromRow, nFromCol, nToRow, nToCol;	
	var vHiddenCnt, vDate;
	
	var strCurrent = fv_calendarYYYYMM;
	var last_date = gfn_LastDateNum(strCurrent.substr(0,6)+"01");
	
	for( var i=1; i<=last_date; i++ ){
		fv_StartDt = strCurrent.substr(0,6)+Right("0" + i, 2);
		vHiddenCnt = fn_computeHiddenDays(fv_StartDt);
				
		if(vHiddenCnt>0){
			for(var iFrom = 0; iFrom < 7; iFrom++ ) {
				strColNm = "day" + iFrom;
				nFromRow = ds_calendar.findRow(strColNm, i);
				nFromCol = iFrom;
				if( nFromRow != -1 ) break;
			}
			for(var iTo = 0; iTo < 7; iTo++ ) {
				strColNm = "day" + iTo;
				nToRow = ds_calendar.findRow(strColNm, i);
				nToCol = iTo;
				if( nToRow != -1 ) break;
			}
			
			fn_renderScheduleHiddenDiv(nFromCol, nFromRow, 1, vHiddenCnt);
		}
	}
}

function moreLinkScheduleMake(obj, vDate)
{
	var strFilter = fv_strStartParamColID+"<='" + vDate + "' && "+fv_strEndParamColID+">='"+vDate+"'";
	
	FilteredDataset.filterstr = strFilter;
	FilteredDataset.binddataset = fv_dsScheduleDepth;
		
	for(var i=0; i<FilteredDataset.rowcount; i++){
		fv_StartDt = FilteredDataset.getColumn(i, fv_strStartParamColID);
		fv_EndDt   = FilteredDataset.getColumn(i, fv_strEndParamColID);
		fv_Title   = FilteredDataset.getColumn(i, fv_strTitleParamColID);
		//fv_depth   = FilteredDataset.getColumn(i, fv_strDepthParamColID);
		fv_depth   = i+1;
		fv_Rid     = FilteredDataset.getColumn(i, fv_strRidParamColID);
	
		for(var iFrom = 0; iFrom < 7; iFrom++ ) {
			strColNm = "day" + iFrom;
			nFromRow = ds_calendar.findRow(strColNm, parseInt(vDate.substr(6, 8)));
			nFromCol = iFrom;
			if( nFromRow != -1 ) break;
		}
		for(var iTo = 0; iTo < 7; iTo++ ) {
			strColNm = "day" + iTo;
			nToRow = ds_calendar.findRow(strColNm, parseInt(vDate.substr(6, 8)));
			nToCol = iTo;
			if( nToRow != -1 ) break;
		}
		
		fn_renderMoreLinkBoard(nFromCol, nFromRow, vDate);
		
		fn_renderMoreLinkScheduleDiv(nFromCol, nFromRow, 1, fv_Title);
	}	
	FilteredDataset.filterstr = "";
}

function fn_computeHiddenDays(vDate)
{
	var strFilter = fv_strStartParamColID+"<='" + vDate + "' && "+fv_strEndParamColID+">='"+vDate+"'";
	return fv_dsScheduleHidden.getCaseCount(strFilter);
}

function fn_removeMoreLink()
{
	if(div_moreLinkBoard.visible){
		div_moreLinkBoard.visible=false;
		
		var childlist = div_moreLinkBoard.components;
		var childlistlength = childlist.length;
		for(var i=(childlistlength-1); i>=0 ; i--){
			childlist[i].destroy();
 			div_moreLinkBoard.removeChild(childlist[i].name);
		}
	}
}

function fn_clearDataset(){
	fv_dsScheduleDepth.clearData();
	fv_dsScheduleHidden.clearData();
}

function fn_destroyScheduleDivComponents(){
	fn_removeMoreLink();
	var componentsCnt = this.components.length;
 	for(var i=(componentsCnt-1); i>=0; i--){
		if("Div"==this.components[i].toString().replace("[object ",'').replace("]",'')){
			if(this.components[i].name.indexOf("div_schedule_")!=-1 || this.components[i].name.indexOf("div_hiddenSchedule_")!=-1){
				this.components[i].destroy();
				this.removeChild(this.components[i].name);
 			}
		}
 	}
}

function fn_eventHandler(obj:Object, e:MouseEventInfo){
// 	if("Div"==obj.toString().replace("[object ",'').replace("]",'')) //coding
// 	else if("Grid"==obj.toString().replace("[object ",'').replace("]",'')) //coding
// 	else if("Button"==obj.toString().replace("[object ",'').replace("]",'')) //coding
	if(obj.name=="div_moreLinkBoard") {}
	else {fn_removeMoreLink();}
 }
 
 function fn_renderMoreLink(obj:Div, e:MouseEventInfo)
{	
	var vDate = LTrim(obj.name, "div_hiddenSchedule_").substr(0,8);
	moreLinkScheduleMake(obj, vDate);
}




/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
//calendar 이전월
function btn_monPrev_onclick(obj:Button,  e:ClickEventInfo)
{
	var add_date;
	var yyyymm = fv_calendarYYYYMM;
	add_date   = gfn_addMonth(yyyymm+"01", -1);
	yyyymm     = add_date.substr(0, 6);
	DrawCalendar(ds_calendar, grd_calendar, yyyymm);	
	Static09.text = yyyymm.substr(0, 4) + ". " + parseInt(yyyymm.substr(4,2));	
	fn_refresh();
}

//calendar 다음월
function btn_monNext_onclick(obj:Button,  e:ClickEventInfo)
{
	var add_date;
	var yyyymm = fv_calendarYYYYMM;
	add_date   = gfn_addMonth(yyyymm+"01", 1);
	yyyymm     = add_date.substr(0, 6);
	DrawCalendar(ds_calendar, grd_calendar, yyyymm);
	Static09.text = yyyymm.substr(0, 4) + ". " + parseInt(yyyymm.substr(4,2));	
	fn_refresh();
}


function Grid_calendar_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	var yyyymm, add_date;
	yyyymm = obj.UserData;
	
	if( e.cell == 0 )
	{
		add_date = gfn_addMonth(yyyymm+"01", -1);
		yyyymm   = add_date.substr(0, 6);
		DrawCalendar(ds_calendar, obj, yyyymm);
	}
	else if( e.cell == 2 )
	{
		add_date = gfn_addMonth(yyyymm+"01", 1);
		yyyymm   = add_date.substr(0, 6);
		DrawCalendar(ds_calendar, obj, yyyymm);
	}
	
	fn_refresh();
}

function btn_toDay_onclick(obj:Button,  e:ClickEventInfo)
{
	DrawCalendar(ds_calendar, grd_calendar, gfn_getToday().substr(0,6));
	fn_refresh();
}

function Grid_calendar_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	var strCellText = obj.getCellText(e.row,(e.cell%2==0?e.cell:e.cell-1));
	if(e.row < 0 || strCellText=="" || strCellText==null){ return;}
	
	if(confirm("신청하시겠습니까?")) 
		fn_getRequestForm( "", grd_calendar.UserData+Right("0"+obj.getCellText(e.row,(e.cell%2==0?e.cell:e.cell-1)),  2) )
	
}

function Static01_onclick(obj:Static,  e:ClickEventInfo)
{
	var dHeight = div01.position.height;
 
	if(dHeight == 2) {
		div01.position.height = 68;
		grd_calendar.position.y = grd_calendar.position.y + 66;
		position.y = position.y + 66;
		obj.position.y = obj.position.y + 66;
		obj.class = "btn_minimize";
	} else {
		div01.position.height = 2;
		grd_calendar.position.y = grd_calendar.position.y - 66;
		position.y = position.y - 66;
		obj.position.y = obj.position.y - 66;
		obj.class = "btn_minimize_on";
	}
	
	fn_refresh();
}

function Grid_calendar_onsize(obj:Grid, e:SizeEventInfo)
{
	fv_calendarYYYYMM = gfn_getToday().substr(0,6);	// 수정 할 것....
	fn_refresh();
}
]]></Script>
  </Form>
</FDL>
