<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="DL471200" classname="PS030200" inheritanceid="" position="absolute 0 0 989 795" titletext="수수료산출(NEW)" scrollbars="none" onload="DL471200_onload">
    <Layouts>
      <Layout>
        <Tab id="tab_feeMain" taborder="60" position2="absolute l:0 r:0 t:10 b:1" positiontype="position2" tabindex="0" scrollbars="autoboth" style="font:Dotum,9;" onchanged="tab_feeMain_onchanged">
          <Tabpages>
            <Tabpage id="tab_feeCalculation" text="수수료 산출">
              <Layouts>
                <Layout>
                  <Static id="stc_01" class="sta_workSrcBg" position2="absolute l:0 r:0 t:0 h:41" positiontype="position2"/>
                  <Button id="btn_init" taborder="1" onclick="btn_init_onclick" class="btn_WF_Return" position2="absolute r:5 w:72 t:11 h:20" positiontype="position2" tooltiptext="초기화" style="padding:0 0 0 0;"/>
                  <Button id="btn_search" taborder="2" onclick="btn_search_onclick" class="btn_WF_Search" position2="absolute r:79 w:72 t:11 h:20" positiontype="position2" tooltiptext="조회" style="padding:0 0 0 0;shadow:drop 0,0 0 transparent;"/>
                  <Static id="stc_03" class="sta_workSrcBg" position2="absolute l:0 r:0 b:3 h:37" positiontype="position2"/>
                  <Static id="stc_00" text="총대상건수" class="sta_workSrcLabel1" position2="absolute l:6 w:78 b:11 h:20" positiontype="position2"/>
                  <Static id="stc_04" text="총수수료계" class="sta_workSrcLabel1" position2="absolute l:191 w:90 b:11 h:20" positiontype="position2"/>
                  <Edit id="edt_alow_cnt" taborder="3" inputtype="number" lengthunit="utf8" maxlength="20" onkillfocus="edt_cntr_rprs_tlno_onkillfocus" enable="false" position2="absolute l:75 w:110 b:11 h:20" positiontype="position2" style=":disabled {align:right middle;}"/>
                  <Edit id="edt_tot_alow_amt" taborder="4" inputtype="number" lengthunit="utf8" maxlength="20" onkillfocus="edt_cntr_rprs_tlno_onkillfocus" enable="false" position2="absolute l:267 w:110 b:11 h:20" positiontype="position2" style=":disabled {align:right middle;}"/>
                  <Static id="stc_02" text="총환수액" class="sta_workSrcLabel1" position2="absolute l:383 w:105 b:11 h:20" positiontype="position2"/>
                  <Edit id="edt_tot_resnredmpamt" taborder="5" inputtype="number" lengthunit="utf8" maxlength="20" onkillfocus="edt_cntr_rprs_tlno_onkillfocus" enable="false" position2="absolute l:474 w:110 b:11 h:20" positiontype="position2" style=":disabled {align:right middle;}"/>
                  <Static id="stc_05" text="총실지급액" class="sta_workSrcLabel1" position2="absolute l:590 w:98 b:11 h:20" positiontype="position2"/>
                  <Edit id="edt_tot_real_amt" taborder="6" inputtype="number" lengthunit="utf8" maxlength="20" onkillfocus="edt_cntr_rprs_tlno_onkillfocus" enable="false" position2="absolute l:674 w:110 b:11 h:20" positiontype="position2" style=":disabled {align:right middle;}"/>
                  <Static id="stc_06" text="총상조금액" class="sta_workSrcLabel1" position2="absolute l:790 w:98 b:11 h:20" positiontype="position2"/>
                  <Edit id="edt_tot_true_amt" taborder="7" inputtype="number" lengthunit="utf8" maxlength="20" onkillfocus="edt_cntr_rprs_tlno_onkillfocus" enable="false" position2="absolute l:874 w:110 b:11 h:20" positiontype="position2" style=":disabled {align:right middle;}"/>
                  <Button id="btn_excelExport" taborder="8" tabstop="false" text="엑셀" onclick="btn_excelExport_onclick" position2="absolute r:5 w:91 t:44 h:20" positiontype="position2" tooltiptext="엑셀"/>
                  <Grid id="grd_list" taborder="10" binddataset="ds_listAlowBasicInfo" useinputpanel="false" cellsizingtype="none" onvscrolllastover="grd_list_onvscrolllastover" position2="absolute l:0 r:0 t:67 b:44" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="140"/>
                          <Column size="140"/>
                          <Column size="140"/>
                          <Column size="140"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="NO"/>
                          <Cell col="1" text="수수료월"/>
                          <Cell col="2" text="분류"/>
                          <Cell col="3" text="수수료계"/>
                          <Cell col="4" text="환수액"/>
                          <Cell col="5" text="수수료 - 환수액"/>
                          <Cell col="6" text="상조금액"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="text" style="align:center middle;" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:center middle;" text="bind:alow_dt" mask="####-##"/>
                          <Cell col="2" style="align:center middle;" text="bind:grp_nm"/>
                          <Cell col="3" displaytype="number" style="align:right middle;" text="bind:alow_amt"/>
                          <Cell col="4" displaytype="number" style="align:right middle;" text="bind:resnredmpamt"/>
                          <Cell col="5" displaytype="number" style="align:right middle;" text="bind:real_amt"/>
                          <Cell col="6" displaytype="number" style="align:right middle;" text="bind:true_amt"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="stc_07" text="작업년월" class="sta_workSrcLabel1" position="absolute 8 11 65 31"/>
                  <Div id="div_monthCal" taborder="11" url="COMM::Div_monthCal.xfdl" style="border:0 solid #385d8aff ;" position="absolute 72 11 147 34"/>
                  <Static id="stc_08" text="분류" class="sta_workSrcLabel1" position="absolute 157 11 190 31"/>
                  <Combo id="cbo_stGrpCd" taborder="12" innerdataset="@ds_codeGrpCd" codecolumn="com_cd" datacolumn="cd_nm" displayrowcount="10" position="absolute 208 11 347 31"/>
                  <Calendar id="cal_calcDay" taborder="16" dateformat="yyyy-MM" editformat="yyyy-MM" position2="absolute r:-239 w:91 t:-22 h:20" positiontype="position2" visible="false"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tab_b2bFee" text="수당 산출">
              <Layouts>
                <Layout>
                  <Static id="stc_01" class="sta_workSrcBg" position2="absolute l:0 r:0 t:0 h:41" positiontype="position2"/>
                  <Button id="btn_init" taborder="1" onclick="btn_init_onclick" class="btn_WF_Return" position2="absolute r:5 w:72 t:11 h:20" positiontype="position2" tooltiptext="초기화" style="padding:0 0 0 0;"/>
                  <Button id="btn_search" taborder="2" onclick="btn_search_onclick" class="btn_WF_Search" position2="absolute r:79 w:72 t:11 h:20" positiontype="position2" tooltiptext="조회" style="padding:0 0 0 0;shadow:drop 0,0 0 transparent;"/>
                  <Static id="stc_03" class="sta_workSrcBg" position2="absolute l:0 r:0 b:3 h:37" positiontype="position2"/>
                  <Static id="stc_00" text="총대상건수" class="sta_workSrcLabel1" position2="absolute l:6 w:78 b:11 h:20" positiontype="position2"/>
                  <Static id="stc_04" text="모집수당" class="sta_workSrcLabel1" position2="absolute l:207 w:90 b:11 h:20" positiontype="position2"/>
                  <Edit id="edt_alow_cnt" taborder="3" inputtype="number" lengthunit="utf8" maxlength="20" onkillfocus="edt_cntr_rprs_tlno_onkillfocus" enable="false" position2="absolute l:75 w:110 b:11 h:20" positiontype="position2" style=":disabled {align:right middle;}"/>
                  <Edit id="edt_alow_amt" taborder="4" inputtype="number" lengthunit="utf8" maxlength="20" onkillfocus="edt_cntr_rprs_tlno_onkillfocus" enable="false" position2="absolute l:267 w:110 b:11 h:20" positiontype="position2" style=":disabled {align:right middle;}"/>
                  <Static id="stc_02" text="누진수당" class="sta_workSrcLabel1" position2="absolute l:399 w:105 b:11 h:20" positiontype="position2"/>
                  <Edit id="edt_alow_amt2" taborder="5" inputtype="number" lengthunit="utf8" maxlength="20" onkillfocus="edt_cntr_rprs_tlno_onkillfocus" enable="false" position2="absolute l:458 w:110 b:11 h:20" positiontype="position2" style=":disabled {align:right middle;}"/>
                  <Static id="stc_05" text="환수금" class="sta_workSrcLabel1" position2="absolute l:590 w:98 b:11 h:20" positiontype="position2"/>
                  <Edit id="edt_alow_amt3" taborder="6" inputtype="number" lengthunit="utf8" maxlength="20" onkillfocus="edt_cntr_rprs_tlno_onkillfocus" enable="false" position2="absolute l:642 w:110 b:11 h:20" positiontype="position2" style=":disabled {align:right middle;}"/>
                  <Static id="stc_06" text="수당합계" class="sta_workSrcLabel1" position2="absolute l:782 w:98 b:11 h:20" positiontype="position2"/>
                  <Edit id="edt_tot_alow_amt" taborder="7" inputtype="number" lengthunit="utf8" maxlength="20" onkillfocus="edt_cntr_rprs_tlno_onkillfocus" enable="false" position2="absolute l:842 w:110 b:11 h:20" positiontype="position2" style=":disabled {align:right middle;}"/>
                  <Button id="btn_excelExport" taborder="8" tabstop="false" text="엑셀" onclick="btn_excelExport_onclick" position2="absolute r:5 w:91 t:44 h:20" positiontype="position2" tooltiptext="엑셀"/>
                  <Grid id="grd_list" taborder="9" binddataset="ds_listMonthAlowList" useinputpanel="false" onvscrolllastover="grd_list_onvscrolllastover" onheadclick="grd_list_onheadclick" oncelldblclick="grd_list_oncelldblclick" position2="absolute l:0 r:0 t:67 b:44" positiontype="position2" cellsizingtype="col">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="122"/>
                          <Column size="140"/>
                          <Column size="143"/>
                          <Column size="140"/>
                          <Column size="140"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="NO"/>
                          <Cell col="1" text="수수료월" id="ALOW_DT"/>
                          <Cell col="2" text="담당자" id="EMP.EMPLE_NM"/>
                          <Cell col="3" text="부서" id="DEP.DEPT_NM"/>
                          <Cell col="4" text="모집수당" id="ALOW_AMT"/>
                          <Cell col="5" text="누진수당" id="ALOW_AMT2"/>
                          <Cell col="6" text="환수금액" id="ALOW_AMT3"/>
                          <Cell col="7" text="수당 - 환수금" id="(ALOW_AMT + ALOW_AMT2) - ALOW_AMT3"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="text" style="align:center middle;" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:center middle;" text="bind:alow_dt" mask="####-##"/>
                          <Cell col="2" style="align:center middle;" text="bind:emple_nm"/>
                          <Cell col="3" text="bind:dept_nm"/>
                          <Cell col="4" displaytype="number" style="align:right middle;" text="bind:alow_amt"/>
                          <Cell col="5" displaytype="number" style="align:right;" text="bind:alow_amt2"/>
                          <Cell col="6" displaytype="number" style="align:right middle;" text="bind:alow_amt3"/>
                          <Cell col="7" displaytype="number" style="align:right middle;" text="bind:alow_cal"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="stc_07" text="작업년월" class="sta_workSrcLabel1" position="absolute 8 11 65 31"/>
                  <Div id="div_monthCal" taborder="10" url="COMM::Div_monthCal.xfdl" style="border:0 solid #385d8aff ;" position="absolute 72 11 147 34"/>
                  <Static id="stc_08" text="분류" class="sta_workSrcLabel1" position="absolute 157 11 190 31" visible="false"/>
                  <Combo id="cbo_deptKind" taborder="11" displayrowcount="10" position="absolute 208 11 347 31" codecolumn="codecolumn" datacolumn="datacolumn" visible="false">
                    <Dataset id="innerdataset">
                      <ColumnInfo>
                        <Column id="codecolumn" size="256"/>
                        <Column id="datacolumn" size="256"/>
                      </ColumnInfo>
                      <Rows>
                        <Row>
                          <Col id="codecolumn"/>
                          <Col id="datacolumn">전체</Col>
                        </Row>
                        <Row>
                          <Col id="codecolumn">01</Col>
                          <Col id="datacolumn">일반영업</Col>
                        </Row>
                        <Row>
                          <Col id="codecolumn">02</Col>
                          <Col id="datacolumn">계열</Col>
                        </Row>
                      </Rows>
                    </Dataset>
                  </Combo>
                  <Static id="sta_totalCnt" text="검색결과   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt; / 전체   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt;" usedecorate="true" class="sta_workTitle5" position2="absolute l:6 w:236 t:44 h:20" positiontype="position2"/>
                  <Button id="btn_payClose" taborder="12" text="수당마감" onclick="btn_onclick" class="btn_WF_Common" position2="absolute r:-134 w:93 t:2 h:20" positiontype="position2" style="padding:0 0 0 0;" visible="false"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tab_Detail" text="상세데이터">
              <Layouts>
                <Layout>
                  <Static id="stc_01" class="sta_workSrcBg" position2="absolute l:0 r:0 t:0 h:41" positiontype="position2"/>
                  <Grid id="grd_list" taborder="0" binddataset="ds_AlowDetail" useinputpanel="false" onvscrolllastover="grd_list_onvscrolllastover" onheadclick="grd_list_onheadclick" oncelldblclick="grd_list_oncelldblclick" position2="absolute l:0 r:0 t:67 b:44" positiontype="position2" cellsizingtype="col">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="78"/>
                          <Column size="200"/>
                          <Column size="120"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="82"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="80"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="NO"/>
                          <Cell col="1" text="회원번호"/>
                          <Cell col="2" text="회원명"/>
                          <Cell col="3" text="가입일자"/>
                          <Cell col="4" text="접수일자"/>
                          <Cell col="5" text="해약등록일자"/>
                          <Cell col="6" text="해약처리일자"/>
                          <Cell col="7" text="행사일자"/>
                          <Cell col="8" text="상품명"/>
                          <Cell col="9" text="모델분류"/>
                          <Cell col="10" text="근거회차"/>
                          <Cell col="11" text="수수료/수당액"/>
                          <Cell col="12" text="수당항목"/>
                          <Cell col="13" text="수수료/수당구분"/>
                          <Cell col="14" text="산출자료1"/>
                          <Cell col="15" text="산출자료2"/>
                          <Cell col="16" text="사원번호"/>
                          <Cell col="17" text="분류"/>
                          <Cell col="18" text="최종납입회차"/>
                          <Cell col="19" text="최종납입일"/>
                          <Cell col="20" text="ID_NO"/>
                          <Cell col="21" text="주계약"/>
                          <Cell col="22" text="모집사원"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="text" style="align:center middle;" expr="currow+1"/>
                          <Cell col="1" style="align:center middle;" text="bind:accnt_no"/>
                          <Cell col="2" text="bind:mem_nm"/>
                          <Cell col="3" displaytype="date" text="bind:join_dt" calendardisplaynulltype="none"/>
                          <Cell col="4" displaytype="date" text="bind:reg_dm" calendardisplaynulltype="none"/>
                          <Cell col="5" displaytype="date" text="bind:resn_acpt_day" calendardisplaynulltype="none"/>
                          <Cell col="6" displaytype="date" text="bind:resn_proc_day" calendardisplaynulltype="none"/>
                          <Cell col="7" text="bind:event_proc_day"/>
                          <Cell col="8" style="align:left;" text="bind:prod_nm"/>
                          <Cell col="9" style="align:left middle;" text="bind:prod_model_kind" calendardisplaynulltype="default"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" text="bind:pay_no"/>
                          <Cell col="11" displaytype="number" style="align:right;" text="bind:alow_amt"/>
                          <Cell col="12" displaytype="combo" style="align:center middle;" text="bind:alow_bit" combodataset="ds_alow_bit" combocodecol="com_cd" combodatacol="com_nm"/>
                          <Cell col="13" displaytype="combo" style="align:center middle;" text="bind:alow_gubun" combodataset="ds_alow_gubun" combocodecol="com_cd" combodatacol="com_nm"/>
                          <Cell col="14" text="bind:etc_1"/>
                          <Cell col="15" text="bind:etc_2"/>
                          <Cell col="16" displaytype="text" edittype="readonly" text="bind:b2b_comp_cd"/>
                          <Cell col="17" text="bind:st_grp_nm"/>
                          <Cell col="18" displaytype="number" text="bind:true_cnt"/>
                          <Cell col="19" text="bind:true_day"/>
                          <Cell col="20" text="bind:id_no"/>
                          <Cell col="21" text="bind:main_contract_nm"/>
                          <Cell col="22" text="bind:bef_emple_nm"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="sta_totalCnt" text="검색결과   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt; / 전체   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt;" usedecorate="true" class="sta_workTitle5" position2="absolute l:6 w:286 t:44 h:20" positiontype="position2"/>
                  <Button id="btn_search" taborder="2" onclick="btn_search_onclick" class="btn_WF_Search" position2="absolute r:79 w:72 t:11 h:20" positiontype="position2" tooltiptext="조회" style="padding:0 0 0 0;shadow:drop 0,0 0 transparent;"/>
                  <Button id="btn_init" taborder="3" onclick="btn_init_onclick" class="btn_WF_Return" position2="absolute r:5 w:72 t:11 h:20" positiontype="position2" tooltiptext="초기화" style="padding:0 0 0 0;"/>
                  <Button id="btn_excelExport" taborder="4" tabstop="false" text="엑셀" onclick="btn_excelExport_onclick" position2="absolute r:5 w:91 t:44 h:20" positiontype="position2" tooltiptext="엑셀"/>
                  <Div id="div_monthCal" taborder="5" url="COMM::Div_monthCal.xfdl" style="border:0 solid #385d8aff ;" position="absolute 72 11 147 34"/>
                  <Static id="stc_07" text="작업년월" class="sta_workSrcLabel1" position="absolute 8 11 65 31"/>
                  <Edit id="edt_srch_accnt_no" taborder="6" inputmode="upper" inputfilter="dot,comma,sign,symbol" inputtype="numberandenglish" maxlength="12" position="absolute 229 11 358 32"/>
                  <Button id="btn_accntNo" taborder="7" class="btn_workSrcPop" position="absolute 359 11 379 31" onclick="tab_feeMain_tab_Detail_btn_accntNo_onclick"/>
                  <Static id="stc_24" text="회원번호" class="sta_workSrcLabel1" position="absolute 165 11 225 31"/>
                  <Button id="btn_insertAlow" taborder="8" tabstop="false" text="입력" position2="absolute r:101 w:91 t:44 h:20" positiontype="position2" tooltiptext="엑셀" onclick="btn_insertAlow_onclick"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tab_Detail2" text="상세데이터(비투)">
              <Layouts>
                <Layout>
                  <Static id="stc_01" class="sta_workSrcBg" position2="absolute l:0 r:0 t:0 h:41" positiontype="position2"/>
                  <Grid id="grd_list" taborder="1" binddataset="ds_AlowDetail2" useinputpanel="false" cellsizingtype="col" onvscrolllastover="grd_list_onvscrolllastover" onheadclick="grd_list_onheadclick" position2="absolute l:0 r:0 t:67 b:0" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="200"/>
                          <Column size="200"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="40"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="normal" text="기준년월"/>
                          <Cell col="1" displaytype="normal" text="회원번호" id="ABI.ACCNT_NO"/>
                          <Cell col="2" displaytype="normal" text="회원명" id="MB.MEM_NM"/>
                          <Cell col="3" displaytype="normal" text="가입일자" id="MPA.JOIN_DT"/>
                          <Cell col="4" displaytype="normal" text="해약종류" id="RS.RESN_CL"/>
                          <Cell col="5" displaytype="normal" text="해약등록일자" id="RS.RESN_ACPT_DAY"/>
                          <Cell col="6" displaytype="normal" text="해약처리일자" id="RS.RESN_PROC_DAY"/>
                          <Cell col="7" displaytype="normal" text="해약처리여부" id="RS.RESN_PROC_YN"/>
                          <Cell col="8" displaytype="normal" text="상품코드" id="MPA.PROD_CD"/>
                          <Cell col="9" displaytype="normal" text="상품명" id="PD.PROD_NM"/>
                          <Cell col="10" displaytype="normal" text="상품종류" id="PD.PROD_NM"/>
                          <Cell col="11" displaytype="normal" text="수당회차" id="ALOW_NO"/>
                          <Cell col="12" displaytype="normal" text="영업수단코드" id="B2B.SALE_TYPE"/>
                          <Cell col="13" displaytype="normal" text="그룹명" id="B2B.SALE_TYPE"/>
                          <Cell col="14" displaytype="normal" text="수당금액" id="AMT"/>
                          <Cell col="15" displaytype="normal" text="수당코드" id="AMT"/>
                          <Cell col="16" displaytype="normal" text="수당구분" id="AMT"/>
                          <Cell col="17" displaytype="normal" text="기타1" id="B2B.SALE_TYPE"/>
                          <Cell col="18" displaytype="normal" text="기타2" id="B2B.SALE_TYPE"/>
                          <Cell col="19" displaytype="normal" text="납입회차" id="TRUE_CNT"/>
                          <Cell col="20" displaytype="normal" text="납입일자" id="TRUE_DAY"/>
                          <Cell col="21" displaytype="normal" text="식별ID번호" id="B2B.SALE_TYPE"/>
                          <Cell col="22"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="normal" text="bind:yyyymm" calendardisplaynulltype="none"/>
                          <Cell col="1" displaytype="normal" text="bind:accnt_no"/>
                          <Cell col="2" displaytype="normal" text="bind:mem_nm"/>
                          <Cell col="3" displaytype="date" text="bind:join_dt" calendardisplaynulltype="none"/>
                          <Cell col="4" displaytype="normal" text="bind:resn_cl"/>
                          <Cell col="5" displaytype="date" text="bind:resn_acpt_day" calendardisplaynulltype="none"/>
                          <Cell col="6" displaytype="date" text="bind:resn_proc_day" calendardisplaynulltype="none"/>
                          <Cell col="7" text="bind:resn_proc_yn"/>
                          <Cell col="8" displaytype="normal" text="bind:prod_cd"/>
                          <Cell col="9" displaytype="normal" style="align:left middle;" text="bind:prod_nm"/>
                          <Cell col="10" displaytype="normal" style="align:left middle;" text="bind:prod_model_kind"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" text="bind:alow_no"/>
                          <Cell col="12" displaytype="normal" text="bind:sale_type"/>
                          <Cell col="13" displaytype="normal" text="bind:st_grp_nm"/>
                          <Cell col="14" displaytype="number" style="align:right middle;" text="bind:alow_amt"/>
                          <Cell col="15" displaytype="normal" text="bind:alow_bit"/>
                          <Cell col="16" displaytype="normal" text="bind:alow_gubun"/>
                          <Cell col="17" displaytype="normal" style="align:left middle;" text="bind:etc_1"/>
                          <Cell col="18" displaytype="normal" style="align:left middle;" text="bind:etc_2"/>
                          <Cell col="19" displaytype="number" style="align:right middle;" text="bind:true_cnt"/>
                          <Cell col="20" displaytype="date" text="bind:true_day" calendardisplaynulltype="none"/>
                          <Cell col="21" displaytype="normal" text="bind:id_no"/>
                          <Cell col="22"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="sta_totalCnt" text="검색결과   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt; / 전체   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt;" usedecorate="true" class="sta_workTitle5" position2="absolute l:6 w:286 t:44 h:20" positiontype="position2"/>
                  <Button id="btn_search" taborder="2" onclick="btn_search_onclick" class="btn_WF_Search" position2="absolute r:79 w:72 t:11 h:20" positiontype="position2" tooltiptext="조회" style="padding:0 0 0 0;shadow:drop 0,0 0 transparent;"/>
                  <Button id="btn_init" taborder="3" onclick="btn_init_onclick" class="btn_WF_Return" position2="absolute r:5 w:72 t:11 h:20" positiontype="position2" tooltiptext="초기화" style="padding:0 0 0 0;"/>
                  <Button id="btn_excelExport" taborder="4" tabstop="false" text="엑셀" onclick="btn_excelExport_onclick" position2="absolute r:5 w:91 t:44 h:20" positiontype="position2" tooltiptext="엑셀"/>
                  <Div id="div_monthCal" taborder="5" url="COMM::Div_monthCal.xfdl" style="border:0 solid #385d8aff ;" position="absolute 72 11 147 34"/>
                  <Static id="stc_07" text="작업년월" class="sta_workSrcLabel1" position="absolute 8 11 65 31"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Button id="btn_pop" taborder="62" tabstop="false" text="배치일자설정" position2="absolute r:-131 w:91 t:12 h:20" positiontype="position2" tooltiptext="엑셀" onclick="btn_pop_onclick" visible="false"/>
        <Grid id="grd_listA" taborder="63" binddataset="ds_listMonthAlowList" useinputpanel="false" onvscrolllastover="grd_list_onvscrolllastover" onheadclick="grd_list_onheadclick" oncelldblclick="grd_list_oncelldblclick" position2="absolute l:410 r:453 t:12 b:763" positiontype="position2" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="80"/>
                <Column size="140"/>
                <Column size="122"/>
                <Column size="140"/>
                <Column size="143"/>
                <Column size="140"/>
                <Column size="140"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="NO"/>
                <Cell col="1" text="수수료월" id="ALOW_DT"/>
                <Cell col="2" text="담당자" id="EMP.EMPLE_NM"/>
                <Cell col="3" text="부서" id="DEP.DEPT_NM"/>
                <Cell col="4" text="모집수당" id="ALOW_AMT"/>
                <Cell col="5" text="누진수당" id="ALOW_AMT2"/>
                <Cell col="6" text="환수금액" id="ALOW_AMT3"/>
                <Cell col="7" text="수당 - 환수금" id="(ALOW_AMT + ALOW_AMT2) - ALOW_AMT3"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center middle;" expr="currow+1"/>
                <Cell col="1" displaytype="text" style="align:center middle;" text="bind:alow_dt" mask="####-##"/>
                <Cell col="2" style="align:center middle;" text="bind:emple_nm"/>
                <Cell col="3" text="bind:dept_nm"/>
                <Cell col="4" displaytype="number" style="align:right middle;" text="bind:alow_amt"/>
                <Cell col="5" displaytype="number" style="align:right;" text="bind:alow_amt2"/>
                <Cell col="6" displaytype="number" style="align:right middle;" text="bind:alow_amt3"/>
                <Cell col="7" displaytype="number" style="align:right middle;" text="bind:alow_cal"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="grd_excel" taborder="64" binddataset="ds_AlowDetail" useinputpanel="false" cellsizingtype="col" onvscrolllastover="grd_list_onvscrolllastover" onheadclick="grd_list_onheadclick" oncelldblclick="grd_list_oncelldblclick" position2="absolute l:0 r:0 t:808 b:-169" positiontype="position2" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="78"/>
                <Column size="200"/>
                <Column size="120"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="82"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="NO"/>
                <Cell col="1" text="회원번호"/>
                <Cell col="2" text="회원명"/>
                <Cell col="3" text="가입일자"/>
                <Cell col="4" text="접수일자"/>
                <Cell col="5" text="해약등록일자"/>
                <Cell col="6" text="해약처리일자"/>
                <Cell col="7" text="행사일자"/>
                <Cell col="8" text="상품명"/>
                <Cell col="9" text="모델분류"/>
                <Cell col="10" text="근거회차"/>
                <Cell col="11" text="수수료/수당액"/>
                <Cell col="12" text="수당항목"/>
                <Cell col="13" text="수수료/수당구분"/>
                <Cell col="14" text="산출자료1"/>
                <Cell col="15" text="산출자료2"/>
                <Cell col="16" text="사원번호"/>
                <Cell col="17" text="분류"/>
                <Cell col="18" text="최종납입회차"/>
                <Cell col="19" text="최종납입일"/>
                <Cell col="20" text="ID_NO"/>
                <Cell col="21" text="주계약"/>
                <Cell col="22" text="모집사원"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center middle;" expr="currow+1"/>
                <Cell col="1" style="align:center middle;" text="bind:accnt_no"/>
                <Cell col="2" text="bind:mem_nm"/>
                <Cell col="3" displaytype="date" text="bind:join_dt" calendardisplaynulltype="none"/>
                <Cell col="4" displaytype="date" text="bind:reg_dm" calendardisplaynulltype="none"/>
                <Cell col="5" displaytype="date" text="bind:resn_acpt_day" calendardisplaynulltype="none"/>
                <Cell col="6" displaytype="date" text="bind:resn_proc_day" calendardisplaynulltype="none"/>
                <Cell col="7" text="bind:event_proc_day"/>
                <Cell col="8" style="align:left;" text="bind:prod_nm"/>
                <Cell col="9" style="align:left middle;" text="bind:prod_model_kind" calendardisplaynulltype="default"/>
                <Cell col="10" displaytype="number" style="align:right middle;" text="bind:pay_no"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:alow_amt"/>
                <Cell col="12" displaytype="combo" style="align:center middle;" text="bind:alow_bit" combodataset="ds_alow_bit" combocodecol="com_cd" combodatacol="com_nm"/>
                <Cell col="13" displaytype="combo" style="align:center middle;" text="bind:alow_gubun" combodataset="ds_alow_gubun" combocodecol="com_cd" combodatacol="com_nm"/>
                <Cell col="14" text="bind:etc_1"/>
                <Cell col="15" text="bind:etc_2"/>
                <Cell col="16" displaytype="text" edittype="readonly" text="bind:b2b_comp_cd"/>
                <Cell col="17" text="bind:st_grp_nm"/>
                <Cell col="18" displaytype="number" text="bind:true_cnt"/>
                <Cell col="19" text="bind:true_day"/>
                <Cell col="20" text="bind:id_no"/>
                <Cell col="21" text="bind:main_contract_nm"/>
                <Cell col="22" text="bind:bef_emple_nm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="grd_listB" taborder="65" binddataset="ds_AlowDetail2" useinputpanel="false" onvscrolllastover="grd_list_onvscrolllastover" onheadclick="grd_list_onheadclick" oncelldblclick="grd_list_oncelldblclick" visible="false" position2="absolute l:538 r:325 t:12 b:763" positiontype="position2">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="200"/>
                <Column size="200"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="40"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="normal" text="기준년월"/>
                <Cell col="1" displaytype="normal" text="회원번호" id="ABI.ACCNT_NO"/>
                <Cell col="2" displaytype="normal" text="회원명" id="MB.MEM_NM"/>
                <Cell col="3" displaytype="normal" text="가입일자" id="MPA.JOIN_DT"/>
                <Cell col="4" displaytype="normal" text="해약종류" id="RS.RESN_CL"/>
                <Cell col="5" displaytype="normal" text="해약등록일자" id="RS.RESN_ACPT_DAY"/>
                <Cell col="6" displaytype="normal" text="해약처리일자" id="RS.RESN_PROC_DAY"/>
                <Cell col="7" displaytype="normal" text="해약처리여부" id="RS.RESN_PROC_YN"/>
                <Cell col="8" displaytype="normal" text="상품코드" id="MPA.PROD_CD"/>
                <Cell col="9" displaytype="normal" text="상품명" id="PD.PROD_NM"/>
                <Cell col="10" displaytype="normal" text="상품종류" id="PD.PROD_NM"/>
                <Cell col="11" displaytype="normal" text="수당회차" id="ALOW_NO"/>
                <Cell col="12" displaytype="normal" text="영업수단코드" id="B2B.SALE_TYPE"/>
                <Cell col="13" displaytype="normal" text="그룹명" id="B2B.SALE_TYPE"/>
                <Cell col="14" displaytype="normal" text="수당금액" id="AMT"/>
                <Cell col="15" displaytype="normal" text="수당코드" id="AMT"/>
                <Cell col="16" displaytype="normal" text="수당구분" id="AMT"/>
                <Cell col="17" displaytype="normal" text="기타1" id="B2B.SALE_TYPE"/>
                <Cell col="18" displaytype="normal" text="기타2" id="B2B.SALE_TYPE"/>
                <Cell col="19" displaytype="normal" text="납입회차" id="TRUE_CNT"/>
                <Cell col="20" displaytype="normal" text="납입일자" id="TRUE_DAY"/>
                <Cell col="21" displaytype="normal" text="식별ID번호" id="B2B.SALE_TYPE"/>
                <Cell col="22"/>
              </Band>
              <Band id="body">
                <Cell displaytype="normal" text="bind:yyyymm" calendardisplaynulltype="none"/>
                <Cell col="1" displaytype="normal" text="bind:accnt_no"/>
                <Cell col="2" displaytype="normal" text="bind:mem_nm"/>
                <Cell col="3" displaytype="date" text="bind:join_dt" calendardisplaynulltype="none"/>
                <Cell col="4" displaytype="normal" text="bind:resn_cl"/>
                <Cell col="5" displaytype="date" text="bind:resn_acpt_day" calendardisplaynulltype="none"/>
                <Cell col="6" displaytype="date" text="bind:resn_proc_day" calendardisplaynulltype="none"/>
                <Cell col="7" text="bind:resn_proc_yn"/>
                <Cell col="8" displaytype="normal" text="bind:prod_cd"/>
                <Cell col="9" displaytype="normal" style="align:left middle;" text="bind:prod_nm"/>
                <Cell col="10" displaytype="normal" style="align:left middle;" text="bind:prod_model_kind"/>
                <Cell col="11" displaytype="number" style="align:right middle;" text="bind:alow_no"/>
                <Cell col="12" displaytype="normal" text="bind:sale_type"/>
                <Cell col="13" displaytype="normal" text="bind:st_grp_nm"/>
                <Cell col="14" displaytype="number" style="align:right middle;" text="bind:alow_amt"/>
                <Cell col="15" displaytype="normal" text="bind:alow_bit"/>
                <Cell col="16" displaytype="normal" text="bind:alow_gubun"/>
                <Cell col="17" displaytype="normal" style="align:left middle;" text="bind:etc_1"/>
                <Cell col="18" displaytype="normal" style="align:left middle;" text="bind:etc_2"/>
                <Cell col="19" displaytype="number" style="align:right middle;" text="bind:true_cnt"/>
                <Cell col="20" displaytype="date" text="bind:true_day" calendardisplaynulltype="none"/>
                <Cell col="21" displaytype="normal" text="bind:id_no"/>
                <Cell col="22"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_calc" taborder="66" tabstop="false" text="수당,수수료산출" onclick="tab_feeMain_tab_feeCalculation_btn_calc_onclick" position2="absolute r:109 w:100 t:12 h:20" positiontype="position2" tooltiptext="엑셀"/>
        <Button id="btn_payClose" taborder="67" text="수당,수수료마감" onclick="btn_onclick" class="btn_WF_Common" position2="absolute r:6 w:100 t:12 h:20" positiontype="position2" style="padding:0 0 0 0;"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="div_Work.msk_FromDate" propid="value" datasetid="ds_Date" columnid="SDate"/>
      <BindItem id="item2" compid="div_Work.msk_ToDate" propid="value" datasetid="ds_Date" columnid="EDate"/>
    </Bind>
    <Objects>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndtAlowBasicInfo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="alow_dt" type="STRING" size="256"/>
          <Column id="st_grp_cd" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listAlowBasicInfo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="alow_dt" type="STRING" size="256"/>
          <Column id="st_grp_cd" type="STRING" size="256"/>
          <Column id="grp_nm" type="STRING" size="256"/>
          <Column id="alow_amt" type="BIGDECIMAL" size="256"/>
          <Column id="resnredmpamt" type="BIGDECIMAL" size="256"/>
          <Column id="real_amt" type="STRING" size="256"/>
          <Column id="true_amt" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listAlowBasicInfoSummary" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="alow_cnt" type="STRING" size="256"/>
          <Column id="alow_amt" type="STRING" size="256"/>
          <Column id="alow_amt2" type="STRING" size="256"/>
          <Column id="alow_amt3" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_codeGrpCd" reversesubsum="false" useclientlayout="false" enableevent="true" firenextcount="0" loadfiltermode="keep" loadkeymode="keep" firefirstcount="0" updatecontrol="true">
        <ColumnInfo>
          <Column id="com_cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="alow_dt" type="STRING" size="256"/>
          <Column id="tab_id" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndtMonthAlowList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="alow_dt" type="STRING" size="256"/>
          <Column id="dept_kind" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listMonthAlowList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="alow_dt" type="STRING" size="256"/>
          <Column id="emple_no" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="alow_amt" type="BIGDECIMAL" size="256"/>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="alow_amt2" type="BIGDECIMAL" size="256"/>
          <Column id="alow_amt3" type="BIGDECIMAL" size="256"/>
          <Column id="alow_sum" type="BIGDECIMAL" size="256"/>
          <Column id="alow_cal" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listMonthAlowListTemp" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="alow_dt" type="STRING" size="256"/>
          <Column id="emple_no" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="alow_amt" type="BIGDECIMAL" size="256"/>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="alow_amt2" type="BIGDECIMAL" size="256"/>
          <Column id="alow_amt3" type="BIGDECIMAL" size="256"/>
          <Column id="alow_sum" type="BIGDECIMAL" size="256"/>
          <Column id="alow_cal" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listMonthAlowListSummary" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="alow_cnt" type="STRING" size="256"/>
          <Column id="alow_amt" type="STRING" size="256"/>
          <Column id="alow_amt2" type="STRING" size="256"/>
          <Column id="alow_amt3" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_AlowDetailTemp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="alow_dt" type="STRING" size="256"/>
          <Column id="emple_no" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="alow_amt" type="BIGDECIMAL" size="256"/>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="resn_acpt_day" type="STRING" size="256"/>
          <Column id="resn_proc_day" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="prod_model_kind" type="STRING" size="256"/>
          <Column id="alow_bit" type="STRING" size="256"/>
          <Column id="alow_gubun" type="STRING" size="256"/>
          <Column id="etc_1" type="STRING" size="256"/>
          <Column id="etc_2" type="STRING" size="256"/>
          <Column id="pay_no" type="STRING" size="256"/>
          <Column id="st_grp_nm" type="STRING" size="256"/>
          <Column id="true_cnt" type="BIGDECIMAL" size="256"/>
          <Column id="id_no" type="STRING" size="256"/>
          <Column id="true_day" type="STRING" size="256"/>
          <Column id="event_proc_day" type="STRING" size="256"/>
          <Column id="main_contract_nm" type="STRING" size="256"/>
          <Column id="reg_dm" type="STRING" size="256"/>
          <Column id="bef_emple_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_AlowDetail" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="alow_dt" type="STRING" size="256"/>
          <Column id="emple_no" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="alow_amt" type="BIGDECIMAL" size="256"/>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="resn_acpt_day" type="STRING" size="256"/>
          <Column id="resn_proc_day" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="prod_model_kind" type="STRING" size="256"/>
          <Column id="alow_bit" type="STRING" size="256"/>
          <Column id="alow_gubun" type="STRING" size="256"/>
          <Column id="etc_1" type="STRING" size="256"/>
          <Column id="etc_2" type="STRING" size="256"/>
          <Column id="pay_no" type="STRING" size="256"/>
          <Column id="st_grp_nm" type="STRING" size="256"/>
          <Column id="true_cnt" type="BIGDECIMAL" size="256"/>
          <Column id="id_no" type="STRING" size="256"/>
          <Column id="true_day" type="STRING" size="256"/>
          <Column id="event_proc_day" type="STRING" size="256"/>
          <Column id="main_contract_nm" type="STRING" size="256"/>
          <Column id="reg_dm" type="STRING" size="256"/>
          <Column id="bef_emple_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_alow_bit" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="com_cd" type="STRING" size="256"/>
          <Column id="com_nm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="com_cd">T21</Col>
            <Col id="com_nm">모집수당</Col>
          </Row>
          <Row>
            <Col id="com_cd">T32</Col>
            <Col id="com_nm">누진수당</Col>
          </Row>
          <Row>
            <Col id="com_cd">F7A</Col>
            <Col id="com_nm">모집환수(철회)</Col>
          </Row>
          <Row>
            <Col id="com_cd">F7B</Col>
            <Col id="com_nm">모집환수(해약)</Col>
          </Row>
          <Row>
            <Col id="com_cd">F12</Col>
            <Col id="com_nm">이월환수</Col>
          </Row>
          <Row>
            <Col id="com_cd">T33A</Col>
            <Col id="com_nm">알선수수료</Col>
          </Row>
          <Row>
            <Col id="com_cd">T33B</Col>
            <Col id="com_nm">삼디프수수료</Col>
          </Row>
          <Row>
            <Col id="com_cd">F8A</Col>
            <Col id="com_nm">수수료환수(철회)</Col>
          </Row>
          <Row>
            <Col id="com_cd">F8B</Col>
            <Col id="com_nm">수수료환수(해약)</Col>
          </Row>
          <Row>
            <Col id="com_cd">F10</Col>
            <Col id="com_nm">수수료환수(연체)</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_alow_gubun" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="com_cd" type="STRING" size="256"/>
          <Column id="com_nm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="com_cd">ALOW</Col>
            <Col id="com_nm">수당</Col>
          </Row>
          <Row>
            <Col id="com_cd">COMM</Col>
            <Col id="com_nm">수수료</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_accnt_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="page_indx" type="STRING" size="6"/>
          <Column id="accnt_no" type="STRING" size="100"/>
          <Column id="mem_no" type="STRING" size="100"/>
          <Column id="mem_nm" type="STRING" size="100"/>
          <Column id="home_tel" type="STRING" size="100"/>
          <Column id="cell" type="STRING" size="100"/>
          <Column id="wrpl_tel" type="STRING" size="100"/>
          <Column id="idn_no" type="STRING" size="100"/>
          <Column id="prod_cd" type="STRING" size="100"/>
          <Column id="prod_nm" type="STRING" size="100"/>
          <Column id="prod_amt" type="STRING" size="100"/>
          <Column id="mon_pay_amt" type="STRING" size="100"/>
          <Column id="expr_no" type="STRING" size="100"/>
          <Column id="emple_no" type="STRING" size="100"/>
          <Column id="emple_nm" type="STRING" size="100"/>
          <Column id="appfm_no" type="STRING" size="100"/>
          <Column id="join_dt" type="STRING" size="100"/>
          <Column id="compt_dt" type="STRING" size="100"/>
          <Column id="bef_emple_cd" type="STRING" size="100"/>
          <Column id="pay_perd" type="STRING" size="100"/>
          <Column id="pay_mthd" type="STRING" size="100"/>
          <Column id="join_prod" type="STRING" size="100"/>
          <Column id="new_chan_gunsu" type="STRING" size="100"/>
          <Column id="certf_rcv_chk" type="STRING" size="100"/>
          <Column id="pay_stat_1no" type="STRING" size="100"/>
          <Column id="ichae_dt" type="STRING" size="100"/>
          <Column id="bank_accnt_no" type="STRING" size="100"/>
          <Column id="old_mid" type="STRING" size="100"/>
          <Column id="reg_dm" type="STRING" size="100"/>
          <Column id="reg_man" type="STRING" size="100"/>
          <Column id="upd_dm" type="STRING" size="100"/>
          <Column id="upd_man" type="STRING" size="100"/>
          <Column id="accnt_stat" type="STRING" size="100"/>
          <Column id="total_pay" type="STRING" size="100"/>
          <Column id="last_no" type="STRING" size="100"/>
          <Column id="real_pay_no" type="STRING" size="100"/>
          <Column id="ded_no" type="STRING" size="100"/>
          <Column id="join_cl" type="STRING" size="100"/>
          <Column id="trans_gubun" type="STRING" size="100"/>
          <Column id="brth_mon_day" type="STRING" size="100"/>
          <Column id="pay_mthd" type="STRING" size="100"/>
          <Column id="emp_cell" type="STRING" size="100"/>
          <Column id="join_stat" type="STRING" size="100"/>
          <Column id="pay_stat" type="STRING" size="100"/>
          <Column id="pay_no" type="STRING" size="100"/>
          <Column id="pay_allt_no" type="STRING" size="100"/>
          <Column id="pay_add_no" type="STRING" size="100"/>
          <Column id="pay_amt" type="STRING" size="100"/>
          <Column id="pay_allt_amt" type="STRING" size="100"/>
          <Column id="pay_add_amt" type="STRING" size="100"/>
          <Column id="model_cl_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndtAlowDetail2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="alow_dt" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_AlowDetail2Temp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="yyyymm" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="resn_cl" type="STRING" size="256"/>
          <Column id="resn_acpt_day" type="STRING" size="256"/>
          <Column id="resn_proc_day" type="STRING" size="256"/>
          <Column id="resn_proc_yn" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="prod_model_kind" type="STRING" size="256"/>
          <Column id="alow_no" type="STRING" size="256"/>
          <Column id="sale_type" type="STRING" size="256"/>
          <Column id="st_grp_nm" type="STRING" size="256"/>
          <Column id="alow_amt" type="STRING" size="256"/>
          <Column id="alow_bit" type="STRING" size="256"/>
          <Column id="alow_gubun" type="STRING" size="256"/>
          <Column id="etc_1" type="STRING" size="256"/>
          <Column id="etc_2" type="STRING" size="256"/>
          <Column id="true_cnt" type="STRING" size="256"/>
          <Column id="true_day" type="STRING" size="256"/>
          <Column id="id_no" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_AlowDetail2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="yyyymm" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="resn_cl" type="STRING" size="256"/>
          <Column id="resn_acpt_day" type="STRING" size="256"/>
          <Column id="resn_proc_day" type="STRING" size="256"/>
          <Column id="resn_proc_yn" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="prod_model_kind" type="STRING" size="256"/>
          <Column id="alow_no" type="STRING" size="256"/>
          <Column id="sale_type" type="STRING" size="256"/>
          <Column id="st_grp_nm" type="STRING" size="256"/>
          <Column id="alow_amt" type="STRING" size="256"/>
          <Column id="alow_bit" type="STRING" size="256"/>
          <Column id="alow_gubun" type="STRING" size="256"/>
          <Column id="etc_1" type="STRING" size="256"/>
          <Column id="etc_2" type="STRING" size="256"/>
          <Column id="true_cnt" type="STRING" size="256"/>
          <Column id="true_day" type="STRING" size="256"/>
          <Column id="id_no" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/********************************************************************************************/
/* 1. Include Library include, variables Declaration 영역                                  */
/********************************************************************************************/
include "LIB::lib_All.xjs";
include "LIB::lib_TeamUser.xjs";

//var nTotalListCnt = 0; // 문자발송이력 전체건수
var nTotalListCnt = 0;
var nTotalListCnt1 = 0; // 전체건수(** 상세데이터 탭)
var nTotalListCnt2 = 0; // 전체건수(** 상세데이터2 탭)
var intCloseCnt = 0;
var nBatchSuccessCode = 0;

var gvMenuId;  // 프로그램 로그 추가 2017.12.14
/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리                                           	*/
/********************************************************************************************/
function DL471200_onload(obj:Form, e:LoadEventInfo)
{
	gfn_initForm(obj);
	gfn_createPagingDataset(obj);
	fn_init();
}

/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
function fn_callBack(svcid, errcd, errmsg)
{
	if (errcd != 0)
	{
		return false;
	}

	switch (svcid)
	{
		case "selectStGrpCdList" :
			fn_postSearch("selectStGrpCdList");
		break;

		case "getAlowBasicInfo" :
			fn_postSearch("getAlowBasicInfo");
		break;

		case "getMonthAlowList" :
			gfn_appendSearchDs(ds_listMonthAlowList, ds_listMonthAlowListTemp);
			gfn_setTotalRowCount(ds_listMonthAlowList, tab_feeMain.tab_b2bFee.sta_totalCnt, nTotalListCnt, null, true, null);

			fn_postSearch("getMonthAlowList");
		break;

		case "getAlowDetail" :
			gfn_appendSearchDs(ds_AlowDetail, ds_AlowDetailTemp);
			gfn_setTotalRowCount(ds_AlowDetail, tab_feeMain.tab_Detail.sta_totalCnt, nTotalListCnt1, null, true, null);
			
			fn_postSearch("getAlowDetail");
		break;

		case "getAlowDetail_excel" :		
			var colDS = gfn_excelPrepareExcelDS("grd_excel");
			gfn_excelDown("수당수수료 산출 데이터", "XLS_DLCC", "DlwPayMap.getAlowDetailList", "DlwPayMap.getAlowDetailCount", ds_inqCndtAlowBasicInfo, true, colDS, true);
		break;

		case "insertAlowBasicInfo" :
			alert("수수료 / 수당 산출이 완료되었습니다.");
		break;

		case "insertSetClose" :
			trace(intCloseCnt);

			if (intCloseCnt > 0){
				alert("해당월은 마감이 완료 되었습니다.");
			} else {
				alert("정상적으로 처리 하였습니다.");
			}
		break;
		
		case "getAlowDetail2" : 
			gfn_appendSearchDs(ds_AlowDetail2, ds_AlowDetail2Temp);
			gfn_setTotalRowCount(ds_AlowDetail2, tab_feeMain.tab_Detail2.sta_totalCnt, nTotalListCnt2, null, true, null);
			
			fn_postSearch("getAlowDetail2");
		break;
	}
}

/********************************************************************************************/
/**   4. Validation 처리                                                                   	*/
/********************************************************************************************/
// 조회 체크
function fn_preSearch(sType, sSvcId)
{
	if (gfn_isNull(sSvcId) == true)
	{
	    alert("서비스명이 올바르지 않습니다.");
	}

	switch(sSvcId)
	{
		case "selectStGrpCdList" :
			ds_inqCndtAlowBasicInfo.clearData();
			ds_inqCndtAlowBasicInfo.addRow();
		break;

		case "getAlowBasicInfo" :
			var sAlowDt = tab_feeMain.tab_feeCalculation.div_monthCal.getDate();
			var sStGrpCd = tab_feeMain.tab_feeCalculation.cbo_stGrpCd.value;

			if(gfn_isNull(sAlowDt) == true)
			{
				alert("작업년월을 정확하게 입력하여 주십시오.");
				return false;
			}

			ds_inqCndtAlowBasicInfo.clearData();
			var nRow = ds_inqCndtAlowBasicInfo.addRow();

			ds_inqCndtAlowBasicInfo.setColumn(nRow, "alow_dt", sAlowDt);
			ds_inqCndtAlowBasicInfo.setColumn(nRow, "st_grp_cd", sStGrpCd);
		break;

		case "getMonthAlowList" :
			var sAlowDt = tab_feeMain.tab_b2bFee.div_monthCal.getDate();
			var sDeptKind = tab_feeMain.tab_b2bFee.cbo_deptKind.value;

			if(gfn_isNull(sAlowDt) == true)
			{
				alert("작업년월을 정확하게 입력하여 주십시오.");
				return false;
			}

			ds_inqCndtMonthAlowList.clearData();
			var nRow = ds_inqCndtMonthAlowList.addRow();

			ds_inqCndtMonthAlowList.setColumn(nRow, "alow_dt", sAlowDt);
			ds_inqCndtMonthAlowList.setColumn(nRow, "dept_kind", sDeptKind);

			ds_inqCndtMonthAlowList.setColumn(nRow, "orderBy", "ALOW_DT");
			ds_inqCndtMonthAlowList.setColumn(nRow, "orderDirection", "ASC");
		break;


		case "getAlowDetail" :
			var sAlowDt = tab_feeMain.tab_Detail.div_monthCal.getDate();
			var sAccntNo = tab_feeMain.tab_Detail.edt_srch_accnt_no.value;

			if(gfn_isNull(sAlowDt) == true) {
				alert("작업년월을 정확하게 입력하여 주십시오.");
				return false;
			}

			ds_inqCndtAlowBasicInfo.clearData();
			var nRow = ds_inqCndtAlowBasicInfo.addRow();
			ds_inqCndtAlowBasicInfo.setColumn(nRow, "alow_dt", sAlowDt);
			ds_inqCndtAlowBasicInfo.setColumn(nRow, "accnt_no", sAccntNo);

		break;

		case "getAlowDetail_excel" :
			var sAlowDt = tab_feeMain.tab_Detail.div_monthCal.getDate();
			var sAccntNo = tab_feeMain.tab_Detail.edt_srch_accnt_no.value;

			if(gfn_isNull(sAlowDt) == true)			{
				alert("작업년월을 정확하게 입력하여 주십시오.");
				return false;
			}

			ds_inqCndtAlowBasicInfo.clearData();
			var nRow = ds_inqCndtAlowBasicInfo.addRow();
			ds_inqCndtAlowBasicInfo.setColumn(nRow, "alow_dt", sAlowDt);
			ds_inqCndtAlowBasicInfo.setColumn(nRow, "accnt_no", sAccntNo);

		break;
		
		case "getAlowDetail2" : 
			var sAlowDt = tab_feeMain.tab_Detail2.div_monthCal.getDate();
			
			if(gfn_isNull(sAlowDt) == true)
			{
				alert("작업년월을 정확하게 입력하여 주십시오.");
				return false;
			}
			
			ds_inqCndtAlowDetail2.clearData();
			var nRow = ds_inqCndtAlowDetail2.addRow();
			ds_inqCndtAlowDetail2.setColumn(nRow, "alow_dt", sAlowDt);
			
			ds_inqCndtAlowDetail2.setColumn(nRow, "orderBy", "ABI.ACCNT_NO");
			ds_inqCndtAlowDetail2.setColumn(nRow, "orderDirection", "ASC");
		break;
	}

	return true;
}

/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)                                                   	*/
/********************************************************************************************/
// 문자발송이력 조회
function fn_commSearch(sType, sSvcId)
{
	if (fn_preSearch(sType, sSvcId) == false) {
		return false;
	}

	var szParam       = "";
	var szRetCallback = "fn_callBack";

	switch (sSvcId) {
		case "selectStGrpCdList" :
			var szSvcid       = "selectStGrpCdList";
			var szController  = "/common/selectStGrpCdList";
			var szInDs        = "ds_input=ds_inqCndtAlowBasicInfo";
			var szOutDs       = "ds_codeGrpCd=ds_output";
		break;

		case "getAlowBasicInfo" :
			var szSvcid       = "getAlowBasicInfo";
			var szController  = "/dlw/pay/fee/getAlowBasicInfo";
			var szInDs        = "ds_input=ds_inqCndtAlowBasicInfo";
			var szOutDs       = "ds_listAlowBasicInfo=ds_output1 ds_listAlowBasicInfoSummary=ds_output2";
		break;

		case "getMonthAlowList" :
			if(!gfn_pageSearch(sType, ds_listMonthAlowList, tab_feeMain.tab_b2bFee.sta_totalCnt, 500, nTotalListCnt)) return;

			var szSvcid       = "getMonthAlowList";
			var szController  = "/dlw/pay/fee/getMonthAlowList";
			var szInDs        = "ds_input=ds_inqCndtMonthAlowList";
			var szOutDs       = "ds_listMonthAlowListTemp=ds_output1 ds_listMonthAlowListSummary=ds_output2";
		break;

		case "getAlowDetail" :
			if(!gfn_pageSearch(sType, ds_AlowDetail, tab_feeMain.tab_Detail.sta_totalCnt, 50, nTotalListCnt1)) return;

			var szSvcid       = "getAlowDetail";
			var szController  = "/dlw/pay/fee/getAlowDetailList";
			var szInDs        = "ds_input=ds_inqCndtAlowBasicInfo";
			var szOutDs       = "ds_AlowDetailTemp=ds_output1";
		break;

		case "getAlowDetail_excel" :
			var szSvcid       = "getAlowDetail_excel";
			var szController  = "/dlw/pay/fee/getAlowDetailList";
			var szParam       = "excel_fg=Y";
			var szInDs        = "ds_input=ds_inqCndtAlowBasicInfo";
			var szOutDs       = "ds_AlowDetail=ds_output1";
		break;
		
		case "getAlowDetail2" :
			if(!gfn_pageSearch(sType, ds_AlowDetail2, tab_feeMain.tab_Detail2.sta_totalCnt, 500, nTotalListCnt2)) return;
			
			var szSvcid       = "getAlowDetail2";
			var szController  = "/dlw/pay/fee/getAlowDetail2";
			var szInDs        = "ds_input=ds_inqCndtAlowDetail2";
			var szOutDs       = "ds_AlowDetail2Temp=ds_output1";
		break; 
	}

	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

/********************************************************************************************/
/**   6. 사용자 함수                                                                   	*/
/********************************************************************************************/
// 초기화
function fn_init()
{
	switch(tab_feeMain.getStepIndex){
		case 0 :
		break;
	}

	fn_commSearch(gfn_getCommTypeInit(), "selectStGrpCdList");
	ds_listAlowBasicInfo.clearData();

	var sToday = gfn_getToday();
	tab_feeMain.tab_feeCalculation.div_monthCal.setDate(sToday);

	tab_feeMain.tab_feeCalculation.edt_alow_cnt.value = "0건";
	tab_feeMain.tab_feeCalculation.edt_tot_alow_amt.value = "0";
	tab_feeMain.tab_feeCalculation.edt_tot_resnredmpamt.value = "0";
	tab_feeMain.tab_feeCalculation.edt_tot_real_amt.value = "0";
	tab_feeMain.tab_feeCalculation.edt_tot_true_amt.value = "0";

	ds_listMonthAlowListTemp.clearData();
	ds_listMonthAlowList.clearData();
	ds_AlowDetailTemp.clear();
	ds_AlowDetail.clear();

	var sToday = gfn_getToday();
	tab_feeMain.tab_b2bFee.div_monthCal.setDate(sToday);
	tab_feeMain.tab_b2bFee.cbo_deptKind.index = 0;

	// 3번째 탭
	tab_feeMain.tab_Detail.div_monthCal.setDate(sToday);
	tab_feeMain.tab_Detail.edt_srch_accnt_no.value = "";
	tab_feeMain.tab_Detail.sta_totalCnt.text = "검색결과   <fs v='9'><fc v='#f0850c'><b v='true'>0</b></fc></fs> <fc v='#a1a1a1'>건</fc> / 전체   <fs v='9'><fc v='#f0850c'><b v='true'>0</b></fc></fs> <fc v='#a1a1a1'>건</fc>";
	
	tab_feeMain.tab_Detail2.div_monthCal.setDate(sToday);
	tab_feeMain.tab_Detail2.sta_totalCnt.text = "검색결과   <fs v='9'><fc v='#f0850c'><b v='true'>0</b></fc></fs> <fc v='#a1a1a1'>건</fc> / 전체   <fs v='9'><fc v='#f0850c'><b v='true'>0</b></fc></fs> <fc v='#a1a1a1'>건</fc>";
}

// 조회결과
function fn_postSearch(sSvcId)
{
    switch (sSvcId)
	{
		case "selectStGrpCdList" :
			var nRow = ds_codeGrpCd.insertRow(0);
			ds_codeGrpCd.setColumn(nRow, "com_cd", "");
			ds_codeGrpCd.setColumn(nRow, "cd_nm", "전체");
			tab_feeMain.tab_feeCalculation.cbo_stGrpCd.index = 0;
		break;

		case "getAlowBasicInfo" :
			if(ds_listAlowBasicInfo.getRowCount() <= 0)
			{
				alert("조회결과가 없습니다.");
				return false;
			}
			else
			{
			    tab_feeMain.tab_feeCalculation.edt_alow_cnt.value = gfn_appendComma(ds_listAlowBasicInfoSummary.getColumn(0, "alow_cnt")) + "건";
			    tab_feeMain.tab_feeCalculation.edt_tot_alow_amt.value = gfn_appendComma(ds_listAlowBasicInfoSummary.getColumn(0, "tot_alow_amt"));
			    tab_feeMain.tab_feeCalculation.edt_tot_resnredmpamt.value = gfn_appendComma(ds_listAlowBasicInfoSummary.getColumn(0, "tot_resnredmpamt"));
			    tab_feeMain.tab_feeCalculation.edt_tot_real_amt.value = gfn_appendComma(ds_listAlowBasicInfoSummary.getColumn(0, "tot_real_amt"));
			    tab_feeMain.tab_feeCalculation.edt_tot_true_amt.value = gfn_appendComma(ds_listAlowBasicInfoSummary.getColumn(0, "tot_true_amt"));
			}
		break;

		case "getMonthAlowList" :
			if(ds_listMonthAlowList.getRowCount() <= 0)
			{
				alert("조회결과가 없습니다.");
				return false;
			}
			else
			{
				var alow_cnt = gfn_appendComma(ds_listMonthAlowListSummary.getColumn(0, "alow_cnt"));
				var alow_amt = gfn_appendComma(ds_listMonthAlowListSummary.getColumn(0, "alow_amt"));
				var alow_amt2 = gfn_appendComma(ds_listMonthAlowListSummary.getColumn(0, "alow_amt2"));
				var alow_amt3 = gfn_appendComma(ds_listMonthAlowListSummary.getColumn(0, "alow_amt3"));
				var alow_tot_amt = gfn_appendComma(ds_listMonthAlowListSummary.getColumn(0, "alow_tot_amt"));


				trace(alow_tot_amt);

			    tab_feeMain.tab_b2bFee.edt_alow_cnt.value = alow_cnt + "건";
			    tab_feeMain.tab_b2bFee.edt_alow_amt.value = alow_amt;
			    tab_feeMain.tab_b2bFee.edt_alow_amt2.value = alow_amt2;
			    tab_feeMain.tab_b2bFee.edt_alow_amt3.value = alow_amt3;
			    tab_feeMain.tab_b2bFee.edt_tot_alow_amt.value = alow_tot_amt;
			}
		break;
		
		case "getAlowDetail" :
			if(ds_AlowDetail.getRowCount() <= 0)
			{
				alert("조회결과가 없습니다.");
				return false;
			}
		break;
		
		case "getAlowDetail2" : 
			if(ds_AlowDetail2.getRowCount() <= 0)
			{
				alert("조회결과가 없습니다.");
				return false;
			}
		break;
	}
}

/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
// 조회
function btn_search_onclick(obj:Button,  e:ClickEventInfo)
{
	var sTabPageId = tab_feeMain.tabpages[tab_feeMain.tabindex].name;
	var svcId = "";

	switch(sTabPageId){
		//수수료 산출 조회
		case "tab_feeCalculation" :
			svcId = "getAlowBasicInfo";
		break;

		//수당 산출 조회
		case "tab_b2bFee" :
			svcId = "getMonthAlowList";
		break;

		//수당/수수료 상세데이터
		case "tab_Detail" :
			svcId = "getAlowDetail";
		break;
		
		//상세데이터 2
		case "tab_Detail2" :
			svcId = "getAlowDetail2";
		break;
	}
	fn_commSearch(gfn_getCommTypeInit(), svcId);
}

// 초기화
function btn_init_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_init();
}

// onkeydown
function srch_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13) { // 엔터
		fn_commSearch(gfn_getCommTypeInit(), "getAlowDetail"); // 조회
	}
}

function btn_excelExport_onclick(obj:Button,  e:ClickEventInfo)
{
	var sTabPageId = tab_feeMain.tabpages[tab_feeMain.tabindex].name;

	if(sTabPageId == "tab_feeCalculation") {
		if(ds_listAlowBasicInfo.getRowCount() > 0) {
			gfn_exportGridToExcel(tab_feeMain.tab_feeCalculation.grd_list, "수수료산출집계리스트_"+gfn_getTodayFull()+"");
		}
		else {
			alert("엑셀다운로드 할 대상이 없습니다.");
		}
	}
	else if(sTabPageId == "tab_b2bFee")	{
		if(ds_listMonthAlowList.getRowCount() > 0) {
			var colDS = fn_excelPrepareExcelDS("grd_listA");
			gfn_excelDown("수당산출", "XLS_DLCC", "DlwPayMap.getMonthAlowList", "DlwPayMap.getMonthAlowCount", ds_inqCndtMonthAlowList, true, colDS, true);
		}
		else {
			alert("엑셀다운로드 할 대상이 없습니다.");
		}
	}
	else if(sTabPageId == "tab_Detail2") {
		if(ds_AlowDetail2.getRowCount() > 0) {
			var colDS = fn_excelPrepareExcelDS("grd_listB");
			gfn_excelDown("수당산출상세데이터2", "XLS_DLCC", "DlwPayMap.getAlowDetail2", "DlwPayMap.getAlowDetail2Count", ds_inqCndtAlowDetail2, true, colDS, true);
		}
		else {
			alert("엑셀다운로드 할 대상이 없습니다.");
		}
	}
	else {
		if(ds_AlowDetail.rowcount > 0) {
			fn_commSearch(gfn_getCommTypeInit(), "getAlowDetail_excel"); // 조회
		} else {
			alert("엑셀다운로드 할 대상이 없습니다.");
		}

	}
}

function grd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	var sTabPageId = tab_feeMain.tabpages[tab_feeMain.tabindex].name;
	
	// (탭) 상세데이터
	if(sTabPageId == "tab_Detail") {
		var sPrmr = {p_mode:"update"};
		var reVal = gfn_diaLog("수당/수수료 상세데이터 관리", -1, -1, 884, 601, "DL470000::DL471200_03.xfdl", false, sPrmr, false, false, true);
	}
}

function grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	var sTabPageId = tab_feeMain.tabpages[tab_feeMain.tabindex].name;

	if(sTabPageId == "tab_feeCalculation")
	{

	}
	else if(sTabPageId == "tab_b2bFee")
	{
		ds_inqCndtMonthAlowList.setColumn(0, "sController", "/dlw/pay/fee/getMonthAlowList");
		ds_inqCndtMonthAlowList.setColumn(0, "dsName", "ds_output1");

		if(!gfn_pageSearch(gfn_getCommTypeOrderBy(), ds_listMonthAlowList, tab_feeMain.tab_b2bFee.sta_totalCnt, 500, nTotalListCnt)) return;
		gfn_grdHeadClick(obj, e, ds_inqCndtMonthAlowList, null, ds_listMonthAlowListTemp);
		gfn_setTotalRowCount(ds_listMonthAlowList, tab_feeMain.tab_b2bFee.sta_totalCnt, nTotalListCnt);
	}
	else if(sTabPageId == "tab_Detail2")
	{
		ds_inqCndtAlowDetail2.setColumn(0, "sController", "/dlw/pay/fee/getAlowDetail2");
		ds_inqCndtAlowDetail2.setColumn(0, "dsName", "ds_output1");

		if(!gfn_pageSearch(gfn_getCommTypeOrderBy(), ds_AlowDetail2, tab_feeMain.tab_Detail2.sta_totalCnt, 500, nTotalListCnt2)) return;
		gfn_grdHeadClick(obj, e, ds_inqCndtAlowDetail2, null, ds_AlowDetail2Temp);
		gfn_setTotalRowCount(ds_AlowDetail2, tab_feeMain.tab_Detail2.sta_totalCnt, nTotalListCnt2);
	}
}

function fn_postSendData()
{
	ds_inqCndt.clearData();
	var nRow = ds_inqCndt.addRow();
	var sTabPageId = tab_feeMain.tabindex;
	
	if(sTabPageId == "0")
	{
		ds_inqCndt.setColumn(nRow, "alow_dt", tab_feeMain.tab_feeCalculation.div_monthCal.getDate());
	}
	else if(sTabPageId == "1")
	{
		ds_inqCndt.setColumn(nRow, "alow_dt", tab_feeMain.tab_b2bFee.div_monthCal.getDate());
	}
	else
	{
		alert("올바르지 않은 명령입니다.");
		return false;
	}
	
	ds_inqCndt.setColumn(nRow, "tab_id", sTabPageId);
}

function btn_onclick(obj:Button,  e:ClickEventInfo)
{
	if(confirm("수당/수수료 마감산출을 수행 하시겠습니까?") == false)
	{
		return false;
	}
	
	fn_postSendData();

	var szSvcid       = "insertSetClose";
	var szController  = "/dlw/cond/insertSetClose";
	var szInDs        = "ds_input=ds_inqCndt";    // 데이터셋도 삭제
	var szOutDs       = "";
	var szParam       = "";
	var szRetCallback = "fn_callBack";

	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

function grd_list_onvscrolllastover(obj:Grid, e:ScrollEventInfo)
{
	var sTabPageId = tab_feeMain.tabpages[tab_feeMain.tabindex].name;

	if(sTabPageId == "tab_feeCalculation")
	{

	}
	else if(sTabPageId == "tab_b2bFee")
	{
		fn_commSearch(gfn_getCommTypeAppend(), "getMonthAlowList"); // 추가 조회
	}
	else if(sTabPageId == "tab_Detail")
	{
		fn_commSearch(gfn_getCommTypeAppend(), "getAlowDetail"); // 추가 조회
	}
	else if(sTabPageId == "tab_Detail2")
	{
		fn_commSearch(gfn_getCommTypeAppend(), "getAlowDetail2"); // 추가 조회
	}
	else
	{
		
	}
}

function btn_pop_onclick(obj:Button,  e:ClickEventInfo)
{
	var sToday = gfn_getToday();
	var sToMonth = sToday.substring(0, 6);
	var sPrmr = {};

	sPrmr["p_month"] = sToMonth;

	var reVal = gfn_diaLog("수당/수수료배치처리일자관리", -1, -1, 884, 601, "DL470000::DL471200_02.xfdl", false, sPrmr, false, false, true);
}

function fn_excelPrepareExcelDS(grdNM:String) {
	var colDS:Dataset = null;
	if (this["ds_tempExcelDown"]) {
		colDS = this["ds_tempExcelDown"];
	} else {
		colDS = new Dataset;
		colDS.name = "ds_tempExcelDown";
		this.addChild(colDS.name, colDS);
	}
	
	colDS.addColumn("xls_colm_id", "string", 256);
	colDS.addColumn("xls_colm_nm", "string", 256);
	colDS.addColumn("xls_colm_type_cd", "string", 256);
	
	colDS.clearData();
	
	for (var i=0; i< this[grdNM].getCellCount("Head"); i++) {
		var colId = this[grdNM].getCellProperty("Body", i, "text")
		if (colId==null || colId.search("expr") > -1)
			continue;
			
		colId = colId.replace("bind:", "");
		colDS.addRow();
		colDS.setColumn(colDS.rowposition, "xls_colm_id", colId);
		colDS.setColumn(colDS.rowposition, "xls_colm_nm", this[grdNM].getCellProperty("Head", i, "text"));
		colDS.setColumn(colDS.rowposition, "xls_colm_type_cd", "10");
	}
	
	return colDS;
}

// 상세데이터(탭) - 수기입력
function btn_insertAlow_onclick(obj:Button,  e:ClickEventInfo)
{
	var monthCal = tab_feeMain.tab_Detail.div_monthCal.getDate();
	var sPrmr = {p_mode:"insert", p_monthCal:monthCal};
	var reVal = gfn_diaLog("수당/수수료 상세데이터 관리", -1, -1, 884, 601, "DL470000::DL471200_03.xfdl", false, sPrmr, false, false, true);
}

// 상세데이터(탭) 회원번호 팝업
function tab_feeMain_tab_Detail_btn_accntNo_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_srchAccntNoPop();
}

// 회원조회 팝업
function fn_srchAccntNoPop()
{	
	var sPrmr = {p_srch_typ:"accnt_no", p_srch_vl:tab_feeMain.tab_Detail.edt_srch_accnt_no.value, p_gubun_mode:"", p_option:""};
	var reVal = gfn_diaLog("회원조회", -1, -1, -1, -1, "PS990000::PS992400.xfdl", false, sPrmr, true, false, true, null, null, true);
}

// 회원정보 선택시
function fn_setAccntNo()
{
	tab_feeMain.tab_Detail.edt_srch_accnt_no.value = ds_accnt_info.getColumn(0, "accnt_no");
}

function tab_feeMain_tab_feeCalculation_btn_calc_onclick(obj:Button,  e:ClickEventInfo)
{
	if(confirm("수당/수수료 산출을 수행 하시겠습니까?") == false)
	{
		return false;
	}
	
	var szSvcid       = "insertAlowBasicInfo";
	var szController  = "/dlw/cond/insertAlowBasicInfo";
	var szInDs        = "";
	var szOutDs       = "";
	var szParam       = "";
	var szRetCallback = "fn_callBack";

	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}
]]></Script>
  </Form>
</FDL>
