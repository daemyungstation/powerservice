<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="PS080300" classname="캠페인관리" inheritanceid="" position="absolute 0 0 989 795" titletext="사용자관리" onload="PS080300_onload">
    <Layouts>
      <Layout>
        <Static id="stc_01" class="sta_workSrcBg" position2="absolute l:0 r:0 t:7px h:66" positiontype="position2"/>
        <Static id="stc_08" class="sta_workData" position2="absolute l:95 r:0px b:160 h:26" positiontype="position2"/>
        <Static id="stc_17" text="상담그룹" class="sta_workSrcLabel1" position2="absolute l:20 w:62 t:18 h:20" positiontype="position2"/>
        <Button id="btn_Search" taborder="7" onclick="btn_Search_onclick" class="btn_WF_Search" tooltiptext="조회" position2="absolute r:95 w:72 t:42px h:20" positiontype="position2"/>
        <Button id="btn_Init" taborder="8" onclick="btn_Init_onclick" class="btn_WF_Return" tooltiptext="초기화" position2="absolute r:21 w:72 t:42px h:20" positiontype="position2" tabstop="false"/>
        <Combo id="cbo_searchItem" taborder="4" position2="absolute l:85 w:77 t:42 h:20" positiontype="position2" codecolumn="codecolumn" datacolumn="datacolumn">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">user_nm</Col>
                <Col id="datacolumn">사용자명</Col>
              </Row>
              <Row>
                <Col id="codecolumn">lgn_id</Col>
                <Col id="datacolumn">사용자ID</Col>
              </Row>
              <Row>
                <Col id="codecolumn">cti_id</Col>
                <Col id="datacolumn">CTI ID</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Grid id="Grid00" taborder="10" useinputpanel="false" position2="absolute l:0 r:0 t:109 b:301" positiontype="position2" autofittype="col" binddataset="ds_list_user" onvscrolllastover="Grid00_onvscrolllastover" oncellclick="Grid00_oncellclick" onheadclick="Grid_onheadclick" tabstop="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="50"/>
                <Column size="82"/>
                <Column size="82"/>
                <Column size="82"/>
                <Column size="82"/>
                <Column size="82"/>
                <Column size="82"/>
                <Column size="82"/>
                <Column size="82"/>
                <Column size="82"/>
                <Column size="82"/>
                <Column size="116"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="NO"/>
                <Cell col="1" text="상담그룹"/>
                <Cell col="2" text="사용자명"/>
                <Cell col="3" text="사용자ID"/>
                <Cell col="4" text="직무유형"/>
                <Cell col="5" text="권한유형"/>
                <Cell col="6" text="CTI ID"/>
                <Cell col="7" text="근무상태"/>
                <Cell col="8" text="입사일"/>
                <Cell col="9" text="퇴사일"/>
                <Cell col="10" text="수정자"/>
                <Cell col="11" text="수정일시"/>
              </Band>
              <Band id="body">
                <Cell text="bind:page_indx"/>
                <Cell col="1" text="bind:team_nm"/>
                <Cell col="2" text="bind:user_nm"/>
                <Cell col="3" text="bind:lgn_id"/>
                <Cell col="4" text="bind:duty_nm"/>
                <Cell col="5" text="bind:athr_nm"/>
                <Cell col="6" text="bind:cti_id"/>
                <Cell col="7" text="bind:user_stat_nm"/>
                <Cell col="8" displaytype="expr:enco_dt == null ? 'none' : 'date'" edittype="none" text="bind:enco_dt"/>
                <Cell col="9" displaytype="expr:rtco_dt == null ? 'none' : 'date'" text="bind:rtco_dt"/>
                <Cell col="10" text="bind:amnd_nm"/>
                <Cell col="11" text="bind:amnt_dttm" mask="####-##-## ##:##"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="stc_04" text="근무상태" class="sta_workSrcLabel1" position2="absolute l:521 w:62 t:18 h:20" positiontype="position2"/>
        <Combo id="cbo_userStatCdList" taborder="3" position2="absolute l:584 w:90 t:18 h:20" positiontype="position2" innerdataset="@ds_userStatCdList" codecolumn="cd" datacolumn="cd_nm"/>
        <Static id="stc_02" text="직무유형" class="sta_workSrcLabel1" position2="absolute l:348 w:62 t:18 h:20" positiontype="position2"/>
        <Edit id="edt_item" taborder="5" autoselect="true" autoskip="true" onkeydown="edt_onkeydown" position2="absolute l:165 w:131 t:42 h:20" positiontype="position2"/>
        <Static id="stc_25" text="사용자 상세정보" class="sta_workTitle2" position2="absolute l:0 w:121 b:262 h:20" positiontype="position2"/>
        <Static id="stc_21" class="sta_workData" position2="absolute l:95 r:0 b:235 h:26" positiontype="position2"/>
        <Static id="stc_33" text="센터" class="sta_workLabel1_P" validate="" position2="absolute l:456 w:96 b:235 h:26" positiontype="position2"/>
        <Static id="stc_10" class="sta_workData" position2="absolute l:95 r:0px b:185 h:26" positiontype="position2"/>
        <Static id="stc_16" text="담당업무" class="sta_workLabel1" validate="" position2="absolute l:95 w:96 b:185 h:26" positiontype="position2"/>
        <Static id="stc_07" text="근무상태" class="sta_workLabel1" validate="" position2="absolute l:95 w:96 b:160 h:26" positiontype="position2"/>
        <Static id="stc_13" text="CTI사용여부" class="sta_workLabel1" validate="" position2="absolute l:0 w:96 b:135 h:26" positiontype="position2"/>
        <Static id="stc_14" class="sta_workData" position2="absolute l:95 r:0 b:135 h:26" positiontype="position2"/>
        <Static id="stc_18" text="파티그룹번호" class="sta_workLabel1" validate="" position2="absolute l:456 w:96 b:135 h:26" positiontype="position2"/>
        <Static id="stc_19" text="ACD그룹번호" class="sta_workLabel1" validate="" position2="absolute l:719 w:96 b:135 h:26" positiontype="position2"/>
        <Static id="stc_22" text="CTI아이디" class="sta_workLabel1" validate="" position2="absolute l:233 w:96 b:135 h:26" positiontype="position2"/>
        <Static id="stc_27" text="상담그룹" class="sta_workLabel1_P" validate="" position2="absolute l:719 w:96 b:235 h:26" positiontype="position2"/>
        <Combo id="cbo_cntr" taborder="15" innerdataset="@ds_cntrCdList" codecolumn="cntr_cd" datacolumn="cntr_nm" position2="absolute l:554 w:162 b:238 h:20" positiontype="position2"/>
        <Static id="stc_30" class="sta_workData" position2="absolute l:95 r:0 b:110 h:26" positiontype="position2"/>
        <Static id="stc_32" class="sta_workData" position2="absolute l:551 r:0 b:35 h:51" positiontype="position2"/>
        <Static id="stc_34" text="핸드폰" class="sta_workLabel1" validate="" position2="absolute l:456 w:96 b:110 h:26" positiontype="position2"/>
        <Static id="stc_36" class="sta_workData" position2="absolute l:95 w:362 b:60 h:26" positiontype="position2"/>
        <Static id="stc_37" text="소속회사" class="sta_workLabel1" validate="" position2="absolute l:0 w:96 b:60 h:26" positiontype="position2"/>
        <Static id="stc_38" text="사용자설명" class="sta_workLabel1" style="align:left top;" validate="" position2="absolute l:456 w:96 b:35 h:51" positiontype="position2"/>
        <Static id="stc_39" text="직원유형" class="sta_workLabel1" validate="" position2="absolute l:0 w:96 b:35 h:26" positiontype="position2"/>
        <Static id="stc_40" class="sta_workData" position2="absolute l:95 w:362 b:35 h:26" positiontype="position2"/>
        <Static id="stc_41" text="등록자" class="sta_workLabel1" validate="" position2="absolute l:0 w:96 b:10 h:26" positiontype="position2"/>
        <Static id="stc_42" class="sta_workData" position2="absolute l:95 r:0 b:10 h:26" positiontype="position2"/>
        <Static id="stc_43" text="수정자" class="sta_workLabel1" validate="" position2="absolute l:456 w:96 b:10 h:26" positiontype="position2"/>
        <Static id="stc_44" text="수정일시" class="sta_workLabel1" validate="" position2="absolute l:719 w:96 b:10 h:26" positiontype="position2"/>
        <Static id="stc_45" text="등록일시" class="sta_workLabel1" validate="" position2="absolute l:233 w:96 b:10 h:26" positiontype="position2"/>
        <Static id="stc_rgsr_nm" style="border:0 none #808080ff ;" position2="absolute l:98 w:134 b:13 h:21" positiontype="position2"/>
        <Static id="stc_46" class="sta_workData" position2="absolute l:95 r:0px b:85 h:26" positiontype="position2"/>
        <Static id="stc_47" text="직원번호" class="sta_workLabel1" validate="" position2="absolute l:233 w:96 b:35 h:26" positiontype="position2"/>
        <Static id="stc_48" text="기수정보" class="sta_workLabel1" validate="" position2="absolute l:233 w:96 b:60 h:26" positiontype="position2"/>
        <Edit id="edt_user_expi" taborder="43" position2="absolute l:554 w:432 b:38 h:45" positiontype="position2" lengthunit="utf8" maxlength="500"/>
        <Edit id="edt_blng_comp_nm" taborder="39" position2="absolute l:98 w:133 b:63 h:20" positiontype="position2" lengthunit="utf8" maxlength="100"/>
        <Edit id="edt_prcnt_no" taborder="40" position2="absolute l:331 w:123 b:63 h:20" positiontype="position2" lengthunit="utf8" maxlength="24"/>
        <Edit id="edt_empl_no" taborder="42" position2="absolute l:331 w:123 b:38 h:20" positiontype="position2" lengthunit="utf8" maxlength="24"/>
        <Static id="stc_51" text="비상연락처" class="sta_workLabel1" validate="" position2="absolute l:719 w:96 b:110 h:26" positiontype="position2"/>
        <Static id="stc_52" text="이메일주소" class="sta_workLabel1" validate="" position2="absolute l:464 w:96 b:-64 h:26" positiontype="position2" visible="false"/>
        <Static id="stc_20" text="성명" class="sta_workLabel1_P" validate="" position2="absolute l:95 w:96 b:235 h:26" positiontype="position2"/>
        <Static id="stc_05" text="사용여부" class="sta_workLabel1" validate="" position2="absolute l:456 w:96 b:185 h:26" positiontype="position2"/>
        <Static id="stc_11" text="입사일" class="sta_workLabel1" validate="" position2="absolute l:456 w:96 b:160 h:26" positiontype="position2"/>
        <Edit id="edt_user_nm" taborder="13" position2="absolute l:192 w:142 b:238 h:20" positiontype="position2" imemode="hangul" maxlength="5" inputtype="full"/>
        <Combo id="cbo_user_stat_cd" taborder="25" innerdataset="@ds_userStatCdList2" datacolumn="cd_nm" position2="absolute l:192 w:158 b:163 h:20" positiontype="position2" codecolumn="cd"/>
        <CheckBox id="Check_Out" taborder="23" text="아웃바운드" onclick="CheckBox00_onclick" position2="absolute l:266 w:95 b:187 h:20" positiontype="position2"/>
        <CheckBox id="Check_In" taborder="22" text="인바운드" onclick="CheckBox00_onclick" position2="absolute l:194 w:70 b:187 h:20" positiontype="position2"/>
        <Static id="stc_49" text="퇴사일" class="sta_workLabel1" validate="" position2="absolute l:719 w:96 b:160 h:26" positiontype="position2"/>
        <Radio id="Radio_use_yn" taborder="24" columncount="0" rowcount="0" codecolumn="codecolumn" datacolumn="datacolumn" direction="vertical" position2="absolute l:554 w:143 b:185 h:26" positiontype="position2" canitemchange="Radio_use_yn_canitemchange">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">사용</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">사용안함</Col>
              </Row>
            </Rows>
          </Dataset>
        </Radio>
        <Combo id="cbo_cti_use_yn" taborder="28" codecolumn="codecolumn" datacolumn="datacolumn" position2="absolute l:97 w:135 b:138 h:20" positiontype="position2">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">사용</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">사용안함</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Edit id="edt_cti_id" taborder="29" position2="absolute l:331 w:123 b:138 h:20" positiontype="position2" lengthunit="utf8" maxlength="10" imemode="none" inputfilter="dot,comma,sign,symbol" inputmode="upper" inputtype="number"/>
        <Button id="btn_zpcdSearch" taborder="33" class="btn_workSrcPop" position2="absolute l:153 w:20 b:113 h:20" positiontype="position2" onclick="btn_zpcdSearch_onclick"/>
        <Edit id="edt_home_addr" taborder="34" enable="false" position2="absolute l:174 w:280 b:113 h:20" positiontype="position2"/>
        <Edit id="edt_home_dtpt_addr" taborder="37" position2="absolute l:98 w:356 b:88 h:20" positiontype="position2" lengthunit="utf8" maxlength="100"/>
        <Combo id="cbo_user_typ_cd" taborder="41" innerdataset="@ds_user_typ_cd" codecolumn="cd" datacolumn="cd_nm" position2="absolute l:97 w:135 b:38 h:20" positiontype="position2"/>
        <Edit id="edt_acd_grop_no" taborder="31" position2="absolute l:817 w:169 b:138 h:20" positiontype="position2" lengthunit="utf8" maxlength="6"/>
        <Button id="btn_excel" taborder="9" text="엑셀다운" onclick="btn_excel_onclick" class="btn_WF_Common" style="padding:0 0 0 0;" position2="absolute r:1 w:92 t:85px h:20" positiontype="position2" tabstop="false"/>
        <Static id="stc_12" text="검색어" onclick="div_Work_stc_12_onclick" class="sta_workSrcLabel1" position2="absolute l:20 w:62 t:42 h:20" positiontype="position2"/>
        <Static id="sta_totalCnt" text="검색결과   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt; / 전체   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt;" usedecorate="true" class="sta_workTitle5" position2="absolute l:2 w:216 t:89 h:20" positiontype="position2"/>
        <Static id="stc_31" text="주소" class="sta_workLabel1" position2="absolute l:0 w:96 b:85 h:51" positiontype="position2" validate=""/>
        <Static id="stc_06" class="sta_workData" position2="absolute l:95 r:0 b:210 h:26" positiontype="position2"/>
        <Static id="stc_09" text="사용자ID" class="sta_workLabel1" position2="absolute l:95 w:96 b:210 h:26" positiontype="position2" validate=""/>
        <Static id="stc_28" text="직무유형" class="sta_workLabel1_P" position2="absolute l:456 w:96 b:210 h:26" positiontype="position2" validate=""/>
        <Static id="stc_24" text="권한유형" class="sta_workLabel1_P" position2="absolute l:719 w:96 b:210 h:26" positiontype="position2" validate=""/>
        <Combo id="cbo_duty_cd" taborder="20" innerdataset="@ds_dutyCdList2" codecolumn="cd" datacolumn="cd_nm" position2="absolute l:554 w:163 b:213 h:20" positiontype="position2"/>
        <Combo id="cbo_athrList" taborder="21" innerdataset="@ds_athrList" codecolumn="athr_cd" datacolumn="athr_nm" position2="absolute l:816 w:171 b:213 h:20" positiontype="position2"/>
        <Edit id="edt_emil_addr" taborder="38" position2="absolute l:562 w:163 b:-61 h:20" positiontype="position2" visible="false"/>
        <Calendar id="msk_enco_dt" taborder="26" readonly="false" dateformat="yyyy-MM-dd" oneditclick="cal_00_oneditclick" class="cal_srch" position2="absolute l:554 w:89 b:163 h:20" positiontype="position2" onchanged="cal_00_onchanged"/>
        <Calendar id="msk_rtco_dt" taborder="27" dateformat="yyyy-MM-dd" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" class="cal_srch" position2="absolute l:817 w:89 b:163 h:20" positiontype="position2"/>
        <Combo id="cbo_teamCd1" taborder="0" innerdataset="ds_teamCd1" codecolumn="team_cd" datacolumn="team_nm" onitemchanged="cbo_teamCd1_onitemchanged" class="cbo_srch" position="absolute 85 16 206 38"/>
        <Combo id="cbo_teamCd2" taborder="1" displaynulltext="전체" innerdataset="ds_teamCd2" codecolumn="team_cd" datacolumn="team_nm" class="cbo_srch" enable="false" position="absolute 208 16 329 38"/>
        <Combo id="cbo_dutyCdList" taborder="2" innerdataset="ds_dutyCdList" codecolumn="cd" datacolumn="cd_nm" class="cbo_srch" position="absolute 411 17 501 39"/>
        <Combo id="cbo_teamCd01" taborder="16" innerdataset="@ds_teamCd01" codecolumn="team_cd" datacolumn="team_nm" onitemchanged="cbo_teamCd1_onitemchanged2" class="cbo_srch" position2="absolute l:816 w:80 b:238 h:20" positiontype="position2" index="-1"/>
        <Combo id="cbo_teamCd02" taborder="17" displaynulltext="선택" innerdataset="@ds_teamCd02" codecolumn="team_cd" datacolumn="team_nm" class="cbo_srch" enable="true" position2="absolute l:897 w:89 b:238 h:20" positiontype="position2"/>
        <Edit id="edt_pty_grop_no" taborder="30" position2="absolute l:554 w:163 b:138 h:20" positiontype="position2" lengthunit="utf8" maxlength="100"/>
        <MaskEdit id="Mask_rgsn_dttm" taborder="44" readonly="true" type="string" mask="####-##-## ##:##" autoselect="true" position2="absolute l:331 w:123 b:12 h:21" positiontype="position2" style="align:left middle;"/>
        <Static id="stc_amnd_nm" position2="absolute l:554 w:159 b:13 h:21" positiontype="position2" style="border:0 none #808080ff ;"/>
        <MaskEdit id="Mask_amnt_dttm" taborder="45" readonly="true" type="string" mask="####-##-## ##:##" autoselect="true" position2="absolute l:817 w:169 b:12 h:21" positiontype="position2" style="align:left middle;"/>
        <ImageViewer id="img_appfm_no" taborder="46" stretch="fit" position2="absolute l:0 w:96 b:161 h:101" positiontype="position2" style="background:#ffffffff;" tabstop="false"/>
        <Button id="btn_fileAdd" taborder="47" text="파일 선택" class="btn_WF_act3" visible="false" position2="absolute l:12 w:69 b:164 h:20" positiontype="position2" onclick="btn_fileAdd_onclick"/>
        <Static id="sta_GrayLine" class="sta_WF_Line1" position2="absolute l:0 r:0 b:261 h:1" positiontype="position2"/>
        <Button id="btn_fileDel" taborder="48" text="파일 삭제" class="btn_WF_act3" visible="false" position2="absolute l:12 w:69 b:164 h:20" positiontype="position2" onclick="btn_fileDel_onclick" tabstop="false"/>
        <Button id="btn_save" taborder="11" onclick="btn_save_onclick" class="btn_WF_Save" visible="false" position2="absolute r:75 w:72 b:265 h:20" positiontype="position2" style="padding:0 0 0 0;"/>
        <Button id="btn_cancel" taborder="12" text="취소" onclick="btn_cancel_onclick" class="btn_WF_Common" visible="false" position2="absolute r:1 w:72 b:265 h:20" positiontype="position2" style="padding:0 0 0 0;"/>
        <Button id="btn_new" taborder="49" onclick="btn_new_onclick" class="btn_WF_New" visible="false" position2="absolute r:75 w:72 b:265 h:20" positiontype="position2" tooltiptext="신규등록" style="padding:0 0 0 0;" tabstop="false"/>
        <Button id="btn_update" taborder="50" onclick="btn_update_onclick" class="btn_WF_Modif" visible="false" position2="absolute r:1 w:72 b:265 h:20" positiontype="position2" tooltiptext="수정" style="padding:0 0 0 0;" tabstop="false"/>
        <Edit id="edt_lgn_id" taborder="18" position2="absolute l:192 w:142 b:213 h:20" positiontype="position2" lengthunit="utf8" maxlength="10" inputtype="digit"/>
        <Button id="btn_resetPass" taborder="14" text="비밀번호 초기화" onclick="btn_resetPass_onclick" class="btn_WF_act3" visible="false" position2="absolute l:342 w:93 b:238 h:20" positiontype="position2" tabstop="false"/>
        <Button id="btn_idCheck" taborder="19" text="중복체크" onclick="btn_idCheck_onclick" class="btn_WF_act3" visible="false" position2="absolute l:342 w:53 b:213 h:20" positiontype="position2"/>
        <Edit id="Mask_zpcd" taborder="32" inputtype="number" readonly="false" lengthunit="utf8" maxlength="5" enable="false" position2="absolute l:98 w:54 b:113 h:20" positiontype="position2" style=":disabled {align:center middle;}"/>
        <Edit id="Mask_clph_no" taborder="35" inputtype="number,symbol" readonly="false" lengthunit="utf8" maxlength="13" onkillfocus="phone_onkillfocus" ontextchanged="phone_ontextchanged" position2="absolute l:554 w:163 b:113 h:20" positiontype="position2"/>
        <Edit id="Mask_edt_tlno" taborder="36" inputtype="number,symbol" readonly="false" lengthunit="utf8" maxlength="13" onkillfocus="phone_onkillfocus" ontextchanged="phone_ontextchanged" position2="absolute l:817 w:169 b:113 h:20" positiontype="position2"/>
        <Static id="stc_00" text="권한유형" class="sta_workSrcLabel1" position2="absolute l:348 w:62 t:43 h:20" positiontype="position2"/>
        <Combo id="cbo_athrList_s" taborder="6" innerdataset="@ds_athrList" codecolumn="athr_cd" datacolumn="athr_nm" class="cbo_srch" position="absolute 411 42 501 64"/>
        <MaskEdit id="med_last_lgn_dtm" taborder="51" readonly="true" type="string" mask="####-##-## ##:##" autoselect="true" position2="absolute l:817 w:169 b:187 h:21" positiontype="position2" style="align:left middle;" displaynulltext="없음"/>
        <Static id="stc_03" text="최근접속일시" class="sta_workLabel1" position2="absolute l:719 w:96 b:185 h:26" positiontype="position2" validate=""/>
        <Static id="stc_15" text="엑셀권한" class="sta_workLabel1" position2="absolute l:719 w:96 b:85 h:26" positiontype="position2" validate=""/>
        <Combo id="cbo_excelYn" taborder="52" class="cbo_srch" position2="absolute l:816 w:80 b:88 h:20" positiontype="position2" codecolumn="codecolumn" datacolumn="datacolumn" index="0" value="N" text="N">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">N</Col>
              </Row>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">Y</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="stc_23" text="내선번호" class="sta_workLabel1" position2="absolute l:456 w:96 b:86 h:26" positiontype="position2" validate=""/>
        <Edit id="edt_extnNo" taborder="53" position2="absolute l:554 w:163 b:89 h:20" positiontype="position2"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item15" compid="msk_enco_dt" propid="value" datasetid="ds_user" columnid="enco_dt"/>
      <BindItem id="item0" compid="msk_rtco_dt" propid="value" datasetid="ds_user" columnid="rtco_dt"/>
      <BindItem id="item1" compid="edt_user_nm" propid="value" datasetid="ds_user" columnid="user_nm"/>
      <BindItem id="item2" compid="cbo_cntr" propid="value" datasetid="ds_user" columnid="cntr_cd"/>
      <BindItem id="item3" compid="cbo_teamCd01" propid="value" datasetid="ds_user" columnid="hgrn_team_cd"/>
      <BindItem id="item4" compid="cbo_teamCd02" propid="value" datasetid="ds_user" columnid="team_cd"/>
      <BindItem id="item6" compid="cbo_duty_cd" propid="value" datasetid="ds_user" columnid="duty_cd"/>
      <BindItem id="item7" compid="Radio_use_yn" propid="value" datasetid="ds_user" columnid="use_yn"/>
      <BindItem id="item8" compid="cbo_user_stat_cd" propid="value" datasetid="ds_user" columnid="user_stat_cd"/>
      <BindItem id="item9" compid="cbo_cti_use_yn" propid="value" datasetid="ds_user" columnid="cti_use_yn"/>
      <BindItem id="item10" compid="edt_cti_id" propid="value" datasetid="ds_user" columnid="cti_id"/>
      <BindItem id="item11" compid="edt_pty_grop_no" propid="value" datasetid="ds_user" columnid="pty_grop_no"/>
      <BindItem id="item12" compid="edt_acd_grop_no" propid="value" datasetid="ds_user" columnid="acd_grop_no"/>
      <BindItem id="item14" compid="edt_home_addr" propid="value" datasetid="ds_user" columnid="home_addr"/>
      <BindItem id="item18" compid="edt_home_dtpt_addr" propid="value" datasetid="ds_user" columnid="home_dtpt_addr"/>
      <BindItem id="item20" compid="edt_blng_comp_nm" propid="value" datasetid="ds_user" columnid="blng_comp_nm"/>
      <BindItem id="item21" compid="edt_prcnt_no" propid="value" datasetid="ds_user" columnid="prcnt_no"/>
      <BindItem id="item22" compid="edt_user_expi" propid="value" datasetid="ds_user" columnid="user_expi"/>
      <BindItem id="item23" compid="cbo_user_typ_cd" propid="value" datasetid="ds_user" columnid="user_typ_cd"/>
      <BindItem id="item24" compid="edt_empl_no" propid="value" datasetid="ds_user" columnid="empl_no"/>
      <BindItem id="item25" compid="stc_rgsr_nm" propid="text" datasetid="ds_user" columnid="rgsr_nm"/>
      <BindItem id="item26" compid="Mask_rgsn_dttm" propid="value" datasetid="ds_user" columnid="rgsn_dttm"/>
      <BindItem id="item27" compid="Mask_amnt_dttm" propid="value" datasetid="ds_user" columnid="amnt_dttm"/>
      <BindItem id="item28" compid="stc_amnd_nm" propid="text" datasetid="ds_user" columnid="amnd_nm"/>
      <BindItem id="item16" compid="cbo_athrList" propid="value" datasetid="ds_user" columnid="athr_cd"/>
      <BindItem id="item30" compid="edt_lgn_id" propid="value" datasetid="ds_user" columnid="lgn_id"/>
      <BindItem id="item31" compid="edt_emil_addr" propid="value" datasetid="ds_user" columnid="emil_addr"/>
      <BindItem id="item5" compid="Mask_zpcd" propid="value" datasetid="ds_user" columnid="zpcd"/>
      <BindItem id="item13" compid="Mask_clph_no" propid="value" datasetid="ds_user" columnid="clph_no"/>
      <BindItem id="item17" compid="Mask_edt_tlno" propid="value" datasetid="ds_user" columnid="tlno"/>
      <BindItem id="item19" compid="med_last_lgn_dtm" propid="value" datasetid="ds_user" columnid="last_lgn_dtm"/>
      <BindItem id="item29" compid="cbo_excelYn" propid="value" datasetid="ds_user" columnid="excel_yn"/>
      <BindItem id="item32" compid="edt_extnNo" propid="value" datasetid="ds_user" columnid="extn_no"/>
    </Bind>
    <Objects>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="duty_cd" type="STRING" size="256"/>
          <Column id="hgrn_team_cd" type="STRING" size="256"/>
          <Column id="team_cd" type="STRING" size="256"/>
          <Column id="user_stat_cd" type="STRING" size="256"/>
          <Column id="searchItem" type="STRING" size="256"/>
          <Column id="item" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
          <Column id="file_id" type="STRING" size="256"/>
          <Column id="user_id" type="STRING" size="256"/>
          <Column id="rltn_item_id" type="STRING" size="256"/>
          <Column id="rltn_tbl_nm" type="STRING" size="256"/>
          <Column id="lgn_id" type="STRING" size="256"/>
          <Column id="combo_yn" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="athr_cd" type="STRING" size="256"/>
          <Column id="authoritycds" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_tmp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_list_user" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="team_nm" type="STRING" size="256"/>
          <Column id="athr_cd" type="STRING" size="256"/>
          <Column id="cti_id" type="STRING" size="256"/>
          <Column id="pwd_amnt_dttm" type="STRING" size="256"/>
          <Column id="urgn_tlno" type="STRING" size="256"/>
          <Column id="cntr_cd" type="STRING" size="256"/>
          <Column id="empl_no" type="STRING" size="256"/>
          <Column id="memo_no" type="STRING" size="256"/>
          <Column id="dual_mont_yn" type="STRING" size="256"/>
          <Column id="duty_nm" type="STRING" size="256"/>
          <Column id="pty_grop_no" type="STRING" size="256"/>
          <Column id="actv_log_yn" type="STRING" size="256"/>
          <Column id="blng_comp_nm" type="STRING" size="256"/>
          <Column id="rgsn_dttm" type="STRING" size="256"/>
          <Column id="athr_nm" type="STRING" size="256"/>
          <Column id="prcnt_no" type="STRING" size="256"/>
          <Column id="rec_ip_addr" type="STRING" size="256"/>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="lgn_id" type="STRING" size="256"/>
          <Column id="home_dtpt_addr" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
          <Column id="main_mont_rslu_cd" type="STRING" size="256"/>
          <Column id="user_stat_nm" type="STRING" size="256"/>
          <Column id="team_cd" type="STRING" size="256"/>
          <Column id="astn_mont_rslu_cd" type="STRING" size="256"/>
          <Column id="clph_no" type="STRING" size="256"/>
          <Column id="user_id" type="STRING" size="256"/>
          <Column id="rgsr_id" type="STRING" size="256"/>
          <Column id="mac_addr" type="STRING" size="256"/>
          <Column id="hgrn_team_nm" type="STRING" size="256"/>
          <Column id="extn_no" type="STRING" size="256"/>
          <Column id="athr_gds_cd" type="STRING" size="256"/>
          <Column id="user_typ_cd" type="STRING" size="256"/>
          <Column id="hgrn_team_cd" type="STRING" size="256"/>
          <Column id="duty_cd" type="STRING" size="256"/>
          <Column id="amnd_nm" type="STRING" size="256"/>
          <Column id="rtco_dt" type="STRING" size="256"/>
          <Column id="brdt" type="STRING" size="256"/>
          <Column id="pwd" type="STRING" size="256"/>
          <Column id="lgn_dttm" type="STRING" size="256"/>
          <Column id="cons_bswr_typ_nm" type="STRING" size="256"/>
          <Column id="cons_bswr_typ_cd" type="STRING" size="256"/>
          <Column id="role" type="STRING" size="256"/>
          <Column id="file_id" type="STRING" size="256"/>
          <Column id="pwd_amnt_yn" type="STRING" size="256"/>
          <Column id="tlno" type="STRING" size="256"/>
          <Column id="emil_addr" type="STRING" size="256"/>
          <Column id="amnt_dttm" type="STRING" size="256"/>
          <Column id="user_nm" type="STRING" size="256"/>
          <Column id="user_stat_cd" type="STRING" size="256"/>
          <Column id="user_typ_nm" type="STRING" size="256"/>
          <Column id="ip_addr" type="STRING" size="256"/>
          <Column id="amnd_id" type="STRING" size="256"/>
          <Column id="cntr_nm" type="STRING" size="256"/>
          <Column id="cti_use_yn" type="STRING" size="256"/>
          <Column id="user_expi" type="STRING" size="256"/>
          <Column id="last_logout_dttm" type="STRING" size="256"/>
          <Column id="rgsr_nm" type="STRING" size="256"/>
          <Column id="zpcd" type="STRING" size="256"/>
          <Column id="acd_grop_no" type="STRING" size="256"/>
          <Column id="enco_dt" type="STRING" size="256"/>
          <Column id="athn_falr_tmcnt" type="STRING" size="256"/>
          <Column id="home_addr" type="STRING" size="256"/>
          <Column id="last_lgn_dtm" type="STRING" size="256"/>
          <Column id="excel_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_teamCd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="team_cd" type="STRING" size="6"/>
          <Column id="team_nm" type="STRING" size="50"/>
          <Column id="hgrn_team_cd" type="STRING" size="6"/>
          <Column id="team_lvl_cnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dutyCdList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="6"/>
          <Column id="cd_nm" type="STRING" size="100"/>
          <Column id="adtl_cd" type="STRING" size="100"/>
          <Column id="adtl_cd_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_teamCd2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="team_cd" type="STRING" size="6"/>
          <Column id="team_nm" type="STRING" size="50"/>
          <Column id="hgrn_team_cd" type="STRING" size="6"/>
          <Column id="cntr_cd" type="STRING" size="6"/>
          <Column id="team_lvl_cnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_teamCd1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="team_cd" type="STRING" size="6"/>
          <Column id="team_nm" type="STRING" size="50"/>
          <Column id="hgrn_team_cd" type="STRING" size="6"/>
          <Column id="cntr_cd" type="STRING" size="6"/>
          <Column id="team_lvl_cnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_userStatCdList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="6"/>
          <Column id="cd_nm" type="STRING" size="100"/>
          <Column id="adtl_cd" type="STRING" size="100"/>
          <Column id="adtl_cd_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_user" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="team_nm" type="STRING" size="256"/>
          <Column id="athr_cd" type="STRING" size="256"/>
          <Column id="cti_id" type="STRING" size="256"/>
          <Column id="pwd_amnt_dttm" type="STRING" size="256"/>
          <Column id="urgn_tlno" type="STRING" size="256"/>
          <Column id="cntr_cd" type="STRING" size="256"/>
          <Column id="empl_no" type="STRING" size="256"/>
          <Column id="memo_no" type="STRING" size="256"/>
          <Column id="dual_mont_yn" type="STRING" size="256"/>
          <Column id="duty_nm" type="STRING" size="256"/>
          <Column id="pty_grop_no" type="STRING" size="256"/>
          <Column id="actv_log_yn" type="STRING" size="256"/>
          <Column id="blng_comp_nm" type="STRING" size="256"/>
          <Column id="rgsn_dttm" type="STRING" size="256"/>
          <Column id="athr_nm" type="STRING" size="256"/>
          <Column id="prcnt_no" type="STRING" size="256"/>
          <Column id="rec_ip_addr" type="STRING" size="256"/>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="lgn_id" type="STRING" size="256"/>
          <Column id="home_dtpt_addr" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
          <Column id="main_mont_rslu_cd" type="STRING" size="256"/>
          <Column id="user_stat_nm" type="STRING" size="256"/>
          <Column id="team_cd" type="STRING" size="256"/>
          <Column id="astn_mont_rslu_cd" type="STRING" size="256"/>
          <Column id="clph_no" type="STRING" size="256"/>
          <Column id="user_id" type="STRING" size="256"/>
          <Column id="rgsr_id" type="STRING" size="256"/>
          <Column id="mac_addr" type="STRING" size="256"/>
          <Column id="hgrn_team_nm" type="STRING" size="256"/>
          <Column id="extn_no" type="STRING" size="256"/>
          <Column id="athr_gds_cd" type="STRING" size="256"/>
          <Column id="user_typ_cd" type="STRING" size="256"/>
          <Column id="hgrn_team_cd" type="STRING" size="256"/>
          <Column id="duty_cd" type="STRING" size="256"/>
          <Column id="amnd_nm" type="STRING" size="256"/>
          <Column id="rtco_dt" type="STRING" size="256"/>
          <Column id="brdt" type="STRING" size="256"/>
          <Column id="pwd" type="STRING" size="256"/>
          <Column id="lgn_dttm" type="STRING" size="256"/>
          <Column id="cons_bswr_typ_nm" type="STRING" size="256"/>
          <Column id="cons_bswr_typ_cd" type="STRING" size="256"/>
          <Column id="role" type="STRING" size="256"/>
          <Column id="file_id" type="STRING" size="256"/>
          <Column id="pwd_amnt_yn" type="STRING" size="256"/>
          <Column id="tlno" type="STRING" size="256"/>
          <Column id="emil_addr" type="STRING" size="256"/>
          <Column id="amnt_dttm" type="STRING" size="256"/>
          <Column id="user_nm" type="STRING" size="256"/>
          <Column id="user_stat_cd" type="STRING" size="256"/>
          <Column id="user_typ_nm" type="STRING" size="256"/>
          <Column id="ip_addr" type="STRING" size="256"/>
          <Column id="amnd_id" type="STRING" size="256"/>
          <Column id="cntr_nm" type="STRING" size="256"/>
          <Column id="cti_use_yn" type="STRING" size="256"/>
          <Column id="user_expi" type="STRING" size="256"/>
          <Column id="last_logout_dttm" type="STRING" size="256"/>
          <Column id="rgsr_nm" type="STRING" size="256"/>
          <Column id="zpcd" type="STRING" size="256"/>
          <Column id="acd_grop_no" type="STRING" size="256"/>
          <Column id="enco_dt" type="STRING" size="256"/>
          <Column id="athn_falr_tmcnt" type="STRING" size="256"/>
          <Column id="home_addr" type="STRING" size="256"/>
          <Column id="last_lgn_dtm" type="STRING" size="256"/>
          <Column id="excel_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cntrCdList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cntr_cd" type="STRING" size="6"/>
          <Column id="cntr_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_teamCd01" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="team_cd" type="STRING" size="6"/>
          <Column id="team_nm" type="STRING" size="50"/>
          <Column id="hgrn_team_cd" type="STRING" size="6"/>
          <Column id="cntr_cd" type="STRING" size="6"/>
          <Column id="team_lvl_cnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_teamCd02" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="team_cd" type="STRING" size="6"/>
          <Column id="team_nm" type="STRING" size="50"/>
          <Column id="hgrn_team_cd" type="STRING" size="6"/>
          <Column id="cntr_cd" type="STRING" size="6"/>
          <Column id="team_lvl_cnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dutyCdList2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="6"/>
          <Column id="cd_nm" type="STRING" size="100"/>
          <Column id="adtl_cd" type="STRING" size="100"/>
          <Column id="adtl_cd_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_userStatCdList2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="6"/>
          <Column id="cd_nm" type="STRING" size="100"/>
          <Column id="adtl_cd" type="STRING" size="100"/>
          <Column id="adtl_cd_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_user_typ_cd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="6"/>
          <Column id="cd_nm" type="STRING" size="100"/>
          <Column id="adtl_cd" type="STRING" size="100"/>
          <Column id="adtl_cd_nm" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_athrList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="athr_cd" type="STRING" size="256"/>
          <Column id="athr_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="consBswrTypCdList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_File" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="file_size_vl" type="STRING" size="256"/>
          <Column id="file_cntn" type="BLOB" size="256"/>
          <Column id="file_id" type="STRING" size="256"/>
          <Column id="file_nm" type="STRING" size="256"/>
          <Column id="atch_typ_cd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/********************************************************************************************/
/* 1. Include Library include, variables Declaration 영역                                  */
/********************************************************************************************/
include "LIB::lib_All.xjs";

var total_count = 0;   // 전체건수
var check_cnt = 0; //ID중복건수
var id_flag = "";//ID중복체크 확인
var file_flag = "N";//파일변경시 Y세팅
var new_yn = "N";//신규저장여부

var gv_user_id = "";
var gv_file_id = ""; // appfm_img_path
var gv_rltn_tbl_nm = "TB_USER";
var gv_atch_typ_cd = "20";

var arrFiles = new Array();	// FileDialog 선택을 통한 File Array
var fv_svcPath = gfn_getServiceUrl("fileUrl");
var xlsRrnoYn; 	// 엑셀 개인정보 권한 여부

/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리                                           	*/
/********************************************************************************************/
function PS080300_onload(obj:Form, e:LoadEventInfo)
{
	gfn_getList("cd","USR010,USR020,USR030,USR040");   //코드조회
	gfn_getList("teamCd","", "fn_callBack", null, null, "ds_teamCd"); //팀코드조회
	gfn_createPagingDataset(obj); // 페이징처리 위한 데이터셋 설정
	
	fn_setAthrPgmBtn();				// 권한에 따른 버튼 설정
	
	fn_commSearch(gfn_getCommTypeInit());
	
//trace(sUserAthrCd);

/* 김경욱매니져 요청  시스템관리자 추가  및  비밀번호 버튼도 권한추가 */
	fn_button_auth();
}

//초기화
function fn_init()
{
	//정훈 소스변경 업체간 검색조건 변경
// 	var sUserAthrCd =gds_UserInfo.getColumn(gds_UserInfo.rowposition,'athr_cd');
// 	if(sUserAthrCd.substr(0,2)=='TM'){
// 		cbo_teamCd1.value = 'T20000';
// 		cbo_teamCd1.enable = false;
// 		gfn_getTeamCodeLoad(cbo_teamCd1.value, "ALL", ds_teamCd2, ds_teamCd);
// 		cbo_teamCd2.value = gds_UserInfo.getColumn(gds_UserInfo.rowposition,'team_cd');
// 		cbo_teamCd2.enable = false;
// 	}else{
// 		cbo_teamCd1.index = 0;
// 		cbo_teamCd2.index = 0;
// 		cbo_teamCd2.enable = false;
// 	}
	cbo_teamCd1.index = 0;
	cbo_teamCd2.index = 0;
	cbo_teamCd2.enable = false;
	
	
	cbo_dutyCdList.index = 0;
	cbo_athrList_s.index = 0;
	cbo_userStatCdList.index = 0;
	cbo_searchItem.index = 0;
	edt_item.value = "";
}

/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
function fn_callBack(svcid, errcd, errmsg) 
{
	if (errcd != 0) {
		trace(errcd)
		return false;
	} else {
		switch (svcid) {
			case "selectCode":
				gfn_getCode("USR040", "ALL", consBswrTypCdList); //담당업무
				gfn_getCode("USR030", "ALL", ds_dutyCdList); //직무유형
				gfn_getCode("USR020", "ALL", ds_userStatCdList); //근무상태
				gfn_getCode("USR030", "SELECT", ds_dutyCdList2); //직무유형
				gfn_getCode("USR020", "SELECT", ds_userStatCdList2); //근무상태
				gfn_getCode("USR010", "SELECT", ds_user_typ_cd); //직원유형
				
				cbo_dutyCdList.index = 0;
				cbo_userStatCdList.index = 0;
				cbo_searchItem.index = 0;
				//trace(consBswrTypCdList.saveXML());
 			break;
 			
			case "selectTeamCode": //팀코드 조회
				gfn_getTeamCodeLoad("", "ALL", ds_teamCd1, ds_teamCd, "1");
				gfn_getTeamCodeLoad("", "SELECT", ds_teamCd01, ds_teamCd, "1");
				//정훈 소스변경 업체간 검색조건 변경
				var sUserAthrCd =gds_UserInfo.getColumn(gds_UserInfo.rowposition,'athr_cd');
				if(sUserAthrCd.substr(0,2)=='TM'){
					cbo_teamCd1.value = 'T20000';
					cbo_teamCd1.enable = false;
					gfn_getTeamCodeLoad(cbo_teamCd1.value, "ALL", ds_teamCd2, ds_teamCd);
					cbo_teamCd2.value = gds_UserInfo.getColumn(gds_UserInfo.rowposition,'team_cd');
					cbo_teamCd2.enable = false;
				}else{
					cbo_teamCd1.value = "";
					cbo_teamCd1_onitemchanged(cbo_teamCd1);
				}
			break;
			
			case "getUserList":
				id_flag = "";
				fn_readMode();   
				fn_button_auth(); //  김경욱 매니져 요청   20170227 처리
				//trace(ds_list_tmp.saveXML());
				gfn_appendSearchDs(ds_list_user, ds_list_tmp); // 조회된 결과를 실제보여줄 데이타셋으로 Append처리
				gfn_setTotalRowCount(ds_list_user, sta_totalCnt, total_count); // 페이지건수 표출
				
				if(ds_list_user.rowcount > 0){
					ds_user.clearData();
					ds_user.addRow();
					ds_user.copyRow(0, ds_list_user, ds_list_user.rowposition);
					gfn_phoneNumObj(Mask_clph_no);
					gfn_phoneNumObj(Mask_edt_tlno);
					//trace(ds_user.saveXML());
					var sConsBswrTypCd = ds_user.getColumn(0, "cons_bswr_typ_cd");
					Check_In.value = "";
					Check_Out.value = "";
					if(!gfn_isNull(sConsBswrTypCd)){
						if(sConsBswrTypCd.indexOf(",") != -1){
							//trace("다건");
							/*
							var objArr;
							objArr = sConsBswrTypCd.split(","); 
							var typCD1 = objArr[0];
							var typCD2 = objArr[1];
							*/
							Check_In.value = "1";
							Check_Out.value = "1";
						}else{
							//trace("단건");
							if(sConsBswrTypCd.indexOf("10") != -1){
								Check_In.value = "1";
							}else{
								Check_Out.value = "1";
							}
						}
					}
					
					gfn_getTeamCodeLoad(cbo_teamCd01.value, "ALL", ds_teamCd02, ds_teamCd);
					
					//gv_user_id = ds_user.getColumn(0, "user_id");
					if(!gfn_isNull(gv_file_id)){
						//gv_file_id = ds_user.getColumn(0, "file_id");
						fn_imageLoad();
					}else if(!gfn_isNull(ds_user.getColumn(0, "file_id"))){
						//gv_file_id = ds_user.getColumn(0, "file_id");
						fn_imageLoad();
					}else{
						img_appfm_no.image = "URL('theme://images/xxx_jpg.png')";
					}	
					
				}else{
					ds_user.clearData();
				}
				
				//fn_readMode();
				fn_cntrList();//센터코드
			break;	
			
			case "srchAccountNoFile":
				gv_file_id = ds_File.getColumn(0, "file_id");
				fn_imageLoad();
			break;
			
			case "deleteFile":
				gv_file_id = "";
				//img_appfm_no.image = "URL('theme://images/xxx_jpg.png')";
				btn_fileAdd.visible = true;
				btn_fileDel.visible = false;
				ds_user.setColumn(ds_user.rowposition, "file_id", "");
				img_appfm_no.image = "URL('theme://images/xxx_jpg.png')";
				fn_srchAccntNoFile();
				//fn_commSearch(gfn_getCommTypeInit());
			break;
			
			case "getCntrList":
				gfn_appendSearchDs(ds_cntrCdList, ds_list_tmp); // 조회된 결과를 실제보여줄 데이타셋으로 Append처리
				ds_cntrCdList.insertRow(0);
				ds_cntrCdList.setColumn(0, "cntr_cd", "");
				ds_cntrCdList.setColumn(0, "cntr_nm", "선택");
				//cbo_cntr.index = 0;
				fn_athrList();//권한코드
			break;
			
			case "getAthrList":
				//trace(ds_list_tmp.saveXML());
				gfn_appendSearchDs(ds_athrList, ds_list_tmp); // 조회된 결과를 실제보여줄 데이타셋으로 Append처리
				ds_athrList.insertRow(0);
				ds_athrList.setColumn(0, "athr_cd", "");
				ds_athrList.setColumn(0, "athr_nm", "선택");
				cbo_athrList_s.index = 0;
			break;
			
			case "saveUser":
				fn_commSearch(gfn_getCommTypeInit());
			break;
			
			case "initPass":
				alert("비밀번호가 초기화 되었습니다.");
				fn_commSearch(gfn_getCommTypeInit());
			break;
			
			case "getLoginIdIdDuplicateCount":
				if(check_cnt > 0){
					alert(edt_lgn_id.value + "는 이미 사용중인 아이디 입니다.");
					return false;
				}else{
					if(!confirm(edt_lgn_id.value + "는 사용할 수 있는 아이디 입니다. 사용하시겠습니까?")) {
						return false;
					}
					btn_idCheck.visible = false;
					id_flag = "Y";
				}
				
			break;
			
		}	
 	}		
}

/********************************************************************************************/
/**   4. Validation 처리                                                                   	*/
/********************************************************************************************/
//팀코드 1
function fn_preChngTeam1(item1 , item2, inDs)
{
	if (gfn_isNull(item1.value)) {
		item2.index = "0";
		item2.enable = false;
		
		return false;
	}
	return true;
}

/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)                                                   	*/
/********************************************************************************************/
//조회
function fn_commSearch(sType)
{
	if(file_flag == "Y"){
		alert("이미지파일이 변경되었습니다. 저장 후 조회하세요.");
		return false;
	}
	
	if (sType == gfn_getCommTypeInit())
	{
		// 조회조건 및 default 정렬
		ds_list_user.clearData();
	}	
	
	ds_inqCndt.clearData();
	ds_inqCndt.addRow();
	
	ds_inqCndt.setColumn(0, "duty_cd", cbo_dutyCdList.value);
	ds_inqCndt.setColumn(0, "hgrn_team_cd", cbo_teamCd1.value);
	ds_inqCndt.setColumn(0, "team_cd", cbo_teamCd2.value);
	ds_inqCndt.setColumn(0, "user_stat_cd", cbo_userStatCdList.value);
	ds_inqCndt.setColumn(0, "searchItem", cbo_searchItem.value);
	ds_inqCndt.setColumn(0, "item", edt_item.value);
	ds_inqCndt.setColumn(0, "orderBy", "amnt_dttm");
	ds_inqCndt.setColumn(0, "orderDirection", "desc");
	ds_inqCndt.setColumn(0, "athr_cd", cbo_athrList_s.value);
	
	
	
	
	
	// 호출 건수 설정 및 조회여부 설정
	if(!gfn_pageSearch(sType, ds_list_user, sta_totalCnt, 1000, total_count)) return;
	
	var szSvcid       = "getUserList";
    var szController  = "/user/user/list";
    var szInDs        = "ds_input=ds_inqCndt";
    var szOutDs       = "ds_list_tmp=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

//센터코드조회
function fn_cntrList()
{
	ds_cntrCdList.clearData();
	ds_inqCndt.clearData();
	ds_inqCndt.addRow();
	ds_inqCndt.setColumn(0, "use_yn", "Y");//사용여부
	ds_inqCndt.setColumn(0, "combo_yn", "Y");//콤보여부
	
	var szSvcid       = "getCntrList";
    var szController  = "/user/cntr/list";
    var szInDs        = "ds_input=ds_inqCndt";
    var szOutDs       = "ds_list_tmp=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

//권한코드조회
function fn_athrList()
{
	ds_athrList.clearData();
	var sUserAthrCd = gds_UserInfo.getColumn(gds_UserInfo.rowposition,'athr_cd');
	//업체간 검색조건 변경
	if(sUserAthrCd.substr(0,2)=='TM'){
		ds_inqCndt.clearData();
		ds_inqCndt.addRow();	
		ds_inqCndt.setColumn(0, "athr_cd2", sUserAthrCd.substr(0,3));
	}
	var szSvcid       = "getAthrList";
    var szController  = "/syst/athr/list";
    var szInDs        = "ds_input=ds_inqCndt";
    var szOutDs       = "ds_list_tmp=ds_athr";
    var szParam       = "";
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

// 파일 조회
function fn_srchAccntNoFile()
{
	ds_inqCndt.clearData();
	ds_inqCndt.addRow();
	ds_inqCndt.setColumn(0, "rltn_item_id", ds_user.getColumn(0, "user_id"));
	ds_inqCndt.setColumn(0, "rltn_tbl_nm", gv_rltn_tbl_nm);
	
	var szSvcid       = "srchAccountNoFile";
    var szController  = "/file/list";
    var szInDs        = "ds_input=ds_inqCndt";
    var szOutDs       = "ds_File=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback , false);
}

//파일삭제
function fn_delFile()
{	
	file_flag = "Y";
	ds_inqCndt.clearData();
	ds_inqCndt.addRow();
	ds_inqCndt.setColumn(0, "file_id", ds_user.getColumn(ds_user.rowposition, "file_id"));

	var szSvcid       = "deleteFile";
    var szController  = "/file/delete/real";
    var szInDs        = "ds_input=ds_inqCndt";
    var szOutDs       = "";
    var szParam       = "";
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback , false);
}

//저장
function fn_save()
{
	if(new_yn == "Y" && id_flag != "Y"){
		alert("사용자ID 중복체크를 하세요.");
        return false;
	}
	if(gfn_isNull(edt_user_nm.value)){
		alert("성명을 입력 하세요.");
        return false;
	}
	if(gfn_isNull(cbo_cntr.value)){
		alert("센터를 하세요.");
        return false;
	}
	if(gfn_isNull(cbo_teamCd01.value)){
		alert("상담그룹을 선택 하세요.");
        return false;
	}
	if(gfn_isNull(cbo_teamCd02.value)){
		alert("상담그룹을 선택 하세요.");
        return false;
	}
	if(gfn_isNull(cbo_duty_cd.value)){
		alert("직무유형을 선택 하세요.");
        return false;
	}
	if(gfn_isNull(cbo_athrList.value)){
		alert("권한유형을 선택 하세요.");
        return false;
	}
	
	var sConsBswrTypCd = "";
	
	if(Check_In.value == "1" && Check_Out.value == "1"){
		sConsBswrTypCd = "10,20";
	}else if(Check_In.value == "1"){
		sConsBswrTypCd = "10";
	}else if(Check_Out.value == "1"){
		sConsBswrTypCd = "20";
	}else{
		sConsBswrTypCd = "";
	}
	//alert(sConsBswrTypCd);
	ds_user.setColumn(0, "cons_bswr_typ_cd", sConsBswrTypCd);
	var szSvcid       = "saveUser";
    var szController  = "/user/user/save";
    var szInDs        = "ds_input=ds_user";
    var szOutDs       = "";
    var szParam       = "";
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback , false);
}

/********************************************************************************************/
/**   6. 사용자 함수                                                                   	*/
/********************************************************************************************/
//저장모드
function fn_saveMode()
{
	btn_new.visible = false;
	btn_update.visible = false;
	btn_save.visible = true;
	btn_cancel.visible = true;
	
	btn_fileAdd.visible =  false;
	btn_fileDel.visible = false;
	
	edt_user_nm.readonly = false;//성명
	btn_resetPass.visible = false;//비밀번호초기화
	cbo_cntr.readonly = false;//센터
	
	//업체간 검색조건 변경
	var sUserAthrCd = gds_UserInfo.getColumn(gds_UserInfo.rowposition,'athr_cd');
	if(sUserAthrCd.substr(0,2)=='TM'){
		ds_user.setColumn(0, "hgrn_team_cd", cbo_teamCd1.value);
		//조회 팀1콤보 변경시
		fn_changeTeam1Cd2(cbo_teamCd01 , cbo_teamCd02, ds_teamCd02);
		ds_user.setColumn(0, "team_cd", cbo_teamCd2.value);
	}else{
		cbo_teamCd01.readonly = false;//상담그룹1
		cbo_teamCd02.readonly = false;//상담그룹2
		cbo_teamCd01.index = 0;
	}
	
	edt_lgn_id.readonly = false;//사용자ID
	btn_idCheck.visible = true;//사용자ID중복체크
	cbo_duty_cd.readonly = false;//직무유형
	cbo_athrList.readonly = false;//권한유형
	Check_In.readonly = false;//담당업무
	Check_Out.readonly = false;//담당업무
	Radio_use_yn.readonly = false;//사용여부
	cbo_user_stat_cd.readonly = false;//근무상태
	msk_enco_dt.readonly = false;//입사일
	msk_rtco_dt.readonly = false;//퇴사일
	cbo_cti_use_yn.readonly = false;//CTI사용여부
	edt_cti_id.readonly = false;//CTI아이디
	edt_pty_grop_no.readonly = false;//파티그룹번호
	edt_acd_grop_no.readonly = false;//ACD그룹번호
	Mask_zpcd.readonly = false;//우편번호
	btn_zpcdSearch.visible = true;//우편번호검색버튼
	edt_home_addr.readonly = false;//주소
	edt_home_dtpt_addr.readonly =false;//상세주소
	Mask_clph_no.readonly = false;//핸드폰
	Mask_edt_tlno.readonly = false;//비상연락처
	edt_emil_addr.readonly = false;//이메일주소
	edt_extnNo.readonly = false;//내선번호
	edt_blng_comp_nm.readonly = false;//소속회사
	edt_prcnt_no.readonly = false;//기수정보
	cbo_user_typ_cd.readonly = false;//직원유형
	edt_empl_no.readonly = false;//직원번호
	edt_user_expi.readonly = false;//사용자설명
	cbo_excelYn.readonly = false;//엑셀권한
	
	stc_rgsr_nm.text = "";
	stc_amnd_nm.text = "";
	Mask_rgsn_dttm.mask = "";
	Mask_amnt_dttm.mask = "";
	med_last_lgn_dtm.mask = "";
}

//수정모드
function fn_updateMode()
{
	btn_new.visible = false;
	btn_update.visible = false;
	btn_save.visible = true;
	btn_cancel.visible = true;
	
	if(!gfn_isNull(ds_user.getColumn(0, "file_id"))){
		btn_fileDel.visible = true;
	}else{
		btn_fileAdd.visible =  true;
	}
	edt_user_nm.readonly = false;//성명
	btn_resetPass.visible = false;//비밀번호초기화
	cbo_cntr.readonly = false;//센터
	//업체간 검색조건 변경
	var sUserAthrCd = gds_UserInfo.getColumn(gds_UserInfo.rowposition,'athr_cd');
	if(sUserAthrCd.substr(0,2)=='TM'){
		cbo_teamCd01.readonly = true;
		cbo_teamCd02.readonly = true;
	}else{
		cbo_teamCd01.readonly = false;//상담그룹1
		cbo_teamCd02.readonly = false;//상담그룹2
	}
	edt_lgn_id.readonly = true;//사용자ID
	btn_idCheck.visible = false;//사용자ID중복체크
	cbo_duty_cd.readonly = false;//직무유형
	
	
	
	var sUserAthrCd =gds_UserInfo.getColumn(gds_UserInfo.rowposition,'athr_cd');
//	trace(sUserAthrCd);
	   if (sUserAthrCd == 'AT01' ) {  ///시스템 관리자만 수정가능 
		   cbo_athrList.readonly = false ;//권한유형
		
		} else {
		   cbo_athrList.readonly =  true;//권한유형
		}
	
	
	
	
	
	Check_In.readonly = false;//담당업무
	Check_Out.readonly = false;//담당업무
	Radio_use_yn.readonly = false;//사용여부
	cbo_user_stat_cd.readonly = false;//근무상태
	msk_enco_dt.readonly = false;//입사일
	msk_rtco_dt.readonly = false;//퇴사일
	cbo_cti_use_yn.readonly = false;//CTI사용여부
	edt_cti_id.readonly = false;//CTI아이디
	edt_pty_grop_no.readonly = false;//파티그룹번호
	edt_acd_grop_no.readonly = false;//ACD그룹번호
	Mask_zpcd.readonly = false;//우편번호
	btn_zpcdSearch.visible = true;//우편번호검색버튼
	edt_home_addr.readonly = false;//주소
	edt_home_dtpt_addr.readonly =false;//상세주소
	Mask_clph_no.readonly = false;//핸드폰
	Mask_edt_tlno.readonly = false;//비상연락처
	edt_emil_addr.readonly = false;//이메일주소
	edt_extnNo.readonly = false;//내선번호
	edt_blng_comp_nm.readonly = false;//소속회사
	edt_prcnt_no.readonly = false;//기수정보
	cbo_user_typ_cd.readonly = false;//직원유형
	edt_empl_no.readonly = false;//직원번호
	edt_user_expi.readonly = false;//사용자설명
	cbo_excelYn.readonly = false;//엑셀권한
	
	stc_rgsr_nm.text = "";
	stc_amnd_nm.text = "";
	Mask_rgsn_dttm.mask = "";
	Mask_amnt_dttm.mask = "";
	med_last_lgn_dtm.mask = "";
	
	stc_rgsr_nm.text = "";
	stc_amnd_nm.text = "";
	Mask_rgsn_dttm.mask = "";
	Mask_amnt_dttm.mask = "";
	med_last_lgn_dtm.mask = "";
}

//읽기모드
function fn_readMode()
{
	//btn_new.visible = true;
	//btn_update.visible = true;
	btn_save.visible = false;
	btn_cancel.visible = false;
	
	btn_fileAdd.visible = false;
	btn_fileDel.visible = false;
	
	edt_user_nm.readonly = true;//성명
	//btn_resetPass.visible = true;//비밀번호초기화
	cbo_cntr.readonly = true;//센터
	cbo_teamCd01.readonly = true;//상담그룹1
	cbo_teamCd02.readonly = true;//상담그룹2
	edt_lgn_id.readonly = true;//사용자ID
	btn_idCheck.visible = false;//사용자ID중복체크
	cbo_duty_cd.readonly = true;//직무유형
	cbo_athrList.readonly = true;//권한유형
	Check_In.readonly = true;//담당업무
	Check_Out.readonly = true;//담당업무
	Radio_use_yn.readonly = true;//사용여부
	cbo_user_stat_cd.readonly = true;//근무상태
	msk_enco_dt.readonly = true;//입사일
	msk_rtco_dt.readonly = true;//퇴사일
	cbo_cti_use_yn.readonly = true;//CTI사용여부
	edt_cti_id.readonly = true;//CTI아이디
	edt_pty_grop_no.readonly = true;//파티그룹번호
	edt_acd_grop_no.readonly = true;//ACD그룹번호
	Mask_zpcd.readonly = true;//우편번호
	btn_zpcdSearch.visible = false;//우편번호검색버튼
	edt_home_addr.readonly = true;//주소
	edt_home_dtpt_addr.readonly = true;//상세주소
	Mask_clph_no.readonly = true;//핸드폰
	Mask_edt_tlno.readonly = true;//비상연락처
	edt_emil_addr.readonly = true;//이메일주소
	edt_extnNo.readonly = true;//내선번호
	edt_blng_comp_nm.readonly = true;//소속회사
	edt_prcnt_no.readonly = true;//기수정보
	cbo_user_typ_cd.readonly = true;//직원유형
	edt_empl_no.readonly = true;//직원번호
	edt_user_expi.readonly = true;//사용자설명
	cbo_excelYn.readonly = true;//엑셀권한
	
	Mask_rgsn_dttm.mask = "####-##-## ##:##";
	Mask_amnt_dttm.mask = "####-##-## ##:##";
	med_last_lgn_dtm.mask = "####-##-## ##:##";
}	

//상단 팀 코드 1변경
function fn_changeTeam1Cd(item1 , item2, inDs)
{
	if (!fn_preChngTeam1(item1 , item2, inDs)) return false;
	
	gfn_getTeamCodeLoad(item1.value, "ALL", inDs, ds_teamCd);
	//정훈 소스변경 업체간 검색조건 변경
	var sUserAthrCd =gds_UserInfo.getColumn(gds_UserInfo.rowposition,'athr_cd');
	
	if(item1.value == 'T20000'){
		if(sUserAthrCd.substr(0,2)=='TM'){
			item2.value = gds_UserInfo.getColumn(gds_UserInfo.rowposition,'team_cd');
			item2.enable = false;
		}else{
			item2.index = "0";
			item2.enable = true;
		}
	}else{
		item2.index = "0";
		item2.enable = true;
	}
}

//하단 팀 코드 1변경
function fn_changeTeam1Cd2(item1 , item2, inDs)
{
	if (!fn_preChngTeam1(item1 , item2, inDs)) return false;
	
	gfn_getTeamCodeLoad(item1.value, "SELECT", inDs, ds_teamCd);
	
	
	item2.index = "0";
	item2.enable = true;
}

// 이미지 설정
function fn_imageLoad()
{
	//trace(ds_user.getColumn(ds_user.rowposition, "file_id"));
	//trace(gv_file_id);
	if (!gfn_isNull(gv_file_id)) {
		img_appfm_no.image = "URL('fileUrl::/file/download?file_id="+gv_file_id+"')";
	}else if(!gfn_isNull(ds_user.getColumn(ds_user.rowposition, "file_id"))){
		img_appfm_no.image = "URL('fileUrl::/file/download?file_id="+ds_user.getColumn(ds_user.rowposition, "file_id")+"')";
	}else{
		img_appfm_no.image = "URL('theme://images/xxx_jpg.png')";
	}
	gv_file_id = "";
}

/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
//상단 팀콤보 1변경시
function cbo_teamCd1_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	//조회 팀1콤보 변경시
	fn_changeTeam1Cd(cbo_teamCd1 , cbo_teamCd2, ds_teamCd2)
}

//하단 팀콤보 1변경시
function cbo_teamCd1_onitemchanged2(obj:Combo, e:ItemChangeEventInfo)
{
	//조회 팀1콤보 변경시
	fn_changeTeam1Cd2(cbo_teamCd01 , cbo_teamCd02, ds_teamCd02)
}

//오버스크롤
function Grid00_onvscrolllastover(obj:Grid, e:ScrollEventInfo)
{
	fn_commSearch(gfn_getCommTypeAppend());
}

//조회버튼클릭
function btn_Search_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_commSearch(gfn_getCommTypeInit());
}

//초기화버튼클릭
function btn_Init_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_init();
}

//유져 신규 등록 및 수정 권한 비트 
function fn_button_auth()
{ 

   	var sUserAthrCd =gds_UserInfo.getColumn(gds_UserInfo.rowposition,'athr_cd');
	var sUserId = gds_UserInfo.getColumn(gds_UserInfo.rowposition,'user_id')
   if (sUserAthrCd == 'OP10'||sUserAthrCd == 'AT01' ||  sUserAthrCd == 'CC10' || sUserAthrCd == 'CC20' || sUserAthrCd == 'TM10' ||  sUserAthrCd == 'TM20' ||  sUserAthrCd == 'TM30' || sUserAthrCd == 'OP46') {
		btn_new.visible = true;
		btn_update.visible = true;
		if  (sUserAthrCd == 'AT01') {
			btn_resetPass.visible = true;
		}
	} else {
		btn_new.visible = false;
		btn_update.visible = false;
		if  (sUserAthrCd == 'AT01') {
			btn_resetPass.visible = false;
		}
	}
}



//파일선택
function btn_fileAdd_onclick(obj:Button,  e:ClickEventInfo)
{
	//alert(gv_file_id);
	if (!gfn_isNull(ds_user.getColumn(ds_user.rowposition, "file_id"))) {
		alert("최대 1개의 파일을 첨부할 수 있습니다.");
		return false;
	}
	var sFilterType, sFilePath, sFileName, nFileSize, objContents;
	
	//다이얼로그 타입 
	sFilterType = "image files (*.jpg;*.jpeg;*.gif;*.png;)|*.jpg;*.jpeg;*.gif;*.png"; // 이미지 파일만 저장 가능
	
	//다이얼로그창 
 	fileDialog = objects["fileDialog"];
 	if (fileDialog == null) {
		fileDialog = new FileDialog();
	}
	fileDialog.defaultextention = true;
	fileDialog.filter = sFilterType;
	
	var vFile = fileDialog.open("파일 추가", FileDialog.LOAD);
    if (!vFile) return;	//파일을 선택하지 않은 경우
        
    arrFiles[0] = vFile;	               // 파일 배열 생성
    vFile.open(VirtualFile.openRead| VirtualFile.openBinary);
    sFilePath = vFile.path;
    sFileName = vFile.filename;
    nFileSize = vFile.getFileSize();
    vFile.close();
            
    ds_File.clearData();
    ds_File.addRow();
    ds_File.addColumn("file_size_vl", "string", 256);
    ds_File.addColumn("file_cntn", "string", 256);
    ds_File.addColumn("file_id", "string", 256);
    ds_File.addColumn("file_nm", "string", 256);
    ds_File.addColumn("atch_typ_cd", "string", 256);
    ds_File.setColumn(0, "file_size_vl", nFileSize);
    ds_File.setColumn(0, "file_nm", sFileName);
	ds_File.setColumn(0, "atch_typ_cd", gv_atch_typ_cd);

    var rVal = fn_fileUpload();
	if (rVal) {
		btn_fileAdd.visible = false;
		btn_fileDel.visible = true;
		fn_srchAccntNoFile();
		//fn_commSearch(gfn_getCommTypeInit());
	}
}

//파일저장
function fn_fileUpload()
{
	file_flag = "Y";
	var bResult;
	sWorkMode = "UPLOAD";
 	httpObjectInput = objects["httpObject"];

 	if (httpObjectInput == null) {
		httpObjectInput = new HttpObject();
	}
	
 	//파일올릴때 파라미터같이 올릴때URL에 파라미터값 붙여서 넘기는방법 추후 좋은방법 있을시 변경
	if (arrFiles.length == 1) {
		var Url = fv_svcPath +"file/insert?";
			Url += 'atch_typ_cd='+gv_atch_typ_cd;
			Url += '&rltn_item_id='+ds_user.getColumn(0, "user_id");
			Url += '&rltn_tbl_nm='+gv_rltn_tbl_nm;
		bResult = httpObjectInput.upload(Url, FileDialog.LOAD, arrFiles[0], false);
					
		if(bResult == false) {
			return false;
		}
	}
	
	return true;
}

//파일삭제버튼클릭
function btn_fileDel_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_delFile();
}

//그리드 셀클릭
function Grid00_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	if(file_flag == "Y"){
		alert("이미지파일이 변경되었습니다. 저장 후 조회하세요.");
		return false;
	}
	id_flag = "";
	fn_readMode();  //김경욱 매니져 요청   20170227 처리
	
	ds_user.clearData();
	ds_user.addRow();
	ds_user.copyRow(0, ds_list_user, e.row);
	//trace(ds_user.saveXML());
	gfn_phoneNumObj(Mask_clph_no);
	gfn_phoneNumObj(Mask_edt_tlno);
					
	var sConsBswrTypCd = ds_user.getColumn(0, "cons_bswr_typ_cd");
	Check_In.value = "";
	Check_Out.value = "";
	if(!gfn_isNull(sConsBswrTypCd)){
		if(sConsBswrTypCd.indexOf(",") != -1){
			//trace("다건");
			/*
			var objArr;
			objArr = sConsBswrTypCd.split(","); 
			var typCD1 = objArr[0];
			var typCD2 = objArr[1];
			*/
			Check_In.value = "1";
			Check_Out.value = "1";
		}else{
			//trace("단건");
			if(sConsBswrTypCd.indexOf("10") != -1){
				Check_In.value = "1";
			}else{
				Check_Out.value = "1";
			}
		}
	}
	
	gfn_getTeamCodeLoad(cbo_teamCd01.value, "ALL", ds_teamCd02, ds_teamCd);
	
	if(!gfn_isNull(gv_file_id)){
		//gv_file_id = ds_user.getColumn(0, "file_id");
		fn_imageLoad();
	}else if(!gfn_isNull(ds_user.getColumn(0, "file_id"))){
		//gv_file_id = ds_user.getColumn(0, "file_id");
		fn_imageLoad();
	}else{
		img_appfm_no.image = "URL('theme://images/xxx_jpg.png')";
	}
	
}

//비밀번호초기화버튼클릭
function btn_resetPass_onclick(obj:Button,  e:ClickEventInfo)
{
	if(!confirm("비밀번호를 초기화 하시겠습니까?")) {
		return false;
	}
	
	var szSvcid       = "initPass";
    var szController  = "/user/user/password/init";
    var szInDs        = "ds_input=ds_user";
    var szOutDs       = "";
    var szParam       = "";
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback , false);
	
}

//사용자 ID 중복체크
function btn_idCheck_onclick(obj:Button,  e:ClickEventInfo)
{
	if(gfn_isNull(edt_lgn_id.value)){
		alert("사용자ID를 입력하세요.");
        return false;
	}
	
	ds_inqCndt.clearData();
	ds_inqCndt.addRow();
	ds_inqCndt.setColumn(0, "lgn_id", edt_lgn_id.value);
	
	var szSvcid       = "getLoginIdIdDuplicateCount";
    var szController  = "/user/user/duplicate-count";
    var szInDs        = "ds_input=ds_inqCndt";
    var szOutDs       = "";
    var szParam       = "";
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback , false);
	
}

//신규등록버튼클릭
function btn_new_onclick(obj:Button,  e:ClickEventInfo)
{
	img_appfm_no.image = "URL('theme://images/xxx_jpg.png')";
	new_yn = "Y";
	ds_user.clearData();
	ds_user.addRow();
	fn_saveMode();
	cbo_cntr.index = 0;
	cbo_duty_cd.index = 0;
	cbo_athrList.index = 0;
	cbo_user_stat_cd.index = 0;
	Radio_use_yn.value = "Y";
	cbo_cti_use_yn.index = 0;
	cbo_user_typ_cd.index = 0;
	Check_In.value = "";
	Check_Out.value = "";
	cbo_excelYn.index = 0;
}

//수정버튼클릭
function btn_update_onclick(obj:Button,  e:ClickEventInfo)
{
	new_yn = "N";
	fn_updateMode();
}

//저장버튼클릭
function btn_save_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_save();
}

//취소버튼클릭
function btn_cancel_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_commSearch(gfn_getCommTypeInit());
}

//엑셀다운로드
function btn_excel_onclick(obj:Button,  e:ClickEventInfo)
{
	gfn_exportGridToExcel(Grid00, "사용자관리_"+gfn_getTodayFull()+"");
}

//우편번호 클릭
function btn_zpcdSearch_onclick(obj:Button,  e:ClickEventInfo)
{
	// 기존 주소검색 폐지 / 2017.04.10 부로 다음API사용
	var sPrmr = {};
	var reVal = gfn_diaLog("주소 조회", -1, -1, 884, 601, "PS990000::PS992099.xfdl", false, sPrmr, false, false, true);	
}

// 주소 값 등록(팝업창 호출)
function fn_daum_addr()
{
	Mask_zpcd.value = gv_dpost; 
	edt_home_addr.value = gv_daddr;	
}


//그리드헤더클릭
function Grid_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	gfn_grdHeadClick(obj, e);
}

//엔터조회
function edt_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13) { // 엔터
		fn_commSearch(gfn_getCommTypeInit());
	}
}

// 전화번호 설정
function phone_ontextchanged(obj:Edit,  e:TextChangedEventInfo)
{
	obj.value = gfn_phoneNumStr(obj.value);
	obj.setCaretPos(-1);
}

function phone_onkillfocus(obj:Edit, e:KillFocusEventInfo)
{
	obj.value = gfn_phoneNumStr(obj.value);
}


/********************************************************************************************/
/**   사용자 함수                                                                         	*/
/********************************************************************************************/
// 권한에 따른 버튼 설정
function fn_setAthrPgmBtn()
{
	gfn_athrPgm(gfn_gdsCd_admin());
	
	if (xlsYn == "Y") {
		btn_excel.visible = true;		// 엑셀다운로드
 	} else {
		btn_excel.visible = false;
 	}
}

// 값이 사용안함일때 사용으로 변경 가능한 조건은 시스템관리자만 허용
function Radio_use_yn_canitemchange(obj:Radio, e:ItemChangeEventInfo)
{
	var sUserAthrCd = gds_UserInfo.getColumn(gds_UserInfo.rowposition, "athr_cd");
	var sListUserYn = ds_list_user.getColumn(ds_list_user.rowposition, "use_yn");
	
	if (new_yn != "Y")
	{
		if (sUserAthrCd != "AT01" && sListUserYn == "N") 
		{
			alert("사용여부의 변경은 시스템 관리자만 가능합니다.");
			Radio_use_yn.value = sListUserYn;
			return false;
		}
	}
}
]]></Script>
  </Form>
</FDL>
