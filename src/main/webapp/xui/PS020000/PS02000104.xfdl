<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="PS02000104" classname="PS02000104" inheritanceid="" position="absolute 0 0 745 410" titletext="상품 상세정보" onload="PS02000104_onload" scrollbars="none" ontimer="fn_recDualHr_ontimer">
    <Layouts>
      <Layout>
        <Static id="stc_45" class="sta_workData" position2="absolute l:27.52% r:0px t:226px h:26" positiontype="position2"/>
        <Calendar id="cal_kydate" taborder="197" enable="false" position2="absolute l:62.82% w:89 t:228 h:20" positiontype="position2" oneditclick="cal_kydate_oneditclick"/>
        <Static id="stc_48" class="sta_workData" position2="absolute l:27.52% r:0 t:51px h:26" positiontype="position2"/>
        <Button id="btn_updateCardCms" taborder="112" text="CMS/카드수정" onclick="btn_onclick" class="btn_WF_Common" tooltiptext="CMS/카드 수정" style="padding:0 0 0 0;" position2="absolute l:123 w:90 t:3 h:20" positiontype="position2" visible="false"/>
        <Button id="btn_cnctRgsn" taborder="111" text="해약등록" onclick="btn_onclick" class="btn_WF_Common" tooltiptext="해약등록" style="padding:0 0 0 0;" position2="absolute l:216 w:72 t:3 h:20" positiontype="position2" visible="false"/>
        <Button id="btn_srchEvent" taborder="110" text="행사조회" class="btn_WF_Common" tooltiptext="행사조회" style="padding:0 0 0 0;" position2="absolute l:5 w:111 t:240 h:17" positiontype="position2" onclick="btn_onclick" visible="false" enable="false"/>
        <Static id="stc_49" class="sta_workData" position2="absolute l:27.52% r:0px t:76px h:26" positiontype="position2"/>
        <Static id="stc_86" class="sta_workData" position2="absolute l:27.52% r:0px t:201px h:26" positiontype="position2"/>
        <Static id="stc_47" class="sta_workData" position2="absolute l:27.52% r:0 t:26 h:26" positiontype="position2"/>
        <Static id="stc_50" class="sta_workData" position2="absolute l:27.52% r:0px t:101px h:26" positiontype="position2"/>
        <Static id="stc_55" class="sta_workData" position2="absolute l:27.52% r:0px t:126px h:26" positiontype="position2"/>
        <Static id="stc_54" class="sta_workData" position2="absolute l:27.52% r:0px t:151px h:26" positiontype="position2"/>
        <Static id="stc_52" class="stc_product_end" position2="absolute l:27.52% r:0px t:176px h:26" positiontype="position2"/>
        <Static id="sta_GrayLine00" class="sta_WF_Line1" position2="absolute l:16.64% r:0px t:25px h:1" positiontype="position2"/>
        <Button id="btn_memberAddr" taborder="59" text="주소관리" style="padding:0 0 0 0;" position2="absolute l:90.2% w:69 t:204 h:20" positiontype="position2" onclick="btn_onclick"/>
        <Edit id="edt_inspl_addr2" taborder="58" position2="absolute l:71.14% w:18.93% t:204 h:20" positiontype="position2"/>
        <Static id="stc_87" text="설치장소" class="sta_workLabel1" validate="" position2="absolute l:16.64% w:11.14% t:201px h:26" positiontype="position2"/>
        <Edit id="edt_appfm_no" taborder="51" position2="absolute l:55.44% w:12.62% t:29 h:20" positiontype="position2" imemode="alpha" lengthunit="utf8" maxlength="6" inputmode="upper" inputtype="numberandenglish" visible="false"/>
        <Static id="stc_64" text="신청서" class="sta_workLabel1" validate="" position2="absolute l:44.03% w:11.14% t:26 h:26" positiontype="position2" visible="false"/>
        <Static id="stc_prod_start" text="회원번호" class="sta_workLabel1" validate="" position2="absolute l:16.64% w:11.14% t:26px h:26" positiontype="position2"/>
        <Static id="stc_43" text="상품내용" class="sta_workLabel1_P" validate="" position2="absolute l:16.64% w:11.14% t:51px h:26" positiontype="position2"/>
        <Grid id="grd_list_prod" taborder="48" binddataset="ds_list_prod" useinputpanel="false" autofittype="col" position2="absolute l:0 r:83.76% t:25 h:175" positiontype="position2" oncellclick="grd_list_oncellclick" style="align:left middle;" onmousemove="grd_onmousemove">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="118"/>
              </Columns>
              <Rows>
                <Row size="25" band="head"/>
                <Row size="25"/>
              </Rows>
              <Band id="head">
                <Cell text="가입상품"/>
              </Band>
              <Band id="body">
                <Cell style="align:left middle;selectfont: ;" text="bind:prod_nm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="stc_58" text="상품 상세정보" class="sta_workTitle2" position="absolute 0 5 104 25"/>
        <Static id="stc_74" text="상담사명" class="sta_workLabel1" validate="" position2="absolute l:71.41% w:11.14% t:126px h:26" positiontype="position2" style="color:#555555ff;"/>
        <Edit id="edt_cnsl_man" taborder="46" position2="absolute l:82.82% w:16.64% t:129 h:20" positiontype="position2" class="edt_clssEnable" readonly="true"/>
        <Static id="stc_76" text="만기일자" class="sta_workLabel1" validate="" position2="absolute l:44.03% w:11.14% t:126px h:26" positiontype="position2" style="color:#555555ff;"/>
        <Static id="stc_77" text="특별할인" class="sta_workLabel1" validate="" position2="absolute l:71.41% w:11.14% t:151px h:26" positiontype="position2"/>
        <Spin id="spn_new_chan_gunsu" taborder="43" position2="absolute l:82.82% w:11.41% t:154 h:20" positiontype="position2" value="0" max="999" ontextchanged="spn_ontextchanged" onkillfocus="spn_onkillfocus"/>
        <Static id="stc_1" class="sta_workLabel1" validate="" position2="absolute l:16.64% w:11.14% t:101px h:26" positiontype="position2" style="color:saddlebrown;" text="해피콜상태"/>
        <Combo id="cbo_prod_kind" taborder="41" innerdataset="@ds_cbo_prdtKind" codecolumn="seq" datacolumn="prod_kind_nm" position2="absolute l:82.82% w:16.64% t:78 h:22" positiontype="position2" displaynulltext="선택"/>
        <Static id="stc_79" text="상품종류" class="sta_workLabel1" validate="" position2="absolute l:71.41% w:11.14% t:76px h:26" positiontype="position2"/>
        <Static id="stc_81" text="모집사원" class="sta_workLabel1_P" validate="" position2="absolute l:71.41% w:11.14% t:51px h:26" positiontype="position2"/>
        <Static id="stc_99" text="모델분류" class="sta_workLabel1_P" validate="" position2="absolute l:16.64% w:11.14% t:76px h:26" positiontype="position2"/>
        <Static id="stc_94" text="가입구분" class="sta_workLabel1_P" validate="" position2="absolute l:16.64% w:11.14% t:151px h:26" positiontype="position2"/>
        <Combo id="cbo_join_cl" taborder="40" innerdataset="@ds_joinTypCd" codecolumn="cd" datacolumn="cd_nm" position2="absolute l:28.05% w:15.7% t:153px h:22" positiontype="position2" displaynulltext="선택"/>
        <Combo id="cbo_prod_model_kind" taborder="38" innerdataset="@ds_cbo_modlTyp" codecolumn="prod_kind" datacolumn="prod_kind_nm" position2="absolute l:28.05% w:15.7% t:78px h:22" positiontype="position2" displaynulltext="선택" onitemchanged="cbo_onitemchanged"/>
        <Static id="stc_62" text="모델명" class="sta_workLabel1" validate="" position2="absolute l:44.03% w:11.14% t:76px h:26" positiontype="position2"/>
        <Combo id="cbo_prod_model_cd" taborder="37" innerdataset="@ds_cbo_modlNm" codecolumn="modl_cd" datacolumn="modl_nm" position2="absolute l:55.44% w:15.7% t:78px h:22" positiontype="position2" displaynulltext="선택"/>
        <Static id="stc_61" text="납입방법" class="sta_workLabel1_P" validate="" position2="absolute l:71.41% w:11.14% t:101px h:26" positiontype="position2"/>
        <Combo id="cbo_pay_mthd" taborder="36" innerdataset="@ds_pyinMthdCd" codecolumn="cd" datacolumn="cd_nm" position2="absolute l:82.82% w:16.64% t:103 h:22" positiontype="position2" displaynulltext="선택" onitemchanged="cbo_onitemchanged"/>
        <Static id="stc_68" text="가입일자" class="sta_workLabel1_P" validate="" position2="absolute l:16.64% w:11.14% t:126px h:26" positiontype="position2"/>
        <Static id="stc_69" text="승인관계" class="sta_workLabel1" validate="" position2="absolute l:44.03% w:11.14% t:151px h:26" positiontype="position2" style="color:#555555ff;"/>
        <Edit id="edt_appr_reltn" taborder="32" position2="absolute l:55.44% w:15.7% t:154px h:20" positiontype="position2" class="edt_clssEnable" readonly="true" style="color:red;"/>
        <Static id="stc_93" text="B2B회사명" class="sta_workLabel1" validate="" position2="absolute l:16.64% w:11.14% t:176px h:26" positiontype="position2" style="font:Dotum,8,bold;"/>
        <Edit id="edt_b2b_comp_nm" taborder="31" position2="absolute l:28.05% w:12.75% t:179 h:20" positiontype="position2" onkeydown="edt_onkeydown" imemode="hangul" style="font:Dotum,9;"/>
        <Button id="btn_srchB2bComp" taborder="30" class="btn_workSrcPop" position2="absolute l:41.07% w:20 t:179px h:20" positiontype="position2" onclick="btn_onclick"/>
        <Static id="stc_91" text="B2B사원코드" class="sta_workLabel1" style="padding:6 0 0 6;font:Dotum,8,bold;" validate="" position2="absolute l:44.03% w:11.14% t:176px h:26" positiontype="position2"/>
        <Edit id="edt_b2b_emple_no" taborder="29" position2="absolute l:55.44% w:6.71% t:179 h:20" positiontype="position2" imemode="alpha" style="font:Dotum,9;"/>
        <Static id="stc_63" text="해약금" class="sta_workLabel1" validate="" position2="absolute l:44.03% w:11.14% t:101px h:26" positiontype="position2" style="color:saddlebrown;"/>
        <Static id="stc_82" text="담당사원" class="sta_workLabel1_P" validate="" position2="absolute l:71.41% w:11.14% t:26px h:26" positiontype="position2"/>
        <Button id="btn_befEmple" taborder="20" class="btn_workSrcPop" position2="absolute l:96.91% w:20 t:54 h:20" positiontype="position2" onclick="btn_onclick"/>
        <Static id="stc_42" text="삼성매장정보" class="sta_workLabel1" validate="" position2="absolute l:71.41% w:11.14% t:176px h:26" positiontype="position2" style="color:#555555ff;padding:6 1 0 5;font:Dotum,8,bold;"/>
        <Edit id="edt_sm_shop_nm" taborder="19" position2="absolute l:82.82% w:13.83% t:179 h:20" positiontype="position2" visible="false" onkeydown="edt_onkeydown" imemode="hangul" style="font:Dotum,9;"/>
        <Button id="btn_srchSmShop" taborder="18" class="btn_workSrcPop" position2="absolute l:96.91% w:20 t:179 h:20" positiontype="position2" visible="false" onclick="btn_onclick"/>
        <Button id="btn_srchPhoneTyp" taborder="16" text="가져오기" style="padding:0 0 0 0;" position2="absolute l:41.07% w:69 t:229 h:20" positiontype="position2" onclick="btn_onclick"/>
        <Button id="btn_save_prod" taborder="8" onclick="btn_dsps_onclick" class="btn_WF_Save" tooltiptext="저장" style="padding:0 0 0 0;" position2="absolute r:-81 w:72 t:3 h:20" positiontype="position2" visible="false"/>
        <Button id="btn_cancel_prod" taborder="7" text="취소" onclick="btn_dsps_onclick" class="btn_Cancel" tooltiptext="취소" style="border:0 none #000000ff ;padding:0 0 0 0;" position2="absolute r:-156 w:72 t:3 h:20" positiontype="position2" visible="false"/>
        <Button id="btn_Search00" taborder="1" onclick="btn_Search_onclick" class="btn_WF_Del" position="absolute -591 176 -519 196" tooltiptext="삭제" style="shadow:drop 0,0 0 #00000033;"/>
        <Button id="btn_samsung" taborder="115" text="삼성인증" onclick="btn_onclick" tooltiptext="삼성인증" style="padding:0 0 0 0;" position2="absolute r:3 w:50 t:229 h:20" positiontype="position2"/>
        <Button id="btn_del_prod" taborder="117" onclick="btn_dsps_onclick" class="btn_WF_Del" tooltiptext="삭제" style="shadow:drop 0,0 0 #00000033;" position2="absolute r:4 w:72 t:3 h:20" positiontype="position2" visible="false"/>
        <Edit id="edt_inspl_phone" taborder="119" position2="absolute l:28.05% w:12.75% t:229 h:20" positiontype="position2" lengthunit="utf8" inputtype="number,symbol" maxlength="13" onkillfocus="phone_onkillfocus" ontextchanged="phone_ontextchanged"/>
        <Static id="stc_126" text="연락처" class="sta_workLabel1" validate="" position2="absolute l:16.64% w:11.14% t:226px h:26" positiontype="position2"/>
        <Static id="stc_01" class="sta_workData" position2="absolute l:27.52% r:0 t:251 h:26" positiontype="position2"/>
        <Static id="stc_00" text="상조납입상태" class="sta_workLabel1" position2="absolute l:16.64% w:11.14% t:251 h:26" positiontype="position2" validate="" style="color:saddlebrown;padding:6 0 0 7;font:Dotum,8,bold;"/>
        <Edit id="edt_pay_state" taborder="129" position2="absolute l:28.05% w:10.34% t:254 h:20" positiontype="position2" enable="true" readonly="true" class="edt_clssEnable" style="color:red;font:Dotum,9,bold;"/>
        <Static id="stc_02" text="행사상태" class="sta_workLabel1" position2="absolute l:60.81% w:9.13% t:251 h:26" positiontype="position2" validate="" style="color:saddlebrown;align:middle;font:Dotum,8,bold;"/>
        <Edit id="edt_event_nm" taborder="130" position2="absolute l:70.07% w:12.89% t:254 h:20" positiontype="position2" enable="true" class="edt_clssEnable" readonly="true" style="color:red;font:Dotum,9,bold;"/>
        <Static id="stc_03" text="결합납입상태" class="sta_workLabel1" position2="absolute l:38.66% w:11.14% t:251 h:26" positiontype="position2" validate="" style="color:darkorchid;padding:6 0 0 7;font:Dotum,8,bold;"/>
        <Edit id="edt_union_pay_state" taborder="131" position2="absolute l:50.07% w:10.34% t:254 h:20" positiontype="position2" enable="true" class="edt_clssEnable" readonly="true" style="color:red;font:Dotum,9,bold;"/>
        <Grid id="grd_list_prodSrvc" taborder="136" useinputpanel="false" autofittype="col" position2="absolute l:0 r:67.79% t:280 h:126" positiontype="position2" binddataset="ds_list_prodSrvc" cellsizingtype="col" oncellclick="grd_list_oncellclick" onmousemove="grd_onmousemove">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="25"/>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="131"/>
              </Columns>
              <Rows>
                <Row size="25" band="head"/>
                <Row size="25"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="normal" edittype="none" style="checkboxsize: ;"/>
                <Cell col="1" text="구분"/>
                <Cell col="2" text="회차"/>
                <Cell col="3" text="부가서비스"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="expr:vital_service==&quot;Y&quot; ||  isu_yn == &quot;Y&quot; ? &quot;none&quot; : &quot;checkbox&quot;" style="background:expr:vital_service==&quot;Y&quot; ||  isu_yn == &quot;Y&quot; ? &quot;#dededeff&quot; : &quot;&quot;;background2:expr:vital_service==&quot;Y&quot; ||  isu_yn == &quot;Y&quot; ? &quot;#dededeff&quot; : &quot;&quot;;selectbackground:expr:vital_service==&quot;Y&quot; ||  isu_yn == &quot;Y&quot; ? &quot;#dededeff&quot; : &quot;&quot;;" text="bind:_chk"/>
                <Cell col="1" text="bind:svc_event_bf_cl"/>
                <Cell col="2" text="bind:app_no"/>
                <Cell col="3" style="align:left middle;" text="bind:opt_svc_nm_ex"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="stc_prod_srvc_start" text="리조트구분" class="sta_workLabel1" style="padding:6 0 0 12;" validate="" position2="absolute l:32.48% w:10.74% t:280 h:26" positiontype="position2"/>
        <Static id="stc_66" class="sta_workData" position2="absolute l:43.09% r:0 t:280 h:26" positiontype="position2"/>
        <Static id="stc_67" text="리조트번호" class="sta_workLabel1" validate="" position2="absolute l:55.84% w:10.74% t:280 h:26" positiontype="position2" style="padding:6 1 0 12;"/>
        <Combo id="cbo_pay_gubun" taborder="137" codecolumn="codecolumn" datacolumn="datacolumn" position2="absolute l:43.49% w:12.08% t:283 h:20" positiontype="position2" displaynulltext="비회원" onitemchanged="cbo_onitemchanged">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">00</Col>
                <Col id="datacolumn">비회원</Col>
              </Row>
              <Row>
                <Col id="codecolumn">01</Col>
                <Col id="datacolumn">회원(기명)</Col>
              </Row>
              <Row>
                <Col id="codecolumn">02</Col>
                <Col id="datacolumn">회원(무기명)</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Edit id="edt_resort_mem_no" taborder="138" position2="absolute l:66.85% w:10.74% t:283 h:20" positiontype="position2" enable="false" maxlength="20" lengthunit="ascii"/>
        <Static id="stc_04" class="sta_workData" position2="absolute l:43.09% r:0 t:305 h:26" positiontype="position2"/>
        <Edit id="edt_kb_no" taborder="139" position2="absolute l:66.85% w:10.6% t:308 h:20" positiontype="position2" style="font:Dotum,9;" lengthunit="ascii" maxlength="50"/>
        <Static id="stc_05" class="sta_workData" position2="absolute l:43.09% r:0 t:330 h:26" positiontype="position2"/>
        <Static id="stc_11" class="sta_workData" position2="absolute l:43.09% r:0 t:355 h:26" positiontype="position2"/>
        <Static id="stc_10" class="sta_workData" position2="absolute l:43.09% r:0 t:380 h:26" positiontype="position2"/>
        <Static id="stc_80" text="포인트산출" class="sta_workLabel1" style="color:#555555ff;padding:6 0 0 12;" validate="" position2="absolute l:77.85% w:10.74% t:355 h:26" positiontype="position2"/>
        <Static id="stc_17" class="sta_workLabel1" style="padding:6 0 0 15;" validate="" position2="absolute l:32.48% w:10.74% t:380 h:26" positiontype="position2" text="OCB발급일"/>
        <Static id="stc_19" text="구독여부" class="sta_workLabel1" style="padding:6 0 0 15;" validate="" position2="absolute l:55.84% w:10.74% t:330 h:26" positiontype="position2"/>
        <Static id="stc_20" text="등록사원" class="sta_workLabel1" style="color:#555555ff;padding:6 0 0 15;" validate="" position2="absolute l:55.84% w:10.74% t:380 h:26" positiontype="position2"/>
        <Static id="stc_21" text="ID NO." class="sta_workLabel1" validate="" position2="absolute l:32.48% w:10.74% t:305 h:26" positiontype="position2" style="color:#555555ff;font:Dotum,8,bold;"/>
        <Edit id="edt_id_no" taborder="151" position2="absolute l:43.49% w:12.08% t:308 h:20" positiontype="position2" style="font:Dotum,9;" maxlength="20" lengthunit="ascii"/>
        <Static id="stc_101" text="KB NO." class="sta_workLabel1" validate="" position2="absolute l:55.84% w:10.74% t:305 h:26" positiontype="position2" style="color:#555555ff;font:Dotum,8,bold;"/>
        <Static id="stc_22" text="할인우대권" class="sta_workLabel1" validate="" position2="absolute l:77.85% w:10.74% t:305 h:26" positiontype="position2" style="padding:6 1 0 12;"/>
        <Edit id="edt_rand_num" taborder="152" position2="absolute l:88.86% w:10.74% t:308 h:20" positiontype="position2" lengthunit="ascii" ontextchanged="edt_ontextchanged" maxlength="10" imemode="alpha" inputmode="upper" inputtype="numberandenglish"/>
        <Static id="stc_24" text="주문번호" class="sta_workLabel1" validate="" position2="absolute l:32.48% w:10.74% t:330 h:26" positiontype="position2"/>
        <Static id="stc_25" text="OCB상태" class="sta_workLabel1" validate="" position2="absolute l:32.48% w:10.74% t:355 h:26" positiontype="position2" style="color:#555555ff;"/>
        <Edit id="edt_reg_man" taborder="161" position2="absolute l:66.85% w:10.74% t:383 h:20" positiontype="position2" readonly="true" class="edt_clssEnable"/>
        <Edit id="edt_order_num" taborder="162" position2="absolute l:43.49% w:12.08% t:333 h:20" positiontype="position2" lengthunit="ascii" maxlength="20"/>
        <Combo id="cbo_ja_subscrpt_yn" taborder="167" codecolumn="codecolumn" datacolumn="datacolumn" position2="absolute l:66.85% w:10.6% t:333 h:20" positiontype="position2" index="-1" displaynulltext="아니오">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">예</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">아니오</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Button id="btn_add_prod" taborder="169" text="상품추가" onclick="btn_dsps_onclick" class="btn_WF_Common" position2="absolute r:154 w:72 t:3 h:20" positiontype="position2" tooltiptext="상품추가" style="border:0 none #000000ff ;padding:0 0 0 0;"/>
        <MaskEdit id="mae_inspl_zip_1" taborder="170" enable="true" position2="absolute l:100.67% w:7.11% t:206 h:20" positiontype="position2" type="string" style="align:center middle; :disabled {align:center middle;}" readonly="true" class="mae_clssEnable" visible="false"/>
        <Button id="btn_insplAddrPop" taborder="56" class="btn_workSrcPop" position2="absolute l:35.44% w:23 t:204px h:20" positiontype="position2" onclick="btn_onclick"/>
        <Edit id="edt_prod_kind" taborder="173" position2="absolute l:100.54% w:13.83% t:127 h:20" positiontype="position2" visible="false" readonly="true" class="edt_clssEnable"/>
        <Static id="stc_12" text="우대번호" class="sta_workLabel1" position2="absolute l:77.85% w:10.74% t:330 h:26" positiontype="position2" style="color:#555555ff;padding:6 0 0 15;" validate=""/>
        <Static id="stc_13" text="OCB여부" class="sta_workLabel1" position2="absolute l:55.84% w:10.74% t:355 h:26" positiontype="position2" style="color:#555555ff;" validate=""/>
        <Combo id="cbo_ocb_reg_yn" taborder="175" position2="absolute l:66.85% w:10.6% t:358 h:20" positiontype="position2" codecolumn="codecolumn" datacolumn="datacolumn" displaynulltext="아니오">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">예</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">아니오</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Edit id="edt_ocb_gubn" taborder="176" position2="absolute l:43.49% w:12.08% t:358 h:20" positiontype="position2" class="edt_clssEnable" readonly="true"/>
        <Static id="stc_06" text="리조트회원명" class="sta_workLabel1" position2="absolute l:77.85% w:10.74% t:280 h:26" positiontype="position2" validate="" style="padding:6 1 0 7;font:Dotum,8;"/>
        <Edit id="edt_resort_mem_nm" taborder="177" position2="absolute l:88.86% w:10.74% t:283 h:20" positiontype="position2" enable="false" lengthunit="ascii" maxlength="100"/>
        <Static id="sta_GrayLine03" class="sta_WF_Line1" position2="absolute l:242 r:1 t:280 h:1" positiontype="position2"/>
        <Button id="btn_update_prod" taborder="178" onclick="btn_dsps_onclick" class="btn_WF_Modif" position2="absolute r:79 w:72 t:3 h:20" positiontype="position2" tooltiptext="수정" style="border:0 none #000000ff ;padding:0 0 0 0;" visible="false"/>
        <Static id="stc_08" text="등록일" class="sta_workLabel1" validate="" position2="absolute l:77.85% w:10.74% t:380 h:26" positiontype="position2" style="color:#555555ff;"/>
        <Combo id="cbo_ocb_point_yn" taborder="181" displaynulltext="아니오" codecolumn="codecolumn" datacolumn="datacolumn" position2="absolute l:88.86% w:10.6% t:358 h:20" positiontype="position2" enable="false">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">예</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">아니오</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <MaskEdit id="mae_edt_reg_dm" taborder="182" readonly="true" type="string" class="mae_clssEnable" position2="absolute l:88.86% w:10.74% t:383 h:20" positiontype="position2" style="align:center middle; :disabled {align:center middle;}"/>
        <PopupDiv id="pdv_inspl_phone" visible="false" position="absolute 301 419 376 512" dragscrolltype="both" scrollbars="none" taborder="0">
          <Layouts>
            <Layout>
              <ListBox id="lb_consTyp" taborder="0" innerdataset="ds_pdvConsTyp" codecolumn="full_cons_typ_cd" datacolumn="full_cons_typ_nm" onitemchanged="lb_onitemchanged" position="absolute -183 467 172 614" anchor="default"/>
              <ListBox id="lb_inspl_phone" taborder="1" position="absolute 2 9 71 77" anchor="default" codecolumn="codecolumn" datacolumn="datacolumn" scrollbars="none" onitemchanged="inspl_onitemchanged">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">10</Col>
                      <Col id="datacolumn">휴대전화</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">20</Col>
                      <Col id="datacolumn">자택전화</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">30</Col>
                      <Col id="datacolumn">회사전화</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </ListBox>
            </Layout>
          </Layouts>
        </PopupDiv>
        <Button id="btn_bugaInfo" taborder="183" text="부가서비스 등록" onclick="btn_onclick" class="btn_WF_Common" position2="absolute l:5 w:111 t:202 h:17" positiontype="position2" tooltiptext="부가서비스 등록" style="padding:0 0 0 0;" visible="false" enable="false"/>
        <Button id="btn_smartLifeReg" taborder="184" text="삼성카드 등록" onclick="btn_onclick" class="btn_WF_Common" position2="absolute l:5 w:111 t:221 h:17" positiontype="position2" tooltiptext="삼성카드 등록" style="padding:0 0 0 0;" visible="false" enable="false"/>
        <Button id="btn_recDual" taborder="185" text="부분시작" onclick="btn_onclick" class="btn_WF_Common" visible="false" position2="absolute r:325 w:60 t:3 h:20" positiontype="position2" tooltiptext="부분녹취시작" style="padding:0 0 0 0;"/>
        <Edit id="edt_rec_dual_hr" taborder="187" tabstop="false" readonly="true" class="edt_clssEnable" position2="absolute l:366 w:60 t:3 h:20" positiontype="position2" style="align:center middle;font:Dotum,10;"/>
        <Combo id="cbo_hpcl_stat_cd" taborder="188" displaynulltext="선택" innerdataset="ds_hpcl_cd" codecolumn="cd" datacolumn="cd_nm" enable="true" position2="absolute l:28.05% w:15.7% t:103px h:22" positiontype="position2" onitemchanged="cbo_hpcl_stat_cd_onitemchanged"/>
        <Button id="btn_recDualEnd" taborder="189" text="부분종료" onclick="btn_onclick" class="btn_WF_Common" position2="absolute r:263 w:60 t:3 h:20" positiontype="position2" tooltiptext="부분녹취종료" style="padding:0 0 0 0;" visible="false" enable="true"/>
        <Edit id="edt_prod_amt" taborder="192" imemode="alpha" onkeydown="edt_onkeydown" position2="absolute l:51.81% w:9.8% t:54 h:20" positiontype="position2" class="edt_clssEnable1" readonly="true" style="align:right middle;"/>
        <Button id="btn_appfmNo" taborder="50" class="btn_workSrcPop" position2="absolute l:68.32% w:20 t:29 h:20" positiontype="position2" onclick="btn_onclick" visible="false"/>
        <Div id="div_prod_srvc_disable" taborder="194" position2="absolute l:101.21% r:-48 t:280 h:26" positiontype="position2" style="background:#ffff99ff;color:#ffffffff;"/>
        <Edit id="edt_prod_cd" taborder="53" position2="absolute l:28.05% w:3.87% t:54 h:20" positiontype="position2" onkeydown="edt_onkeydown" imemode="alpha" style="color:red;font:Dotum,9;" class="edt_clssEnable1" inputmode="upper" maxlength="2" inputtype="numberandenglish" inputfilter="dot,comma,space"/>
        <Div id="div_prod_disable" taborder="193" style="background:#ffff99ff;color:#ffffffff;" transparenthittest="false" position2="absolute l:754 r:-48 t:26 h:26" positiontype="position2">
          <Layouts>
            <Layout width="39" height="26"/>
          </Layouts>
        </Div>
        <Edit id="edt_inspl_addr" taborder="57" position2="absolute l:38.39% w:32.48% t:204 h:20" positiontype="position2" enable="true" readonly="true" tooltiptype="hover,mouseleave" class="edt_clssEnable"/>
        <MaskEdit id="mae_ocb_crt_dt" taborder="196" readonly="true" type="string" class="mae_clssEnable" position2="absolute l:43.49% w:12.08% t:383 h:20" positiontype="position2" style="align:center middle; :disabled {align:center middle;}" mask="####-##-##"/>
        <Edit id="edt_resort_no" taborder="174" position2="absolute l:88.86% w:10.74% t:333 h:20" positiontype="position2" readonly="true" class="edt_clssEnable" lengthunit="ascii" maxlength="10"/>
        <Edit id="edt_resn_amt" taborder="35" position2="absolute l:55.44% w:15.7% t:104 h:20" positiontype="position2" class="edt_clssEnable1" readonly="true" style="align:right middle;"/>
        <Calendar id="cal_join_dt" taborder="165" dateformat="yyyy-MM-dd" position2="absolute l:28.05% w:89 t:129 h:20" positiontype="position2" enable="false" readonly="false" autoselect="false" oneditclick="cal_join_dt_oneditclick"/>
        <Calendar id="cal_man_day" taborder="180" dateformat="yyyy-MM-dd" position2="absolute l:55.44% w:89 t:129 h:20" positiontype="position2" enable="false"/>
        <Static id="stc_kydate" text="설치완료일자" class="sta_workLabel1" position2="absolute l:50.47% w:11.68% t:227 h:22" positiontype="position2" validate="" style="align:left;"/>
        <Edit id="edt_accnt_no" taborder="49" position2="absolute l:28.05% r:57.45% t:29 h:20" positiontype="position2" enable="true" readonly="true"/>
        <Edit id="edt_prod_nm" taborder="198" onkeydown="edt_onkeydown" class="edt_clssEnable1" position2="absolute l:32.21% w:19.19% t:54 h:20" positiontype="position2" style="color:red;font:Dotum,9;"/>
        <Static id="stc_kydate00" text="회원상태" class="sta_workLabel1" position2="absolute l:75.84% w:8.59% t:226 h:26" positiontype="position2" validate=""/>
        <Combo id="Combo_kstbit" taborder="200" index="-1" innerdataset="@ds_kstbit" codecolumn="kscode" datacolumn="ksname" position2="absolute l:85.64% w:6.44% t:229 h:20" positiontype="position2" enable="true" imemode="alpha,full" readonly="true"/>
        <Button id="btn_evnt_ip" taborder="201" text="행사등록" onclick="btn_onclick" class="btn_WF_Common" visible="true" position2="absolute l:291 w:72 t:3 h:20" positiontype="position2" tooltiptext="행사등록" style="padding:0 0 0 0;" transparenthittest="false"/>
        <Edit id="edt_emple_nm" taborder="23" position2="absolute l:82.82% w:13.83% t:29 h:20" positiontype="position2" onkeydown="edt_onkeydown" imemode="hangul" onmouseenter="tooltip_emp" onmousemove="tooltip_emp" tooltiptype="hover" readonly="false" style="border:0 none #4c8de4ff ;"/>
        <Button id="btn_srchEmple" taborder="22" class="btn_workSrcPop" position2="absolute l:96.91% w:20 t:29 h:20" positiontype="position2" onclick="btn_onclick"/>
        <Edit id="edt_bef_emple_nm" taborder="21" position2="absolute l:82.82% w:6.31% t:54 h:20" positiontype="position2" onkeydown="edt_onkeydown" imemode="hangul" onmouseenter="tooltip_bef" onmousemove="tooltip_bef" readonly="false" style="border:0 none #4c8de4ff ;"/>
        <Edit id="edt_bef_emple_cell" taborder="195" imemode="hangul" position2="absolute l:89.26% w:7.38% t:54 h:20" positiontype="position2" enable="true" class="edt_clssEnable" readonly="true" onmouseenter="tooltip_bef" onmousemove="tooltip_bef" style="border:1 solid #a9a9a90c transparent;"/>
        <Button id="btn_srchshow" taborder="202" text="공연혜택" onclick="btn_onclick" class="btn_WF_Common" enable="true" visible="true" position2="absolute l:5 w:111 t:260 h:17" positiontype="position2" tooltiptext="행사조회" style="padding:0 0 0 0;"/>
        <Button id="btn_shinhan" taborder="203" text="신한인증" onclick="btn_onclick" visible="false" position2="absolute r:63 w:58 t:229 h:20" positiontype="position2" tooltiptext="신한인증" style="padding:0 0 0 0;"/>
        <Button id="btn_concCmpl" taborder="204" text="계약완료" onclick="btn_onclick" class="btn_WF_Common" enable="false" position2="absolute l:429 w:60 t:3 h:20" positiontype="position2" tooltiptext="계약완료" style="padding:0 0 0 0;"/>
        <Static id="stc_07" text="단체건수" class="sta_workLabel1" position2="absolute l:83.22% w:9.13% t:251 h:26" positiontype="position2" style="color:saddlebrown;align:middle;font:Dotum,8,bold;" validate=""/>
        <Edit id="edt_insert_cnt" taborder="205" imemode="alpha" position2="absolute l:92.62% w:7.11% t:254 h:20" positiontype="position2" style="font:Dotum,9;" enable="false" inputtype="number" maxlength="3"/>
        <Edit id="mae_inspl_zip" taborder="206" readonly="true" style="background:URL('theme://images/bg_compD.png') stretch 5,5;color:#999999ff;align:center middle;" position2="absolute l:28.05% w:7.11% t:204 h:20" positiontype="position2"/>
        <Button id="btn_amtUseshow" taborder="207" text="쇼핑몰연동" onclick="btn_onclick" position2="absolute r:230 w:72 t:3 h:20" positiontype="position2" visible="false"/>
        <Button id="btn_niceSecondSend" taborder="208" text="계약문자발송" position2="absolute r:305 w:78 t:3 h:20" positiontype="position2" visible="false" onclick="btn_niceSecondSend_onclick"/>
        <Edit id="edt_prod_model_kind" taborder="210" readonly="true" class="edt_clssEnable1" visible="false" position2="absolute l:100.54% w:13.83% t:79 h:20" positiontype="position2" style="color:red;font:Dotum,9;"/>
        <Edit id="edt_prod_model_cd" taborder="211" readonly="true" class="edt_clssEnable" visible="false" position2="absolute l:100.54% w:13.83% t:103 h:20" positiontype="position2"/>
        <Edit id="edt_b2b_emple_ci" taborder="212" imemode="alpha" position2="absolute l:62.42% w:8.59% t:179 h:20" positiontype="position2" style="font:Dotum,9;" enable="false"/>
        <Button id="btn_mangiExt" taborder="213" text="만기연장" onclick="btn_onclick" visible="true" position2="absolute l:64.43% w:61 t:129 h:20" positiontype="position2" style="padding:0 0 0 0;"/>
        <Button id="btn_main_contract" taborder="215" text="주계약" position2="absolute l:44.03% w:11.14% t:29 h:20" positiontype="position2" onclick="btn_main_contract_onclick" enable="false"/>
        <Button id="btn_certf" taborder="190" text="증서" onclick="btn_onclick" position2="absolute l:61.74% w:69 t:54 h:20" positiontype="position2" style="padding:0 0 0 0;" visible="false"/>
        <Button id="btn_srchProd" taborder="120" class="btn_workSrcPop" position2="absolute l:61.74% w:20 t:54 h:20" positiontype="position2" visible="false" onclick="btn_onclick"/>
        <Edit id="edt_main_contract" taborder="218" position2="absolute l:55.44% w:12.62% t:29 h:20" positiontype="position2" readonly="true" enable="true" class="edt_clssEnable"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item3" compid="cal_join_dt" propid="value" datasetid="ds_prod" columnid="join_dt"/>
      <BindItem id="item0" compid="edt_accnt_no" propid="value" datasetid="ds_prod" columnid="accnt_no"/>
      <BindItem id="item1" compid="edt_appfm_no" propid="value" datasetid="ds_prod" columnid="appfm_no"/>
      <BindItem id="item2" compid="edt_emple_nm" propid="value" datasetid="ds_prod" columnid="emple_nm"/>
      <BindItem id="item4" compid="edt_prod_cd" propid="value" datasetid="ds_prod" columnid="prod_cd"/>
      <BindItem id="item6" compid="edt_bef_emple_nm" propid="value" datasetid="ds_prod" columnid="bef_emple_nm"/>
      <BindItem id="item8" compid="cbo_pay_mthd" propid="value" datasetid="ds_prod" columnid="pay_mthd"/>
      <BindItem id="item9" compid="cbo_join_cl" propid="value" datasetid="ds_prod" columnid="join_cl"/>
      <BindItem id="item10" compid="spn_new_chan_gunsu" propid="value" datasetid="ds_prod" columnid="new_chan_gunsu"/>
      <BindItem id="item11" compid="edt_b2b_comp_nm" propid="value" datasetid="ds_prod" columnid="b2b_comp_nm"/>
      <BindItem id="item12" compid="edt_b2b_emple_no" propid="value" datasetid="ds_prod" columnid="b2b_emple_no"/>
      <BindItem id="item13" compid="edt_sm_shop_nm" propid="value" datasetid="ds_prod" columnid="sm_shop_nm"/>
      <BindItem id="item15" compid="edt_inspl_addr" propid="value" datasetid="ds_prod" columnid="inspl_addr"/>
      <BindItem id="item16" compid="edt_inspl_addr2" propid="value" datasetid="ds_prod" columnid="inspl_addr2"/>
      <BindItem id="item17" compid="edt_inspl_phone" propid="value" datasetid="ds_prod" columnid="inspl_phone"/>
      <BindItem id="item18" compid="cbo_pay_gubun" propid="value" datasetid="ds_prod" columnid="pay_gubun"/>
      <BindItem id="item19" compid="edt_resort_mem_no" propid="value" datasetid="ds_prod" columnid="resort_mem_no"/>
      <BindItem id="item20" compid="edt_rand_num" propid="value" datasetid="ds_prod" columnid="rand_num"/>
      <BindItem id="item21" compid="edt_order_num" propid="value" datasetid="ds_prod" columnid="order_num"/>
      <BindItem id="item22" compid="cbo_ja_subscrpt_yn" propid="value" datasetid="ds_prod" columnid="ja_subscrpt_yn"/>
      <BindItem id="item23" compid="edt_id_no" propid="value" datasetid="ds_prod" columnid="id_no"/>
      <BindItem id="item24" compid="edt_kb_no" propid="value" datasetid="ds_prod" columnid="kb_no"/>
      <BindItem id="item14" compid="mae_inspl_zip_1" propid="value" datasetid="ds_prod" columnid="inspl_zip"/>
      <BindItem id="item25" compid="edt_inspl_addr" propid="tooltiptext" datasetid="ds_prod" columnid="inspl_addr"/>
      <BindItem id="item28" compid="edt_prod_kind" propid="value" datasetid="ds_prod" columnid="prod_kind_nm"/>
      <BindItem id="item29" compid="edt_resort_mem_nm" propid="value" datasetid="ds_prod" columnid="resort_mem_nm"/>
      <BindItem id="item30" compid="edt_event_nm" propid="value" datasetid="ds_prod" columnid="event_nm"/>
      <BindItem id="item31" compid="edt_pay_state" propid="value" datasetid="ds_prod" columnid="pay_state"/>
      <BindItem id="item32" compid="cal_man_day" propid="value" datasetid="ds_prod" columnid="man_day"/>
      <BindItem id="item33" compid="edt_cnsl_man" propid="value" datasetid="ds_prod" columnid="cnsl_man"/>
      <BindItem id="item34" compid="edt_appr_reltn" propid="value" datasetid="ds_prod" columnid="appr_reltn"/>
      <BindItem id="item35" compid="edt_reg_man" propid="value" datasetid="ds_prod" columnid="reg_man"/>
      <BindItem id="item38" compid="cbo_ocb_reg_yn" propid="value" datasetid="ds_prod" columnid="ocb_reg_yn"/>
      <BindItem id="item39" compid="edt_ocb_gubn" propid="value" datasetid="ds_prod" columnid="ocb_gubn"/>
      <BindItem id="item40" compid="edt_resort_no" propid="value" datasetid="ds_prod" columnid="resort_no"/>
      <BindItem id="item41" compid="cbo_ocb_point_yn" propid="value" datasetid="ds_prod" columnid="ocb_point_yn"/>
      <BindItem id="item37" compid="mae_edt_reg_dm" propid="value" datasetid="ds_prod" columnid="reg_dm"/>
      <BindItem id="item7" compid="cbo_hpcl_stat_cd" propid="value" datasetid="ds_prod" columnid="hpcl_stat_cd"/>
      <BindItem id="item36" compid="edt_prod_amt" propid="value" datasetid="ds_prod" columnid=""/>
      <BindItem id="item42" compid="edt_union_pay_state" propid="value" datasetid="ds_prod" columnid="union_pay_state"/>
      <BindItem id="item43" compid="edt_bef_emple_cell" propid="value" datasetid="ds_prod" columnid="bef_emple_cell"/>
      <BindItem id="item44" compid="mae_ocb_crt_dt" propid="value" datasetid="ds_prod" columnid="ocb_crt_dt"/>
      <BindItem id="item45" compid="cal_kydate" propid="value" datasetid="ds_prod" columnid="kydate"/>
      <BindItem id="item5" compid="edt_prod_nm" propid="value" datasetid="ds_prod" columnid="prod_nm"/>
      <BindItem id="item47" compid="Combo_kstbit" propid="value" datasetid="ds_prod" columnid="kstbit"/>
      <BindItem id="item46" compid="edt_insert_cnt" propid="value" datasetid="ds_prod" columnid="insert_cnt"/>
      <BindItem id="item48" compid="mae_inspl_zip" propid="value" datasetid="ds_prod" columnid="inspl_zip"/>
      <BindItem id="item51" compid="edt_prod_model_kind" propid="value" datasetid="ds_prod" columnid="prod_model_kind_nm"/>
      <BindItem id="item52" compid="edt_prod_model_kind" propid="tooltiptext" datasetid="ds_prod" columnid="prod_model_kind_nm"/>
      <BindItem id="item53" compid="edt_prod_model_cd" propid="value" datasetid="ds_prod" columnid="prod_model_nm"/>
      <BindItem id="item54" compid="edt_prod_model_cd" propid="tooltiptext" datasetid="ds_prod" columnid="prod_model_nm"/>
      <BindItem id="item26" compid="edt_b2b_emple_ci" propid="value" datasetid="ds_prod" columnid="b2b_emple_ci"/>
      <BindItem id="item27" compid="edt_main_contract" propid="value" datasetid="ds_prod" columnid="main_contract_nm"/>
    </Bind>
    <Style url="CSS::main.css"/>
    <Objects>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dwl_cds" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd_set_cd" type="STRING" size="256"/>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_pyinMthdCd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_joinTypCd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cbo_modlTyp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="prod_kind" type="STRING" size="256"/>
          <Column id="prod_kind_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cbo_modlNm" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="modl_cd" type="STRING" size="256"/>
          <Column id="modl_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cbo_prdtKind" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="prod_kind_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_prodSrvc" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="_chk" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="mem_cl" type="STRING" size="256"/>
          <Column id="mem_cl_nm" type="STRING" size="256"/>
          <Column id="resort_mem_cl" type="STRING" size="256"/>
          <Column id="opt_svc_nm" type="STRING" size="256"/>
          <Column id="opt_svc_nm_ex" type="STRING" size="256"/>
          <Column id="svc_cd" type="STRING" size="256"/>
          <Column id="app_no" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
          <Column id="use_yn_nm" type="STRING" size="256"/>
          <Column id="svc_event_bf_cl" type="STRING" size="256"/>
          <Column id="vital_service" type="STRING" size="256"/>
          <Column id="online_app_gubun" type="STRING" size="256"/>
          <Column id="start_dt" type="STRING" size="256"/>
          <Column id="end_dt" type="STRING" size="256"/>
          <Column id="isu_yn" type="STRING" size="256"/>
          <Column id="opt_svc_cd" type="STRING" size="256"/>
          <Column id="isu_cnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_prod" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <ConstColumn id="ConstColumn0" type="STRING" size="30" value=""/>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="appfm_no" type="STRING" size="256"/>
          <Column id="emple_no" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="bef_emple_cd" type="STRING" size="256"/>
          <Column id="bef_emple_nm" type="STRING" size="256"/>
          <Column id="prod_model_kind" type="STRING" size="256"/>
          <Column id="prod_model_kind_nm" type="STRING" size="256"/>
          <Column id="prod_model_cd" type="STRING" size="256"/>
          <Column id="prod_model_nm" type="STRING" size="256"/>
          <Column id="prod_kind" type="STRING" size="256"/>
          <Column id="prod_kind_nm" type="STRING" size="256"/>
          <Column id="bank_accnt_no" type="STRING" size="256"/>
          <Column id="pay_mthd" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="man_day" type="STRING" size="256"/>
          <Column id="cnsl_man" type="STRING" size="256"/>
          <Column id="join_cl" type="STRING" size="256"/>
          <Column id="appr_reltn" type="STRING" size="256"/>
          <Column id="new_chan_gunsu" type="STRING" size="256"/>
          <Column id="b2b_comp_cd" type="STRING" size="256"/>
          <Column id="b2b_comp_nm" type="STRING" size="256"/>
          <Column id="b2b_emple_no" type="STRING" size="256"/>
          <Column id="smcl" type="STRING" size="256"/>
          <Column id="sm_shop_info" type="STRING" size="256"/>
          <Column id="sm_shop_nm" type="STRING" size="256"/>
          <Column id="inspl_zip" type="STRING" size="256"/>
          <Column id="inspl_addr" type="STRING" size="256"/>
          <Column id="inspl_addr2" type="STRING" size="256"/>
          <Column id="inspl_phone" type="STRING" size="256"/>
          <Column id="pay_state" type="STRING" size="256"/>
          <Column id="납입내역" type="STRING" size="256"/>
          <Column id="event_nm" type="STRING" size="256"/>
          <Column id="pay_gubun" type="STRING" size="256"/>
          <Column id="resort_mem_gubun" type="STRING" size="256"/>
          <Column id="resort_mem_no" type="STRING" size="256"/>
          <Column id="resort_mem_nm" type="STRING" size="256"/>
          <Column id="id_no" type="STRING" size="256"/>
          <Column id="kb_no" type="STRING" size="256"/>
          <Column id="rand_num" type="STRING" size="256"/>
          <Column id="order_num" type="STRING" size="256"/>
          <Column id="reg_dm" type="STRING" size="256"/>
          <Column id="card_gubun" type="STRING" size="256"/>
          <Column id="ocb_gubn" type="STRING" size="256"/>
          <Column id="ocb_reg_yn" type="STRING" size="256"/>
          <Column id="ocb_point_yn" type="STRING" size="256"/>
          <Column id="ja_subscrpt_yn" type="STRING" size="256"/>
          <Column id="reg_man" type="STRING" size="256"/>
          <Column id="resort_no" type="STRING" size="256"/>
          <Column id="resn_yn" type="STRING" size="256"/>
          <Column id="resn_amt" type="STRING" size="256"/>
          <Column id="r_gubn" type="STRING" size="256"/>
          <Column id="start_dt" type="STRING" size="256"/>
          <Column id="mem_prod_accnt_svc" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="pay_no" type="STRING" size="256"/>
          <Column id="cms_yn" type="STRING" size="256"/>
          <Column id="event_seq" type="STRING" size="256"/>
          <Column id="hpcl_stat_nm" type="STRING" size="256"/>
          <Column id="hpcl_stat_cd" type="STRING" size="256"/>
          <Column id="prod_amt" type="STRING" size="256"/>
          <Column id="union_pay_state" type="STRING" size="256"/>
          <Column id="kydate" type="STRING" size="256"/>
          <Column id="kstbit" type="STRING" size="256"/>
          <Column id="trgt_id" type="STRING" size="256"/>
          <Column id="trgt_id_resend" type="STRING" size="256"/>
          <Column id="trgt_id_bailor" type="STRING" size="256"/>
          <Column id="img_file_nm" type="STRING" size="256"/>
          <Column id="trgt_finish_resend" type="STRING" size="256"/>
          <Column id="upp_tx_type" type="STRING" size="256"/>
          <Column id="finish_flag" type="STRING" size="256"/>
          <Column id="nice_no" type="STRING" size="256"/>
          <Column id="auth_01" type="STRING" size="256"/>
          <Column id="auth_02" type="STRING" size="256"/>
          <Column id="b2b_emple_ci" type="STRING" size="256"/>
          <Column id="section_thr" type="STRING" size="256"/>
          <Column id="main_contract" type="STRING" size="256"/>
          <Column id="main_contract_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt_procSrvc" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="pay_gubun" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="gubun" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt_prod" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="etc_yn" type="STRING" size="256"/>
          <Column id="ci_val" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_prod" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="appfm_no" type="STRING" size="256"/>
          <Column id="emple_no" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="bef_emple_cd" type="STRING" size="256"/>
          <Column id="bef_emple_nm" type="STRING" size="256"/>
          <Column id="bef_emple_cell" type="STRING" size="256"/>
          <Column id="prod_model_kind" type="STRING" size="256"/>
          <Column id="prod_model_kind_nm" type="STRING" size="256"/>
          <Column id="prod_model_cd" type="STRING" size="256"/>
          <Column id="prod_model_nm" type="STRING" size="256"/>
          <Column id="prod_kind" type="STRING" size="256"/>
          <Column id="prod_kind_nm" type="STRING" size="256"/>
          <Column id="bank_accnt_no" type="STRING" size="256"/>
          <Column id="pay_mthd" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="man_day" type="STRING" size="256"/>
          <Column id="cnsl_man" type="STRING" size="256"/>
          <Column id="join_cl" type="STRING" size="256"/>
          <Column id="appr_reltn" type="STRING" size="256"/>
          <Column id="new_chan_gunsu" type="STRING" size="256"/>
          <Column id="b2b_comp_cd" type="STRING" size="256"/>
          <Column id="b2b_comp_nm" type="STRING" size="256"/>
          <Column id="b2b_emple_no" type="STRING" size="256"/>
          <Column id="smcl" type="STRING" size="256"/>
          <Column id="sm_shop_info" type="STRING" size="256"/>
          <Column id="sm_shop_nm" type="STRING" size="256"/>
          <Column id="inspl_zip" type="STRING" size="256"/>
          <Column id="inspl_addr" type="STRING" size="256"/>
          <Column id="inspl_addr2" type="STRING" size="256"/>
          <Column id="inspl_phone" type="STRING" size="256"/>
          <Column id="pay_state" type="STRING" size="256"/>
          <Column id="납입내역" type="STRING" size="256"/>
          <Column id="event_nm" type="STRING" size="256"/>
          <Column id="pay_gubun" type="STRING" size="256"/>
          <Column id="resort_mem_gubun" type="STRING" size="256"/>
          <Column id="resort_mem_no" type="STRING" size="256"/>
          <Column id="resort_mem_nm" type="STRING" size="256"/>
          <Column id="id_no" type="STRING" size="256"/>
          <Column id="kb_no" type="STRING" size="256"/>
          <Column id="rand_num" type="STRING" size="256"/>
          <Column id="order_num" type="STRING" size="256"/>
          <Column id="reg_dm" type="STRING" size="256"/>
          <Column id="card_gubun" type="STRING" size="256"/>
          <Column id="ocb_gubn" type="STRING" size="256"/>
          <Column id="ocb_reg_yn" type="STRING" size="256"/>
          <Column id="ocb_point_yn" type="STRING" size="256"/>
          <Column id="ja_subscrpt_yn" type="STRING" size="256"/>
          <Column id="reg_man" type="STRING" size="256"/>
          <Column id="resort_no" type="STRING" size="256"/>
          <Column id="resn_yn" type="STRING" size="256"/>
          <Column id="resn_amt" type="STRING" size="256"/>
          <Column id="r_gubn" type="STRING" size="256"/>
          <Column id="start_dt" type="STRING" size="256"/>
          <Column id="mem_prod_accnt_svc" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="pay_no" type="STRING" size="256"/>
          <Column id="cms_yn" type="STRING" size="256"/>
          <Column id="event_seq" type="STRING" size="256"/>
          <Column id="hpcl_stat_nm" type="STRING" size="256"/>
          <Column id="hpcl_stat_cd" type="STRING" size="256"/>
          <Column id="prod_amt" type="STRING" size="256"/>
          <Column id="union_pay_state" type="STRING" size="256"/>
          <Column id="ocb_crt_dt" type="STRING" size="256"/>
          <Column id="kydate" type="STRING" size="256"/>
          <Column id="kstbit" type="STRING" size="256"/>
          <Column id="emple_dept_nm" type="STRING" size="256"/>
          <Column id="bef_emple_dept_nm" type="STRING" size="256"/>
          <Column id="emple_cell" type="STRING" size="256"/>
          <Column id="insert_cnt" type="STRING" size="256"/>
          <Column id="trgt_id" type="STRING" size="256"/>
          <Column id="img_file_nm" type="STRING" size="256"/>
          <Column id="b2b_emple_ci" type="STRING" size="256"/>
          <Column id="section_thr" type="STRING" size="256"/>
          <Column id="main_contract" type="STRING" size="256"/>
          <Column id="main_contract_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_resnAmt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="r_gubn" type="STRING" size="256"/>
          <Column id="resn_amt" type="STRING" size="256"/>
          <Column id="ci_val" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_tmp_prodSrvc" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="_chk" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="mem_cl" type="STRING" size="256"/>
          <Column id="mem_cl_nm" type="STRING" size="256"/>
          <Column id="resort_mem_cl" type="STRING" size="256"/>
          <Column id="opt_svc_nm" type="STRING" size="256"/>
          <Column id="opt_svc_nm_ex" type="STRING" size="256"/>
          <Column id="svc_cd" type="STRING" size="256"/>
          <Column id="app_no" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
          <Column id="use_yn_nm" type="STRING" size="256"/>
          <Column id="svc_event_bf_cl" type="STRING" size="256"/>
          <Column id="vital_service" type="STRING" size="256"/>
          <Column id="online_app_gubun" type="STRING" size="256"/>
          <Column id="start_dt" type="STRING" size="256"/>
          <Column id="end_dt" type="STRING" size="256"/>
          <Column id="isu_yn" type="STRING" size="256"/>
          <Column id="opt_svc_cd" type="STRING" size="256"/>
          <Column id="isu_cnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_randNum" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="resultMsg" type="STRING" size="256"/>
          <Column id="newChanGunsu" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_prodList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="page_indx" type="STRING" size="6"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="mon_pay_amt" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="prod_amt" type="STRING" size="256"/>
          <Column id="use_cnt" type="STRING" size="256"/>
          <Column id="reg_dm" type="STRING" size="256"/>
          <Column id="prod_cl" type="STRING" size="256"/>
          <Column id="prod_cl_nm" type="STRING" size="256"/>
          <Column id="sale_gubn" type="STRING" size="256"/>
          <Column id="sale_cl" type="STRING" size="256"/>
          <Column id="sale_close_day" type="STRING" size="256"/>
          <Column id="prod_save_point" type="STRING" size="256"/>
          <Column id="pay_type" type="STRING" size="256"/>
          <Column id="pay_type_nm" type="STRING" size="256"/>
          <Column id="join_type" type="STRING" size="256"/>
          <Column id="join_type_nm" type="STRING" size="256"/>
          <Column id="join_gift_card_sort" type="STRING" size="256"/>
          <Column id="join_gift_card_sort_nm" type="STRING" size="256"/>
          <Column id="join_gift_card_amt" type="STRING" size="256"/>
          <Column id="prod_dc_cnt" type="STRING" size="256"/>
          <Column id="membership" type="STRING" size="256"/>
          <Column id="ocb_point" type="STRING" size="256"/>
          <Column id="ocb_fee" type="STRING" size="256"/>
          <Column id="upd_man" type="STRING" size="256"/>
          <Column id="lgbestcl" type="STRING" size="256"/>
          <Column id="order_seq" type="STRING" size="256"/>
          <Column id="acuon_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_resortInfo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="pay_gubun" type="STRING" size="256"/>
          <Column id="resort_mem_no" type="STRING" size="256"/>
          <Column id="resort_mem_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_saleAccnt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="emple_no" type="STRING" size="256"/>
          <Column id="gubun" type="STRING" size="256"/>
          <Column id="result_flag" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bugaInfo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_chbfProd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="appfm_no" type="STRING" size="256"/>
          <Column id="emple_no" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="bef_emple_cd" type="STRING" size="256"/>
          <Column id="bef_emple_nm" type="STRING" size="256"/>
          <Column id="prod_model_kind" type="STRING" size="256"/>
          <Column id="prod_model_kind_nm" type="STRING" size="256"/>
          <Column id="prod_model_cd" type="STRING" size="256"/>
          <Column id="prod_model_nm" type="STRING" size="256"/>
          <Column id="prod_kind" type="STRING" size="256"/>
          <Column id="prod_kind_nm" type="STRING" size="256"/>
          <Column id="bank_accnt_no" type="STRING" size="256"/>
          <Column id="pay_mthd" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
          <Column id="man_day" type="STRING" size="256"/>
          <Column id="cnsl_man" type="STRING" size="256"/>
          <Column id="join_cl" type="STRING" size="256"/>
          <Column id="appr_reltn" type="STRING" size="256"/>
          <Column id="new_chan_gunsu" type="STRING" size="256"/>
          <Column id="b2b_comp_cd" type="STRING" size="256"/>
          <Column id="b2b_comp_nm" type="STRING" size="256"/>
          <Column id="b2b_emple_no" type="STRING" size="256"/>
          <Column id="smcl" type="STRING" size="256"/>
          <Column id="sm_shop_info" type="STRING" size="256"/>
          <Column id="sm_shop_nm" type="STRING" size="256"/>
          <Column id="inspl_zip" type="STRING" size="256"/>
          <Column id="inspl_addr" type="STRING" size="256"/>
          <Column id="inspl_addr2" type="STRING" size="256"/>
          <Column id="inspl_phone" type="STRING" size="256"/>
          <Column id="pay_state" type="STRING" size="256"/>
          <Column id="납입내역" type="STRING" size="256"/>
          <Column id="event_nm" type="STRING" size="256"/>
          <Column id="pay_gubun" type="STRING" size="256"/>
          <Column id="resort_mem_gubun" type="STRING" size="256"/>
          <Column id="resort_mem_no" type="STRING" size="256"/>
          <Column id="resort_mem_nm" type="STRING" size="256"/>
          <Column id="id_no" type="STRING" size="256"/>
          <Column id="kb_no" type="STRING" size="256"/>
          <Column id="rand_num" type="STRING" size="256"/>
          <Column id="order_num" type="STRING" size="256"/>
          <Column id="reg_dm" type="STRING" size="256"/>
          <Column id="card_gubun" type="STRING" size="256"/>
          <Column id="ocb_gubun" type="STRING" size="256"/>
          <Column id="ocb_reg_yn" type="STRING" size="256"/>
          <Column id="ocb_point_yn" type="STRING" size="256"/>
          <Column id="ja_subscrpt_yn" type="STRING" size="256"/>
          <Column id="reg_man" type="STRING" size="256"/>
          <Column id="resort_no" type="STRING" size="256"/>
          <Column id="resn_yn" type="STRING" size="256"/>
          <Column id="resn_amt" type="STRING" size="256"/>
          <Column id="r_gubn" type="STRING" size="256"/>
          <Column id="start_dt" type="STRING" size="256"/>
          <Column id="mem_prod_accnt_svc" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="pay_no" type="STRING" size="256"/>
          <Column id="cms_yn" type="STRING" size="256"/>
          <Column id="event_seq" type="STRING" size="256"/>
          <Column id="hpcl_stat_nm" type="STRING" size="256"/>
          <Column id="hpcl_stat_cd" type="STRING" size="256"/>
          <Column id="prod_amt" type="STRING" size="256"/>
          <Column id="union_pay_state" type="STRING" size="256"/>
          <Column id="main_contract_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_hpcl_cd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd_set_cd" type="STRING" size="256"/>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
          <Column id="use_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_deleteProdInfo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="cti_crnc_dtl_id" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="emple_no" type="STRING" size="256"/>
          <Column id="empel_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_kstbit" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="kscode" type="STRING" size="256"/>
          <Column id="ksname" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="kscode">01</Col>
            <Col id="ksname">대기</Col>
          </Row>
          <Row>
            <Col id="kscode">02</Col>
            <Col id="ksname">가입</Col>
          </Row>
          <Row>
            <Col id="kscode">03</Col>
            <Col id="ksname">해약</Col>
          </Row>
          <Row>
            <Col id="kscode">04</Col>
            <Col id="ksname">행사</Col>
          </Row>
          <Row>
            <Col id="kscode">09</Col>
            <Col id="ksname">만기</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_niceReSend2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="trgt_cust_dtpt_id" type="STRING" size="256"/>
          <Column id="mem_no" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="ci_val" type="STRING" size="256"/>
          <Column id="upp_tx_type" type="STRING" size="256"/>
          <Column id="nice_no" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_pdfFileInfo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="trgt_cust_dtpt_id" type="STRING" size="256"/>
          <Column id="img_file_nm" type="STRING" size="256"/>
          <Column id="img_file_path" type="STRING" size="256"/>
          <Column id="nice_no2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_pdfTemp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="trgt_cust_dtpt_id" type="STRING" size="256"/>
          <Column id="img_file_path" type="STRING" size="256"/>
          <Column id="img_file_nm" type="STRING" size="256"/>
          <Column id="nice_no2" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="join_dt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listWdrwReq" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="pay_mthd" type="STRING" size="256"/>
          <Column id="req_bit" type="STRING" size="256"/>
          <Column id="stat" type="STRING" size="256"/>
          <Column id="kstbit" type="STRING" size="256"/>
          <Column id="true_cnt" type="STRING" size="256"/>
          <Column id="req_pay_no" type="STRING" size="256"/>
          <Column id="pay_bit" type="STRING" size="256"/>
          <Column id="ichae_no" type="STRING" size="256"/>
          <Column id="ichae_cd" type="STRING" size="256"/>
          <Column id="req_day" type="STRING" size="256"/>
          <Column id="bank_filin_brkdn" type="STRING" size="256"/>
          <Column id="pay_amt" type="STRING" size="256"/>
          <Column id="reg_dm" type="STRING" size="256"/>
          <Column id="reg_man" type="STRING" size="256"/>
          <Column id="ichae_dt" type="STRING" size="256"/>
          <Column id="req_pay_gunsu" type="STRING" size="256"/>
          <Column id="upd_dm" type="STRING" size="256"/>
          <Column id="upd_man" type="STRING" size="256"/>
          <Column id="del_fg" type="STRING" size="256"/>
          <Column id="birth" type="STRING" size="256"/>
          <Column id="bill_gubun" type="STRING" size="256"/>
          <Column id="result_key" type="STRING" size="256"/>
          <Column id="result_kind" type="STRING" size="256"/>
          <Column id="month_cnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listMemberMangiExt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="cell" type="STRING" size="256"/>
          <Column id="zip_code" type="STRING" size="256"/>
          <Column id="adress" type="STRING" size="256"/>
          <Column id="ext_yn" type="STRING" size="256"/>
          <Column id="ext_period" type="STRING" size="256"/>
          <Column id="ext_day" type="STRING" size="256"/>
          <Column id="insert_gbn" type="STRING" size="256"/>
          <Column id="tx_etc" type="STRING" size="256"/>
          <Column id="del_fg" type="STRING" size="256"/>
          <Column id="reg_dm" type="STRING" size="256"/>
          <Column id="cancel_dt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_main_contract" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="cd">01</Col>
            <Col id="cd_nm">상조</Col>
          </Row>
          <Row>
            <Col id="cd">02</Col>
            <Col id="cd_nm">해외여행</Col>
          </Row>
          <Row>
            <Col id="cd">03</Col>
            <Col id="cd_nm">크루즈</Col>
          </Row>
          <Row>
            <Col id="cd">04</Col>
            <Col id="cd_nm">골프</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/********************************************************************************************/
/* 1. Include Library include, variables Declaration 영역                                  */
/********************************************************************************************/
include "LIB::lib_All.xjs"; // 공통라이브러리
var gv_jobsel          ="" ; // 신규 & 수정 구분
var gv_emple_no        = ""; // 담당사원
var gv_bef_emple_cd    = ""; // 모집사원
var gv_emple_cell    = "";   // 담당사원번호
var gv_b2b_comp_cd     = ""; // B2B 회사코드
var gv_sm_shop_info    = ""; // 삼성 매장코드
   
var gv_mem_no          = ""; // 고유아이디
var gv_accnt_no        = ""; // 회원아이디
var gv_cival           = ""; // 회원CI

var isChgPayGubun      = "Y"; // 리조트 회원에 따른 부가서비스 변경시 사용
var gv_oldCboPayGubunIdx = 0; // old 리조트회원 구분

var gv_smartLifeFg     = "N"; // 스마트라이프 여부
var gv_regFg           = "N"; // 상품 등록 여부 => 팝업 호출(CMS/카드/삼성카드)

var delBtnFlag         = false; // 삭제버튼 표출여부
var wdrwReqSrchFlag    = "";  // 상품정보 삭제 여부 체크

var gv_bugaCmsFg       = "N"; // 부가서비스 등록 팝업전에 회원CMS 체크
var gv_bugaCardFg      = "N"; // 부가서비스 등록 팝업전에 회원Card 체크
var fv_acuon_valid_days	= 30; // 애큐온신용등급유효기간(일수)
var gv_wdrw_req_accnt = 0;     //청구고객
var gv_able_prod_update = "N"; //청구고객

var gv_sbit = ""; // 사원조회 E:엔터 / C:클릭
//var niceSendingFlag = "N"; // NICE 전송중 여부

var gv_athrCd = gfn_getUserInfo("athr_cd");		// 2018.03.20  TM40 추가

var gv_niceNo = "";		// 선택된 회원의 nice key
var gv_Auth01 = "";		// 선택된 회원의 회원 인증 값
var gv_Auth02 = "";		// 선택된 회원의 계약 인증 값

/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리                                           	*/
/********************************************************************************************/
function PS02000104_onload(obj:Form, e:LoadEventInfo)
{
	gfn_getList("dlwCd", "01,113,81", null, null, "PS02000104DLWCD", "ds_dwl_cds");  // 공통코드조회
	var sUserId = gds_UserInfo.getColumn(0, "user_id");
	if( sUserId == "2011030007" || sUserId == "2010120001" || sUserId == "2011030009" || sUserId == "2011040027" ||
        sUserId == "2011060324" || sUserId == '2011040028' || sUserId == '2011040008' || sUserId == '2011120024' || 
        sUserId == '2011100009' || sUserId == '2011060475' || sUserId == '2013060011' ||	//콜센터 채현정 매니저 2013/11/05
        sUserId == '2013060017') {
        delBtnFlag = true;
	}
}

/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
function fn_callBack(svcid, errcd, errmsg) 
{
	if (errcd != 0) {
		trace(errcd)
		return false;
	} else {
		switch (svcid) {
			case "PS02000104DLWCD":
			gfn_getCode("01", "SELECT", ds_pyinMthdCd, ds_dwl_cds);	// 납입방법
			gfn_getCode("113", "SELECT", ds_joinTypCd, ds_dwl_cds); // 가입구분
			gfn_getCode("81", "SELECT", ds_hpcl_cd, ds_dwl_cds);	// 해피콜 상담상태
			fn_init(); // 초기화
			break;
			
			case "srchProdList":
			fn_postSearch();
			break;
			
			case "srchResnAmt":
			fn_SetNiceBtn();
			edt_resn_amt.value = gfn_setComma(ds_resnAmt.getColumn(0, "resn_amt"));
			fn_insertSrchHist(); // 금일 조회 이력 추가  ------- 임동진매니져 요청 20161108
			break;
			
			case "srchProdSrvc":
			fn_setProdSrvc(); // 부가서비스 설정
			break;
			
			// 할인우대권 확인 결과
			case "chkRandNum":
			if (ds_randNum.getColumn(0, "resultMsg") == "success") {
				var sNewChanGunsu = ds_randNum.getColumn(0, "new_chan_gunsu");
				var sProdDcCnt = ds_prodList.getColumn(0, "prod_dc_cnt");
				var tmp = Number(sNewChanGunsu) + Number(sProdDcCnt);
				spn_new_chan_gunsu.value = tmp;
			} else {
				alert("잘못된 할인우대권입니다.");
				edt_rand_num.value = "";
				return false;
			}
			break;
			
			// 모델분류 설정
			case "srchModlTyp":
			ds_cbo_modlNm.clearData();
			ds_cbo_prdtKind.clearData();
			
			if (ds_cbo_modlTyp.rowcount > 0) {
				ds_cbo_modlTyp.insertRow(0);
				ds_cbo_modlTyp.setColumn(0, "prod_kind", "");
				ds_cbo_modlTyp.setColumn(0, "prod_kind_nm", "선택");
				
				if (gfn_isNull(edt_accnt_no.value)) {
					if (ds_cbo_modlTyp.rowcount == 2) {
						cbo_prod_model_kind.index = 1;  // 단일건일 경우 자동선택
						fn_srchModlNm();                // 모델명 상품종류 조회
						
						// 모델 (단일건) 선택 후, 주계약 버튼 enable
						btn_main_contract.enable = true;
					} else {
						cbo_prod_model_kind.index = 0;
						// 모델 선택되지 않은 경우, 주계약 버튼 enable
						btn_main_contract.enable = false;
					}
				} else {
					if (!gfn_isNull(ds_prod.getColumn(0, "prod_model_kind"))) {
						cbo_prod_model_kind.value = ds_prod.getColumn(0, "prod_model_kind");
						fn_srchModlNm();
						
						// 모델이 있는 경우, 주계약 버튼 enable
						btn_main_contract.enable = true;
					}
				}
			}
			
			fn_setEnableCombo();
			break;
			
			// 모델명, 상품종류 설정
			case "srchModlNm":
			if (ds_cbo_modlNm.rowcount > 0) {
				ds_cbo_modlNm.insertRow(0);
				ds_cbo_modlNm.setColumn(0, "modl_cd", "");
				ds_cbo_modlNm.setColumn(0, "modl_nm", "선택");
				
				if (gfn_isNull(edt_accnt_no.value)) {
					if (ds_cbo_modlNm.rowcount == 2) {
						cbo_prod_model_cd.index = 1; // 단일건일 경우 자동선택
					} else {
						//cbo_prod_model_kind.index = 0;
						cbo_prod_model_cd.index = 0;
					}
				} else {
					if (!gfn_isNull(ds_prod.getColumn(0, "prod_model_cd"))) {
						cbo_prod_model_cd.value = ds_prod.getColumn(0, "prod_model_cd");
					}
				}
			}
			
			if (ds_cbo_prdtKind.rowcount > 0) {
				ds_cbo_prdtKind.insertRow(0);
				ds_cbo_prdtKind.setColumn(0, "seq", "");
				ds_cbo_prdtKind.setColumn(0, "prod_kind_nm", "선택");
				
				if (gfn_isNull(edt_accnt_no.value)) {
					if (ds_cbo_prdtKind.rowcount == 2) {
						cbo_prod_kind.index = 1; // 단일건일 경우 자동선택
					} else {
						cbo_prod_kind.index = 0;
					}
				} else {
					if (!gfn_isNull(ds_prod.getColumn(0, "prod_kind"))) {
						cbo_prod_kind.value = ds_prod.getColumn(0, "prod_kind");
					}
				}
			}
			
			fn_setEnableCombo();
			break;
			
			// 회원 리조트 정보 조회 결과
			case "srchResortInfo":
			cbo_pay_gubun.value = ds_resortInfo.getColumn(0, "pay_gubun");
			edt_resort_mem_no.value = ds_resortInfo.getColumn(0, "resort_mem_no");
			edt_resort_mem_nm.value = ds_resortInfo.getColumn(0, "resort_mem_nm");
			
			fn_chngResort();
			break;
			
			// 2구좌 가입 제한 확인 결과
			case "srchNoSaleAccnt":
				if(ds_saleAccnt.getColumn(0, "result_flag") == "Y") {  // 구좌 등록가능 
					if(ds_saleAccnt.getColumn(0, "gubun") == "prod") { // 상품 선택시
						fn_chngResort();                                   // 리조트 회원 설정
						if (ds_prod.getColumn(0, "accnt_no") != "00000") { // 기타문의 일 경우는 제외
							fn_srchProdSrvc();                             // 부가서비스 조회
						}
					}
				} else {                                               // 구좌 등록 불가건
					alert("3구좌 이상 가입불가 건입니다.");
					
					edt_emple_nm.value = "";
					gv_emple_no = "";
					edt_bef_emple_nm.value = "";
					gv_bef_emple_cd = "";
					edt_prod_cd.value = "";
					edt_prod_nm.value = "";
				}
			break;
			
			// 저장 콜백
			case "saveMemProdAccnt":
				fn_srch_prod_info("research"); // 상품 재조회
				parent.div_cons_hstr.fn_srch_mem_cons_hstr(); // 상담이력조회
				
				fn_vatSvcSync(); //저장 후 부가서비스 관리 이력과 동기화 처리 로직 호출
			break;
			
			// 부가정보
			case "srchBugaInfo":
				if (ds_bugaInfo.rowcount > 0) {
					var sNewChanGunsu =  ds_prod.getColumn(0, "expr_no");
					var sPayNo = ds_prod.getColumn(0, "pay_no");
					if (gfn_isNull(sPayNo)) {
						sPayNo = 0;
					}
					var tmp = Number(sNewChanGunsu) - Number(sPayNo); // 만기회차 - 납입회차
					spn_new_chan_gunsu.max = tmp; // 특별할인 max 설정
					
					if (ds_prod.getColumn(0, "resn_yn") == "Y") { // 해약구분
						edt_resn_amt.value = gfn_setComma(ds_prod.getColumn(0, "resn_amt")); // 해약금
						
						fn_insertSrchHist(); // 금일 조회 이력 추가  ------- 임동진매니져 요청 20161108
						
						btn_cnctRgsn.text = "해약수정";
					} else {
						fn_srchResnAmt(); // 해약금 조회
						
						btn_cnctRgsn.text = "해약등록";
					}
				} else {
					edt_resn_amt.value = "0";
				}
			break;
			
			// 삭제전 체크
			case "wdrwReqSrch":
				if(wdrwReqSrchFlag == "Y") {
					fn_deleteMemProdAccnt();
				} else {
					if(wdrwReqSrchFlag == "F") {
						alert("입금건이 존재합니다.\n입금이 없어야 삭제 가능합니다.");
					} else {
						alert("CMS/CARD 출금이체 중입니다.");
					}
					return;
				}
			break;
			
			// 삭제결과
			case "deleteMemProdAccnt":
				alert("상품이 삭제되었습니다.");
				fn_srch_prod_info("resrch");
				parent.div_cons_hstr.fn_srch_mem_cons_hstr(); // 상담이력조회
			break;
			
			// 부가서비스 등록 회원정보 CMS/Card 체크 결과
			case "bugaSrvcMemChk":
				btn_bugaInfo.visible = true;
				
				if (gv_bugaCmsFg == "N" && gv_bugaCardFg == "N") {
					btn_bugaInfo.enable = true;
				} else {
					btn_bugaInfo.enable = false;
				}
			break;
			
			
			// 2018.02.20 전자 서명 관련 콜백
			case "insertNiceInfomation2":
				alert("계약문자 발송이 완료 되었습니다!");
				fn_srch_prod_info("research");
				//niceSendingFlag = "N";
			break;
			
			case "getNicePdfFile":
				if(ds_pdfFileInfo.getRowCount() == 0)
				{
					alert("2차전송이 수행되지 않은 고객입니다. 계약문자전송을 실행하여 주십시오.");
				}
				else
				{
					var sImg_file_nm = ds_pdfFileInfo.getColumn(ds_pdfFileInfo.rowposition, "img_file_nm");
					var sImg_file_path = ds_pdfFileInfo.getColumn(ds_pdfFileInfo.rowposition, "img_file_path");
					var param = {pdfFileName : sImg_file_nm, pdfFilePath : sImg_file_path};
					var reVal = gfn_diaLog("전자서명증서", -1, -1, 800, 600, "PS990000::PS999000.xfdl", false, param, true, false, true, null, null, true);
				}
			break;
			
			case "resendKaKao2" :
				alert("계약문자 재전송이 완료되었습니다!");
				fn_srch_prod_info("research");
			break;
			
			case "sendNiceCancel" :
				alert("2차접수 취소가 완료되었습니다!");
				fn_srch_prod_info("research");
			break;
			
			case "resendNicePdfFile" :
				alert("전자서명재전송이 완료되었습니다.");
				fn_srch_prod_info("research");
			break; 
			
			case "getAcuonLatelyAuth" :
				
			break;
		}
	}
}

/********************************************************************************************/
/**   4. Validation 처리                                                                   	*/
/********************************************************************************************/
// 상품 조회전
function fn_preSrchProdInfo(sType)
{
	gv_mem_no = parent.div_member.ds_member.getColumn(0, "mem_no");
	gv_cival = parent.div_member.ds_member.getColumn(0, "ci_val");
	if (gfn_isNull(sType)) {
		gv_accnt_no = parent.div_member.ds_member.getColumn(0, "accnt_no");
	}
	
	if (gfn_isNull(gv_mem_no)) {
		alert("회원정보가 없습니다.");
		return false;
	}
	
	ds_inqCndt_prod.clearData();
	ds_inqCndt_prod.addRow();
	ds_inqCndt_prod.setColumn(0, "mem_no", gv_mem_no);
	ds_inqCndt_prod.setColumn(0, "etc_yn", "Y");
	
	// 전자서명 인증값을 가져오기 위한 ci값 입력
	ds_inqCndt_prod.setColumn(0, "ci_val", gv_cival);
	return true;
}

// 부가서비스 리스트 조회전
function fn_preSrchProdSrvc()
{
	ds_inqCndt_procSrvc.clearData();
	ds_inqCndt_procSrvc.addRow();
	ds_inqCndt_procSrvc.setColumn(0, "prod_cd", ds_prod.getColumn(0, "prod_cd"));
	ds_inqCndt_procSrvc.setColumn(0, "pay_gubun", ds_prod.getColumn(0, "pay_gubun")); // 리조트 회원구분
	if (gfn_isNull(ds_prod.getColumn(0, "accnt_no"))) { // 신규등록 여부에 따라 use_yn 설정
		ds_inqCndt_procSrvc.setColumn(0, "use_yn", "Y");
		ds_inqCndt_procSrvc.setColumn(0, "accnt_no", "");
		ds_inqCndt_procSrvc.setColumn(0, "gubun", "");
	} else {
		ds_inqCndt_procSrvc.setColumn(0, "use_yn", "");
		ds_inqCndt_procSrvc.setColumn(0, "accnt_no", ds_prod.getColumn(0, "accnt_no"));
		ds_inqCndt_procSrvc.setColumn(0, "gubun", "inq");
	}
	
	return true;
}

// 추가버튼 체크
function fn_preAddProd()
{
	if (gfn_isNull(parent.div_member.mem_no.value)) {
		alert("회원정보가 없습니다.");
		return false;
	}

	if (!parent.div_member.business_yn.value) { // 사업자가 아닐 경우
		if (gfn_isNull(parent.div_member.ci_val.value)) {
			alert("본인인증을 하셔야 합니다.");
			return false;
		}
	}
	
	if (gfn_isNull(parent.div_member.home_zip.value) || gfn_isNull(parent.div_member.home_addr.value)) {
		alert("회원의 수령지 주소를 입력하세요.");
		return false;
	} else if (gfn_isNull(parent.div_member.home_addr2.value)) {
		alert("회원의 수령지 상세주소를 입력하세요.");
		parent.div_member.home_addr2.setFocus();
		return false;
	}
	
	if (!parent.div_member.gv_memberHomeAddrFlag) {
		alert("회원의 수령지 정보를 저장하여야 합니다.");
		return false;
	}
	
	return true;
}

// 저장 전
function fn_preSaveProd()
{
	if (gfn_isNull(parent.div_member.mem_no.value)) {
		alert("회원정보가 없습니다.");
		return false;
	}
	
	if (!parent.div_member.business_yn.value) { // 사업자가 아닐 경우
		if (gfn_isNull(parent.div_member.ci_val.value)) {
			alert("본인인증을 하십시요.");
			parent.div_member.ci_val.setFocus();
			return false;
		}
	}
	
	if (!gfn_isNull(edt_appfm_no.value)) {
		if (String(edt_appfm_no.value).length != 6) {
			alert("신청서 번호를 6자리로 입력하여 주십시요.");
			edt_appfm_no.setFocus();
			return false;
		}
	}
	
	if (gfn_isNull(parent.div_member.home_zip.value) || gfn_isNull(parent.div_member.home_addr.value)) {
		alert("회원의 수령지 주소를 입력하세요.");
		return false;
	} else if (gfn_isNull(parent.div_member.home_addr2.value)) {
		alert("회원의 수령지 상세주소를 입력하세요.");
		parent.div_member.home_addr2.setFocus();
		return false;
	}
	
	if (!parent.div_member.gv_memberHomeAddrFlag) {
		alert("회원의 수령지 정보를 저장하여야 합니다.");
		return false;
	}
	
	if (gfn_isNull(edt_emple_nm.value) || gfn_isNull(gv_emple_no)) {
		alert("담당사원 정보를 입력하십시요.");
		return false;
	}
	
	if (gfn_isNull(edt_bef_emple_nm.value) || gfn_isNull(gv_bef_emple_cd)) {
		alert("모집사원 정보를 입력하십시요.");
		return false;
	}
	
	if (gfn_isNull(edt_prod_cd.value) || gfn_isNull(edt_prod_nm.value)) {
		alert("상품을 선택하십시요.");
		return false;
	}
	
	if (gfn_isNull(cbo_join_cl.value)) {
		alert("가입구분을 선택하십시요.");
		return false;
	}
	
	if (gfn_isNull(cbo_pay_mthd.value)) {
		alert("납입방법을 선택하십시요.");
		return false;
	}
	
	if (gfn_isNull(cal_join_dt.value)) {
		alert("가입일자를 입력하십시요.");
		return false;
	}
	
	var sCboPayGubun = cbo_pay_gubun.value;
	if ((sCboPayGubun == "01" || sCboPayGubun == "02") && (gfn_isNull(edt_resort_mem_no.value) || gfn_isNull(edt_resort_mem_nm.value))) {
		alert("리조트 회원인 경우 리조트 회원번호,회원명은 반드시 입력하셔야 합니다.");
		return false;
	}
	
	var sEdtRandNum = edt_rand_num.value;
	if (!gfn_isNull(sEdtRandNum) && String(sEdtRandNum).length != 10) {
		alert("할인우대권 10자리를 입력하십시오.");
		return false;
	}
	
	if (ds_cbo_modlTyp.rowcount > 1 && gfn_isNull(cbo_prod_model_kind.value)) {
		alert("모델분류를 선택하세요.");
		return false;
	}
	
	if (ds_cbo_modlNm.rowcount > 1 && gfn_isNull(cbo_prod_model_cd.value)) {
		alert("모델명을 선택하세요.");
		return false;
	}
	
	if (ds_cbo_prdtKind.rowcount > 1 && gfn_isNull(cbo_prod_kind.value)) {
		alert("상품종류를 선택하세요.");
		return false;
	}
	
	var sSectionThr = ds_list_prod.getColumn(ds_list_prod.rowposition, "section_thr");
	var sB2bEmpleCi = new String(edt_b2b_emple_ci.value);
	
	if(sSectionThr == "0010")
	{
		if(gfn_isNull(sB2bEmpleCi) || sB2bEmpleCi.length != 88) // || edt_b2b_emple_ci.value.leng)
		{
			if(confirm("B2B사원의 CI가 정상적이지 않습니다. 그래도 저장하시겠습니까?") == true)
			{
			
			}
			else
			{
				return false;
			}
		}
	}
	
	var bfCnt = 0;   // 전방 갯수
	var afCnt = 0;   // 후방 갯수
	var tempAC = [];  //적용회차를 담아둘 리스트
	var k = 0;
	
	for(var i=0; i<ds_list_prodSrvc.rowcount; i++){
		if(ds_list_prodSrvc.getColumn(i, "vital_service") != 'Y') {
			if (ds_list_prodSrvc.getColumn(i, "svc_event_bf_cl") == '전방') {
				bfCnt += 1;
				var appNoCnt = 0;
				
				for(var j=0; j<tempAC.length; j++) {
					if(String(tempAC[j]) == ds_list_prodSrvc.getColumn(i, "app_no")) {
						appNoCnt++;
					}
				}
				
				if(appNoCnt == 0) {
					tempAC[k] = ds_list_prodSrvc.getColumn(i, "app_no");
					++k;
				}
			} else {
				afCnt += 1;	
			}
		}
	}
			
	var chk = false;
	for(var j=0; j<tempAC.length; j++) {
		if (bfCnt>0)  {
			chk = false;
			for(var i=0; i<ds_list_prodSrvc.rowcount; i++){
				if (ds_list_prodSrvc.getColumn(i, "app_no") == tempAC[j] && ds_list_prodSrvc.getColumn(i, "_chk") == 1
				 && ds_list_prodSrvc.getColumn(i, "svc_event_bf_cl") == '전방') {
					chk = true;
				}
			}

			if (chk == false && ds_list_prodSrvc.rowcount > 0) { 
				alert(tempAC[j] + "회차 전방 부가서비스중 하나는 반드시 선택하셔야 합니다.");
				return false;
			}
		}
	}
	chk = false;
	if (afCnt>0)  {
		for(var i=0; i<ds_list_prodSrvc.rowcount; i++){
			if (ds_list_prodSrvc.getColumn(i, "_chk") == 1 && ds_list_prodSrvc.getColumn(i, "svc_event_bf_cl") == '후방') {
				chk = true;
			}
		}

		if (chk == false && ds_list_prodSrvc.rowcount > 0) { 
			alert("후방 부가서비스는 반드시 선택하셔야 합니다.");
			return false;
		}
	}
	
	
	/*
	//청구고객
	fn_setAbleSave();
	if(gv_wdrw_req_accnt > 0)
	{
		if(gv_able_prod_update == "N")
		{
			alert("현재 금액 청구중인 회원입니다. 청구 삭제후 등록 가능합니다.");
			return false;
		}
	}
	*/
	
	// 상품 추가가 아닌 경우 체크
	if(gv_jobsel != "1") {
		fn_setAbleSave();
		if(gv_able_prod_update == "N") {
		
			var sDelFg = ds_listWdrwReq.getColumn(0, "del_fg"); // DEL_FG (N:산출, R:청구)
			if(sDelFg == "N")
			{
				alert("현재 산출중인 회원입니다. 산출 삭제 후 등록 가능합니다.");
				return false;
			}
			else if(sDelFg == "R")
			{
				alert("현재 청구중인 회원입니다.");
				return false;
			}
		}
	}
	
	// 납입주기
	return true;
}

/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)                                                   	*/
/********************************************************************************************/
// 상품 조회
function fn_commSearch(sType) {
    fn_srch_prod_info(sType);
}
function fn_srch_prod_info(sType)
{	
	if (!fn_preSrchProdInfo(sType)) return false;
	
	var szSvcid       = "srchProdList";
    var szController  = "/dlw/cons-prod/list";
    var szInDs        = "ds_input=ds_inqCndt_prod";
    var szOutDs       = "ds_list_prod=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

// 해약금 조회
function fn_srchResnAmt()
{
	ds_resnAmt.clearData();
	ds_resnAmt.addRow();
	ds_resnAmt.setColumn(0, "accnt_no", ds_prod.getColumn(0, "accnt_no"));
	ds_resnAmt.setColumn(0, "ci_val", parent.div_member.ds_member.getColumn(0, "ci_val"));
	ds_resnAmt.setColumn(0, "r_gubn", ds_prod.getColumn(0, "r_gubn"));
	
	var szSvcid       = "srchResnAmt";
    var szController  = "/dlw/cons-prod/resn-amt";
    var szInDs        = "ds_input=ds_resnAmt";
    var szOutDs       = "ds_resnAmt=ds_output";
    var szParam       = ""
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

// 부가서비스 리스트 조회
function fn_srchProdSrvc()
{
	if (!fn_preSrchProdSrvc()) return false;
	
	var szSvcid       = "srchProdSrvc";
    var szController  = "/dlw/cons-prod/srvc-list";
    var szInDs        = "ds_input=ds_inqCndt_procSrvc";
    var szOutDs       = "ds_list_tmp_prodSrvc=ds_output";
    var szParam       = ""
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

// 할인우대권 체크
function fn_chkRandNum()
{
	if (gfn_isNull(edt_rand_num.value)) return false;
	
	var szSvcid       = "chkRandNum";
    var szController  = "/dlw/cons-prod/chk-rand-num";
    var szInDs        = "";
    var szOutDs       = "ds_randNum=ds_output";
    var szParam       = "rand_num="+edt_rand_num.value;
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

// 모델분류 조회
function fn_srchModelTyp(sType)
{
	var sProdCd = "";
	if (sType == "CHC") {
		sProdCd = ds_prodList.getColumn(0, "prod_cd")
	} else if (sType == "AMNT") {
		sProdCd = ds_prod.getColumn(0, "prod_cd");
	}
	
	if (gfn_isNull(sProdCd)) {
		alert("상품코드가 없습니다.");
		return false;
	}
	
	var szSvcid       = "srchModlTyp";
    var szController  = "/dlw/cons-prod/modl-list/modlTyp";
    var szInDs        = "";
    var szOutDs       = "ds_cbo_modlTyp=ds_output";
    var szParam       = "prod_cd="+sProdCd;
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

// 모델분류에 따른 모델명, 상품종류 조회
function fn_srchModlNm()
{
	if (gfn_isNull(edt_prod_cd.value)) {
		alert("상품코드가 없습니다.");
		return false;
	} else if (gfn_isNull(cbo_prod_model_kind.value)) {
		alert("모델분류가 없습니다.");
		return false;
	}
	
	var szSvcid       = "srchModlNm";
    var szController  = "/dlw/cons-prod/modl-list/modlNm";
    var szInDs        = "";
    var szOutDs       = "ds_cbo_modlNm=ds_output ds_cbo_prdtKind=ds_subOutput";
    //var szParam       = "prod_cd="+edt_prod_cd.value+" prod_kind="+cbo_prod_model_kind.value;
    // 2018.05.17 - 상품추가(신규) 또는 수정시 단종모델은 불러오지 않도록 수정
    var szParam       = "prod_cd="+edt_prod_cd.value+" prod_kind="+cbo_prod_model_kind.value+" continued=Y";
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

// 회원의 리조트 정보 조회
function fn_srchResortInfo()
{	
	var szSvcid       = "srchResortInfo";
    var szController  = "/dlw/cons-prod/resort-info";
    var szInDs        = "";
    var szOutDs       = "ds_resortInfo=ds_output";
    var szParam       = "mem_no="+parent.div_member.mem_no.value;
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

// 2구좌 가입 제한 확인
function fn_srchNoSaleAccnt(sType)
{
	ds_saleAccnt.clearData();
	ds_saleAccnt.addRow();
	ds_saleAccnt.setColumn(0, "prod_cd", edt_prod_cd.value);
	ds_saleAccnt.setColumn(0, "emple_no", gv_emple_no);
	ds_saleAccnt.setColumn(0, "gubun", sType);
	ds_saleAccnt.setColumn(0, "result_flag", "N");

	var szSvcid       = "srchNoSaleAccnt";
    var szController  = "/dlw/cons-prod/no-sale-accnt";
    var szInDs        = "ds_input=ds_saleAccnt";
    var szOutDs       = "ds_saleAccnt=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

// 상품 저장
function fn_saveProd()
{
	if (ds_prod.getColumn(0, "accnt_no") == "00000") {
		alert("기타문의는 저장할 수 없습니다.");
		return false;
	}
	
	if (gv_jobsel =="1") {
		if(!confirm("마케팅 동의 하시겠습니까?")) {
				parent.div_member.cbo_markt_agr_yn.value ="N"
		} else {
				parent.div_member.cbo_markt_agr_yn.value ="Y"
		}
	}
	
	if (!fn_preSaveProd()) return false;
	
	if (gfn_isNull(edt_b2b_comp_nm.value)) { // B2B회사명 없다면 코드 초기화
		gv_b2b_comp_cd = "";
	}
	
	if (gfn_isNull(edt_sm_shop_nm.value)) {  // 매장명 없다면 코드 초기화
		gv_sm_shop_info = "";
	}
	
	if (gfn_isNull(edt_b2b_emple_ci.value)) { // B2B회사 사원 CI 없다면 CI 초기화
		edt_b2b_emple_ci.value = "";
	}
	
	if(gfn_isNull(spn_new_chan_gunsu.value)) spn_new_chan_gunsu.value = 0;

	gv_mem_no = parent.div_member.ds_member.getColumn(0, "mem_no");
	ds_prod.setColumn(0, "mem_no", gv_mem_no);
	ds_prod.setColumn(0, "emple_no", gv_emple_no);
	ds_prod.setColumn(0, "bef_emple_cd", gv_bef_emple_cd);
	ds_prod.setColumn(0, "prod_model_kind", cbo_prod_model_kind.value);
	ds_prod.setColumn(0, "prod_model_cd", cbo_prod_model_cd.value);
	ds_prod.setColumn(0, "prod_kind", cbo_prod_kind.value);
	ds_prod.setColumn(0, "b2b_comp_cd", gv_b2b_comp_cd);
	ds_prod.setColumn(0, "sm_shop_info", gv_sm_shop_info);
	ds_prod.setColumn(0, "kydate", cal_kydate.value);
	ds_prod.setColumn(0, "kstbit", Combo_kstbit.value);
	ds_prod.setColumn(0, "order_num" , gfn_Trim(edt_order_num.value));
	
//	trace('설치일=========='+Combo_kstbit.value);
	//trace(ds_prod.saveXML());
		
	if (gfn_isNull(edt_accnt_no.value)) {   // 상품 등록
		// 상품 코드 54 이벤트 상품일 경우 이벤트 상품 등록 건수를 조회하여 제한함
		// 이번트 상품 코드 54 사용하지 않음 => 기존에는 주민등록번호로 체크, 쿼리 오류(잘못된 컬럼)
		// mergeMemProdAccnt
		// 특정상품 스마트라이프상담 등록
		// insertReqUpdDelInf 구좌별 부가서비스 등록
		
		gv_regFg = "Y";
	} else {								// 상품 수정
		// mergeMemProdAccnt
		// deleteMemProdAccntSvc 부가서비스 삭제
		// insertMemProdAccntSvc 체크된 부가서비스 등록
		
		// mode update
		// 변경 내용 등록
		// 마스터 상담 및 상세 상담 등록
		
		gv_regFg = "N";
	}
	
	// CTI통화이력ID가 TOP에 있을 경우(통화중)
	// 없다면 현재 상담의 CTI통화이력ID로 설정
	var sCtiCrncDtlId = ap_TopFrame.form.gv_cti_crnc_dtl_id;
	if (gfn_isNull(sCtiCrncDtlId)) {
		if (parent.div_cons_memo.tab_cons.tp_cons1.div_cons1.ds_cons.rowcount > 0) {
			sCtiCrncDtlId = parent.div_cons_memo.tab_cons.tp_cons1.div_cons1.ds_cons.getColumn(0, "cti_crnc_dtl_id");
		}
	}
	
	ds_prod.addColumn("cti_crnc_dtl_id", "string", 256);
	ds_prod.setColumn(0, "cti_crnc_dtl_id", sCtiCrncDtlId);	// CTI 통화 내역 ID
	
	ds_prod.addColumn("mem_nm", "string", 256);
	ds_prod.setColumn(0, "mem_nm", parent.div_member.ds_member.getColumn(0, "mem_nm")); // 회원명(주소관리-설치장소 처리위해)
	
	if (gfn_isNull(cbo_hpcl_stat_cd.value)) {
		ds_prod.setColumn(0, "hpcl_stat_nm", "");
	} else {
		ds_prod.setColumn(0, "hpcl_stat_nm", cbo_hpcl_stat_cd.text);
	}
	
	ds_prod.setColumn(0, "b2b_emple_ci", edt_b2b_emple_ci.value); // B2B사원CI
	
	var szSvcid       = "saveMemProdAccnt";
	var szController  = "/dlw/cons-prod/save";
	var szInDs        = "ds_input=ds_prod ds_subInput=ds_list_prodSrvc ds_chbfProd=ds_chbfProd";
	var szOutDs       = "ds_prod=ds_output";
	var szParam       = "";
	var szRetCallback = "fn_callBack";

	// 트랜젝션 공통함수 호출
	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

// 상품 삭제 여부 체크
function fn_delProd()
{
	if (ds_prod.getColumn(0, "accnt_no") == "00000") {
		alert("기타문의는 삭제할 수 없습니다.");
		return false;
	}
	
	if (confirm("해당 상품을 삭제하시겠습니까?")) {
		if (gfn_isNull(ds_prod.getColumn(0, "mem_no"))) {
			alert("회원고유번호가 없습니다.");
			return false;
		}
		
		if (gfn_isNull(ds_prod.getColumn(0, "accnt_no"))) {
			alert("회원번호가 없습니다.");
			return false;
		}
	
		var szSvcid       = "wdrwReqSrch";
		var szController  = "/dlw/cons-prod/wdrw-req-srch";
		var szInDs        = "";
		var szOutDs       = "";
		var szParam       = "accnt_no="+ds_prod.getColumn(0, "accnt_no");
		var szRetCallback = "fn_callBack";
			
		// 트랜젝션 공통함수 호출
		gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
	}
}

// 상품정보 삭제
function fn_deleteMemProdAccnt()
{
	// CTI통화이력ID가 TOP에 있을 경우(통화중)
	// 없다면 현재 상담의 CTI통화이력ID로 설정
	var sCtiCrncDtlId = ap_TopFrame.form.gv_cti_crnc_dtl_id;
	if (gfn_isNull(sCtiCrncDtlId)) {
		if (parent.div_cons_memo.tab_cons.tp_cons1.div_cons1.ds_cons.rowcount > 0) {
			sCtiCrncDtlId = parent.div_cons_memo.tab_cons.tp_cons1.div_cons1.ds_cons.getColumn(0, "cti_crnc_dtl_id");
		}
	}

	ds_deleteProdInfo.clearData();
	ds_deleteProdInfo.addRow();
	ds_deleteProdInfo.setColumn(0, "accnt_no", ds_prod.getColumn(0, "accnt_no"));
	ds_deleteProdInfo.setColumn(0, "mem_no", ds_prod.getColumn(0, "mem_no"));
	ds_deleteProdInfo.setColumn(0, "cti_crnc_dtl_id", sCtiCrncDtlId);
	ds_deleteProdInfo.setColumn(0, "prod_cd", ds_prod.getColumn(0, "prod_cd"));
	ds_deleteProdInfo.setColumn(0, "prod_nm", ds_prod.getColumn(0, "prod_nm"));
	ds_deleteProdInfo.setColumn(0, "emple_no", ds_prod.getColumn(0, "emple_no"));
	ds_deleteProdInfo.setColumn(0, "emple_nm", ds_prod.getColumn(0, "emple_nm"));
	
	var szSvcid       = "deleteMemProdAccnt";
	var szController  = "/dlw/cons-prod/delete";
	var szInDs        = "ds_input=ds_deleteProdInfo";
	var szOutDs       = "";
	var szParam       = "";
	var szRetCallback = "fn_callBack";
			
	// 트랜젝션 공통함수 호출
	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

// 부가정보 조회
function fn_srchBugaInfo()
{
	var szSvcid       = "srchBugaInfo";
    var szController  = "/dlw/card/buga-info";
    var szInDs        = "";
    var szOutDs       = "ds_bugaInfo=ds_output";
    var szParam       = "accnt_no=" + edt_accnt_no.value;
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback, false);
}

// 금일 조회 이력 저장
function fn_insertSrchHist()
{
	var szSvcid       = "insertSrchHist";
    var szController  = "/dlw/cons-prod/hist/insert";
    var szInDs        = "";
    var szOutDs       = "";
    var szParam       = "accnt_no=" + edt_accnt_no.value;
    var szRetCallback = "";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

// 부가서비스 멤버 체크
function fn_bugaSrvcMemChk()
{
	var sAccntNo = edt_accnt_no.value;
	if (gfn_isNull(sAccntNo) || sAccntNo == "00000") {
		//alert("가입상품이 없습니다.");
		gv_bugaCmsFg = "N";
		gv_bugaCardFg = "N";
		btn_bugaInfo.visible = false;
		return false;
	}
		
	var szSvcid       = "bugaSrvcMemChk";
    var szController  = "/dlw/cust/buga-srvc/chk";
    var szInDs        = "";
    var szOutDs       = "";
    var szParam       = "accnt_no=" + edt_accnt_no.value;
    var szRetCallback = "fn_callBack";
	
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

/********************************************************************************************/
/**   6. 사용자 함수                                                                   	*/
/********************************************************************************************/
// 초기화
function fn_init(sType)
{
	ds_prod.clearData();
	ds_list_prodSrvc.clearData(); // 상품에 따른 부가서비스 리스트
	ds_cbo_modlTyp.clearData();
	
	if (sType == "ADD") {
		ds_prod.addRow();
		
		cal_join_dt.enable = true;
		cal_join_dt.value = gfn_getToday();
		
		parent.div_buga.fn_init();     // 납입정보 부가서비스 초기화
		parent.div_buga.fn_initOdrg(); // 발주정보 초기화
		parent.div_cms_hstr.fn_init(); // 해약정보/납입이력/결제정보/청구내역 초기화
	} else {
		ds_list_prod.clearData(); // 상품 리스트
		cal_join_dt.enable = false;
	}
	
	cbo_pay_mthd.index = 1;       // 납입방법
	cbo_join_cl.index = 1;        // 가입구분
	cbo_pay_gubun.index = 0;      // 리조트 회원구분
	cbo_ja_subscrpt_yn.index = 1; // 구독여부
	cbo_ocb_point_yn.index = 1;
	cbo_hpcl_stat_cd.index = 0;	  // 해피콜 상태
	
	spn_new_chan_gunsu.value = 0;
	edt_resn_amt.value = "";
	
	//mae_inspl_zip.mask = "";
	mae_edt_reg_dm.mask = "";
	mae_ocb_crt_dt.mask = "";
	
	// 상품가격 초기화
	edt_prod_amt.value = "";
	
	//설치완료일자초기화
	cal_kydate.value =""
	// 전역변수 초기화
	gv_mem_no = "";          // 고유번호
	gv_accnt_no = "";        // 회원번호
	gv_emple_no = "";        // 담당사원
	gv_bef_emple_cd = "";    // 모집사원
	gv_b2b_comp_cd = "";     // B2B 회사코드
	gv_sm_shop_info = "";    // 삼성 매정코드
	isChgPayGubun = "Y";
	gv_oldCboPayGubunIdx = 0;
	gv_smartLifeFg = "N";
	gv_regFg = "N";
	
	fn_setBtnConr("NULL");   // 버튼 초기화
	fn_setEnableCombo();     // 콤보 초기화
	fn_setSmShopInfo("N");   // 매장정보 설정
	
	// 보기모드 상품 정보 변경 제한 처리
	// 1. "div_prod_disable" DIV "BringToFront" 실행!
	// 2. 보기모드에서 클릭 가능한 회원번호 상품내용, 증서 버튼, 설치장소 우편주소 항목 "BringToFront" 실행!!!
	div_prod_disable.style.background = "#ffffffff";
	div_prod_disable.style.opacity = "15%";
	div_prod_disable.position.top = 26;
	div_prod_disable.position.bottom = 277;
	div_prod_disable.position2.left = stc_prod_start.position2.left;
	//cal_kydate.visible=true
	
	
	
	div_prod_disable.visible = true;
	
	// 보기모드 부가서비스 정보 변경 제한 처리
	div_prod_srvc_disable.style.background = "#ffffffff";
	div_prod_srvc_disable.style.opacity = "15%";
	div_prod_srvc_disable.position.top = 280;
	div_prod_srvc_disable.position.bottom = 406;
	div_prod_srvc_disable.position2.left = stc_prod_srvc_start.position2.left;
	div_prod_srvc_disable.visible = true;
}

// 버튼 제어
function fn_setBtnConr(sType)
{

	if (sType == "NULL") {
		btn_save_prod.visible = false;
		btn_cancel_prod.visible = false;
		btn_del_prod.visible = false;
		btn_update_prod.visible = false;
		btn_srchProd.visible = false;
		
		// 쇼핑몰 연동 버튼...
		btn_amtUseshow.position2 = "absolute r:154 w:72 t:3 h:20";
		
		// NICE 2차연동 버튼... 위치를 잡는다.		
		btn_niceSecondSend.position2 = "absolute r:230 w:78 t:3 h:20";
		
		btn_concCmpl.position2 = "absolute l:429 w:60 t:3 h:20";
		edt_rec_dual_hr.position2 = "absolute l:366 w:60 t:3 h:20";
		
		
		btn_add_prod.position2 = "absolute r:4 w:72 t:3 h:20";
		btn_add_prod.visible = true;
		
		btn_appfmNo.visible = false;      // 신청서
		btn_srchEmple.visible = false;    // 담당사원
		btn_befEmple.visible = false;     // 모집사원
		btn_srchB2bComp.visible = false;  // B2B회사
		
		// 2016. 04. 21 최현식
		// 상품 조회시에만 표출되도록 처리
		btn_updateCardCms.visible = false;// CMS/카드 수정
		btn_cnctRgsn.visible = false;     // 해약등록
		btn_cnctRgsn.text = "해약등록";   // 해약등록
		btn_evnt_ip.visible = false;      // 행사등록
		btn_certf.visible = false;		  // 증서
		
		btn_srchEvent.visible = false;   // 행사조회
		btn_bugaInfo.visible = false;	 // 부가서비스 등록
		btn_smartLifeReg.visible = false;// 삼성카드 등록
		btn_srchshow.visible = false;   // 공연혜택
		
		btn_amtUseshow.visible = false;		//쇼핑몰연동
		
		// 2차전송 버튼 여부 초기엔 계약문자발송을 제외한 모든 버튼은 안보이는걸로 세팅
		btn_niceSecondSend.visible = false;	//계약문자발송
		edt_b2b_emple_ci.enable = false;
		
		// 2019. 05. 22 김주용
		// 상품 조회시 만기연장 버튼활성화
		btn_mangiExt.enable = false;
	} else if (sType == "ADD" || sType == "UPDATE") {
		btn_del_prod.visible = false;
		btn_add_prod.visible = false;
		btn_update_prod.visible = false;
		
		if (sType == "ADD") {
			btn_srchProd.visible = true;
			
			btn_updateCardCms.visible = false;// CMS/카드 수정
			btn_cnctRgsn.visible = false;     // 해약등록
			btn_cnctRgsn.text = "해약등록";   // 해약등록
			btn_evnt_ip.visible = false;      // 행사등록
			btn_certf.visible = false;		  // 증서
			btn_bugaInfo.visible = false;	  // 부가서비스 등록
			btn_smartLifeReg.visible = false; // 삼성카드 등록
			btn_srchEvent.visible = false;    // 행사조회
			btn_srchshow.visible = false;    // 공연혜택
			btn_srchEmple.visible = true;    // 담당사원
			btn_befEmple.visible = true;     // 모집사원	
					
			btn_amtUseshow.visible = false;		//쇼핑몰연동
			edt_b2b_emple_ci.enable = true;
			
			// 2019. 05. 22 김주용
			// 상품 조회시 만기연장 버튼활성화
			btn_mangiExt.enable = false;
			
			//상품 추가시 NICE 버튼은 모두 안보이도록 세팅
			//btn_niceSecondSend.visible = false;	//계약문자발송	
		} else {
			btn_srchProd.visible = false;
			
			btn_updateCardCms.visible = true; // CMS/카드 수정
			btn_cnctRgsn.visible = true;      // 해약등록
			btn_evnt_ip.visible = true ;      // 행사등록
			btn_certf.visible = true;		  // 증서
			btn_bugaInfo.visible = true;	  // 부가서비스 등록
			btn_smartLifeReg.visible = true;  // 삼성카드 등록
			btn_srchEvent.visible = true;     // 행사조회
			btn_srchshow.visible = true;
			
			btn_amtUseshow.visible = true;		//쇼핑몰연동
			edt_b2b_emple_ci.enable = true;
			btn_main_contract.enable = true;     //주계약
			
			// 2019. 05. 22 김주용
			// 상품 조회시 만기연장 버튼활성화
			btn_mangiExt.enable = true;
			//상품 변경시 NICE 버튼은 모두 안보이도록 세팅
			//btn_niceSecondSend.visible = false;	//계약문자발송	
				/*
				var fv_emple_no = gfn_getUserInfo("user_id");
				trace(fv_emple_no);
				if ( fv_emple_no == '2012040344' || fv_emple_no == '2016020003' ) {
				  // alert("로그인 아이디 : " + fv_emple_no);
					btn_srchshow.enable = true;     // 공연혜택
					}*/
			//btn_srchshow.visible = true;     // 공연혜택
		}
		
		btn_save_prod.position2 = "absolute r:79 w:72 t:3 h:20";
		btn_cancel_prod.position2 = "absolute r:4 w:72 t:3 h:20";
		btn_save_prod.visible = true;
		btn_cancel_prod.visible = true;
		//btn_appfmNo.visible = true;      // 신청서
		btn_srchB2bComp.visible = true;  // B2B회사
	} else if (sType == "SEARCH") {
		btn_save_prod.visible = false;
		btn_cancel_prod.visible = false;
		btn_srchProd.visible = false;
		
		if (delBtnFlag) { // 상품 삭제 권한 있을 경우
			btn_del_prod.posit2 = "absolute r:4 w:72 t:3 h:20";
			btn_del_prod.visible = true;
			
			btn_amtUseshow.position2 = "absolute r:230 w:72 t:3 h:20"
			
			//조회시 버튼 위치 잡기
			btn_niceSecondSend.position2 = "absolute r:230 w:78 t:3 h:20";
			
			btn_concCmpl.position2 = "absolute l:429 w:60 t:3 h:20";
			edt_rec_dual_hr.position2 = "absolute l:366 w:60 t:3 h:20";
			
			btn_add_prod.position2 = "absolute r:154 w:72 t:3 h:20";
			btn_update_prod.position2 = "absolute r:79 w:72 t:3 h:20";
			btn_add_prod.visible = true;
			btn_update_prod.visible = true;
		} else {
			btn_del_prod.visible = false;
			
			btn_amtUseshow.position2 = "absolute r:154 w:72 t:3 h:20"
			
			//조회시 버튼 위치 잡기
			btn_niceSecondSend.position2 = "absolute r:230 w:78 t:3 h:20";
			
			btn_concCmpl.position2 = "absolute l:429 w:60 t:3 h:20";
			edt_rec_dual_hr.position2 = "absolute l:366 w:60 t:3 h:20";
			
			btn_add_prod.position2 = "absolute r:79 w:72 t:3 h:20";
			btn_update_prod.position2 = "absolute r:4 w:72 t:3px h:20";
			btn_add_prod.visible = true;
			btn_update_prod.visible = true;
		}
		
		btn_appfmNo.visible = false;      // 신청서
		btn_srchEmple.visible = true;    // 담당사원
		btn_befEmple.visible = true;     // 모집사원
		btn_srchB2bComp.visible = false;  // B2B회사
		
		btn_updateCardCms.visible = true; // CMS/카드 수정
		btn_cnctRgsn.visible = true;      // 해약등록
		btn_cnctRgsn.text = "해약등록";   // 해약등록
		btn_evnt_ip.visible = true ;      // 행사등록
		btn_certf.visible = true;		  // 증서
		btn_bugaInfo.visible = true;	  // 부가서비스 등록
		btn_smartLifeReg.visible = true;  // 삼성카드 등록
		
		btn_srchEvent.visible = true;
		btn_srchshow.visible = true;
		
		btn_amtUseshow.visible = true;		//쇼핑몰연동
		
		
		/*
			var fv_emple_no = gfn_getUserInfo("user_id");
					trace(fv_emple_no);
					if ( fv_emple_no == '2012040344' || fv_emple_no == '2016020003' ) {
					  // alert("로그인 아이디 : " + fv_emple_no);
					   	btn_srchshow.enable = true;     // 공연혜택
					}
		*/
		
		//btn_srchshow.visible = true;     // 공연혜택
		if (!gfn_isNull(ds_list_prod.getColumn(ds_list_prod.rowposition, "event_seq"))) {
			btn_srchEvent.enable = true;  // 행사조회
		} else {
			btn_srchEvent.enable = false; // 행사조회
		}
		
		edt_b2b_emple_ci.enable = false;
		btn_main_contract.enable = false; // 주계약
		
		// 2019. 05. 22 김주용
		// 상품 조회시 만기연장 버튼활성화
		btn_mangiExt.enable = true;
	}
	
	// 상품내용 활성화
	//if (sType == "ADD" || sType == "UPDATE") {
	if (sType == "ADD") {
	    edt_prod_cd.readonly = false;
		edt_prod_cd.class = "";
		edt_prod_nm.readonly = false;
		edt_prod_nm.class = "";
	} else {
	    edt_prod_cd.readonly = true;
		edt_prod_cd.class = "edt_clssEnable";
		edt_prod_nm.readonly = true;
		edt_prod_nm.class = "edt_clssEnable";
	}
	
	// 2018.03.20  TM40 추가
	if (gv_athrCd == "TM40")
	{
		btn_updateCardCms.enable = false;
		btn_cnctRgsn.enable = false;
		btn_evnt_ip.enable = false;
		
		btn_amtUseshow.enable = false;
		btn_add_prod.enable = false;
		btn_update_prod.enable = false;
		btn_del_prod.enable = false;
		btn_save_prod.enable = false;
		btn_cancel_prod.enable = false;
		btn_bugaInfo.enable = false;
		btn_smartLifeReg.enable = false;
		btn_srchEvent.enable = false;
		btn_srchshow.enable = false;
		btn_srchEmple.enable = false;
		btn_befEmple.enable = false;
		btn_srchB2bComp.enable = false;
		btn_srchSmShop.enable = false;
		btn_srchPhoneTyp.enable = false;
		btn_shinhan.enable = false;
		btn_memberAddr.enable = false;
		btn_samsung.enable = false;
		btn_certf.enable = false;
	}
	
	
}

// 콤보 값이 없을 경우 enable 처리
function fn_setEnableCombo()
{	
	// 모델분류
	if (ds_cbo_modlTyp.rowcount == 0) 
	{ 
		cbo_prod_model_kind.enable = false;
	}
	else 
	{
		cbo_prod_model_kind.enable = true;
	}
	
	// 모델명
	if (ds_cbo_modlNm.rowcount == 0) 
	{
		cbo_prod_model_cd.enable = false;
	}
	else 
	{
		cbo_prod_model_cd.enable = true;
	}
	
	// 상품 종류
	if (ds_cbo_prdtKind.rowcount == 0) 
	{
		cbo_prod_kind.enable = false;
	}
	else 
	{
		cbo_prod_kind.enable = true;
	}

	/*
	var strgtId = ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_id");
	var sTrgtIdResend = ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_id_resend");
	var sTrgtIdBailor = ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_id_bailor");
	var simgFileNm = ds_list_prod.getColumn(ds_list_prod.rowposition, "img_file_nm");
	var sTrgtFinishResend = ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_finish_resend");
	var sUppTxType = ds_list_prod.getColumn(ds_list_prod.rowposition, "upp_tx_type");
	var sFinishFlag = ds_list_prod.getColumn(ds_list_prod.rowposition, "finish_flag");
	var sHpclStatCd = ds_list_prod.getColumn(ds_list_prod.rowposition, "hpcl_stat_cd");
	var oHpclStatCd = cbo_hpcl_stat_cd.value;
	
	if(gfn_IsNull(strgtId) == true)
	{
		strgtId = "";
	}
	
	if(gfn_IsNull(sTrgtIdResend) == true)
	{
		sTrgtIdResend = "";
	}
	
	if(gfn_IsNull(sTrgtIdBailor) == true)
	{
		sTrgtIdBailor = "";
	}
	
	if(gfn_IsNull(simgFileNm) == true)
	{
		simgFileNm = "";
	}
	
	if(gfn_IsNull(sTrgtFinishResend) == true)
	{
		sTrgtFinishResend = "";
	}
	
	if(strgtId.length == 18 && gfn_IsNull(sUppTxType) == true)
	{
		cbo_prod_model_kind.enable = true;
		cbo_prod_model_cd.enable = true;
		cbo_prod_kind.enable = true;
	}
	else if(sTrgtIdResend.length == 18 && sUppTxType == "04")
	{
		cbo_prod_model_kind.enable = false;
		cbo_prod_model_cd.enable = false;
		cbo_prod_kind.enable = false;
	}
	else if(sTrgtIdBailor.length == 18 && sUppTxType == "05")
	{
		cbo_prod_model_kind.enable = false;
		cbo_prod_model_cd.enable = false;
		cbo_prod_kind.enable = false;
	}
	else if(simgFileNm.length >= 18 && sUppTxType == "06" && sHpclStatCd == "21")
	{
		cbo_prod_model_kind.enable = true;
		cbo_prod_model_cd.enable = true;
		cbo_prod_kind.enable = true;
		
		if(oHpclStatCd != "21")
		{
			cbo_prod_model_kind.enable = false;
			cbo_prod_model_cd.enable = false;
			cbo_prod_kind.enable = false;
		}
	}
	else if(simgFileNm.length >= 18 && sUppTxType == "06" && sHpclStatCd != "21")
	{
		cbo_prod_model_kind.enable = false;
		cbo_prod_model_cd.enable = false;
		cbo_prod_kind.enable = false;
		
		if(oHpclStatCd == "21")
		{
			cbo_prod_model_kind.enable = true;
			cbo_prod_model_cd.enable = true;
			cbo_prod_kind.enable = true;
		}
	}
	else if(sTrgtFinishResend.length >= 18 && sUppTxType == "03")
	{
		cbo_prod_model_kind.enable = true;
		cbo_prod_model_cd.enable = true;
		cbo_prod_kind.enable = true;
	}
	else
	{
		cbo_prod_model_kind.enable = true;
		cbo_prod_model_cd.enable = true;
		cbo_prod_kind.enable = true;
	}
	
	if(gv_jobsel == "1")
	{
		cbo_prod_model_kind.enable = true;
		cbo_prod_model_cd.enable = true;
		cbo_prod_kind.enable = true;
	}
	*/
}


 function fn_SetNiceBtn()
{			
	// 2018.02.19 전자서명 2차 발송 관련 버튼 유무
	
	var sJoinCl     = ds_list_prod.getColumn(ds_list_prod.rowposition, "join_cl");
	var sHpclStatCd = ds_list_prod.getColumn(ds_list_prod.rowposition, "hpcl_stat_cd");
	var sAuthCode1 = gv_Auth01;
	var sAuthCode2 = gv_Auth02;
	
	/*
	trace("sAuthCode1  :" + gv_Auth01);
	trace("sAuthCode2  :" + gv_Auth02);
	trace("sHpclStatCd :" + sHpclStatCd);
	trace("sJoinCl     :" + sJoinCl);
	*/
	
	if (sJoinCl == "06") // 가입구분이 전자서명인지 아닌지를 먼저 체크함. 20181010
	{
		if(gfn_IsNull(sAuthCode1) == true)
		{
			sAuthCode1 = "";
		}

		if(gfn_IsNull(sAuthCode2) == true)
		{
			sAuthCode2 = "";
		}

		if(gfn_IsNull(sHpclStatCd) == true)
		{
			sHpclStatCd = "";
		}
	
		// 전자서명 인증 이력이 없으면 버튼 삭제
		if (sAuthCode1 == "")
		{
			btn_niceSecondSend.visible = false;
		}
		// 전자서명 인증값이 진행중일때 버튼을 띄우고 계약서 전송 막음
		if (sAuthCode1 == "01" || sAuthCode1 == "02")
		{
			btn_niceSecondSend.text = "계약문자발송";
			btn_niceSecondSend.visible = true;
			btn_niceSecondSend.enable = false;			
		}
	
		// 전자서명 인증값이 완료이고 계약서가 신규일때 계약서 전송 허락 
		if (sAuthCode1 == "03" && sAuthCode2 == "신규")
		{
			btn_niceSecondSend.text = "계약문자발송";
			btn_niceSecondSend.visible = true;
			btn_niceSecondSend.enable = true;			
		}
	
		// 계약서가 진행중일때 버튼을 재전송 변경(인증이 나이스키로 연동 된다)
		if (sAuthCode2 == "04" || sAuthCode2 == "05"){
			btn_niceSecondSend.text = "재전송";
			btn_niceSecondSend.visible = true;
			btn_niceSecondSend.enable = true;			
		}
	
		if (sAuthCode2 == "06"){
			btn_niceSecondSend.text = "증서열람";
			btn_niceSecondSend.visible = true;
			btn_niceSecondSend.enable = true;			
		}
	
		if (sAuthCode2 == "06" && sHpclStatCd == "21")
		{
			btn_niceSecondSend.text = "계약재전송";
			btn_niceSecondSend.visible = true;
			btn_niceSecondSend.enable = true;			
		}	
	}
	else
	{
		btn_niceSecondSend.visible = false;
	}
}		

// 상품 조회 결과
function fn_postSearch()
{	
 	if (ds_list_prod.rowcount <= 1) {
		//mae_inspl_zip.mask = "";
 		mae_edt_reg_dm.mask = "";
 		mae_ocb_crt_dt.mask = "";
 		
 		fn_setBtnConr("NULL"); // 버튼 초기화 설정
 	}
 	
 	 fn_setProdAccntNo(); // accnt_no로 그리드 선택후 상품 상세정보 설정
 		
 		//alert("등록된 상품정보가 없습니다.");
		//trace("ds_list_prod.rowposition :" + grd_list_prod.ro);
		//trace("ds_list_prod.rowcount :" + ds_list_prod.rowcount);
		//trace("ds_list_prod.getColumn :" + ds_list_prod.getColumn(1,"nice_no"));
 		
		
		/*
		if (sAuthCode1 == "06"){
			btn_niceSecondSend.visible = true;
			btn_niceSecondSend.text = "계약문자발송";
		}		
	
		if(gfn_IsNull(sAuthCode1) == true && (sAuthCode2 == "신규" || gfn_IsNull(sAuthCode2)))
		{
			btn_niceSecondSend.visible = false;
			btn_niceSecondSend.text = "계약문자발송";
			cbo_hpcl_stat_cd.enable = true;
			cbo_prod_model_kind.enable = true;
			cbo_prod_model_cd.enable = true;
			cbo_prod_kind.enable = true;
		}
		else if(sAuthCode1 == "01" && (sAuthCode2 == "신규" || gfn_IsNull(sAuthCode2)))
		{
			btn_niceSecondSend.visible = true;
			btn_niceSecondSend.text = "계약문자발송";
			cbo_hpcl_stat_cd.enable = true;
			cbo_prod_model_kind.enable = true;
			cbo_prod_model_cd.enable = true;
			cbo_prod_kind.enable = true;
		}
		else if(sAuthCode1 == "02" && (sAuthCode2 == "신규" || gfn_IsNull(sAuthCode2)))
		{
			btn_niceSecondSend.visible = true;
			btn_niceSecondSend.text = "계약문자발송";
			cbo_hpcl_stat_cd.enable = true;
			cbo_prod_model_kind.enable = true;
			cbo_prod_model_cd.enable = true;
			cbo_prod_kind.enable = true;
		}
		else if(sAuthCode1 == "03" && (sAuthCode2 == "신규" || gfn_IsNull(sAuthCode2)))
		{
			btn_niceSecondSend.visible = true;
			btn_niceSecondSend.text = "계약문자발송";
			cbo_hpcl_stat_cd.enable = true;
			cbo_prod_model_kind.enable = true;
			cbo_prod_model_cd.enable = true;
			cbo_prod_kind.enable = true;
		}
		else if(sAuthCode1 == "03" && sAuthCode2 == "04") 
		{
			btn_niceSecondSend.visible = true;
			btn_niceSecondSend.text = "문자재발송";
			cbo_hpcl_stat_cd.enable = false;
			cbo_prod_model_kind.enable = false;
			cbo_prod_model_cd.enable = false;
			cbo_prod_kind.enable = false;
		}
		else if(sAuthCode1 == "03" && sAuthCode2 == "05") 
		{
			btn_niceSecondSend.visible = true;
			btn_niceSecondSend.text = "문자재발송";
			cbo_hpcl_stat_cd.enable = false;
			cbo_prod_model_kind.enable = false;
			cbo_prod_model_cd.enable = false;
			cbo_prod_kind.enable = false;
		}
		else if(sAuthCode1 == "03" && sAuthCode2 == "06") 
		{
			btn_niceSecondSend.visible = true;
			btn_niceSecondSend.text = "전자서명증서";
				
			if(sHpclStatCd == "21")
			{
				cbo_prod_model_kind.enable = true;
				cbo_prod_model_cd.enable = true;
				cbo_prod_kind.enable = true;
			}
			else
			{
				cbo_prod_model_kind.enable = false;
				cbo_prod_model_cd.enable = false;
				cbo_prod_kind.enable = false;
			}
		
			if(Combo_kstbit.value == "02")
			{
				cbo_hpcl_stat_cd.enable = false;
			}
			else
			{
				cbo_hpcl_stat_cd.enable = true;
			}
		}
		else
		{
			btn_niceSecondSend.visible = true;
			cbo_hpcl_stat_cd.enable = true;
			cbo_prod_model_kind.enable = true;
			cbo_prod_model_cd.enable = true;
			cbo_prod_kind.enable = true;
		}
		*/
		/*
		var strgtId = ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_id");
		var sTrgtIdResend = ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_id_resend");
		var sTrgtIdBailor = ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_id_bailor");
		var simgFileNm = ds_list_prod.getColumn(ds_list_prod.rowposition, "img_file_nm");
		var sTrgtFinishResend = ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_finish_resend");
		var sUppTxType = ds_list_prod.getColumn(ds_list_prod.rowposition, "upp_tx_type");
		var sFinishFlag = ds_list_prod.getColumn(ds_list_prod.rowposition, "finish_flag");
		var sHpclStatCd = ds_list_prod.getColumn(ds_list_prod.rowposition, "hpcl_stat_cd");
		var oHpclStatCd = cbo_hpcl_stat_cd.value;
		
		if(gfn_IsNull(strgtId) == true)
		{
			strgtId = "";
		}
	
		if(gfn_IsNull(sTrgtIdResend) == true)
		{
			sTrgtIdResend = "";
		}
	
		if(gfn_IsNull(sTrgtIdBailor) == true)
		{
			sTrgtIdBailor = "";
		}
	
		if(gfn_IsNull(simgFileNm) == true)
		{
			simgFileNm = "";
		}
		
		if(gfn_IsNull(sTrgtFinishResend) == true)
		{
			sTrgtFinishResend = "";
		}
	
		if(strgtId.length == 18 && gfn_IsNull(sUppTxType) == true)
		{
			cbo_prod_model_kind.enable = true;
			cbo_prod_model_cd.enable = true;
			cbo_prod_kind.enable = true;
		}
		else if(sTrgtIdResend.length == 18 && sUppTxType == "04")
		{
			cbo_prod_model_kind.enable = false;
			cbo_prod_model_cd.enable = false;
			cbo_prod_kind.enable = false;
		}
		else if(sTrgtIdBailor.length == 18 && sUppTxType == "05")
		{
			cbo_prod_model_kind.enable = false;
			cbo_prod_model_cd.enable = false;
			cbo_prod_kind.enable = false;
		}
		else if(simgFileNm.length >= 18 && sUppTxType == "06" && sHpclStatCd == "21")
		{
			cbo_prod_model_kind.enable = true;
			cbo_prod_model_cd.enable = true;
			cbo_prod_kind.enable = true;
			
			if(oHpclStatCd != "21")
			{
				cbo_prod_model_kind.enable = false;
				cbo_prod_model_cd.enable = false;
				cbo_prod_kind.enable = false;
			}
		}
		else if(simgFileNm.length >= 18 && sUppTxType == "06" && sHpclStatCd != "21")
		{
			cbo_prod_model_kind.enable = false;
			cbo_prod_model_cd.enable = false;
			cbo_prod_kind.enable = false;
			
			if(oHpclStatCd == "21")
			{
				cbo_prod_model_kind.enable = true;
				cbo_prod_model_cd.enable = true;
				cbo_prod_kind.enable = true;
			}
		}
		else if(sTrgtFinishResend.length >= 18 && sUppTxType == "03")
		{
			cbo_prod_model_kind.enable = true;
			cbo_prod_model_cd.enable = true;
			cbo_prod_kind.enable = true;
		}
		else
		{
			cbo_prod_model_kind.enable = true;
			cbo_prod_model_cd.enable = true;
			cbo_prod_kind.enable = true;
		}
		*/

	
}

// 상품 상세정보 설정
function fn_setProdDtl()
{
	//niceSendingFlag = "N";
	ds_prod.clearData();
	ds_prod.addRow();
	ds_prod.copyRow(0, ds_list_prod, ds_list_prod.rowposition);
	
	ds_chbfProd.clearData();
	ds_chbfProd.addRow();
	ds_chbfProd.copyRow(0, ds_list_prod, ds_list_prod.rowposition); // 상품정보 변경전 데이터셋 저장
	
	//gfn_SetHomeZipMask(mae_inspl_zip);
	gfn_phoneNumObj(edt_inspl_phone);
	
	fn_chngResort();          // 리조트 회원 설정
	fn_setModelCombo("VIEW"); // 모델 설정	
	
	//20180605 LDJ 하드코딩
	//fn_setSmShopInfo(ds_prod.getColumn(0, "smcl"), true); // 삼성매정 표출 여부
	// 2019.02.18 FV,FW,FX,FY 상품코드도 삼성카드 등록버튼 활성화
	var sProdCd = edt_prod_cd.value;
	if(sProdCd == "S7" || sProdCd == "S8" || sProdCd == "S9" || sProdCd == "T0" || sProdCd == "X5" || 
	   sProdCd == "X6" || sProdCd == "EC" || sProdCd == "ED" || sProdCd == "EE" || sProdCd == "EF" || 
	   sProdCd == "EG" || sProdCd == "EH" || sProdCd == "FV" || sProdCd == "FW" || sProdCd == "FX" || sProdCd == "FY" ||
	   sProdCd == "HA" || sProdCd == "HB" || sProdCd == "HC" || sProdCd == "HD"
	   ) {		
		fn_setSmShopInfo("Y", true); // 삼성매정 표출 여부
	} else {		
		fn_setSmShopInfo("N", true); // 삼성매정 표출 여부
	}
	
	//fn_chngPayMthd();         // 카드번호, 계좌번호 설정
	
	cal_join_dt.enable = false;
	
	if (gv_regFg == "Y") {
		fn_newProdAccntPayPopup();
	}
	gv_regFg = "N";
	
	// 상품가격 표시
	edt_prod_amt.value = gfn_setComma(ds_prod.getColumn(0, "prod_amt"));
	
	// 2016. 07. 15 부가서비스 버튼 항시 표출
	//fn_bugaSrvcMemChk(); // 부가서비스 등록 버튼 표출 여부 체크
	btn_bugaInfo.visible = true;
	btn_bugaInfo.enable = true;
	
	if (ds_prod.getColumn(0, "accnt_no") == "00000") { // 기타문의일 경우 회원번호 미표출
		edt_accnt_no.visible = false;
		
		edt_resn_amt.value = "";
		mae_edt_reg_dm.mask = "";
		mae_ocb_crt_dt.mask = "";
		
		ds_list_prodSrvc.clearData();
		
		// 전역변수 초기화
		gv_emple_no = "";
		gv_bef_emple_cd = "";
		gv_b2b_comp_cd = "";
		
		fn_setBtnConr("NULL");
		
		parent.div_buga.fn_init();     // 납입정보 부가서비스 초기화
		parent.div_buga.fn_initOdrg(); // 발주정보 초기화
		parent.div_cms_hstr.fn_init(); // 해약정보/납입이력/결제정보/청구내역 초기화
	} else {
		edt_accnt_no.visible = true;
		mae_edt_reg_dm.mask = "####-##-##";
		mae_ocb_crt_dt.mask = "####-##-##";
		
		gv_emple_no = ds_prod.getColumn(0, "emple_no");
		gv_bef_emple_cd = ds_prod.getColumn(0, "bef_emple_cd");
		gv_b2b_comp_cd = ds_prod.getColumn(0, "b2b_comp_cd");
		
		/*if (ds_prod.getColumn(0, "cms_yn") == "Y") {	// CMS정보수정 버튼 표출
			btn_updateCardCms.text = "CMS정보 수정";
		}
		if (ds_prod.getColumn(0, "pay_mthd") == "06") {	// 카드정보수정 버튼 표출
			btn_updateCardCms.text = "카드정보 수정";
		}*/
		
		fn_setBtnConr("SEARCH");
		
		fn_srchProdSrvc(); // 부가서비스 리스트 조회
		fn_srchBugaInfo(); // 부가 정보 조회
		
		var sType = "";
		if (ds_prod.getColumn(0, "pay_mthd") == "06") sType = "card";
		else sType = "cms";
		
		parent.div_buga.fn_srchBugaSrvcMemInfo(sType, ds_prod.getColumn(0, "accnt_no")); // CMS/카드 회원관리 개별목록 조회
		parent.div_buga.fn_srchOdrgInfo(ds_prod.getColumn(0, "accnt_no"));				 // 발주정보 조회
		parent.div_cms_hstr.fn_srchCmsHstr(); 											 // 해약정보 조회
		
		//fn_getWdrwReqAccntConfirm(); //청구고객
	    // 회원조회시 산출 또는 청구중인지 체크
	    fn_getWdrwReqAccntConfirm2();
	    fn_getMemberMangiExtConfirmList();
	}
	
	// 보기모드 상품 정보 변경 제한 처리
	// 보기모드에서 클릭 가능한 증서(btn_certf) 버튼은 맨 앞으로 가져와야 함!
	div_prod_disable.visible = true;
	
	// 보기모드 부가서비스 정보 변경 제한 처리
	div_prod_srvc_disable.visible = true;
	
	
	//fn_niceSendMemberStatus();
	
	
	// 2018.02.19 전자서명 2차 발송 관련 버튼 유무
	/*
	var sAuthCode1 = ds_acuonLatelyAuth.getColumn(0, "auth_01");
	var sAuthCode2 = ds_acuonLatelyAuth.getColumn(0, "auth_02");
	var sHpclStatCd = ds_list_prod.getColumn(ds_list_prod.rowposition, "hpcl_stat_cd");
	
	if(gfn_IsNull(sAuthCode1) == true)
	{
		sAuthCode1 = "";
	}
	
	if(gfn_IsNull(sAuthCode2) == true)
	{
		sAuthCode2 = "";
	}
	
	if(gfn_IsNull(sHpclStatCd) == true)
	{
		sHpclStatCd = "";
	}
	
	if(gfn_IsNull(sAuthCode1) == true && (sAuthCode2 == "신규" || gfn_IsNull(sAuthCode2)))
	{
		btn_niceSecondSend.visible = false;
		btn_niceSecondSend.text = "계약문자발송";
		cbo_hpcl_stat_cd.enable = true;
		cbo_prod_model_kind.enable = true;
		cbo_prod_model_cd.enable = true;
		cbo_prod_kind.enable = true;
	}
	else if(sAuthCode1 == "01" && (sAuthCode2 == "신규" || gfn_IsNull(sAuthCode2)))
	{
		btn_niceSecondSend.visible = true;
		btn_niceSecondSend.text = "계약문자발송";
		cbo_hpcl_stat_cd.enable = true;
		cbo_prod_model_kind.enable = true;
		cbo_prod_model_cd.enable = true;
		cbo_prod_kind.enable = true;
	}
	else if(sAuthCode1 == "02" && (sAuthCode2 == "신규" || gfn_IsNull(sAuthCode2)))
	{
		btn_niceSecondSend.visible = true;
		btn_niceSecondSend.text = "계약문자발송";
		cbo_hpcl_stat_cd.enable = true;
		cbo_prod_model_kind.enable = true;
		cbo_prod_model_cd.enable = true;
		cbo_prod_kind.enable = true;
	}
	else if(sAuthCode1 == "03" && (sAuthCode2 == "신규" || gfn_IsNull(sAuthCode2)))
	{
		btn_niceSecondSend.visible = true;
		btn_niceSecondSend.text = "계약문자발송";
		cbo_hpcl_stat_cd.enable = true;
		cbo_prod_model_kind.enable = true;
		cbo_prod_model_cd.enable = true;
		cbo_prod_kind.enable = true;
	}
	else if(sAuthCode1 == "03" && sAuthCode2 == "04") 
	{
		btn_niceSecondSend.visible = true;
		cbo_hpcl_stat_cd.enable = false;
		btn_niceSecondSend.text = "문자재발송";
		cbo_prod_model_kind.enable = false;
		cbo_prod_model_cd.enable = false;
		cbo_prod_kind.enable = false;
	}
	else if(sAuthCode1 == "03" && sAuthCode2 == "05") 
	{
		btn_niceSecondSend.visible = true;
		cbo_hpcl_stat_cd.enable = false;
		btn_niceSecondSend.text = "문자재발송";
		cbo_prod_model_kind.enable = false;
		cbo_prod_model_cd.enable = false;
		cbo_prod_kind.enable = false;
	}
	else if(sAuthCode1 == "03" && sAuthCode2 == "06") 
	{
		btn_niceSecondSend.visible = true;
		btn_niceSecondSend.text = "전자서명증서";
				
		if(sHpclStatCd == "21")
		{
			cbo_prod_model_kind.enable = true;
			cbo_prod_model_cd.enable = true;
			cbo_prod_kind.enable = true;
		}
		else
		{
			cbo_prod_model_kind.enable = false;
			cbo_prod_model_cd.enable = false;
			cbo_prod_kind.enable = false;
		}
		
		if(Combo_kstbit.value == "02")
		{
			cbo_hpcl_stat_cd.enable = false;
		}
		else
		{
			cbo_hpcl_stat_cd.enable = true;
		}
	}
	else
	{
		btn_niceSecondSend.visible = true;
		cbo_hpcl_stat_cd.enable = true;
		cbo_prod_model_kind.enable = true;
		cbo_prod_model_cd.enable = true;
		cbo_prod_kind.enable = true;
	}
	*/
	
	/*
	var strgtId = ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_id");
	var sTrgtIdResend = ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_id_resend");
	var sTrgtIdBailor = ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_id_bailor");
	var simgFileNm = ds_list_prod.getColumn(ds_list_prod.rowposition, "img_file_nm");
	var sTrgtFinishResend = ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_finish_resend");
	var sUppTxType = ds_list_prod.getColumn(ds_list_prod.rowposition, "upp_tx_type");
	var sFinishFlag = ds_list_prod.getColumn(ds_list_prod.rowposition, "finish_flag");
	var sHpclStatCd = ds_list_prod.getColumn(ds_list_prod.rowposition, "hpcl_stat_cd");

	if(strgtId.length == 18 && gfn_IsNull(sUppTxType) == true)
	{
		btn_niceSecondSend.visible = true;
		btn_niceCertf.visible = false;
		btn_niceSecondResend.visible = false;
		//cbo_hpcl_stat_cd.enable = false;
		btn_NiceSend2Cancel.visible = false;
		btn_niceCertfResend.visible = false;
		cbo_prod_model_kind.enable = true;
		cbo_prod_model_cd.enable = true;
		cbo_prod_kind.enable = true;
	}
	else if(sTrgtIdResend.length == 18 && sUppTxType == "04" && sFinishFlag != "FR")
	{
		trace("04" + " : " + "취소가능");
		btn_niceSecondSend.visible = false;
		btn_niceCertf.visible = false;
		btn_niceSecondResend.visible = true;
		cbo_hpcl_stat_cd.enable = false;
		btn_NiceSend2Cancel.visible = true;
		btn_niceCertfResend.visible = false;
		cbo_prod_model_kind.enable = false;
		cbo_prod_model_cd.enable = false;
		cbo_prod_kind.enable = false;
		
	}
	else if(sTrgtIdResend.length == 18 && sUppTxType == "04" && sFinishFlag == "FR")
	{
		trace("04" + " : " + "취소불가능");
		btn_niceSecondSend.visible = false;
		btn_niceCertf.visible = false;
		btn_niceSecondResend.visible = true;
		cbo_hpcl_stat_cd.enable = false;
		btn_NiceSend2Cancel.visible = false;
		btn_niceCertfResend.visible = false;
		cbo_prod_model_kind.enable = false;
		cbo_prod_model_cd.enable = false;
		cbo_prod_kind.enable = false;
	}
	else if(sTrgtIdBailor.length == 18 && sUppTxType == "05" && sFinishFlag != "FR")
	{
		trace("05" + " : " + "취소가능");
		btn_niceSecondSend.visible = false;
		btn_niceCertf.visible = false;
		btn_niceSecondResend.visible = true;
		cbo_hpcl_stat_cd.enable = false;
		btn_NiceSend2Cancel.visible = true;
		btn_niceCertfResend.visible = false;
		cbo_prod_model_kind.enable = false;
		cbo_prod_model_cd.enable = false;
		cbo_prod_kind.enable = false;
	}
	else if(sTrgtIdBailor.length == 18 && sUppTxType == "05" && sFinishFlag == "FR")
	{
		trace("05" + " : " + "취소불가능");
		btn_niceSecondSend.visible = false;
		btn_niceCertf.visible = false;
		btn_niceSecondResend.visible = true;
		cbo_hpcl_stat_cd.enable = false;
		btn_NiceSend2Cancel.visible = false;
		btn_niceCertfResend.visible = false;
		cbo_prod_model_kind.enable = false;
		cbo_prod_model_cd.enable = false;
		cbo_prod_kind.enable = false;
	}
	else if(simgFileNm.length >= 18 && sUppTxType == "06")
	{
		btn_niceSecondSend.visible = false;
		btn_niceCertf.visible = true;
		btn_niceSecondResend.visible = false;
		btn_NiceSend2Cancel.visible = false;
		
		if(sHpclStatCd == "21")
		{
			btn_niceCertfResend.position2 = "absolute r:310 w:78 t:3 h:20";
			btn_niceCertfResend.visible = true;
			cbo_prod_model_kind.enable = true;
			cbo_prod_model_cd.enable = true;
			cbo_prod_kind.enable = true;
		}
		else
		{
			btn_niceCertfResend.position2 = "absolute r:310 w:78 t:3 h:20";
			btn_niceCertfResend.visible = false;
			cbo_prod_model_kind.enable = false;
			cbo_prod_model_cd.enable = false;
			cbo_prod_kind.enable = false;
		}
		
		if(Combo_kstbit.value == "02")
		{
			cbo_hpcl_stat_cd.enable = false;
		}
		else
		{
			cbo_hpcl_stat_cd.enable = true;
		}
		
		//alert("전송안보임, 증서보임");
	}
	else if(sTrgtFinishResend.length >= 18 && sUppTxType == "03")
	{
		btn_niceSecondSend.visible = false;
		btn_niceCertf.visible = false;
		btn_niceSecondResend.visible = false;
		cbo_hpcl_stat_cd.enable = true;
		btn_NiceSend2Cancel.visible = false;
		btn_niceCertfResend.position2 = "absolute r:310 w:78 t:3 h:20";
		btn_niceCertfResend.visible = true;
		cbo_prod_model_kind.enable = true;
		cbo_prod_model_cd.enable = true;
		cbo_prod_kind.enable = true;
		//alert("전송안보임, 증서보임");
	}
	else
	{
		btn_niceSecondSend.visible = false;
		btn_niceCertf.visible = false;
		btn_niceSecondResend.visible = false;
		cbo_hpcl_stat_cd.enable = true;
		btn_NiceSend2Cancel.visible = false;
		btn_niceCertfResend.visible = false;
		cbo_prod_model_kind.enable = true;
		cbo_prod_model_cd.enable = true;
		cbo_prod_kind.enable = true;
	}
	*/
		
	// 2018.05.28 EC,ED,EE,EF,EG,EH 상품코드 일 경우는 파란색 볼드 처리...	
	var sProdCd = edt_prod_cd.value ;
	if(sProdCd == "EC" || sProdCd == "ED"||sProdCd == "EE"|| sProdCd == "EF" || sProdCd == "EG" || sProdCd == "EH")
	{
		edt_prod_cd.style.color = "blue";
		edt_prod_cd.style.font = "Dotum,9,bold";
		edt_prod_nm.style.color = "blue";
		edt_prod_nm.style.font = "Dotum,9,bold";
		edt_prod_model_kind.style.color = "blue";
		edt_prod_model_kind.style.font = "Dotum,9,bold";
	}
	// 2019.02.19 FV,FW,FX,FY 상품코드 일 경우는 초록색 볼드 처리...	
	else if(sProdCd == "FV" || sProdCd == "FW" || sProdCd == "FX" || sProdCd == "FY")
	{
		edt_prod_cd.style.color = "green";
		edt_prod_cd.style.font = "Dotum,9,bold";
		edt_prod_nm.style.color = "green";
		edt_prod_nm.style.font = "Dotum,9,bold";
		edt_prod_model_kind.style.color = "green";
		edt_prod_model_kind.style.font = "Dotum,9,bold";
	}
	// 2019.02.19 FV,FW,FX,FY 상품코드 일 경우는 초록색 볼드 처리...	
	else if(sProdCd == "HA" || sProdCd == "HB" || sProdCd == "HC" || sProdCd == "HD")
	{
		edt_prod_cd.style.color = "maroon";
		edt_prod_cd.style.font = "Dotum,9,bold";
		edt_prod_nm.style.color = "maroon";
		edt_prod_nm.style.font = "Dotum,9,bold";
		edt_prod_model_kind.style.color = "maroon";
		edt_prod_model_kind.style.font = "Dotum,9,bold";
	}	
	else
	{
		edt_prod_cd.style.color = "red";
		edt_prod_cd.style.font = "Dotum,9";
		edt_prod_nm.style.color = "red";
		edt_prod_nm.style.font = "Dotum,9";
		edt_prod_model_kind.style.color = "red";
		edt_prod_model_kind.style.font = "Dotum,9";
	}		
	

}
   
function fn_niceSendMemberStatus()
{
	ds_niceReSend2.clearData();
	var nRow = ds_niceReSend2.addRow();
		
	//ds_niceReSend2.setColumn(nRow, "ci_val", parent.div_member.ci_val.value);
	ds_niceReSend2.setColumn(nRow, "mem_no", ds_list_prod.getColumn(ds_list_prod.rowposition, "mem_no"));
	ds_niceReSend2.setColumn(nRow, "accnt_no", ds_list_prod.getColumn(ds_list_prod.rowposition, "accnt_no"));
		
	var szSvcid       = "getAcuonLatelyAuth";
	var szController  = "/web/nice/getAcuonLatelyAuth";
	var szInDs        = "ds_input1=ds_niceReSend2";
	var szOutDs       = "ds_acuonLatelyAuth=ds_output";
	var szParam       = "";
	var szRetCallback = "fn_callBack";

	// 트랜젝션 공통함수 호출
	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback, false);
}

// 납입 방법에 따른 변경
// 2016. 04. 15 계좌번호 카드번호 숨김 요청
// function fn_chngPayMthd()
// {
// 	if (ds_prod.getColumn(0, "pay_mthd") == "06") { // 납입방법이 카드일 경우
// 		stc_txt_payMthd.text = "카드번호";
// 	} else {
// 		stc_txt_payMthd.text = "계좌번호";
// 	}
// }

// 리조트 구분에 따른 변경
function fn_chngResort()
{
	var sPayGubun = ds_prod.getColumn(0, "pay_gubun");
	if (sPayGubun == "01" || sPayGubun == "02") {
		edt_resort_mem_no.enable = true;
		edt_resort_mem_nm.enable = true;
	} else { // 리조트 비회원일 경우
		edt_resort_mem_no.enable = false;
		edt_resort_mem_nm.enable = false;
		edt_resort_mem_no.value = "";
		edt_resort_mem_nm.value = "";
	}
}

// 모델 Edit or Combo 설정
function fn_setModelCombo(sType)
{
	if (sType == "CBO") {
		cbo_prod_model_kind.visible = true;
		edt_prod_model_kind.visible = false;
		
		cbo_prod_model_cd.value = true;
		edt_prod_model_cd.visible = false;
		
		cbo_prod_kind.value = true;
		edt_prod_kind.visible = false;
	} else {
		// 조회일 경우 모델분류 edit 표출
		cbo_prod_model_kind.visible = false;
		edt_prod_model_kind.position2 = "absolute l:28.05% w:15.7% t:78px h:22";
		edt_prod_model_kind.visible = true;
		// 조회일 경우 모델명 edit 표출
		cbo_prod_model_cd.value = false;
		edt_prod_model_cd.position2 = "absolute l:55.44% w:15.7% t:78px h:22";
		edt_prod_model_cd.visible = true;
		// 조회일 경우 상품종류 edit 표출
		cbo_prod_kind.value = false;
		edt_prod_kind.position2 = "absolute l:82.82% w:16.64% t:78 h:22";
		edt_prod_kind.visible = true;
	}
}

// 회원정보에 따른 상품정보 그리드 선택
function fn_setProdAccntNo(p_accnt_no)
{
	// 상담정보 탭 선택시 상담의 accnt_no 로 값 설정
 	if (!gfn_isNull(p_accnt_no)) {
 		gv_accnt_no = p_accnt_no;
 		p_accnt_no = null;
 	}
 	
 	if (!gfn_isNull(gv_accnt_no)) {
 		for (var i=0; i<ds_list_prod.rowcount; i++) {
  			if (gv_accnt_no == ds_list_prod.getColumn(i, "accnt_no")) {
  				ds_list_prod.selectRow(i);
  				break;
  			}
 		}
 	} else {
 		ds_list_prod.selectRow(0);
 	}
 	
 	fn_setProdDtl();
}

// 상품에 따른 부가서비스 설정
// 상품추가시 부가서비스 선택 / 상품조회 / 리조트구분에 따라 조회
function fn_setProdSrvc()
{
	var tmpAllSvcNm = "",
		tmpSvcNm = "",
		x;
	
	for (var i=0; i<ds_list_tmp_prodSrvc.rowcount; ++i) {
		tmpSvcNm = ds_list_tmp_prodSrvc.getColumn(i, "opt_svc_nm_ex");			
		if ( !gfn_isEmpty(tmpSvcNm) ) {
			tmpAllSvcNm += + ds_list_tmp_prodSrvc.getColumn(i, "opt_svc_nm_ex");
		}
	}
	
	ds_list_prodSrvc.clearData();
	
	if (gfn_isNull(ds_prod.getColumn(0, "accnt_no"))) { // 상품 등록일 경우
		
		if ( !gfn_isEmpty(tmpAllSvcNm) ) {
			gfn_appendSearchDs(ds_list_prodSrvc, ds_list_tmp_prodSrvc);
		}
		
		if (ds_list_prodSrvc.rowcount > 0) {
			var bfCnt = 0;
			var afCnt = 0;
			
			ds_prod.setColumn(0, "resort_mem_gubun", ds_list_prodSrvc.getColumn(0, "resort_mem_cl"));
			
			for (var i=0; i<ds_list_prodSrvc.rowcount; i++) {
				if (ds_list_prodSrvc.getColumn(i, "svc_event_bf_cl") == "전방") {
					bfCnt += 1;
				} else {
					afCnt += 1;
				}
			}
			
			if (bfCnt == 1 || afCnt == 1) {
				for (var i=0; i<ds_list_prodSrvc.rowcount; i++) {
					if (ds_list_prodSrvc.getColumn(i, "svc_event_bf_cl") == "전방" && bfCnt == 1) {
						ds_list_prodSrvc.setColumn(i, "_chk", 1);
					} else if (ds_list_prodSrvc.getColumn(i, "svc_event_bf_cl") == "후방" && afCnt == 1) {
						ds_list_prodSrvc.setColumn(i, "_chk", 1);
					}
				}
			}
			
			// 필수 항목이면 무조건 체크
			for (var i=0; i<ds_list_prodSrvc.rowcount; i++) {
				if (ds_list_prodSrvc.getColumn(i, "vital_service") == "Y") {
					ds_list_prodSrvc.setColumn(i, "_chk", 1);
				}
			}
		}
	} else {                                            // 상품 수정일 경우
		if (isChgPayGubun == "N") {
			cbo_pay_gubun.index = gv_oldCboPayGubunIdx; // 이전 상태로 변경
			alert("발급된 부가서비스가 있습니다.\n발급 취소 후 변경하세요");
			return false;
		}
		
		ds_list_prodSrvc.clearData();
		
		var sJoinDt = ds_prod.getColumn(0, "join_dt");
		var copyIdx = 0;
		
		if ( !gfn_isEmpty(tmpAllSvcNm) ) {
			for (var i=0; i<ds_list_tmp_prodSrvc.rowcount; i++) {
				if (ds_list_tmp_prodSrvc.getColumn(i, "start_dt") <= sJoinDt && ds_list_tmp_prodSrvc.getColumn(i, "end_dt") >= sJoinDt) {
					ds_list_prodSrvc.addRow();
					ds_list_prodSrvc.copyRow(copyIdx, ds_list_tmp_prodSrvc, i);
					++copyIdx;
				}
			}		
		}
		
		if (ds_list_prodSrvc.rowcount > 0) {
			ds_prod.setColumn(0, "resort_mem_gubun", ds_list_prodSrvc.getColumn(0, "resort_mem_cl"));
		}
		
		var sArrMemProdAccntSvc = String(ds_prod.getColumn(0, "mem_prod_accnt_svc")).split(",");
		var sPayGubun = ds_prod.getColumn(0, "pay_gubun");
		var mem_cl = "";
		var bfCnt = 0;
		var afCnt = 0;
		if (gfn_isNull(sPayGubun) || sPayGubun == "00") {
			mem_cl = "L";
		} else {
			mem_cl = "T";
		}
		
		for (var i=0; i<sArrMemProdAccntSvc.length; i++) {
			for (var j=0; j<ds_list_prodSrvc.rowcount; j++) {
				if (ds_list_prodSrvc.getColumn(j, "seq") == sArrMemProdAccntSvc[i]
				   && mem_cl == ds_list_prodSrvc.getColumn(j, "mem_cl")) {
				   
					ds_list_prodSrvc.setColumn(j, "_chk", 1);
					bfCnt += 1;
				}
				if (ds_list_prodSrvc.getColumn(j, "vital_service") == "Y") {
					ds_list_prodSrvc.setColumn(j, "_chk", 1);
				}
				if (ds_list_prodSrvc.getColumn(j, "isu_yn") == "Y") {
					for (var k=0; k<ds_list_prodSrvc.rowcount; k++) {
						if (ds_list_prodSrvc.getColumn(k, "app_no") == ds_list_prodSrvc.getColumn(j, "app_no")
						   && ds_list_prodSrvc.getColumn(j, "vital_service") != "Y") {
						   ds_list_prodSrvc.setColumn(k, "isu_yn", "Y");
						}
					}
				}
			}
		}
		
		if (bfCnt == 0) {
			for (var i=0; i<ds_list_prodSrvc.rowcount; i++) {
				if (ds_list_prodSrvc.getColumn(i, "svc_event_bf_cl") == "전방") {
					bfCnt += 1;
				} else {
					afCnt += 1;
				}
			}
			if (bfCnt == 1 || afCnt == 1)  {
				for (var i=0; i<ds_list_prodSrvc.rowcount; i++) {
					if (ds_list_prodSrvc.getColumn(i, "svc_event_bf_cl") == "전방" && bfCnt == 1) {
						ds_list_prodSrvc.setColumn(i, "_chk", 1);
					} else  if (ds_list_prodSrvc.getColumn(i, "svc_event_bf_cl") == "후방" && afCnt == 1) {
						ds_list_prodSrvc.setColumn(i, "_chk", 1);
					}
				}
			}
		}
	}
}

// 부가서비스 체크박스 선택 또는 해제시
function fn_chkProcSrvcToggle()
{
	var sExprNo = ds_prod.getColumn(0, "expr_no");
	if (sExprNo == 1 || sExprNo == 12) return;
	
	var selectedIdx = ds_list_prodSrvc.rowposition; // 선택된 로우
	if (ds_list_prodSrvc.getColumn(selectedIdx, "vital_service") != "Y") {
		var sAppNo = ds_list_prodSrvc.getColumn(selectedIdx, "app_no");
		
		for (var i=0; i<ds_list_prodSrvc.rowcount; i++) {
			if (ds_list_prodSrvc.getColumn(i, "app_no") == sAppNo 
			  && ds_list_prodSrvc.getColumn(i, "vital_service") != "Y") { // 동일한 app_no 존재시
				if (selectedIdx != i) {
					ds_list_prodSrvc.setColumn(i, "_chk", 0); // 체크해제
				}
			}
		}
	}
}

// 팝업 호출
function fn_openPopup(sType)
{
	// 신청서 등록
	if (sType == "btn_appfmNo") {
		if (edt_accnt_no.value == "00000" || gfn_isNull(edt_accnt_no.value)) {
			alert("회원번호가 없습니다.");
			return;
		}
		var sPrmr = {p_accnt_no:edt_accnt_no.value};
		var reVal = gfn_diaLog("가입신청서 이미지", -1, -1, -1, -1, "PS990000::PS993600.xfdl", true, sPrmr, true, false, true, null, null, true);
	}
	// 담당사원조회
	else if (sType == "btn_srchEmple" || sType == "edt_emple_nm") {
		var sPrmr = {p_empl_nm:edt_emple_nm.value, p_pageTyp:"PS02000104", p_typ:"emp", p_sbit:gv_sbit};
		var reVal = gfn_diaLog("담당사원 조회", -1, -1, -1, -1, "PS990000::PS992000.xfdl", false, sPrmr, true, false, true, null, null, true);
	}
	// 모집사원조회
	else if (sType == "btn_befEmple" || sType == "edt_bef_emple_nm") {
		var sPrmr = {p_empl_nm:edt_bef_emple_nm.value, p_pageTyp:"PS02000104", p_typ:"bef", p_sbit:gv_sbit};
		var reVal = gfn_diaLog("모집사원 조회", -1, -1, -1, -1, "PS990000::PS992000.xfdl", false, sPrmr, true, false, true, null, null, true);
	}
	// 상품조회 버튼
	else if (sType == "btn_srchProd") {
		var sPrmr = {p_prod_cd:"", p_prod_nm:"", p_mode:"reg"};
		var reVal = gfn_diaLog("상품조회", -1, -1, -1, -1, "PS990000::PS992200.xfdl", false, sPrmr, true, false, true, null, null, true);
	}
	// 상품조회 상품코드
	else if (sType == "edt_prod_cd" && !edt_prod_cd.readonly) {
		var sPrmr = {p_prod_cd:edt_prod_cd.value, p_prod_nm:"", p_mode:"reg"};
		var reVal = gfn_diaLog("상품조회", -1, -1, -1, -1, "PS990000::PS992200.xfdl", false, sPrmr, true, false, true, null, null, true);
	}
	// 상품조회 상품명
	else if (sType == "edt_prod_nm" && !edt_prod_nm.readonly) {
		var sPrmr = {p_prod_cd:"", p_prod_nm:edt_prod_nm.value, p_mode:"reg"};
		var reVal = gfn_diaLog("상품조회", -1, -1, -1, -1, "PS990000::PS992200.xfdl", false, sPrmr, true, false, true, null, null, true);
	}
	// B2B회사조회
	else if (sType == "btn_srchB2bComp" || sType == "edt_b2b_comp_nm") {
		var sPrmr = {p_com_nm:edt_b2b_comp_nm.value};
		var reVal = gfn_diaLog("B2B회사 조회", -1, -1, -1, -1, "PS990000::PS993400.xfdl", false, sPrmr, true, false, true, null, null, true);
	}
	// 매장조회
	else if (sType == "btn_srchSmShop" || sType == "edt_sm_shop_nm") {
		var sPrmr = {p_sm_shop_nm:edt_sm_shop_nm.value};
		var reVal = gfn_diaLog("매장 조회", -1, -1, -1, -1, "PS990000::PS993500.xfdl", false, sPrmr, true, false, true, null, null, true);
	}
	// 설치장소
	else if (sType == "btn_insplAddrPop") {
		var sMemNo = parent.div_member.ds_member.getColumn(0, "mem_no");
		if (gfn_isNull(sMemNo) || edt_accnt_no.value == "00000") {
			return false;
		}
		//var reVal = gfn_diaLog("우편번호조회", -1, -1, -1, -1, "PS990000::PS994100.xfdl", false, {}, true, false, true, null, null, true);
		// 기존 주소검색 폐지 / 2017.04.10 부로 다음API사용
		var sPrmr = {};
		var reVal = gfn_diaLog("주소 조회", -1, -1, 884, 601, "PS990000::PS992099.xfdl", false, sPrmr, false, false, true);		
	} 
	// 주소관리
	else if (sType == "btn_memberAddr") {
		var sMemNo = parent.div_member.ds_member.getColumn(0, "mem_no");
		var sMemNm = parent.div_member.ds_member.getColumn(0, "mem_nm");
		if (gfn_isNull(sMemNo) || edt_accnt_no.value == "00000") {
			return false;
		}
		
		var reVal = gfn_diaLog("회원주소관리", -1, -1, -1, -1, "PS990000::PS993900.xfdl", false, {p_mem_no:sMemNo, p_mem_nm:sMemNm}, true, false, true, null, null, true);
	} 
	// 연락처 가져오기
	else if (sType == "btn_srchPhoneTyp") {
		pdv_inspl_phone.trackPopupByComponent(edt_inspl_phone, -1, 12);
	} 
	// 신한인증
	else if (sType == "btn_shinhan") {
// 		수정자 : 정훈연구원
// 		요청자 : 정성안팀장
// 		수정이유 : 신한인증 사용안함
		//var reVal = gfn_diaLog("신한인증", -1, -1, -1, -1, "PS990000::PS993800.xfdl", false, {}, false, false, true);
	} 
	// 삼성인증
	else if (sType == "btn_samsung") {
		var url = "https://www.samsungcard.com/hpsub/hpsub/UHPPSU0701P0.jsp";
		system.execBrowser(url);
	}
	// 카드정보 수정 / CMS정보 수정
	else if (sType == "btn_updateCardCms") {
		var gubun = "";
		if (ds_prod.getColumn(0, "cms_yn") == "Y") {	// CMS정보수정
			gubun = "cms";
		}
		if (ds_prod.getColumn(0, "pay_mthd") == "06") {	// 카드정보수정
			gubun = "card";
		}
	
		var sPrmr = {p_accnt_no:edt_accnt_no.value, p_gubun:gubun};
		var reVal = gfn_diaLog("CMS/카드정보 수정", -1, -1, -1, -1, "DL410000::DL410101.xfdl", false, sPrmr, false, false, true);
	}
	// 부가서비스 등록
	else if (sType == "btn_bugaInfo") {
		fn_bugaSrvcPop();
	}
	// 삼성카드 등록
	else if (sType == "btn_smartLifeReg") {
		var sAccntNo = edt_accnt_no.value;
		if (gfn_isNull(sAccntNo) || sAccntNo == "00000") {
			alert("회원번호가 없습니다.");
			return;
		}
		var sMemNm = parent.div_member.ds_member.getColumn(0, "mem_nm");
		var sBrthMonDay = parent.div_member.ds_member.getColumn(0, "brth_mon_day");
	
		if (gv_smartLifeFg == "Y") {
			var sPrmr = {p_accnt_no:sAccntNo, p_mem_nm:sMemNm, p_brth_mon_day:sBrthMonDay};
			var reVal = gfn_diaLog("삼성카드등록", -1, -1, -1, -1, "PS990000::PS993700.xfdl", false, sPrmr, false, false, true);
		}
	}
	// 해약등록
	else if (sType == "btn_cnctRgsn") {
	
		
		var card_openFg = gfn_cardPop();
		
			if (card_openFg == "N")
			{
				alert("청구 중입니다!\n청구 종료 후 해약 등록을 하시기 바랍니다! ");
				return false;
			}
			else
			{
				var sAccntNo = edt_accnt_no.value;
				if (gfn_isNull(sAccntNo) || sAccntNo == "00000") {
					sAccntNo = "";
				}
				var sGubun = (btn_cnctRgsn.text == "해약수정") ? "update" : "reg";
				
				var sPrmr = {p_accnt_no:sAccntNo, p_prod_cd:edt_prod_cd.value, p_gubun:sGubun, p_mainYn:"Y"};
				var reVal = gfn_diaLog("해약등록", -1, -1, -1, -1, "PS020000::PS020302.xfdl", false, sPrmr, false, false, true);
			}	
	
// //       2017년 9월 8일 수정	정기청구 중입니다!\n정기청구 종료 후 해약 등록을 하시기 바랍니다
// // 		var sAccntNo = edt_accnt_no.value;
// // 		if (gfn_isNull(sAccntNo) || sAccntNo == "00000") {
// // 			sAccntNo = "";
// // 		}
// // 		var sGubun = (btn_cnctRgsn.text == "해약수정") ? "update" : "reg";
// // 		
// // 		var sPrmr = {p_accnt_no:sAccntNo, p_prod_cd:edt_prod_cd.value, p_gubun:sGubun, p_mainYn:"Y"};
// // 		var reVal = gfn_diaLog("해약등록", -1, -1, -1, -1, "PS020000::PS020302.xfdl", false, sPrmr, false, false, true);
	}
	// 행사등록
	else if (sType == "btn_evnt_ip") {
	
		var card_openFg = gfn_cardPop();
		
			if (card_openFg == "N")
			{
				alert("청구 중입니다!\n청구 종료 후 행사 등록을 하시기 바랍니다! ");
				return false;
			}
			else
			{
				var mode = "new";
				var sAccntNo = edt_accnt_no.value;
				if (gfn_isNull(sAccntNo) || sAccntNo == "00000") {
					sAccntNo = "";
				}
				//var sGubun = (btn_cnctRgsn.text == "해약수정") ? "update" : "reg";

				var	sPrmr = {p_mode:mode, p_btn_en:"", p_event_stat_fg:"", p_accnt_no:sAccntNo, p_seq:""};
				var reVal = gfn_diaLog("행사등록", -1, -1, 884, 601, "DL430000::DL430102.xfdl", false, sPrmr, true, false, true, null, true, true);
				//var reVal = gfn_diaLog("해약등록", -1, -1, -1, -1, "PS020000::PS020302.xfdl", false, sPrmr, false, false, true);
			}		
			
// //       2017년 9월 8일 수정 정기청구 중입니다!\n정기청구 종료 후 행사 등록을 하시기 바랍니다			
// // 		var mode = "new";
// // 		var sAccntNo = edt_accnt_no.value;
// // 		if (gfn_isNull(sAccntNo) || sAccntNo == "00000") {
// // 			sAccntNo = "";
// // 		}
// // 		//var sGubun = (btn_cnctRgsn.text == "해약수정") ? "update" : "reg";
// // 
// // 		var	sPrmr = {p_mode:mode, p_btn_en:"", p_event_stat_fg:"", p_accnt_no:sAccntNo, p_seq:""};
// // 		var reVal = gfn_diaLog("행사등록", -1, -1, 884, 601, "DL430000::DL430102.xfdl", false, sPrmr, true, false, true, null, true, true);
// // 		//var reVal = gfn_diaLog("해약등록", -1, -1, -1, -1, "PS020000::PS020302.xfdl", false, sPrmr, false, false, true);
	}	
	// 행사조회
	else if (sType == "btn_srchEvent") {
		var sAccntNo = edt_accnt_no.value;
		var sSeq = ds_list_prod.getColumn(ds_list_prod.rowposition, "event_seq");
		var	sPrmr = {p_mode:"updateMain", p_btn_en:"N", p_event_stat_fg:"N", p_accnt_no:sAccntNo, p_seq:sSeq};
		var reVal = gfn_diaLog("행사 등록/수정", -1, -1, 884, 601, "DL430000::DL430102.xfdl", false, sPrmr, true, false, true, null, null, true);	
	}
	// 부분 녹취 시작/취소
	else if (sType == "btn_recDual") {
		var sCtiStatus = ap_TopFrame.form.ctiStatus;	
		if (sCtiStatus != ap_TopFrame.form.CTI_STATUS_BUSY) {	// 통화 중 체크
			alert("[통화중]일 경우에만 부분 녹취가 가능합니다.");
			return;
		}
		
		if (btn_recDual.text == ap_TopFrame.form.CTI_STATUS_STARTRECDUAL) {
			fn_startRecHr();
		} else {
			fn_endRecHr("1");
		}
	}
	// 부분 녹취 종료
	else if (sType == "btn_recDualEnd") {
		fn_endRecHr();
	}
	// 증서
	else if (sType == "btn_certf") {
		var sPrmr = {prod_cd : edt_prod_cd.value, prod_nm : edt_prod_nm.value, join_dt : cal_join_dt.value};
		gfn_diaLog("증서관리", -1, -1, 673,655, "DL450000::PS994500.xfdl", false, sPrmr, false, false, true, null, null, true);
	}
	// 계약완료
	else if (sType == "btn_concCmpl") {
		var sAccntNo = edt_accnt_no.value;
		var sMemNo = parent.div_member.ds_member.getColumn(0, "mem_no");
		var sMemNm = parent.div_member.ds_member.getColumn(0, "mem_nm");
		var sProdCd = edt_prod_cd.value;
		
		ap_TopFrame.form.gfn_recUpdateCloseCallDual(sAccntNo, sMemNo, sProdCd, sMemNm); // 부분녹취 부가정보 업데이트
		
		btn_concCmpl.enable = false;
	}
	//공연혜택 
	else if (sType == "btn_srchshow" ) {
	    
	    if (parent.div_member.business_yn.value == true ) {
			alert("법인회원에게는 제공 되지 않습니다.!!");
			return ;
	    }
	    
		var sAccntNo = edt_accnt_no.value;
		var sMemNm = parent.div_member.ds_member.getColumn(0, "mem_nm");
		var sCell = parent.div_member.ds_member.getColumn(0, "cell");
		var	sPrmr = {p_accnt_no:sAccntNo,p_MemNm : sMemNm , p_Cell :sCell };
		var reVal = gfn_diaLog("공연혜택", -1, -1, 884, 601, "PS990000::PS996200.xfdl", false, sPrmr, true, false, true, null, null, true);	
	}
	// 쇼핑몰연동
	/* ================================================================
     * 날짜 : 20171221
     * 이름 : 송준빈
     * 추가내용 : 쇼핑몰적립금사용금상세조회
     * ================================================================
     * */
	else if (sType == "btn_amtUseshow") {		
		if(gfn_isNull(parent.div_member.ds_member.getColumn(0, "mem_no")) == false || gfn_isNull(edt_accnt_no.value) == false)
		{
			var sParams = {p_mem_no   : parent.div_member.ds_member.getColumn(0, "mem_no"), 
						   p_accent_no: edt_accnt_no.value, 
						   p_res_amt  : edt_resn_amt.value,
		                   p_ci_val   : parent.div_member.ds_member.getColumn(0, "ci_val")};
			var reVal = gfn_diaLog("쇼핑몰적립금사용금상세조회", -1, -1, -1, -1, "PS030000::PS030100P01.xfdl", false, sParams, true, false, true, null, null, true);
		}
		else
		{
			alert("회원정보가 없습니다.");
		}
	}
	else if(sType == "btn_mangiExt")
	{
		if(ds_listMemberMangiExt.getRowCount() > 0)
		{
			var sAccntNo    = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "accnt_no");
			var sCell       = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "cell");
			var sZipCode    = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "zip_code");
			var sAdress     = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "adress");
			var sExtYn      = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "ext_yn");
			var sExtPeriod  = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "ext_period");
			var sExtDay     = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "ext_day");
			var sInsertGbn  = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "insert_gbn");
			var sTxEtc      = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "tx_etc");
			var sRegDm      = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "reg_dm");
			var sCancelDt   = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "cancel_dt");
	
			var sPrmr = {"pAccntNo" : sAccntNo, "pCell" : sCell,           "pZipCode" : sZipCode, 
						 "pAdress" : sAdress,   "pExtYn" : sExtYn,         "pExtPeriod" : sExtPeriod, 
						 "pExtDay" : sExtDay,   "pInsertGbn" : sInsertGbn, "pTxEtc" : sTxEtc, 
						 "pRegDm" : sRegDm,     "pCancelDt" : sCancelDt,          "pPlug" : "U"};
	             
			gfn_diaLog("설정", -1, -1, 500, 500, "DL450000::DL451300_02.xfdl", false, sPrmr, true, false, true, null, null, true);
		}
		else
		{
			if(gfn_isNull(ds_prod.getColumn(ds_prod.rowposition, "accnt_no"))) {
				alert("회원번호 정보가 없습니다.	");
				return;
			}
			var sAccntNo    = ds_prod.getColumn(ds_prod.rowposition, "accnt_no");
			var sCell		= parent.div_member.ds_member.getColumn(0, "cell");
			var sZipCode    = parent.div_member.ds_member.getColumn(0, "home_zip");
			var sAdress     = parent.div_member.ds_member.getColumn(0, "home_addr");
			
// 			var sExtYn      = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "ext_yn");
// 			var sExtPeriod  = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "ext_period");
// 			var sExtDay     = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "ext_day");
// 			var sInsertGbn  = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "insert_gbn");
// 			var sTxEtc      = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "tx_etc");

// 			var sRegDm      = ds_listMemberMangiExt.getColumn(ds_listMemberMangiExt.rowposition, "reg_dm");
	
			var sPrmr = {"pAccntNo" : sAccntNo, "pCell" : sCell,           "pZipCode" : sZipCode, 
						 "pAdress" : sAdress,   "pExtYn" : "",             "pExtPeriod" : "", 
						 "pExtDay" : "",        "pInsertGbn" : "",         "pTxEtc" : "", 
						 "pRegDm" : "",         "pCancelDt" : "",          "pPlug" : "D" };
	             
			gfn_diaLog("설정", -1, -1, 500, 500, "DL450000::DL451300_02.xfdl", false, sPrmr, true, false, true, null, null, true);
			/*alert("만기연장 정보가 없습니다.");*/
		}
	}
}

// 주소 값 등록(팝업창 호출)
function fn_daum_addr()
{
	mae_inspl_zip.value = gv_dpost; 
	edt_inspl_addr.value = gv_daddr;	
}

// 상품 추가
function fn_addProd()
{
	if (!fn_preAddProd()) return false;
	
	fn_init("ADD");          // 상품 정보 초기화
	fn_setBtnConr("ADD");    // 버튼 설정 
	fn_setModelCombo("CBO"); // 상품 Edit 를 Combo로 변경
	fn_srchResortInfo();     // 상품 추가시 리조트구분 자동 설정
	
	btn_bugaInfo.visible = false;
	
	// 수정모드 상품 정보 변경 제한 해제
	div_prod_disable.visible = false;
	
	// 수정모드 부가서비스 정보 변경 제한 처리
	div_prod_srvc_disable.visible = false;
	
	// 담당사원&모집사원 변경 제한 해제
	edt_emple_nm.readonly = false;
	edt_bef_emple_nm.readonly = false;
	
	edt_insert_cnt.enable = true;
	
	ds_cbo_modlTyp.clearData();
	ds_cbo_modlNm.clearData();
	ds_cbo_prdtKind.clearData();
	edt_b2b_emple_ci.enable = true;
}

// 상품 수정
function fn_updateProd()
{
	if (ds_prod.getColumn(0, "accnt_no") == "00000") {
		alert("기타문의는 수정할 수 없습니다.");
		return false;
	}
	
	gv_oldCboPayGubunIdx = cbo_pay_gubun.index; // 리조트구분
	
	fn_setBtnConr("UPDATE");
	fn_setModelCombo("CBO"); // 상품 Edit 를 Combo로 변경
	fn_srchModelTyp("AMNT"); // 모델분류, 모델명, 상품종류 조회
	
	// 수정모드 상품 정보 변경 제한 해제
	div_prod_disable.visible = false;
	
	// 수정모드 부가서비스 정보 변경 제한 처리
	div_prod_srvc_disable.visible = false;
	
	// 수정모드 설치일자 수정 가능
	cal_kydate.enable=true;
	
	// 담당사원&모집사원 변경 제한
	edt_emple_nm.readonly = true;
	edt_bef_emple_nm.readonly = true;	
}

// 상품 취소
function fn_cancelProd()
{
	if (ds_list_prod.rowcount > 1) {
		fn_setBtnConr("SEARCH");
	} else { // 기타문의
		fn_setBtnConr("NULL");
	}
	
	// 담당사원&모집사원 변경 제한
	edt_emple_nm.readonly = true;
	edt_bef_emple_nm.readonly = true;	
	
	fn_setProdDtl();
}

// 담당사원 설정시 호출
function setEmpleInfo()
{
	if (gfn_isNull(edt_accnt_no.value) && edt_accnt_no.value != "00000") { // 등록일 경우 담당사원 설정시 모집사원 자동설정
		gv_bef_emple_cd = gv_emple_no;
		edt_bef_emple_nm.value = edt_emple_nm.value;
		edt_bef_emple_cell.value = gv_emple_cell;
	}
	
	if (!gfn_isNull(edt_prod_cd.value) && !gfn_isNull(gv_emple_no)) {    // 제품코드가 있을 경우
		fn_srchNoSaleAccnt("emp");           // 2구좌 가입제한 확인
	}
}

// 매장정보 설정
function fn_setSmShopInfo(sType, setFg)
{
	trace(sType);
	
	if (sType == "Y") {
		edt_sm_shop_nm.visible = true;
		btn_srchSmShop.visible = true;
		gv_sm_shop_info = ds_prod.getColumn(0, "sm_shop_info");
		
		if (!setFg) {
			cbo_pay_mthd.value = "06"; // 납입 방법 : 카드
		}
		gv_smartLifeFg = "Y";
		btn_smartLifeReg.visible = true; // 삼성카드 등록 버튼
		btn_smartLifeReg.enable = true;
	} else {
		edt_sm_shop_nm.visible = false;
		edt_sm_shop_nm.value = "";
		btn_srchSmShop.visible = false;
		gv_sm_shop_info = "";
		
		if (!setFg) {
			cbo_pay_mthd.value = "01"; // 납입 방법 : 손수
		}
		btn_smartLifeReg.enable = false; // 삼성카드 등록 버튼
	}
}

// 상품 등록 후 처리
function fn_newProdAccntPayPopup()
{
	var sMemNo = parent.div_member.ds_member.getColumn(0, "mem_no");
	var sMemNm = parent.div_member.ds_member.getColumn(0, "mem_nm");
	var sBrthMonDay = parent.div_member.ds_member.getColumn(0, "brth_mon_day");
	var sIdnNo = parent.div_member.ds_member.getColumn(0, "idn_no");
	var sProdCd = edt_prod_cd.value;
	var sProdNm = edt_prod_nm.value;
	
	var sBusinessYn = parent.div_member.business_yn.value;
	
	if (gv_smartLifeFg == "Y") {
		if (confirm("삼성카드 등록하시겠습니까?")) {
			var sPrmr = {p_accnt_no:edt_accnt_no.value, p_mem_nm:sMemNm, p_brth_mon_day:sBrthMonDay};
			var reVal = gfn_diaLog("삼성카드등록", -1, -1, -1, -1, "PS990000::PS993700.xfdl", false, sPrmr, false, false, true);
		}
	} else {
		if (cbo_pay_mthd.value == "06") {
			if (confirm("카드 등록 하시겠습니까?")) {
				var reVal = gfn_diaLog("카드등록", -1, -1, -1, -1, "PS990000::PS992601.xfdl", false, {}, false, false, true);
			}
		} else {
			if (confirm("CMS등록 하시겠습니까?")) {
				if (sBusinessYn) {
					sBrthMonDay = sIdnNo
				} else {
					sBrthMonDay = sBrthMonDay.substring(2, 8);
				}
				
				var sPrmr = {p_accnt_no:edt_accnt_no.value, p_mem_no:sMemNo, p_mem_nm:sMemNm, p_idn_no:sBrthMonDay};
				var reVal = gfn_diaLog("CMS등록", -1, -1, -1, -1, "PS990000::PS992600.xfdl", false, sPrmr, false, false, true);
			}
		}
	}
}

// 상품 선택팝업에서 상품 선택시 호출
function fn_prodChcResl()
{
	// 모델분류 조회
	var sProdCd = ds_prodList.getColumn(0, "prod_cd");
	if (gfn_isNull(sProdCd)) {
		alert("상품코드가 없습니다.");
		return false;
	}
	
	
	// 애큐온 상품일 경우 세이프키 존재여부 체크 시작
	var lgnId = gfn_getUserInfo("lgn_id");
	if (lgnId == "ADMIN") {
	
		var acuonYn = ds_prodList.getColumn(0, "acuon_yn");
		
		if (!gfn_isEmpty(acuonYn) && "Y" == acuonYn) {
		
			if ( gfn_isEmpty(parent.div_member.edt_safekey.value) ) {
				alert("애큐온인증이 필요한 상품입니다. 먼저 애큐온 인증을 하시기 바랍니다.");
				return;
			}
			
			if ( "Y" != parent.div_member.edt_acuon_fitness_yn.value ) {
				alert("심사결과가 존재하지만 유효하지 않습니다. 애큐온 인증을 다시 하시기 바랍니다.");
				return;
			}
		
			var sYmd = parent.div_member.ds_member.getColumn(0, "curr_ymd");
			if ( !gfn_isEmpty(parent.div_member.edt_safekeySrchDt.value) && !gfn_isEmpty(sYmd) ) {
				var nDay = gfn_getDayDiff(parent.div_member.edt_safekeySrchDt.value, sYmd);
				if (nDay > fv_acuon_valid_days) {
					var userAns = confirm("심사결과 유효기간이 " + (nDay - fv_acuon_valid_days) + "일 지났습니다.\n계속 하시겠습니까?");
					if (!userAns) {
						return;
					}
				}
			}
		}
	}
	// 애큐온 상품일 경우 세이프키 존재여부 체크 끝
	edt_prod_cd.value = sProdCd;
	edt_prod_nm.value = ds_prodList.getColumn(0, "prod_nm");
	ds_prod.setColumn(0, "expr_no", ds_prodList.getColumn(0, "expr_no"));
	
	spn_new_chan_gunsu.value = ds_prodList.getColumn(0, "prod_dc_cnt"); // 특별할인
	spn_new_chan_gunsu.max = ds_prodList.getColumn(0, "expr_no");       // 특별할인 max 설정
	
	// 상품가격 표시
	edt_prod_amt.value = gfn_setComma(ds_prodList.getColumn(0, "prod_amt"));
	
	if (!gfn_isNull(gv_emple_no)) {       // 제품코드가 있을 경우
		fn_srchNoSaleAccnt("prod");       // 2구좌 가입제한 확인
	} else {
		fn_chngResort();                                   // 리조트 회원 설정
		if (ds_prod.getColumn(0, "accnt_no") != "00000") { // 기타문의 일 경우는 제외
			fn_srchProdSrvc();                             // 부가서비스 조회
		}
	}
	
	// 2019.02.18 FV,FW,FX,FY 상품코드도 삼성카드 등록버튼 활성화
	if(sProdCd == "S7" || sProdCd == "S8"||sProdCd == "S9"|| sProdCd == "T0" || sProdCd == "X5" || sProdCd == "X6" || sProdCd == "EC" || sProdCd == "ED" || sProdCd == "EE" || sProdCd == "EF" || sProdCd == "EG" || sProdCd == "EH"
	   || sProdCd == "FV" || sProdCd == "FW" || sProdCd == "FX" || sProdCd == "FY") {
		fn_setSmShopInfo("Y");
	} else {
		fn_setSmShopInfo("N");
	}
	//fn_chngPayMthd(); // 카드번호, 계좌번호 설정
	
	fn_srchModelTyp("CHC");
	
	
	// 2018.05.28 EC,ED,EE,EF,EG,EH 상품코드 일 경우는 파란색 볼드 처리...
	if(sProdCd == "EC" || sProdCd == "ED"||sProdCd == "EE"|| sProdCd == "EF" || sProdCd == "EG" || sProdCd == "EH")
	{
		edt_prod_cd.style.color = "blue";
		edt_prod_cd.style.font = "Dotum,9,bold";
		edt_prod_nm.style.color = "blue";
		edt_prod_nm.style.font = "Dotum,9,bold";
	}
	// 2019.02.19 FV,FW,FX,FY 상품코드 일 경우는 초록색 볼드 처리...
	else if(sProdCd == "FV" || sProdCd == "FW" || sProdCd == "FX" || sProdCd == "FY")
	{
		edt_prod_cd.style.color = "green";
		edt_prod_cd.style.font = "Dotum,9,bold";
		edt_prod_nm.style.color = "green";
		edt_prod_nm.style.font = "Dotum,9,bold";
	}
	// 2019.05.09 HA,HB,HC,HD 상품코드 일 경우는 초록색 볼드 처리...
	else if(sProdCd == "HA" || sProdCd == "HB" || sProdCd == "HC" || sProdCd == "HD")
	{
		edt_prod_cd.style.color = "maroon";
		edt_prod_cd.style.font = "Dotum,9,bold";
		edt_prod_nm.style.color = "maroon";
		edt_prod_nm.style.font = "Dotum,9,bold";
	}	
	else
	{
		edt_prod_cd.style.color = "red";
		edt_prod_cd.style.font = "Dotum,9";
		edt_prod_nm.style.color = "red";
		edt_prod_nm.style.font = "Dotum,9";
	}
}

// 부가서비스 등록 팝업
function fn_bugaSrvcPop()
{
// 	if (gv_bugaCmsFg == "N" && gv_bugaCardFg == "N") {
// 		alert("부가서비스 등록을 할 수 없습니다.");
// 		return;
// 	}
	var sMemNo = parent.div_member.ds_member.getColumn(0, "mem_no");
	var sMemNm = parent.div_member.ds_member.getColumn(0, "mem_nm");
	var sBrthMonDay = parent.div_member.ds_member.getColumn(0, "brth_mon_day");
	var sIdnNo = parent.div_member.ds_member.getColumn(0, "idn_no");
	var sEmail = parent.div_member.ds_member.getColumn(0, "email");
	
	var sBusinessYn = parent.div_member.business_yn.value;
	
	var sPayMthd = cbo_pay_mthd.value;
	var pProdCd = edt_prod_cd.value;
	var sProdNm = edt_prod_nm.value;
    var sInsPlPhone = edt_inspl_phone.value;
    var sBankAccntNo = ds_prod.getColumn(0, "bank_accnt_no");
	
	if (sBusinessYn) {
		sBrthMonDay = sIdnNo
	} else {
		sBrthMonDay = sBrthMonDay.substring(2, 8);
	}
		
	var sPrmr = {p_accnt_no:edt_accnt_no.value, p_mem_no:sMemNo, p_mem_nm:sMemNm, p_idn_no:sBrthMonDay, p_email:sEmail, p_pay_mthd:sPayMthd, p_prod_cd:pProdCd, p_prod_nm:sProdNm, p_inspl_phone:sInsPlPhone, p_bank_accnt_no:sBankAccntNo};
	//var reVal = gfn_diaLog("부가서비스등록", -1, -1, -1, -1, "PS020000::PS020301.xfdl", false, sPrmr, false, false, true);
	var reVal = gfn_diaLog("부가서비스등록", -1, -1, -1, -1, "DL410000::DL410201.xfdl", false, sPrmr, true, false, true, null, null, true); 
}

// 신한카드 인증결과 호출
function fn_ShinHanAppComplete(pCardNo) {
	cbo_pay_mthd.value = "06";
	//stc_txt_payMthd.text = "카드번호";
	//edt_bankAccntNo.text = pCardNo;
	ds_prod.setColumn(0, "bank_accnt_no", pCardNo);
}

/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
// 전화번호 설정
function phone_ontextchanged(obj:Edit,  e:TextChangedEventInfo)
{
	obj.value = gfn_phoneNumStr(obj.value);
	obj.setCaretPos(-1);
}

function phone_onkillfocus(obj:Edit, e:KillFocusEventInfo)
{
	obj.value = gfn_phoneNumStr(obj.value);
}

// 그리드 셀 선택
function grd_list_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	if (obj.name == "grd_list_prod") {
		gv_accnt_no = ds_list_prod.getColumn(ds_list_prod.rowposition, "accnt_no");
		fn_srch_prod_info("research"); // 상품 재조회
		
		//반복으로 호출 같아서 삭제 (임동진_20180813)
		//fn_setProdDtl();

		//fn_niceSendMemberStatus();
		
		if (parent.div_cons_hstr.btn_accnt_yn.class == "btn_productS1") {
 			parent.div_cons_hstr.fn_setConsHstrFilter("Y");
 		}
	} else if (obj.name == "grd_list_prodSrvc") {
		if (e.cell == 0) {
			if (ds_list_prodSrvc.getColumn(obj.currentrow, "_chk") == 1) {
				fn_chkProcSrvcToggle();
			}
		}
	}
}

// 콤보 선택시
function cbo_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	if (obj.name == "cbo_pay_gubun") {              // 리조트 회원구분
		fn_chngResort();
		if (ds_prod.getColumn(0, "accnt_no") != "00000") { // 기타문의 일 경우는 제외
			fn_srchProdSrvc();                             // 부가서비스 조회
		}
	} else if (obj.name == "cbo_pay_mthd") {        // 납입방법
		//fn_chngPayMthd();                           // 카드번호, 계좌번호 설정
	} else if (obj.name == "cbo_prod_model_kind") { // 모델분류
		if (gfn_isNull(obj.value)) {
			ds_cbo_modlNm.clearData();
			ds_cbo_prdtKind.clearData();
			
			// 모델 선택되지 않은 경우, 주계약 버튼 enable
            btn_main_contract.enable = false;
		} else {
			fn_srchModlNm();
			
			// 모델 선택된 경우, 주계약 버튼 enable
            btn_main_contract.enable = true;
			
		}
	}
}

// 그리드 헤더 사이즈 초기화
function btn_gdInit_onclick(obj:Button,  e:ClickEventInfo)
{
	if (obj.name == "btn_gdInit_prodSrvc") {
		gfn_resetColsize(grd_list_prodSrvc);
	}
}

function inspl_onitemchanged(obj:ListBox, e:ItemChangeEventInfo)
{
	if (obj.value == "10") { // 휴대전화
		if (!gfn_isNull(parent.div_member.cell.value)) {
			edt_inspl_phone.value = parent.div_member.cell.value;
		} else {
			edt_inspl_phone.value = "";
		}
	} else if (obj.value == "20") { // 자택전화
		if (!gfn_isNull(parent.div_member.home_tel.value)) {
			edt_inspl_phone.value = parent.div_member.home_tel.value;
		} else {
			edt_inspl_phone.value = "";
		}
	} else if (obj.value == "30") { // 회사전화
		if (!gfn_isNull(parent.div_member.wrpl_tel.value)) {
			edt_inspl_phone.value = parent.div_member.wrpl_tel.value;
		} else {
			edt_inspl_phone.value = "";
		}
	}
	pdv_inspl_phone.closePopup();
}

// edit ontextchanged
function edt_ontextchanged(obj:Edit,  e:TextChangedEventInfo)
{
	if (obj.name = "edt_rand_num") { // 할인우대권
		if (String(obj.value).length == 10) {
			fn_chkRandNum();
		}
	}
}

// 버튼 클릭
function btn_onclick(obj:Button,  e:ClickEventInfo)
{
	gv_sbit = "C";
	fn_openPopup(obj.name);
}




// edit onkeydown
function edt_onkeydown(obj:Edit, e:KeyEventInfo)
{
	
	if (e.keycode == 13) { // 엔터
		gv_sbit = "E";
		fn_openPopup(obj.name);
	}
}

// 버튼 클릭
function btn_dsps_onclick(obj:Button,  e:ClickEventInfo)
{
	if (obj.name == "btn_add_prod") {            // 추가
	    gv_jobsel ="1";
		fn_addProd();
	} else if (obj.name == "btn_update_prod") {  // 수정
	     gv_jobsel ="2";
		fn_updateProd();
	} else if (obj.name == "btn_del_prod") {     // 삭제
		fn_delProd();
	} else if (obj.name == "btn_save_prod") {    // 저장
		fn_saveProd();
	} else if (obj.name == "btn_cancel_prod") {  // 취소
		fn_cancelProd();
	}	
}

// spin
function spn_ontextchanged(obj:Spin, e:TextChangedEventInfo)
{
	if (obj.value > obj.max) {
		obj.value = obj.max;
	}
}

function spn_onkillfocus(obj:Spin, e:KillFocusEventInfo)
{
	if (obj.value > obj.max) {
		obj.value = obj.max;
	}
}

var gv_recHr_flag = false;

// ontimer
function fn_recDualHr_ontimer(obj:Form, e:TimerEventInfo)
{
	if (gv_recHr_flag) {
		fn_setRecDualHr();
	}
}

///////////////////////// 총 통화시간 설정
// function fn_setRecDualHr()
// {
// 	var sTm = edt_rec_dual_hr.value;
// 	
// 	var aTm = String(sTm).split(":");
// 	var nTm = (Number(aTm[0]) * 3600)
//             + (Number(aTm[1]) * 60)
//             + (Number(aTm[2]) + 1); // 1초 증가
// 
// 	var nHH = Math.floor(nTm / 3600);
//     nTm = nTm % 3600;
//     var nMM = Math.floor(nTm / 60);
//     var nSS = nTm % 60;
// 	
//     sTm = (nHH < 10 ? "0" : "") + nHH + ":"
//         + (nMM < 10 ? "0" : "") + nMM + ":"
//         + (nSS < 10 ? "0" : "") + nSS;
//     
//     if (sTm == "00:01:30") { // 자동 종료
// 		fn_endRecHr();
//     }
//     
// 	edt_rec_dual_hr.value = sTm;
// }
function fn_setRecDualHr()
{
	var sTm = edt_rec_dual_hr.value;
	
	var aTm = String(sTm).split(":");
	var nTm = (Number(aTm[0]) * 3600)
            + (Number(aTm[1]) * 60)
            + (Number(aTm[2]) - 1); // 1초 감소

	var nHH = Math.floor(nTm / 3600);
    nTm = nTm % 3600;
    var nMM = Math.floor(nTm / 60);
    var nSS = nTm % 60;
	
    sTm = (nHH < 10 ? "0" : "") + nHH + ":"
        + (nMM < 10 ? "0" : "") + nMM + ":"
        + (nSS < 10 ? "0" : "") + nSS;
    
    if (sTm == "00:00:00") { // 자동 종료
		fn_endRecHr();
    }
    
	edt_rec_dual_hr.value = sTm;
}

// function fn_clearRecHr(sType)
// {
// 	var nTm = edt_rec_dual_hr.value;
// 	if (nTm == null || nTm == "" || isNaN(Number(nTm))) {
// 		nTm = 0;
// 	}
//     nTm = Number(nTm);
// 
//     var nHH = Math.floor(nTm / 3600);
//     nTm = nTm % 3600;
//     var nMM = Math.floor(nTm / 60);
//     var nSS = nTm % 60;
// 
// 	sTm = (nHH < 10 ? "0" : "") + nHH + ":"
//         + (nMM < 10 ? "0" : "") + nMM + ":"
//         + (nSS < 10 ? "0" : "") + nSS
// 
// 	edt_rec_dual_hr.value = sTm;
// 	
// 	gv_recHr_flag = true;
// 	
// 	if (gfn_isNull(sType)) {
// 		setTimer("recDualHrId", 1000);
// 	}
// }
function fn_clearRecHr(sType)
{
	var nTm = edt_rec_dual_hr.value;
	if (nTm == null || nTm == "" || isNaN(Number(nTm))) {
		nTm = 90;
	}
    nTm = Number(nTm);

    var nHH = Math.floor(nTm / 3600);
    nTm = nTm % 3600;
    var nMM = Math.floor(nTm / 60);
    var nSS = nTm % 60;

	sTm = (nHH < 10 ? "0" : "") + nHH + ":"
        + (nMM < 10 ? "0" : "") + nMM + ":"
        + (nSS < 10 ? "0" : "") + nSS

	edt_rec_dual_hr.value = sTm;
	
	gv_recHr_flag = true;
	
	if (gfn_isNull(sType)) {
		setTimer("recDualHrId", 1000);
	}
}

// 시간 설정 종료/취소
function fn_endRecHr(sCancFg)
{
	gv_recHr_flag = false;
	
	var sAccntNo = edt_accnt_no.value;
	var sMemNo = parent.div_member.ds_member.getColumn(0, "mem_no");
	var sMemNm = parent.div_member.ds_member.getColumn(0, "mem_nm");
	var sProdCd = edt_prod_cd.value;
	
	ap_TopFrame.form.gfn_recEndDual(sAccntNo, sMemNo, sProdCd, sMemNm, sCancFg); // 부분 녹취 종료/취소
	btn_recDual.text = ap_TopFrame.form.CTI_STATUS_STARTRECDUAL;
	btn_recDualEnd.visible = false;
	
	if (sCancFg == "1") {
		edt_rec_dual_hr.value = "";
	}
}

function fn_startRecHr()
{
	var sAccntNo = edt_accnt_no.value;
	var sMemNo = parent.div_member.ds_member.getColumn(0, "mem_no");
	var sMemNm = parent.div_member.ds_member.getColumn(0, "mem_nm");
	var sProdCd = edt_prod_cd.value;
		
	fn_clearRecHr();				// 부분 녹취 타이머 시작
	btn_recDual.text = ap_TopFrame.form.CTI_STATUS_CANCELRECDUAL;
	btn_recDualEnd.visible = true;
	ap_TopFrame.form.gfn_recStartDual(sAccntNo, sMemNo, sProdCd, sMemNm); // 부분 녹취 시작
}

// grid onmousemove
function grd_onmousemove(obj:Grid, e:GridMouseEventInfo)
{
	if(e.row >= 0) {
		if (obj.name == "grd_list_prod") {
			obj.tooltiptext = obj.getCellText(e.row, e.cell);
		} else if (obj.name == "grd_list_prodSrvc") {
			obj.tooltiptext = ds_list_prodSrvc.getColumn(e.row, "opt_svc_nm_ex");
		}
	}
}


// 회원별 부가서비스 이력과 부가서비스 관리 키번호를 동기화 시키는 로직
function fn_vatSvcSync()
{
	if (ds_prod.getColumn(0, "accnt_no") == "00000") {
		alert("기타문의는 저장할 수 없습니다.");
		return false;
	}

	var szSvcid       = "updateCallCenterVatSvcHist";
	var szController  = "/dlw/vatSvc/updateCallCenterVatSvcHist";
	var szInDs        = "ds_input=ds_prod ";
	var szOutDs       = " ";
	var szParam       = "";
	var szRetCallback = "fn_callBack";

	// 트랜젝션 공통함수 호출
	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
	
}

// 담당사원 툴팁
function tooltip_emp(obj:Edit, e:MouseEventInfo)
{
	var emple_nm = ds_prod.getColumn(0, "emple_nm");
	var emple_cell = ds_prod.getColumn(0, "emple_cell");
	var emple_dept_nm = ds_prod.getColumn(0, "emple_dept_nm");
	
	var emple_text = emple_nm + "/" + emple_dept_nm + "/" + emple_cell;
	
	obj.tooltiptext = emple_text;
}

// 모집사원 툴팁
function tooltip_bef(obj:Edit, e:MouseEventInfo)
{
	var emple_nm = ds_prod.getColumn(0, "bef_emple_nm");
	var emple_cell = ds_prod.getColumn(0, "bef_emple_cell");
	var emple_dept_nm = ds_prod.getColumn(0, "bef_emple_dept_nm");
	
	var bef_emple_text = emple_nm + "/" + emple_dept_nm + "/" + emple_cell;
	
	obj.tooltiptext = bef_emple_text;	
}


//////////////////////////////////////////////////////////
//2018.02.12 전자서명 2차 NICE 전문 발송....
/////////////////////////////////////////////////////////
function fn_niceSecondSendValidation()
{
	var sB2bComp = gv_b2b_comp_cd;      //b2b가 있는지 체크 
	var cardChk =  parent.div_buga.edt_card_no.value; //카드번호가 있는지 체크
	var cmsChk =  parent.div_buga.edt_bankaccnt_no.value; //CMS번호가 있는지 체크
	
	/* CMS 인경우 정보 */
	var sIdnNo       = parent.div_buga.edt_brdt.value;         // 생년월일
	var sBankCd      = parent.div_buga.edt_bank_cd.value;      // 은행코드
	var sBankAccntNo = parent.div_buga.edt_bankaccnt_no.value; // 은행계좌번호
	
	/* CARD 인경우 정보 */
	var sCardNm      = parent.div_buga.edt_card_nm.value;      // 카드사명
	var sCardNo      = parent.div_buga.edt_card_no.value;      // 카드번호
	
	if(gfn_isNull(parent.div_member.ci_val.value) == true)
	{
		alert("본인인증을 하지 않은 고객입니다. 2차 접수가 불가능 합니다.")
		return false;
	}
		
	//trace("카드여부 체크 : " + cardChk);
	//trace("B2B 체크 : " + sB2bComp);
		
	if(cbo_pay_mthd.value == "04")
	{
		/*/
		if(cmsChk == "" || gfn_isNull(cmsChk) == true)
		{
			alert("CMS 등록을 해주십시요!![CMS 미등록]");
			return false;			
		}
		*/
		if((gfn_isNull(sIdnNo) == true) || (gfn_isNull(sBankCd) == true) || 
		   (gfn_isNull(sBankAccntNo) == true))
		{
			alert("납입정보의 생년월일, 은행코드, 계좌번호를 정확하게 입력하여 주십시오.");
			return false;
		}
	}
	else if(cbo_pay_mthd.value == "06")
	{
		/*
		if(cardChk == "" || gfn_isNull(cardChk) == true)
		{
			alert("카드 등록을 해주십시요!![카드 미등록]");
			return false;			
		}
		*/
		if((gfn_isNull(sIdnNo) == true) || (gfn_isNull(sCardNm) == true) || 
		   (gfn_isNull(sCardNo) == true))
		{
			alert("납입정보의 생년월일, 카드사명, 카드번호를 정확하게 입력하여 주십시오.");
			return false;
		}
	}
	else
	{
		alert("전자서명 계약의 납입방식은 CMS 또는 카드 결제만 가능합니다.");
		return false;
	}
		
	if(sB2bComp != "6018" || gfn_isNull(sB2bComp) == true)
	{
		alert("b2b회사명을 확인 하여 주십시요");
		return false;
	}	
		
	if(cbo_hpcl_stat_cd.value != "21")
	{
		alert("계약문자 전송시에는 해피콜상태를 [전자서명대기]로 설정하여 주십시오.");
		return false;
	}	
			
	/*
	var sAuthCode1 = ds_acuonLatelyAuth.getColumn(0, "auth_01");
	var sAuthCode2 = ds_acuonLatelyAuth.getColumn(0, "auth_02");
	
	if(gfn_isNull(parent.div_member.ci_val.value) == true)
	{
		alert("본인인증을 하지 않은 고객입니다. 2차 접수가 불가능 합니다.")
		return false;
	}
	
	if(cbo_pay_mthd.value != "04" && cbo_pay_mthd.value != "06")
	{
		alert("전자서명 계약의 납입방식은 CMS 또는 카드 결제만 가능합니다.");
		cbo_pay_mthd.focus();
		return false;
	}
	
	if(gfn_isNull(parent.div_buga.edt_bankaccnt_no.value) == true)
	{
		alert("고객의 납입정보가 등록되지 않아 계약문자발송을 할수 없습니다.");
		return false;
	}
	
	if(cbo_hpcl_stat_cd.value != "21")
	{
		alert("계약문자 전송시에는 해피콜상태를 [전자서명대기]로 설정하여 주십시오.");
		return false;
	}
	
	if(sAuthCode1 != "03" && (sAuthCode2 != "신규" || gfn_isNull(sAuthCode2) == false))
	{
		alert("해당 고객의 본인/신용정보인증이 종료되지 않아 계약문자를 발송할수 없습니다.");
		return false;
	}
	*/
		
	//trace("정상");	
	return true;
}

function fn_niceSecondResendValidation()
{
	var sAuthCode1 = ds_acuonLatelyAuth.getColumn(0, "auth_01"); // 03
	var sAuthCode2 = ds_acuonLatelyAuth.getColumn(0, "auth_02"); // 04, 05
	
	if((sAuthCode1 == "03" && sAuthCode2 == "04") || (sAuthCode1 == "03" && sAuthCode2 == "05"))
	{
		return true;
	}
	else
	{
		alert("계약문자재발송은 [2차접수완료] 또는 [위탁처리]단계에서만 가능합니다.");
		return false;
	}
}

function btn_niceSecondSend_onclick(obj:Button,  e:ClickEventInfo)
{	
	trace("obj.text   : " + obj.text);
	if (gfn_isNull(obj.text) == true) 
	{
		trace("NICE 전자서명 전송을 위한 기능명이 없어 해당 작업을 수행할수 없습니다.");
		return false;
	} 
	else 
	{
		switch (obj.text) 
		{
			case "계약문자발송" :
				if(fn_niceSecondSendValidation() == true)
				{
					ds_niceReSend2.clearData();
					var nRow = ds_niceReSend2.addRow();
		
					//ds_niceReSend2.setColumn(nRow, "trgt_cust_dtpt_id", ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_id"));
					ds_niceReSend2.setColumn(nRow, "accnt_no", ds_list_prod.getColumn(ds_list_prod.rowposition, "accnt_no"));					
					ds_niceReSend2.setColumn(nRow, "nice_no", gv_niceNo);	
					gv_accnt_no = ds_list_prod.getColumn(ds_list_prod.rowposition, "accnt_no");
					
					trace("gv_niceNo" + gv_niceNo);
					trace("gv_niceNo" + gv_accnt_no);
					
					//trace("정상");
					
					//trace("ds_niceReSend2 : " + gv_niceNo);
					//return false;
	
					var szSvcid       = "insertNiceInfomation2";
					var szController  = "/web/nice/insertNiceInfomation2";
					var szInDs        = "ds_input1=ds_niceReSend2";
					var szOutDs       = "";
					var szParam       = "";
					var szRetCallback = "fn_callBack";

					// 트랜젝션 공통함수 호출
					gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
				}
			break;
			
			case "계약재전송" :
				if(fn_niceSecondSendValidation() == true)
				{
					ds_niceReSend2.clearData();
					var nRow = ds_niceReSend2.addRow();
		
					//ds_niceReSend2.setColumn(nRow, "trgt_cust_dtpt_id", ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_id"));
					ds_niceReSend2.setColumn(nRow, "accnt_no", ds_list_prod.getColumn(ds_list_prod.rowposition, "accnt_no"));					
					ds_niceReSend2.setColumn(nRow, "nice_no", gv_niceNo);	
					gv_accnt_no = ds_list_prod.getColumn(ds_list_prod.rowposition, "accnt_no");
					
					//trace("정상");
					
					//trace("ds_niceReSend2 : " + gv_niceNo);
					//return false;
	
					var szSvcid       = "insertNiceInfomation2";
					var szController  = "/web/nice/insertNiceInfomation2";
					var szInDs        = "ds_input1=ds_niceReSend2";
					var szOutDs       = "";
					var szParam       = "";
					var szRetCallback = "fn_callBack";

					// 트랜젝션 공통함수 호출
					gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
				}
			break;			
			
			case "재전송" :
				if(fn_niceSecondSendValidation() == true)
				{		
					ds_niceReSend2.clearData();
					var nRow = ds_niceReSend2.addRow();
			
					//ds_niceReSend2.setColumn(nRow, "trgt_cust_dtpt_id", ds_list_prod.getColumn(ds_list_prod.rowposition, "trgt_id"));
					ds_niceReSend2.setColumn(nRow, "accnt_no", ds_list_prod.getColumn(ds_list_prod.rowposition, "accnt_no"));
		
					gv_accnt_no = ds_list_prod.getColumn(ds_list_prod.rowposition, "accnt_no");
		
					var szSvcid       = "resendKaKao2";
					var szController  = "/web/nice/resendKaKao2";
					var szInDs        = "ds_input1=ds_niceReSend2";
					var szOutDs       = "";
					var szParam       = "";
					var szRetCallback = "fn_callBack";

					// 트랜젝션 공통함수 호출
				    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
				}
			break;
			
			case "증서열람" :
				ds_pdfTemp.clearData();
				var nRow = ds_pdfTemp.addRow();
				ds_pdfTemp.setColumn(nRow, "accnt_no", ds_list_prod.getColumn(ds_list_prod.rowposition, "accnt_no"));
				ds_pdfTemp.setColumn(nRow, "join_dt", ds_list_prod.getColumn(ds_list_prod.rowposition, "join_dt"));
	
				var szSvcid       = "getNicePdfFile";
				var szController  = "/web/nice/getNicePdfFile";
				var szInDs        = "ds_input=ds_pdfTemp";
				var szOutDs       = "ds_pdfFileInfo=ds_output";
				var szParam       = "";
				var szRetCallback = "fn_callBack";
	
				gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
			break;
		}
	}
	
}

function cbo_hpcl_stat_cd_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	var sAuthCode1 = ds_acuonLatelyAuth.getColumn(0, "auth_01");
	var sAuthCode2 = ds_acuonLatelyAuth.getColumn(0, "auth_02");
	var sHpclStatCd = cbo_hpcl_stat_cd.value;
	
	if(sAuthCode1 == "03" && sAuthCode2 == "06")
	{
		if(sHpclStatCd == "21")
		{
			cbo_prod_model_kind.enable = true;
			cbo_prod_model_cd.enable = true;
			cbo_prod_kind.enable = true;
		}
		else
		{
			cbo_prod_model_kind.enable = false;
			cbo_prod_model_cd.enable = false;
			cbo_prod_kind.enable = false;
		}
	}
} 

/*************************************************************************************************************************************************
 * 현재 금액 청구중인 회원인지 아닌지 여부 확인 20181023 송준빈 청구고객
 *************************************************************************************************************************************************/

function fn_getWdrwReqAccntConfirm()
{
	var sAccntNo = edt_accnt_no.value;
	
	var szSvcid       = "getWdrwReqAccntConfirm";
	var szController  = "/dlw/pay/getWdrwReqAccntConfirm";
	var szInDs        = "";
	var szOutDs       = ""; 
	var szParam       = "accnt_no=" + sAccntNo;
	var szRetCallback = "fn_callBack";
			
	// 트랜젝션 공통함수 호출
	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

function fn_setAbleSave()
{
	/*
	var sOddProdModelKind = ds_list_prod.getColumn(ds_list_prod.rowposition, "prod_model_kind"); // 변경전 모델분류
	var sOddProdModelCd   = ds_list_prod.getColumn(ds_list_prod.rowposition, "prod_model_cd");   // 변경전 모델명
	var sOddProdKind      = ds_list_prod.getColumn(ds_list_prod.rowposition, "prod_kind");       // 변경전 상품종류
	*/
	var sOddPayMthd       = ds_list_prod.getColumn(ds_list_prod.rowposition, "pay_mthd");        // 변경전 납입방법
	var sOddNewChanGunsu  = ds_list_prod.getColumn(ds_list_prod.rowposition, "new_chan_gunsu");  // 변경전 특별할인
	var sOddHpclStatCd    = ds_list_prod.getColumn(ds_list_prod.rowposition, "hpcl_stat_cd");    // 변경전 해피콜상태
	
	/*
	var sUpdProdModelKind = ds_prod.getColumn(0, "prod_model_kind"); // 변경후 모델분류
	var sUpdProdModelCd   = ds_prod.getColumn(0, "prod_model_cd");   // 변경후 모델명
	var sUpdProdKind      = ds_prod.getColumn(0, "prod_kind");       // 변경후 상품종류
	*/
	var sUpdPayMthd       = ds_prod.getColumn(ds_prod.rowposition, "pay_mthd");        // 변경후 납입방법
	var sUpdNewChanGunsu  = ds_prod.getColumn(ds_prod.rowposition, "new_chan_gunsu");  // 변경후 특별할인
	var sUpdHpclStatCd    = ds_prod.getColumn(ds_prod.rowposition, "hpcl_stat_cd");    // 변경후 해피콜상태
	
	if(sOddPayMthd != sUpdPayMthd)
	{
	    gv_able_prod_update = "N";
	}
	else if(sOddNewChanGunsu != sUpdNewChanGunsu)
	{
	    gv_able_prod_update = "N";
	}
	else if(sOddHpclStatCd != sUpdHpclStatCd)
	{
		gv_able_prod_update = "N";
	}
	else
	{
		gv_able_prod_update = "Y";
	}
	/*
	else if(sOddProdModelKind != sUpdProdModelKind)
	{
		gv_able_prod_update = "N";
	}
	else if(sOddProdModelCd != sUpdProdModelCd)
	{
	    gv_able_prod_update = "N";
	}
	else if(sOddProdKind != sUpdProdKind)
	{
	    gv_able_prod_update = "N";
	}
	*/
}

// 회원조회시 산출 또는 청구중인지 체크
function fn_getWdrwReqAccntConfirm2()
{
	var sAccntNo = edt_accnt_no.value;
	
	var szSvcid       = "getWdrwReqAccntEventConfirm";
	var szController  = "/dlw/pay/getWdrwReqAccntEventConfirm";
	var szInDs        = "";
	var szOutDs       = "ds_listWdrwReq=ds_output";
	var szParam       = "accnt_no=" + sAccntNo;
	var szRetCallback = "fn_callBack";
			
	// 트랜젝션 공통함수 호출
	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

function fn_getMemberMangiExtConfirmList()
{
	var szSvcid       = "getMemberMangiExtConfirmList";
	var szController  = "/dlw/pay/getMemberMangiExtConfirmList";
	var szInDs        = "ds_input=ds_prod";
	var szOutDs       = "ds_listMemberMangiExt=ds_output";
	var szParam       = "";
	var szRetCallback = "fn_callBack";
			
	// 트랜젝션 공통함수 호출
	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}

// 주계약 팝업 추가
function btn_main_contract_onclick(obj:Button,  e:ClickEventInfo)
{
	var sPrmr = {};
	var reVal = gfn_diaLog("주계약", -1, -1, -1, -1, "PS020000::PS02000104P02.xfdl", false, sPrmr, false, false, true, null, null, true);
}
]]></Script>
  </Form>
</FDL>
