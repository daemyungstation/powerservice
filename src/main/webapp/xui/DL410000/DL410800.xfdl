<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="DL410800" classname="캠페인관리" inheritanceid="" position="absolute 0 0 989 795" titletext="출금이체의뢰내역 조회" onload="DL410800_onload" scrollbars="none">
    <Layouts>
      <Layout>
        <Edit id="edt_cpdcTitlNm08" taborder="1" position="absolute 756 -531 889 -511"/>
        <Static id="stc_04" class="sta_workSrcBg" position2="absolute l:0 r:0 t:10 h:42" positiontype="position2">
          <Layouts>
            <Layout width="989" height="42"/>
          </Layouts>
        </Static>
        <Static id="sta_TotalCnt" text="검색결과   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt; / 전체   &lt;fs v='9'&gt;&lt;fc v='#f0850c'&gt;&lt;b v='true'&gt;0&lt;/b&gt;&lt;/fc&gt;&lt;/fs&gt; &lt;fc v='#a1a1a1'&gt;건&lt;/fc&gt;" usedecorate="true" class="sta_workTitle5" position2="absolute r:-213 w:186 t:16 h:20" positiontype="position2" visible="false"/>
        <Tab id="tab_00" taborder="34" position2="absolute l:0 r:0 t:60 b:11" positiontype="position2" tabindex="2" scrollbars="autoboth">
          <Tabpages>
            <Tabpage id="cms" text="CMS">
              <Layouts>
                <Layout width="739" height="223">
                  <Grid id="grd_List" taborder="0" binddataset="ds_cmsList" useinputpanel="false" cellsizingtype="col" position2="absolute l:4 r:3 t:26 b:37" positiontype="position2" onheadclick="tab_00_cms_grd_List_onheadclick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="47"/>
                          <Column size="164"/>
                          <Column size="80"/>
                          <Column size="99"/>
                          <Column size="67"/>
                          <Column size="119"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="66"/>
                          <Column size="83"/>
                          <Column size="67"/>
                          <Column size="170"/>
                          <Column size="97"/>
                          <Column size="128"/>
                          <Column size="143"/>
                          <Column size="80"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="영업소"/>
                          <Cell col="2" text="담당자"/>
                          <Cell col="3" text="회원번호"/>
                          <Cell col="4" text="회원명"/>
                          <Cell col="5" text="상품명"/>
                          <Cell col="6" text="최종납입회차"/>
                          <Cell col="7" text="연체상태"/>
                          <Cell col="8" text="청구건수"/>
                          <Cell col="9" text="청구금액"/>
                          <Cell col="10" text="신청상태"/>
                          <Cell col="11" text="불능코드"/>
                          <Cell col="12" text="은행명"/>
                          <Cell col="13" text="계좌"/>
                          <Cell col="14" text="통장기재내역"/>
                          <Cell col="15" text="입금일"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" text="bind:dept_nm"/>
                          <Cell col="2" text="bind:emple_nm"/>
                          <Cell col="3" displaytype="text" edittype="readonly" text="bind:accnt_no"/>
                          <Cell col="4" text="bind:mem_nm" expr="expr:gfn_SetNameGrdSecu(mem_nm)"/>
                          <Cell col="5" text="bind:prod_nm"/>
                          <Cell col="6" text="bind:last_pay_no"/>
                          <Cell col="7" text="bind:yenche_stat"/>
                          <Cell col="8" text="bind:inv_gunsu"/>
                          <Cell col="9" style="align:right;" text="bind:wdrw_req_amt" expr="gfn_commaStr(wdrw_req_amt)"/>
                          <Cell col="10" text="bind:stat"/>
                          <Cell col="11" text="bind:imps_nm"/>
                          <Cell col="12" text="bind:bank_nm"/>
                          <Cell col="13" text="bind:bank_accnt_no" mask="expr:gfn_SetCmsNoGrdSecu(bank_accnt_no)"/>
                          <Cell col="14" text="bind:bank_filin_brkdn"/>
                          <Cell col="15" text="bind:inv_dt"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="stc_05" text="CMS 출금이체의뢰 내역" class="sta_workTitle2" position2="absolute l:4 w:244 t:6 h:20" positiontype="position2"/>
                  <Static id="Static04" text="대상회원" position2="absolute l:12 w:50 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_mem_cnt" text="0" position2="absolute l:69 w:50 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static00" text="출금회원" position2="absolute l:102 w:50 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_wdrw_mem_cnt" text="0" position2="absolute l:159 w:30 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static01" text="출금액" position2="absolute l:194 w:37 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_wdrw_amt" text="0" position2="absolute l:235 w:66 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static02" text="불능회원" position2="absolute l:311 w:50 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_imps_cnt" text="0" position2="absolute l:368 w:36 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static03" text="불능금액" position2="absolute l:409 w:50 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_imps_amt" text="0" position2="absolute l:466 w:71 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static05" text="출금수수료" position2="absolute l:545 w:66 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_comp_han" text="0" position2="absolute l:618 w:77 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static06" text="불능수수료" position2="absolute l:700 w:66 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_imps_han" text="0" position2="absolute l:773 w:73 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Button id="btn_aplcCanc" taborder="1" text="신청전으로전환" class="btn_WF_Common" position2="absolute r:4 w:112 b:8 h:20" positiontype="position2" style="padding:0 0 0 0;" onclick="btn_aplcCanc_onclick" visible="false"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="card" text="카드파일" scrollbars="none">
              <Layouts>
                <Layout width="739" height="223">
                  <Grid id="grd_List" taborder="0" binddataset="ds_cardList" useinputpanel="false" cellsizingtype="col" position2="absolute l:4 r:3 t:26 b:37" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="47"/>
                          <Column size="144"/>
                          <Column size="66"/>
                          <Column size="98"/>
                          <Column size="80"/>
                          <Column size="159"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="106"/>
                          <Column size="111"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="119"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="150"/>
                          <Column size="192"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="영업소"/>
                          <Cell col="2" text="담당자"/>
                          <Cell col="3" text="회원번호"/>
                          <Cell col="4" text="회원명"/>
                          <Cell col="5" text="상품명"/>
                          <Cell col="6" text="최종납입회차"/>
                          <Cell col="7" text="연체상태"/>
                          <Cell col="8" text="청구건수"/>
                          <Cell col="9" text="청구금액"/>
                          <Cell col="10" text="신청상태"/>
                          <Cell col="11" text="승인코드"/>
                          <Cell col="12" text="EDI코드"/>
                          <Cell col="13" text="할부개월수"/>
                          <Cell col="14" text="카드사"/>
                          <Cell col="15" text="실제카드사"/>
                          <Cell col="16" text="카드번호"/>
                          <Cell col="17" text="유효기간"/>
                          <Cell col="18" text="결제일"/>
                          <Cell col="19" text="청구내역"/>
                          <Cell col="20" text="통장기재내역"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" text="bind:dept_nm"/>
                          <Cell col="2" text="bind:emple_nm"/>
                          <Cell col="3" displaytype="text" edittype="readonly" text="bind:accnt_no"/>
                          <Cell col="4" text="bind:mem_nm" expr="expr:gfn_SetNameGrdSecu(mem_nm)"/>
                          <Cell col="5" text="bind:prod_nm"/>
                          <Cell col="6" text="bind:last_pay_no"/>
                          <Cell col="7" text="bind:yenche_stat"/>
                          <Cell col="8" text="bind:inv_gunsu"/>
                          <Cell col="9" style="align:right;" text="bind:wdrw_req_amt" expr="gfn_commaStr(wdrw_req_amt)"/>
                          <Cell col="10" text="bind:stat"/>
                          <Cell col="11" text="bind:imps_nm2"/>
                          <Cell col="12" text="bind:imps_nm"/>
                          <Cell col="13" text="bind:install_perod"/>
                          <Cell col="14" text="bind:card_nm"/>
                          <Cell col="15" text="bind:real_card_nm"/>
                          <Cell col="16" text="bind:card_no" mask="expr:gfn_SetCardNoGrdSecu(card_no)"/>
                          <Cell col="17" text="bind:expire_date" mask="{####}" maskchar=" "/>
                          <Cell col="18" text="bind:pay_dt"/>
                          <Cell col="19" text="bind:bank_filin_brkdn"/>
                          <Cell col="20" text="bind:bank_filin_brkdn"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="stc_05" text="카드파일 출금이체의뢰 내역" class="sta_workTitle2" position2="absolute l:4 w:244 t:6 h:20" positiontype="position2"/>
                  <Static id="Static04" text="대상회원" position2="absolute l:12 w:50 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_mem_cnt" text="0" position2="absolute l:69 w:50 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static00" text="출금회원" position2="absolute l:142 w:50 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_wdrw_mem_cnt" text="0" position2="absolute l:199 w:50 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static01" text="출금액" position2="absolute l:282 w:37 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_wdrw_amt" text="0" position2="absolute l:323 w:66 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static02" text="불능회원" position2="absolute l:415 w:50 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_imps_cnt" text="0" position2="absolute l:472 w:36 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static03" text="불능금액" position2="absolute l:561 w:50 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_imps_amt" text="0" position2="absolute l:618 w:71 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Button id="btn_aplcCanc" taborder="1" text="신청전으로전환" onclick="btn_aplcCanc_onclick" class="btn_WF_Common" position2="absolute r:4 w:112 b:8 h:20" positiontype="position2" style="padding:0 0 0 0;" visible="false"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="sttc" text="통계" scrollbars="none">
              <Layouts>
                <Layout width="739" height="223">
                  <Grid id="grd_SumList" taborder="0" binddataset="ds_sttcCmsSumList" useinputpanel="false" cellsizingtype="col" position2="absolute l:4 r:3 t:27 b:549" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="100"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="96"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell rowspan="2" style="background:antiquewhite;">
                            <Cell rowspan="2" text="구분"/>
                          </Cell>
                          <Cell col="1" colspan="3" style="background:antiquewhite;">
                            <Cell colspan="3" text="계"/>
                          </Cell>
                          <Cell col="4" colspan="3" style="background:antiquewhite;">
                            <Cell colspan="3" text="신규"/>
                          </Cell>
                          <Cell col="7" colspan="3" style="background:antiquewhite;">
                            <Cell colspan="3" text="유지"/>
                          </Cell>
                          <Cell col="10" rowspan="2" style="background:antiquewhite;">
                            <Cell rowspan="2" text="수수료합계"/>
                          </Cell>
                          <Cell row="1" col="1" style="background:antiquewhite;" text="청구"/>
                          <Cell row="1" col="2" style="background:antiquewhite;" text="입금"/>
                          <Cell row="1" col="3" style="background:antiquewhite;" text="미입금"/>
                          <Cell row="1" col="4" style="background:antiquewhite;" text="청구"/>
                          <Cell row="1" col="5" style="background:antiquewhite;" text="입금"/>
                          <Cell row="1" col="6" style="background:antiquewhite;" text="입금률(%)"/>
                          <Cell row="1" col="7" style="background:antiquewhite;" text="청구"/>
                          <Cell row="1" col="8" style="background:antiquewhite;" text="입금"/>
                          <Cell row="1" col="9" style="background:antiquewhite;" text="입금률(%)"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:gbn"/>
                          <Cell col="1" expr="gfn_isNull(wdrw)?0:gfn_commaStr(wdrw)"/>
                          <Cell col="2" expr="gfn_isNull(pay)?0:gfn_commaStr(pay)"/>
                          <Cell col="3" expr="gfn_isNull(wdrw_err)?0:gfn_commaStr(wdrw_err)"/>
                          <Cell col="4" expr="gfn_isNull(new_tot)?0:gfn_commaStr(new_tot)"/>
                          <Cell col="5" expr="gfn_isNull(new_amt)?0:gfn_commaStr(new_amt)"/>
                          <Cell col="6" expr="gfn_isNull(new_per)?0:new_per"/>
                          <Cell col="7" expr="gfn_isNull(yuji_tot)?0:gfn_commaStr(yuji_tot)"/>
                          <Cell col="8" expr="gfn_isNull(yuji)?0:gfn_commaStr(yuji)"/>
                          <Cell col="9" expr="gfn_isNull(yuji_per)?0:yuji_per"/>
                          <Cell col="10" expr="gfn_isNull(charge)?0:gfn_commaStr(charge)"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="stc_05" text="통계" class="sta_workTitle2" position2="absolute l:4 w:67 t:6 h:20" positiontype="position2"/>
                  <Grid id="grd_DtlList" taborder="1" binddataset="ds_sttcCmsDtlList" useinputpanel="false" cellsizingtype="col" position2="absolute l:4 r:3 t:155 b:5" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="111"/>
                          <Column size="90"/>
                          <Column size="90"/>
                          <Column size="100"/>
                          <Column size="90"/>
                          <Column size="90"/>
                          <Column size="90"/>
                          <Column size="90"/>
                          <Column size="100"/>
                          <Column size="110"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell rowspan="2" style="background:antiquewhite;" taborder="undefined">
                            <Cell rowspan="2" text="지점"/>
                          </Cell>
                          <Cell col="1" colspan="2" style="background:antiquewhite;" taborder="undefined">
                            <Cell colspan="2" text="청구내역"/>
                          </Cell>
                          <Cell col="3" rowspan="2" style="background:antiquewhite;" taborder="undefined">
                            <Cell rowspan="2" text="청구내역수수료"/>
                          </Cell>
                          <Cell col="4" colspan="4" style="background:antiquewhite;" taborder="undefined">
                            <Cell colspan="4" text="입금내역"/>
                          </Cell>
                          <Cell col="8" rowspan="2" style="background:antiquewhite;" taborder="undefined">
                            <Cell rowspan="2" text="입금내역수수료"/>
                          </Cell>
                          <Cell col="9" rowspan="2" style="background:antiquewhite;" taborder="undefined">
                            <Cell rowspan="2" text="수수료합계"/>
                          </Cell>
                          <Cell row="1" col="1" style="background:antiquewhite;" text="건수"/>
                          <Cell row="1" col="2" style="background:antiquewhite;" text="금액"/>
                          <Cell row="1" col="4" style="background:antiquewhite;" text="신규건수"/>
                          <Cell row="1" col="5" style="background:antiquewhite;" text="금액"/>
                          <Cell row="1" col="6" style="background:antiquewhite;" text="유지건수"/>
                          <Cell row="1" col="7" style="background:antiquewhite;" text="금액"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:dept_nm"/>
                          <Cell col="1" expr="gfn_isNull(cnt)?0:cnt"/>
                          <Cell col="2" style="align:right;" expr="gfn_isNull(wdrw_amt)?0:gfn_commaStr(wdrw_amt)"/>
                          <Cell col="3" expr="gfn_isNull(wdrw_charge)?0:gfn_commaStr(wdrw_charge)"/>
                          <Cell col="4" expr="gfn_isNull(new_cnt)?0:new_cnt"/>
                          <Cell col="5" style="align:right;" expr="gfn_isNull(new_amt)?0:gfn_commaStr(new_amt)"/>
                          <Cell col="6" expr="gfn_isNull(yuji_cnt)?0:yuji_cnt"/>
                          <Cell col="7" style="align:right;" expr="gfn_isNull(yuji_amt)?0:gfn_commaStr(yuji_amt)"/>
                          <Cell col="8" style="align:right;" expr="gfn_isNull(pay_charge)?0:gfn_commaStr(pay_charge)"/>
                          <Cell col="9" expr="gfn_isNull(charge)?0:gfn_commaStr(charge)"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Radio id="rdo_sttc_gubun" taborder="2" columncount="6" rowcount="0" codecolumn="codecolumn" datacolumn="datacolumn" value="cms" position2="absolute l:70 w:132 t:6 h:18" positiontype="position2" index="0" onitemchanged="rdo_sttc_gubun_onitemchanged">
                    <Dataset id="innerdataset">
                      <ColumnInfo>
                        <Column id="codecolumn" size="256"/>
                        <Column id="datacolumn" size="256"/>
                      </ColumnInfo>
                      <Rows>
                        <Row>
                          <Col id="codecolumn">cms</Col>
                          <Col id="datacolumn">CMS</Col>
                        </Row>
                        <Row>
                          <Col id="codecolumn">card</Col>
                          <Col id="datacolumn">카드</Col>
                        </Row>
                      </Rows>
                    </Dataset>
                  </Radio>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="card_batch" text="카드배치" scrollbars="none">
              <Layouts>
                <Layout width="739" height="223">
                  <Grid id="grd_List" taborder="2" binddataset="ds_cardBatchList" useinputpanel="false" cellsizingtype="col" position2="absolute l:4 r:3 t:26 b:37" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="46"/>
                          <Column size="134"/>
                          <Column size="54"/>
                          <Column size="88"/>
                          <Column size="63"/>
                          <Column size="151"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="64"/>
                          <Column size="89"/>
                          <Column size="74"/>
                          <Column size="144"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="116"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="순번"/>
                          <Cell col="1" text="영업소"/>
                          <Cell col="2" text="담당자"/>
                          <Cell col="3" text="회원번호"/>
                          <Cell col="4" text="회원명"/>
                          <Cell col="5" text="상품명"/>
                          <Cell col="6" text="최종납입회차"/>
                          <Cell col="7" text="연체상태"/>
                          <Cell col="8" text="청구건수"/>
                          <Cell col="9" text="청구금액"/>
                          <Cell col="10" text="신청상태"/>
                          <Cell col="11" text="승인코드"/>
                          <Cell col="12" text="할부개월수"/>
                          <Cell col="13" text="카드사"/>
                          <Cell col="14" text="카드번호"/>
                          <Cell col="15" text="결제일"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" text="bind:dept_nm"/>
                          <Cell col="2" text="bind:emple_nm"/>
                          <Cell col="3" displaytype="text" edittype="readonly" text="bind:accnt_no"/>
                          <Cell col="4" text="bind:mem_nm" expr="expr:gfn_SetNameGrdSecu(mem_nm)"/>
                          <Cell col="5" text="bind:prod_nm"/>
                          <Cell col="6" text="bind:last_pay_no"/>
                          <Cell col="7" text="bind:yenche_stat"/>
                          <Cell col="8" text="bind:inv_gunsu"/>
                          <Cell col="9" style="align:right;" text="bind:wdrw_req_amt" expr="gfn_commaStr(wdrw_req_amt)"/>
                          <Cell col="10" text="bind:stat"/>
                          <Cell col="11" text="bind:imps_nm2"/>
                          <Cell col="12" text="bind:install_perod"/>
                          <Cell col="13" text="bind:card_nm"/>
                          <Cell col="14" text="bind:card_no" mask="expr:gfn_SetCardNoGrdSecu(card_no)"/>
                          <Cell col="15"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="stc_05" text="카드 실시간 배치 출금이체의뢰 내역" class="sta_workTitle2" position2="absolute l:4 w:244 t:6 h:20" positiontype="position2"/>
                  <Static id="stc_imps_amt" text="0" position2="absolute l:466 w:71 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static03" text="불능금액" position2="absolute l:409 w:50 b:6 h:23" positiontype="position2"/>
                  <Static id="Static02" text="불능회원" position2="absolute l:311 w:50 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_imps_cnt" text="0" position2="absolute l:368 w:36 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="stc_wdrw_amt" text="0" position2="absolute l:235 w:66 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static01" text="출금액" position2="absolute l:194 w:37 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_wdrw_mem_cnt" text="0" position2="absolute l:159 w:50 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static00" text="출금회원" position2="absolute l:102 w:50 b:6 h:23" positiontype="position2"/>
                  <Static id="stc_mem_cnt" text="0" position2="absolute l:69 w:50 b:6 h:23" positiontype="position2" style="color:red;font:Dotum,9,bold;"/>
                  <Static id="Static04" text="대상회원" position2="absolute l:12 w:50 b:6 h:23" positiontype="position2"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Button id="btn_export_report" taborder="32" text="출력" class="btn_WF_Common" position2="absolute r:80 w:72 t:60 h:20" positiontype="position2" style="padding:0 0 0 0;" onclick="btn_export_report_onclick" visible="false"/>
        <Button id="btn_excl" taborder="35" text="엑셀" onclick="btn_export_grid_onclick" class="btn_WF_Common" position2="absolute r:0 w:72 t:60 h:20" positiontype="position2" style="padding:0 0 0 0;"/>
        <Static id="stc05" text="출금기간" class="sta_workSrcLabel1" position="absolute 23 21 80 41"/>
        <Calendar id="cal_sttDt" taborder="37" dateformat="yyyy-MM-dd" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" position="absolute 88 21 183 41"/>
        <Static id="sta_Dash01" text="~" position="absolute 187 25 200 40"/>
        <Calendar id="cal_endDt" taborder="38" dateformat="yyyy-MM-dd" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" position="absolute 201 21 296 41"/>
        <Button id="btn_Search" taborder="39" onclick="btn_Search_onclick" class="btn_WF_Search" position2="absolute r:10 w:72 t:21 h:20" positiontype="position2" tooltiptext="조회" style="padding:0 0 0 0;"/>
        <Button id="btn_notCompFile" taborder="40" text="파일작성미완료분" class="btn_WF_Common" position2="absolute r:90 w:124 t:21 h:20" positiontype="position2" style="padding:0 0 0 0;" onclick="btn_notCompFile_onclick"/>
      </Layout>
    </Layouts>
    <Bind/>
    <Objects>
      <Dataset id="ds_wdrwTranDtl" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="_chk" type="INT" size="1"/>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="payr_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="ichae_dt" type="STRING" size="256"/>
          <Column id="ichae_limit_gunsu" type="STRING" size="256"/>
          <Column id="mon_pay_amt" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="inv_gunsu" type="STRING" size="256"/>
          <Column id="inv_dt" type="STRING" size="256"/>
          <Column id="wdrw_req_amt" type="STRING" size="256"/>
          <Column id="bank_cd" type="STRING" size="256"/>
          <Column id="bank_nm" type="STRING" size="256"/>
          <Column id="bank_accnt_no" type="STRING" size="256"/>
          <Column id="idn_no" type="STRING" size="256"/>
          <Column id="del_stat" type="STRING" size="256"/>
          <Column id="bank_filin_brkdn" type="STRING" size="256"/>
          <Column id="inv_no" type="STRING" size="256"/>
          <Column id="old_mid" type="STRING" size="256"/>
          <Column id="sync_no" type="STRING" size="256"/>
          <Column id="cl" type="STRING" size="256"/>
          <Column id="note" type="STRING" size="256"/>
          <Column id="wdrw_req_yn" type="STRING" size="256"/>
          <Column id="reg_man" type="STRING" size="256"/>
          <Column id="reg_dm" type="STRING" size="256"/>
          <Column id="wdrw_req_dt" type="STRING" size="256"/>
          <Column id="wdrw_req_stat" type="STRING" size="256"/>
          <Column id="gubun" type="STRING" size="256"/>
          <Column id="real_wdrw_req_stat" type="STRING" size="256"/>
          <Column id="app_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_tmp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="_chk" type="INT" size="1"/>
          <Column id="page_indx" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="payr_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="ichae_dt" type="STRING" size="256"/>
          <Column id="ichae_limit_gunsu" type="STRING" size="256"/>
          <Column id="mon_pay_amt" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="inv_gunsu" type="STRING" size="256"/>
          <Column id="inv_dt" type="STRING" size="256"/>
          <Column id="wdrw_req_amt" type="STRING" size="256"/>
          <Column id="bank_cd" type="STRING" size="256"/>
          <Column id="bank_nm" type="STRING" size="256"/>
          <Column id="bank_accnt_no" type="STRING" size="256"/>
          <Column id="idn_no" type="STRING" size="256"/>
          <Column id="del_stat" type="STRING" size="256"/>
          <Column id="bank_filin_brkdn" type="STRING" size="256"/>
          <Column id="inv_no" type="STRING" size="256"/>
          <Column id="old_mid" type="STRING" size="256"/>
          <Column id="sync_no" type="STRING" size="256"/>
          <Column id="cl" type="STRING" size="256"/>
          <Column id="note" type="STRING" size="256"/>
          <Column id="wdrw_req_yn" type="STRING" size="256"/>
          <Column id="reg_man" type="STRING" size="256"/>
          <Column id="reg_dm" type="STRING" size="256"/>
          <Column id="wdrw_req_dt" type="STRING" size="256"/>
          <Column id="wdrw_req_stat" type="STRING" size="256"/>
          <Column id="gubun" type="STRING" size="256"/>
          <Column id="real_wdrw_req_stat" type="STRING" size="256"/>
          <Column id="app_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmsList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="old_mid" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="last_pay_no" type="STRING" size="256"/>
          <Column id="cms_join_dt" type="STRING" size="256"/>
          <Column id="yenche_stat" type="STRING" size="256"/>
          <Column id="inv_gunsu" type="STRING" size="256"/>
          <Column id="wdrw_req_amt" type="STRING" size="256"/>
          <Column id="stat" type="STRING" size="256"/>
          <Column id="imps_nm" type="STRING" size="256"/>
          <Column id="imps_nm2" type="STRING" size="256"/>
          <Column id="bank_nm" type="STRING" size="256"/>
          <Column id="bank_accnt_no" type="STRING" size="256"/>
          <Column id="bank_filin_brkdn" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="inv_dt" type="STRING" size="256"/>
          <Column id="card_nm" type="STRING" size="256"/>
          <Column id="real_card_nm" type="STRING" size="256"/>
          <Column id="card_cd" type="STRING" size="256"/>
          <Column id="card_no" type="STRING" size="256"/>
          <Column id="pay_dt" type="STRING" size="256"/>
          <Column id="expire_date" type="STRING" size="256"/>
          <Column id="install_perod" type="STRING" size="256"/>
          <Column id="kcc_snd_cd" type="STRING" size="256"/>
          <Column id="auth_no" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="inv_stt_dt" type="STRING" size="256"/>
          <Column id="inv_end_dt" type="STRING" size="256"/>
          <Column id="wdrw_gubun" type="STRING" size="256"/>
          <Column id="gubun_fg" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cardList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="old_mid" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="last_pay_no" type="STRING" size="256"/>
          <Column id="cms_join_dt" type="STRING" size="256"/>
          <Column id="yenche_stat" type="STRING" size="256"/>
          <Column id="inv_gunsu" type="STRING" size="256"/>
          <Column id="wdrw_req_amt" type="STRING" size="256"/>
          <Column id="stat" type="STRING" size="256"/>
          <Column id="imps_nm" type="STRING" size="256"/>
          <Column id="imps_nm2" type="STRING" size="256"/>
          <Column id="bank_nm" type="STRING" size="256"/>
          <Column id="bank_accnt_no" type="STRING" size="256"/>
          <Column id="bank_filin_brkdn" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="inv_dt" type="STRING" size="256"/>
          <Column id="card_nm" type="STRING" size="256"/>
          <Column id="real_card_nm" type="STRING" size="256"/>
          <Column id="card_cd" type="STRING" size="256"/>
          <Column id="card_no" type="STRING" size="256"/>
          <Column id="pay_dt" type="STRING" size="256"/>
          <Column id="expire_date" type="STRING" size="256"/>
          <Column id="install_perod" type="STRING" size="256"/>
          <Column id="kcc_snd_cd" type="STRING" size="256"/>
          <Column id="auth_no" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sttcCmsSumList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="gbn" type="STRING" size="256"/>
          <Column id="wdrw" type="STRING" size="256"/>
          <Column id="pay" type="STRING" size="256"/>
          <Column id="wdrw_err" type="STRING" size="256"/>
          <Column id="new_tot" type="STRING" size="256"/>
          <Column id="new_amt" type="STRING" size="256"/>
          <Column id="new_per" type="STRING" size="256"/>
          <Column id="yuji_tot" type="STRING" size="256"/>
          <Column id="yuji" type="STRING" size="256"/>
          <Column id="yuji_per" type="STRING" size="256"/>
          <Column id="charge" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sttcCmsDtlList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="cnt" type="STRING" size="256"/>
          <Column id="wdrw_charge" type="STRING" size="256"/>
          <Column id="wdrw_amt" type="STRING" size="256"/>
          <Column id="real_amt" type="STRING" size="256"/>
          <Column id="new_cnt" type="STRING" size="256"/>
          <Column id="yuji_cnt" type="STRING" size="256"/>
          <Column id="new_amt" type="STRING" size="256"/>
          <Column id="yuji_amt" type="STRING" size="256"/>
          <Column id="pay_charge" type="STRING" size="256"/>
          <Column id="charge" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cardBatchList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="old_mid" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="last_pay_no" type="STRING" size="256"/>
          <Column id="cms_join_dt" type="STRING" size="256"/>
          <Column id="yenche_stat" type="STRING" size="256"/>
          <Column id="inv_gunsu" type="STRING" size="256"/>
          <Column id="wdrw_req_amt" type="STRING" size="256"/>
          <Column id="stat" type="STRING" size="256"/>
          <Column id="imps_nm" type="STRING" size="256"/>
          <Column id="imps_nm2" type="STRING" size="256"/>
          <Column id="bank_nm" type="STRING" size="256"/>
          <Column id="bank_accnt_no" type="STRING" size="256"/>
          <Column id="bank_filin_brkdn" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="inv_dt" type="STRING" size="256"/>
          <Column id="card_nm" type="STRING" size="256"/>
          <Column id="real_card_nm" type="STRING" size="256"/>
          <Column id="card_cd" type="STRING" size="256"/>
          <Column id="card_no" type="STRING" size="256"/>
          <Column id="pay_dt" type="STRING" size="256"/>
          <Column id="expire_date" type="STRING" size="256"/>
          <Column id="install_perod" type="STRING" size="256"/>
          <Column id="kcc_snd_cd" type="STRING" size="256"/>
          <Column id="auth_no" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sttcCardDtlList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="cnt" type="STRING" size="256"/>
          <Column id="wdrw_charge" type="STRING" size="256"/>
          <Column id="wdrw_amt" type="STRING" size="256"/>
          <Column id="real_amt" type="STRING" size="256"/>
          <Column id="new_cnt" type="STRING" size="256"/>
          <Column id="yuji_cnt" type="STRING" size="256"/>
          <Column id="new_amt" type="STRING" size="256"/>
          <Column id="yuji_amt" type="STRING" size="256"/>
          <Column id="pay_charge" type="STRING" size="256"/>
          <Column id="charge" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sttcCardSumList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="dept_nm" type="STRING" size="256"/>
          <Column id="emple_nm" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="old_mid" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="last_pay_no" type="STRING" size="256"/>
          <Column id="cms_join_dt" type="STRING" size="256"/>
          <Column id="yenche_stat" type="STRING" size="256"/>
          <Column id="inv_gunsu" type="STRING" size="256"/>
          <Column id="wdrw_req_amt" type="STRING" size="256"/>
          <Column id="stat" type="STRING" size="256"/>
          <Column id="imps_nm" type="STRING" size="256"/>
          <Column id="imps_nm2" type="STRING" size="256"/>
          <Column id="bank_nm" type="STRING" size="256"/>
          <Column id="bank_accnt_no" type="STRING" size="256"/>
          <Column id="bank_filin_brkdn" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="inv_dt" type="STRING" size="256"/>
          <Column id="card_nm" type="STRING" size="256"/>
          <Column id="real_card_nm" type="STRING" size="256"/>
          <Column id="card_cd" type="STRING" size="256"/>
          <Column id="card_no" type="STRING" size="256"/>
          <Column id="pay_dt" type="STRING" size="256"/>
          <Column id="expire_date" type="STRING" size="256"/>
          <Column id="install_perod" type="STRING" size="256"/>
          <Column id="kcc_snd_cd" type="STRING" size="256"/>
          <Column id="auth_no" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_apclCanc" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="state" type="STRING" size="256"/>
          <Column id="inv_dt" type="STRING" size="256"/>
          <Column id="mmdd" type="STRING" size="256"/>
          <Column id="wdrw_gubun" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <ExportObject id="ExportObject00" exporttype="0" exporteventtype="itemrecord" onexport="ExportObject00_onexport"/>
    </Objects>
    <InitValue/>
    <Script type="xscript4.0"><![CDATA[/********************************************************************************************/
/* 1. Include Library include, variables Declaration 영역                                  */
/********************************************************************************************/
include "LIB::lib_All.xjs";

var current_tabindex = 0; // 조회전 현재인덱스값 저장
var gubun_fg = "";        // 조회전 현재 구분 플래그값 저장

var wdrwHanAmt = 0;
var impsHanAmt = 0;

var tab_cms = tab_00.cms;
var tab_card = tab_00.card;
var tab_sttc = tab_00.sttc;
var tab_cardBatch = tab_00.card_batch;

var result = "";

//권한
var rgsnYn; //등록권한
var inqYn; //조회권한
var amntYn; //수정권한
var dltnYn; //삭제권한
var pritYn; //출력권한
var xlsYn; //엑셀권한
var athrPpupYn; //팝업오픈권한
var xlsRrnoYn; //엑셀 개인정보 권한 여부 

var gvMenuId;  // 프로그램 로그 추가 2018.01.08
/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리                                           	*/
/********************************************************************************************/
function DL410800_onload(obj:Form, e:LoadEventInfo)
{
	///////////////////////////////////////////////////////////////////////////////////////////
	// 프로그램 로그 추가 2018.01.08 정승철
	gvMenuId = GV_LOGMENUID;
	///////////////////////////////////////////////////////////////////////////////////////////
	
	gfn_initForm(obj);
	gfn_createPagingDataset(obj); // 페이징처리 위한 데이터셋 설정;
	
	fn_setAthrPgmBtn();
	
	fn_init();
}

/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
function fn_callBack(svcid, errcd, errmsg) 
{
	if (errcd != 0) {
	    switch (svcid) {
			case "srchWdrwHstr":
			break;
			case "updateApclCanc":
			break;
	    }
		return false;
	} else {
		switch (svcid) {		
			case "srchWdrwHstr":
			if (tab_00.tabindex == 0) {
				//신청전으로전환 버튼 활성화여부 제어
				fn_chkCancBtn();
				//라벨세팅
				fn_setAmt();
			} else if (tab_00.tabindex == 1) {
				//신청전으로전환 버튼 활성화여부 제어
				fn_chkCancBtn();
				//라벨세팅
				fn_setAmt();
			} else if (tab_00.tabindex == 3) {
				//라벨세팅
				fn_setAmt();
			}
			break;
			case "updateApclCanc":
			//파일삭제실패 여부확인
			if(result != "complete") {
				alert("파일삭제가 이루어지지 않았습니다.")
			}
			//재조회..
			fn_commSearch(gfn_getCommTypeInit(), "srchWdrwHstr"); // 조회
			break;
		}
	}
}

/********************************************************************************************/
/**   4. Validation 처리                                                                   	*/
/********************************************************************************************/
function fn_preSearch(sType, svcid) {
    var return_bool = false;
    switch(svcid) {
        case "srchWdrwHstr":
        var wdrw_gubun = "";
        var gubun_fg = "";
		var inv_stt_dt = "";
		var inv_end_dt = "";
		if (tab_00.tabindex == 0) {
			ds_cmsList.keystring = "";
			wdrw_gubun = "";
		} else if (tab_00.tabindex == 1) {
			ds_cardList.keystring = "";
			wdrw_gubun = "Card";
		} else if (tab_00.tabindex == 2) {
			//탭내부 조건추가
			if (tab_00.sttc.rdo_sttc_gubun.value == "cms")  {
				ds_sttcCmsSumList.keystring = "";
				ds_sttcCmsDtlList.keystring = "";
				gubun_fg = "CMS";
			} else {
				ds_sttcCardSumList.keystring = "";
				ds_sttcCardDtlList.keystring = "";
				gubun_fg = "CARD";
			}
			wdrw_gubun = "Stats";
		} else if (tab_00.tabindex == 3) {
			ds_cardBatchList.keystring = "";
			wdrw_gubun = "CardBatch";
		}
		
		if (gfn_isNull(cal_sttDt.value)) {
			inv_stt_dt = "pre";
		} else {
			inv_stt_dt = cal_sttDt.value;
		}
		if (gfn_isNull(cal_endDt.value)) {
			inv_end_dt = "pre";
		} else {
			inv_end_dt = cal_endDt.value;
		}
				
		ds_inqCndt.clearData();
		ds_inqCndt.addRow();
		ds_inqCndt.setColumn(0, "inv_stt_dt", inv_stt_dt);
		ds_inqCndt.setColumn(0, "inv_end_dt", inv_end_dt);
		ds_inqCndt.setColumn(0, "wdrw_gubun", wdrw_gubun);
		ds_inqCndt.setColumn(0, "gubun_fg", gubun_fg);
		
		//현재 탭인덱스, 구분값저장
		current_tabindex = tab_00.tabindex; 
		gubun_fg = gubun_fg;       
        
		return_bool = true;
        break;   
    }
	return return_bool;
}

function fn_preSave(svcid, consTyp) {
    var return_bool = false;
    switch(svcid) {
        case "updateApclCanc":
        var stt_dt = cal_sttDt.value+"";
        var mmdd = "";
        var wdrw_gubun = "";
		if (tab_00.tabindex == 0) {
			mmdd = stt_dt.substring(4, 8);
		} else if (tab_00.tabindex == 1) {
			mmdd = cal_sttDt.value+"";
			wdrw_gubun = "Card";
		} 
        
        ds_apclCanc.clearData();
        ds_apclCanc.addRow();
        ds_apclCanc.setColumn(0, "state", "01");
        ds_apclCanc.setColumn(0, "inv_dt", stt_dt);
        ds_apclCanc.setColumn(0, "mmdd", mmdd);
        ds_apclCanc.setColumn(0, "wdrw_gubun", wdrw_gubun);
        return_bool = true;
        break;
    }
    return return_bool;

}
/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)                                                   	*/
/********************************************************************************************/
//조회
function fn_commSearch(sType, searchInfo) {
	
	var szSvcid       = "";
    var szController  = "";
    var szInDs        = "";
    var szOutDs       = "";
    var szParam       = "";
    var szRetCallback = "";
    
    switch(searchInfo) {
        case "srchWdrwHstr":
        if(!fn_preSearch(gfn_getCommTypeInit(),"srchWdrwHstr")) return false;
        
	    szSvcid       = "srchWdrwHstr";
		szController  = "/dlw/cms/wdrw-hstr";
		szInDs        = "ds_input=ds_inqCndt";
		if (tab_00.tabindex == 0) {
			szOutDs   = "ds_cmsList=ds_output";
		} else if (tab_00.tabindex == 1) {
			szOutDs   = "ds_cardList=ds_output";
		} else if (tab_00.tabindex == 2) {
			//탭내부 조건추가
			if (tab_00.sttc.rdo_sttc_gubun.value == "cms")  {
				szOutDs   = "ds_sttcCmsSumList=ds_output2 ds_sttcCmsDtlList=ds_output3";
			} else {
				szOutDs   = "ds_sttcCardSumList=ds_output2 ds_sttcCardDtlList=ds_output3";
			}
		} else if (tab_00.tabindex == 3) {
			szOutDs   = "ds_cardBatchList=ds_output";
		}
		//szOutDs       = "ds_list=ds_output";
		szParam       = "";
		szRetCallback = "fn_callBack";
        break;
    }
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,"","","S",gvMenuId);
}
//저장
function fn_commSave(saveInfo) {

    var szSvcid = ""
    var szController = ""
    var szInDs = ""
    var szOutDs = ""
    var szParam = ""
    var szRetCallback = ""

    switch(saveInfo) {
        case "updateApclCanc":
        if(!fn_preSave("updateApclCanc")) return false;
	    szSvcid       = "updateApclCanc";
		szController  = "/dlw/cms/wdrw-apcl-canc";
		if (tab_00.tabindex == 0) {
			szInDs    = "ds_input=ds_apclCanc ds_input2=ds_cmsList";
		} else if (tab_00.tabindex == 1) {
			szInDs    = "ds_input=ds_apclCanc ds_input2=ds_cardList";
		} 
		szOutDs       = "";
		szParam       = "";
		szRetCallback = "fn_callBack";
        break;
    }

	// 트랜젝션 공통함수 호출
	gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}
/********************************************************************************************/
/**   6. 사용자 함수                                                                   	*/
/********************************************************************************************/
//초기화
function fn_init()
{
	cal_sttDt.value = gfn_getToday();
	cal_endDt.value = gfn_getToday();
	
	tab_00.tabindex = 0;
}

//조회 결과
function fn_postSearch(svcid)
{
    switch(svcid) {
        case "":
		if(ds_list.rowcount < 1) {
			alert("조회 결과가 없습니다.");
		} 
        break;
    }
    return;
}

function fn_chkCancBtn()
{
	if (tab_00.tabindex == 0) {
		if(ds_cmsList.rowcount > 0){
			var stat = ds_cmsList.getColumn(0, "stat");
			if(stat == "신청중") {
				tab_cms.btn_aplcCanc.visible = true;
			} else {
				tab_cms.btn_aplcCanc.visible = false;
			}
		}
	} else if (tab_00.tabindex == 1) {
		if(ds_cardList.rowcount > 0){
			var stat = ds_cardList.getColumn(0, "stat");
			if(stat == "신청중") {
				tab_card.btn_aplcCanc.visible = true;
			} else {
				tab_card.btn_aplcCanc.visible = false;
			}	
		}
	}
}

function fn_setAmt()
{
	var memCnt  = 0;
	var wdrwCnt = 0;
	var wdrwAmt = 0;
	var impsCnt = 0;
	var impsAmt = 0;
	
	var ds_obj = null;
	var tab_obj = null;
	
	if (tab_00.tabindex == 0) {
		ds_obj = ds_cmsList;
		tab_obj = tab_cms;
	} else if (tab_00.tabindex == 1) {
		ds_obj = ds_cardList;
		tab_obj = tab_card;
	} else if (tab_00.tabindex == 3) {
		ds_obj = ds_cardBatchList;
		tab_obj = tab_cardBatch;
	}
	
	for(var i=0;i<ds_obj.rowcount;i++) {
		memCnt++;
		var stat = ds_obj.getColumn(i,"stat");
		var wdrw_req_amt = 0;
		var tmp_wdrw_req_amt = ds_obj.getColumn(i,"wdrw_req_amt");
		if(isNaN(gfn_transNullToNumber(tmp_wdrw_req_amt))){
			wdrw_req_amt = 0;
		} else {
			wdrw_req_amt = gfn_transNullToNumber(tmp_wdrw_req_amt);
		}
		if(stat == "완료") {
			wdrwCnt++;
			wdrwAmt += wdrw_req_amt;
		} else if(stat == "오류") {
			impsCnt ++;
			impsAmt += wdrw_req_amt;
		}
	}
	
	tab_obj.stc_mem_cnt.text = memCnt;
	tab_obj.stc_wdrw_mem_cnt.text = wdrwCnt;
	tab_obj.stc_wdrw_amt.text = gfn_commaStr(wdrwAmt);
	tab_obj.stc_imps_cnt.text = impsCnt;
	tab_obj.stc_imps_amt.text = gfn_commaStr(impsAmt);
	if (tab_00.tabindex == 0) {
	tab_obj.stc_comp_han.text = gfn_commaStr(wdrwHanAmt*wdrwCnt);
	tab_obj.stc_imps_han.text = gfn_commaStr(impsHanAmt*impsCnt);
	}
}
/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
//엑셀버튼 클릭 시
function btn_export_grid_onclick(obj:Button,  e:ClickEventInfo)
{
	ExportObject00.exporttype = ExportTypes.EXCEL;
	
	var sheetName = "WdrwList";
	var fileName = "WdrwList";
	
	if (tab_00.tabindex == 0) {
		sheetName += "(CMS)"
		fileName += "(CMS)_" + gfn_getToday() + ".xlsx";
		ExportObject00.addExportItem(ExportItemTypes.GRID, tab_cms.grd_List, sheetName+"!A1" );
	} else if (tab_00.tabindex == 1) {
		sheetName += "(Card)"
		fileName += "(Card)_" + gfn_getToday() + ".xlsx";
		ExportObject00.addExportItem(ExportItemTypes.GRID, tab_card.grd_List, sheetName+"!A1" );
	} else if (tab_00.tabindex == 2) {
		if (tab_00.sttc.rdo_sttc_gubun.value == "cms")  {
			sheetName += "(SttcCMS)"
			fileName += "(SttcCMS)_" + gfn_getToday() + ".xlsx";
		} else {
			sheetName += "(SttcCard)"
			fileName += "(SttcCard)_" + gfn_getToday() + ".xlsx";
		}
		ExportObject00.addExportItem(ExportItemTypes.GRID, tab_sttc.grd_SumList, sheetName+"!A1" );
		ExportObject00.addExportItem(ExportItemTypes.GRID, tab_sttc.grd_DtlList, sheetName+"!A6" );
	} else if (tab_00.tabindex == 3) {
		sheetName += "(CardBatch)"
		fileName += "(CardBatch)_" + gfn_getToday() + ".xlsx";
		ExportObject00.addExportItem(ExportItemTypes.GRID, tab_cardBatch.grd_List, sheetName+"!A1" );
	}
	
	ExportObject00.activepagename = sheetName;	
	ExportObject00.exportfilename = fileName;
	
	ExportObject00.exportopenmode = "overwrite";
	ExportObject00.exporteventtype = "itemrecord";
	ExportObject00.exportuitype = "statusbar";
	
	ExportObject00.exportsavemode = "save";
	ExportObject00.export();
	
}

//조회버튼 클릭시
function btn_Search_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_commSearch(gfn_getCommTypeInit(), "srchWdrwHstr"); // 조회
}

//통계 구분 클릭시
function rdo_sttc_gubun_onitemchanged(obj:Radio, e:ItemChangeEventInfo)
{
	if (obj.value == "cms") {
		tab_sttc.grd_SumList.binddataset = ds_sttcCmsSumList;
		tab_sttc.grd_DtlList.binddataset = ds_sttcCmsDtlList;
	} else {
		tab_sttc.grd_SumList.binddataset = ds_sttcCardSumList;
		tab_sttc.grd_DtlList.binddataset = ds_sttcCardDtlList;
	}
}

//출력
function btn_export_report_onclick(obj:Button,  e:ClickEventInfo)
{
    alert("개발중입니다.");
}

//파일미완료분
function btn_notCompFile_onclick(obj:Button,  e:ClickEventInfo)
{
	cal_sttDt.value = "";
	cal_endDt.value = "";
	fn_commSearch(gfn_getCommTypeInit(), "srchWdrwHstr"); // 조회
}

function btn_aplcCanc_onclick(obj:Button,  e:ClickEventInfo)
{
	
	if(!confirm("신청취소 하고 해당 파일을 일괄삭제 하시겠습니까?")) return false;
	fn_commSave("updateApclCanc");
}

//헤더클릭
function tab_00_cms_grd_List_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	gfn_grdHeadClick(obj, e);
}

// 권한에 따른 버튼 설정
function fn_setAthrPgmBtn()
{
	gfn_athrPgm(gfn_gdsCd_admin());
	
	
	if (inqYn == "N") {
		btn_Search.visible = false;
	}
	if (xlsYn == "N") {
		btn_excl.visible = false;
	}
}]]></Script>
  </Form>
</FDL>
