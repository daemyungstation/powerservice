<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="frm" classname="frm" inheritanceid="" position="absolute 0 0 989 795" titletext="행사현황 및 분석" onload="frm_onload" scrollbars="none">
    <Layouts>
      <Layout>
        <Tab id="tab_main" taborder="11" position2="absolute l:0 r:0 t:85 b:-3" positiontype="position2" onchanged="Tab_Main_onchanged" tabindex="0" scrollbars="autoboth" style="font:Dotum,9;">
          <Tabpages>
            <Tabpage id="tabpage0" text="행사현황">
              <Layouts>
                <Layout>
                  <Grid id="grd_dlvList" class="grd_list" taborder="0" binddataset="ds_evnt_list" useinputpanel="false" cellsizingtype="col" autofittype="none" onvscrolllastover="grd_dlvList_onvscrolllastover" oncellclick="grd_dlvList_oncellclick" onheadclick="grd_dlvList_onheadclick" oncelldblclick="grd_dlvList_oncelldblclick" onselectchanged="grd_dlvList_onSelectChanged" position2="absolute l:10 r:10 t:10 b:10" positiontype="position2" scrollbars="alwayshorz">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="35"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="153"/>
                          <Column size="60"/>
                          <Column size="70"/>
                          <Column size="104"/>
                          <Column size="80"/>
                          <Column size="150"/>
                          <Column size="80"/>
                          <Column size="166"/>
                          <Column size="80"/>
                          <Column size="60"/>
                          <Column size="80"/>
                          <Column size="60"/>
                          <Column size="60"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="NO"/>
                          <Cell col="1" text="행사시작일" id="dlv_id"/>
                          <Cell col="2" text="행사종료일" id="accnt_no"/>
                          <Cell col="3" text="회원명" id="mem_nm"/>
                          <Cell col="4" text="상품명" id="csmm_prfl_no"/>
                          <Cell col="5" text="신규구분" id="sndg_kind_cd"/>
                          <Cell col="6" text="담당지도사" id="dlv_type_cd"/>
                          <Cell col="7" text="출동지부" id="dlv_stat_cd"/>
                          <Cell col="8" text="지역" id="dlv_dsps_rsn_nm"/>
                          <Cell col="9" text="행사장소" id="dlv_no"/>
                          <Cell col="10" text="장법" id="dsps_mthd_cd"/>
                          <Cell col="11" text="장지" id="dsps_rsn_cd"/>
                          <Cell col="12" text="입관일" id="dlv_dsps_dt"/>
                          <Cell col="13" text="입관시간" id="amnd_id"/>
                          <Cell col="14" text="발인일" id="amnt_dttm"/>
                          <Cell col="15" text="발인시간"/>
                          <Cell col="16" text="종교"/>
                        </Band>
                        <Band id="body">
                          <Cell style="color:expr:(page_indx ==&quot;New&quot;?&quot;red&quot;:&quot;black&quot;);color2:expr:(page_indx ==&quot;New&quot;?&quot;red&quot;:&quot;black&quot;);font:expr:(page_indx ==&quot;New&quot;?&quot;Dotum,8,blod&quot;:&quot;Dotum,8&quot;);selectcolor:expr:(page_indx ==&quot;New&quot;?&quot;red&quot;:&quot;black&quot;);selectfont:expr:(page_indx ==&quot;New&quot;?&quot;Dotum,8,blod&quot;:&quot;Dotum,8&quot;);" expr="currow+1"/>
                          <Cell col="1" displaytype="date" text="bind:event_proc_day"/>
                          <Cell col="2" displaytype="date" text="bind:event_comp_day"/>
                          <Cell col="3" text="bind:mem_nm" expr="expr:gfn_SetNameGrdSecu(mem_nm)"/>
                          <Cell col="4" style="align:left;" text="bind:prod_nm"/>
                          <Cell col="5" text="bind:stat"/>
                          <Cell col="6" text="bind:evt_mngr_nm"/>
                          <Cell col="7" style="align:center;" text="bind:branch_nm"/>
                          <Cell col="8" style="align:center;" text="bind:etc_loc_nm"/>
                          <Cell col="9" style="align:left;" text="bind:event_place_cl"/>
                          <Cell col="10" text="bind:bur_cre_cl"/>
                          <Cell col="11" text="bind:cemetery"/>
                          <Cell col="12" displaytype="date" text="bind:val7" mask="yyyy-MM-dd"/>
                          <Cell col="13" displaytype="text" text="bind:val_hm" mask="##:##"/>
                          <Cell col="14" displaytype="date" text="bind:cfn_dt"/>
                          <Cell col="15" displaytype="text" text="bind:cfn_hm" mask="##:##"/>
                          <Cell col="16" style="align:left;" text="bind:brplot"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage1" text="행사분석(종합분석)">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" class="grd_list" taborder="0" binddataset="ds_t1_list" useinputpanel="false" cellsizingtype="col" autofittype="col" onvscrolllastover="grd_dlvList_onvscrolllastover" oncellclick="grd_dlvList_oncellclick" onheadclick="grd_dlvList_onheadclick" onselectchanged="grd_dlvList_onSelectChanged" position2="absolute l:1.01% w:23.91% t:1.43% h:51.5%" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="장법" id="dlv_id"/>
                          <Cell col="1" text="건수" id="accnt_no"/>
                          <Cell col="2" text="비율" id="mem_nm"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:cl" suppress="1" suppressalign="middle"/>
                          <Cell col="1" displaytype="number" text="bind:cnt" suppress="2" suppressalign="middle"/>
                          <Cell col="2" text="bind:pct" suppress="2" suppressalign="middle"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="grd_list5" class="grd_list" taborder="1" binddataset="ds_t1_list5" useinputpanel="false" cellsizingtype="col" autofittype="col" onvscrolllastover="grd_dlvList_onvscrolllastover" oncellclick="grd_dlvList_oncellclick" onheadclick="grd_dlvList_onheadclick" onselectchanged="grd_dlvList_onSelectChanged" position2="absolute l:1.01% w:23.91% t:54.35% h:44.37%" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="직영CP" id="dlv_id"/>
                          <Cell col="1" text="건수" id="accnt_no"/>
                          <Cell col="2" text="비율" id="mem_nm"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:cl" suppress="1" suppressalign="middle"/>
                          <Cell col="1" displaytype="number" text="bind:cnt" suppress="2" suppressalign="middle"/>
                          <Cell col="2" text="bind:pct" suppress="2" suppressalign="middle"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="grd_list2" class="grd_list" taborder="2" binddataset="ds_t1_list2" useinputpanel="false" cellsizingtype="col" autofittype="col" onvscrolllastover="grd_dlvList_onvscrolllastover" oncellclick="grd_dlvList_oncellclick" onheadclick="grd_dlvList_onheadclick" onselectchanged="grd_dlvList_onSelectChanged" position2="absolute l:25.73% w:23.91% t:1.43% h:51.5%" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="80"/>
                          <Column size="69"/>
                          <Column size="78"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="신규구분" id="dlv_id"/>
                          <Cell col="1" text="건수" id="accnt_no"/>
                          <Cell col="2" text="비율" id="mem_nm"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:cl" suppress="1" suppressalign="middle"/>
                          <Cell col="1" displaytype="number" text="bind:cnt" suppress="2" suppressalign="middle"/>
                          <Cell col="2" text="bind:pct" suppress="2" suppressalign="middle"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="grd_list6" class="grd_list" taborder="3" binddataset="ds_t1_list6" useinputpanel="false" cellsizingtype="col" autofittype="col" onvscrolllastover="grd_dlvList_onvscrolllastover" oncellclick="grd_dlvList_oncellclick" onheadclick="grd_dlvList_onheadclick" onselectchanged="grd_dlvList_onSelectChanged" position2="absolute l:25.73% w:23.91% t:54.35% h:44.37%" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="종교별" id="dlv_id"/>
                          <Cell col="1" text="건수" id="accnt_no"/>
                          <Cell col="2" text="비율" id="mem_nm"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:cl" suppress="1" suppressalign="middle"/>
                          <Cell col="1" displaytype="number" text="bind:cnt" suppress="2" suppressalign="middle"/>
                          <Cell col="2" displaytype="text" text="bind:pct" suppress="2" suppressalign="middle"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="grd_list3" class="grd_list" taborder="4" binddataset="ds_t1_list3" useinputpanel="false" cellsizingtype="col" autofittype="col" onvscrolllastover="grd_dlvList_onvscrolllastover" oncellclick="grd_dlvList_oncellclick" onheadclick="grd_dlvList_onheadclick" onselectchanged="grd_dlvList_onSelectChanged" position2="absolute l:50.46% w:23.91% t:1.43% h:97.15%" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="지부" id="dlv_id"/>
                          <Cell col="1" text="건수" id="accnt_no"/>
                          <Cell col="2" text="비율" id="mem_nm"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:cl" suppress="1" suppressalign="middle"/>
                          <Cell col="1" displaytype="number" text="bind:cnt" suppress="2" suppressalign="middle"/>
                          <Cell col="2" text="bind:pct" suppress="2" suppressalign="middle"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="grd_list4" class="grd_list" taborder="5" binddataset="ds_t1_list4" useinputpanel="false" cellsizingtype="col" autofittype="col" onvscrolllastover="grd_dlvList_onvscrolllastover" oncellclick="grd_dlvList_oncellclick" onheadclick="grd_dlvList_onheadclick" onselectchanged="grd_dlvList_onSelectChanged" position2="absolute l:75.18% w:23.91% t:1.43% h:97.15%" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell text="지역" id="dlv_id"/>
                          <Cell col="1" text="건수" id="accnt_no"/>
                          <Cell col="2" text="비율" id="mem_nm"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:cl" suppress="1" suppressalign="middle"/>
                          <Cell col="1" displaytype="number" text="bind:cnt" suppress="2" suppressalign="middle"/>
                          <Cell col="2" text="bind:pct" suppress="2" suppressalign="middle"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage2" text="행사분석(상품분류별,지부별)">
              <Layouts>
                <Layout>
                  <Grid id="grid_branch" taborder="0" useinputpanel="false" binddataset="ds_t2_list" position2="absolute l:10 r:10 t:10 b:10" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Col size="80"/>
                        </Columns>
                        <Rows>
                          <Row band="head" size="24"/>
                          <Row band="body" size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell col="0" displaytype="normal" text="gubun"/>
                        </Band>
                        <Band id="body">
                          <Cell col="0" displaytype="normal" text="bind:gubun"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage3" text="행사분석(CP별, 상품분류별)">
              <Layouts>
                <Layout>
                  <Grid id="grid_emple" class="grd_list" taborder="0" binddataset="ds_t3_list" scrollbars="alwayshorz" useinputpanel="false" cellsizingtype="col" onvscrolllastover="grd_dlvList_onvscrolllastover" oncellclick="grd_dlvList_oncellclick" onheadclick="grd_dlvList_onheadclick" oncelldblclick="grd_dlvList_oncelldblclick" onselectchanged="grd_dlvList_onSelectChanged" position2="absolute l:10 r:10 t:10 b:10" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Col size="80"/>
                        </Columns>
                        <Rows>
                          <Row band="head" size="24"/>
                          <Row band="body" size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell col="0" displaytype="normal" text="gubun"/>
                        </Band>
                        <Band id="body">
                          <Cell col="0" displaytype="normal" text="bind:gubun"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage5" text="행사 후 유지현황">
              <Layouts>
                <Layout>
                  <Grid id="grd_Uji" class="grd_list" taborder="0" binddataset="ds_evt_uji" scrollbars="alwayshorz" useinputpanel="false" cellsizingtype="col" onvscrolllastover="grd_dlvList_onvscrolllastover" oncellclick="grd_dlvList_oncellclick" onheadclick="grd_onheadclick" oncelldblclick="grd_dlvList_oncelldblclick" onselectchanged="grd_dlvList_onSelectChanged" position2="absolute l:10 r:10 t:10 b:10" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="42"/>
                          <Column size="89"/>
                          <Column size="90"/>
                          <Column size="88"/>
                          <Column size="91"/>
                          <Column size="62"/>
                          <Column size="125"/>
                          <Column size="85"/>
                          <Column size="94"/>
                          <Column size="181"/>
                          <Column size="85"/>
                          <Column size="114"/>
                          <Column size="153"/>
                          <Column size="169"/>
                          <Column size="66"/>
                          <Column size="62"/>
                          <Column size="67"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="normal" text="순번"/>
                          <Cell col="1" displaytype="normal" text="행사시작일"/>
                          <Cell col="2" displaytype="normal" text="행사종료일"/>
                          <Cell col="3" displaytype="normal" text="회원번호"/>
                          <Cell col="4" displaytype="normal" text="회원명"/>
                          <Cell col="5" displaytype="normal" text="상품코드"/>
                          <Cell col="6" displaytype="normal" text="상품명"/>
                          <Cell col="7" displaytype="normal" text="지도사"/>
                          <Cell col="8" displaytype="normal" text="출동지부"/>
                          <Cell col="9" displaytype="normal" text="행사장소"/>
                          <Cell col="10" displaytype="normal" text="기존회원코드"/>
                          <Cell col="11" text="B2B회사명"/>
                          <Cell col="12" displaytype="normal" text="기존상품"/>
                          <Cell col="13" text="최종납입"/>
                          <Cell col="14" displaytype="normal" text="회원상태"/>
                          <Cell col="15" displaytype="normal" text="납입회차"/>
                          <Cell col="16" displaytype="normal" text="연체회차"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="normal" text="bind:cnt" expr="currow+1"/>
                          <Cell col="1" displaytype="date" text="bind:event_proc_day"/>
                          <Cell col="2" displaytype="date" text="bind:event_comp_day"/>
                          <Cell col="3" displaytype="normal" text="bind:accnt_no"/>
                          <Cell col="4" displaytype="normal" text="bind:mem_nm" expr="expr:gfn_SetNameGrdSecu(mem_nm)"/>
                          <Cell col="5" displaytype="normal" text="bind:prod_cd"/>
                          <Cell col="6" displaytype="normal" style="align:left;" text="bind:prod_nm"/>
                          <Cell col="7" displaytype="normal" text="bind:val6"/>
                          <Cell col="8" displaytype="normal" text="bind:work_dept"/>
                          <Cell col="9" displaytype="normal" style="align:left;" text="bind:event_place"/>
                          <Cell col="10" displaytype="normal" text="bind:evt_accno"/>
                          <Cell col="11" style="align:left;" text="bind:b2bcom"/>
                          <Cell col="12" displaytype="normal" style="align:left;" text="bind:prod_nm_bf"/>
                          <Cell col="13" style="align:left;" text="bind:last_pay"/>
                          <Cell col="14" displaytype="normal" text="bind:kstbit"/>
                          <Cell col="15" displaytype="normal" text="bind:no"/>
                          <Cell col="16" displaytype="normal" text="bind:yen_che"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="stc_27" class="sta_workSrcBg" position2="absolute l:0 r:0 t:7 h:71" positiontype="position2"/>
        <Edit id="edt_cpdcTitlNm08" taborder="18" position="absolute 756 -531 889 -511"/>
        <Static id="stc_03" text="지역" class="sta_workSrcLabel1" position="absolute 343 18 376 38"/>
        <Combo id="cbo_loc" taborder="3" position="absolute 383 18 450 38" codecolumn="codecolumn" datacolumn="datacolumn" onitemchanged="cbo_loc_onitemchanged">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">강원</Col>
                <Col id="datacolumn">강원</Col>
              </Row>
              <Row>
                <Col id="codecolumn">경기</Col>
                <Col id="datacolumn">경기</Col>
              </Row>
              <Row>
                <Col id="codecolumn">경남</Col>
                <Col id="datacolumn">경남</Col>
              </Row>
              <Row>
                <Col id="codecolumn">경북</Col>
                <Col id="datacolumn">경북</Col>
              </Row>
              <Row>
                <Col id="codecolumn">서울</Col>
                <Col id="datacolumn">서울</Col>
              </Row>
              <Row>
                <Col id="codecolumn">인천</Col>
                <Col id="datacolumn">인천</Col>
              </Row>
              <Row>
                <Col id="codecolumn">전남</Col>
                <Col id="datacolumn">전남</Col>
              </Row>
              <Row>
                <Col id="codecolumn">전북</Col>
                <Col id="datacolumn">전북</Col>
              </Row>
              <Row>
                <Col id="codecolumn">제주</Col>
                <Col id="datacolumn">제주</Col>
              </Row>
              <Row>
                <Col id="codecolumn">충남 </Col>
                <Col id="datacolumn">충남</Col>
              </Row>
              <Row>
                <Col id="codecolumn">충북</Col>
                <Col id="datacolumn">충북</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="stc_05" text="CP" class="sta_workSrcLabel1" position="absolute 610 18 637 38"/>
        <Edit id="edt_mngr_cd" taborder="5" position="absolute 645 17 719 38" readonly="false" enable="false"/>
        <Edit id="edt_mngr_nm" taborder="6" position="absolute 720 17 809 38" readonly="false" enable="false"/>
        <Button id="btn_01" taborder="7" class="btn_workSrcPop" position="absolute 811 17 831 37" onclick="fn_openPopup"/>
        <Button id="btn_Search" taborder="8" onclick="btn_Search_onclick" class="btn_WF_Search" tooltiptext="조회" style="shadow:drop 0,0 0 #00000033;" position2="absolute r:83 w:72 t:17 h:20" positiontype="position2"/>
        <Button id="btn_Init00" taborder="9" onclick="btn_Init_onclick" class="btn_WF_Return" tooltiptext="초기화" position2="absolute r:9 w:72 t:17 h:20" positiontype="position2"/>
        <Combo id="cbo_dt_typ" taborder="0" codecolumn="codecolumn" datacolumn="datacolumn" index="0" position="absolute 15 18 122 38" value="01" text="행사시작일자">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">01</Col>
                <Col id="datacolumn">행사시작일자</Col>
              </Row>
              <Row>
                <Col id="codecolumn">02</Col>
                <Col id="datacolumn">행사종료일자</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="sta_Dash00" text="~" position="absolute 224 22 237 37"/>
        <Calendar id="stt_dt" taborder="1" dateformat="yyyy-MM-dd" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" position="absolute 125 18 220 38"/>
        <Calendar id="end_dt" taborder="2" dateformat="yyyy-MM-dd" onchanged="cal_00_onchanged" oneditclick="cal_00_oneditclick" position="absolute 238 18 333 38"/>
        <Static id="Static01" position="absolute 323 8 333 44" style="background:#ff9900ff;" visible="false" text="10"/>
        <Static id="Static02" visible="false" position="absolute 30 8 280 19" style="background:#ff9900ff;" text="11px"/>
        <Static id="Static03" text="10" visible="false" position="absolute 373 7 383 43" style="background:#ff9900ff;"/>
        <Static id="stc_00" text="지부" class="sta_workSrcLabel1" position="absolute 460 18 493 38"/>
        <Combo id="cbo_jibu" taborder="4" innerdataset="@ds_branch_list" codecolumn="cd" datacolumn="cd_nm" position="absolute 500 18 607 38"/>
        <Static id="Static04" text="10" visible="false" position="absolute 448 8 458 44" style="background:#ff9900ff;"/>
        <Static id="Static05" text="10" visible="false" position="absolute 490 7 500 43" style="background:#ff9900ff;"/>
        <Static id="Static06" text="10" visible="false" position="absolute 607 7 617 43" style="background:#ff9900ff;"/>
        <Static id="Static07" text="10" visible="false" position="absolute 635 6 645 42" style="background:#ff9900ff;"/>
        <Static id="Static08" text="11px" visible="false" position="absolute 38 38 288 49" style="background:#ff9900ff;"/>
        <Button id="btn_excel" taborder="10" text="엑셀" onclick="fn_excel_data" class="btn_WF" position2="absolute r:9 w:72 t:43 h:20" positiontype="position2" tooltiptext="엑셀" style="padding:0 0 0 0;"/>
        <Static id="sta_cnt" position="absolute 680 69 719 95" style="color:blue;align:right middle;font:Dotum,9,bold;"/>
        <Edit id="edt_accnt_no" taborder="19" onkeydown="edt_accnt_onkeydown" class="edt_clssEnable" position="absolute 86 49 207 71"/>
        <Button id="btn_accnt_no" taborder="20" onclick="btn_accnt_onclick" class="btn_workSrcPop" position="absolute 210 50 232 70"/>
        <Static id="stc_01" text="상품" class="sta_workSrcLabel1" position="absolute 343 50 376 70"/>
        <Static id="stc_02" text="회원번호" class="sta_workSrcLabel1" position="absolute 17 50 76 70" style="align:left middle;"/>
        <Edit id="edt_prod_cd" taborder="21" imemode="alpha" inputmode="upper" onkeydown="edt_onkeydown" class="edt_clssEnable1" style="color:black;font:Dotum,9;" anchor="default" position="absolute 382 49 420 69" positiontype="position"/>
        <Edit id="edt_prod_nm" taborder="22" onkeydown="edt_onkeydown" class="edt_clssEnable1" style="color:black;font:Dotum,9;" anchor="default" position="absolute 424 49 614 69" positiontype="position"/>
        <Button id="btn_00" taborder="23" onclick="fn_ProdPopup" class="btn_workSrcPop" position="absolute 616 49 636 69"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="edt_accnt_no" propid="value" datasetid="ds_accnt_info" columnid="accnt_no"/>
      <BindItem id="item4" compid="edt_prod_cd" propid="value" datasetid="ds_prod" columnid="prod_cd"/>
      <BindItem id="item5" compid="edt_prod_nm" propid="value" datasetid="ds_prod" columnid="prod_nm"/>
    </Bind>
    <Objects>
      <ExportObject id="ExportObject00" exporttype="0" exporteventtype="itemrecord" onexport="ExportObject00_onexport"/>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inqCndt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="dt_typ" type="STRING" size="256"/>
          <Column id="stt_dt" type="STRING" size="256"/>
          <Column id="end_dt" type="STRING" size="256"/>
          <Column id="dept_cd" type="STRING" size="256"/>
          <Column id="event" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="event_yn" type="STRING" size="256"/>
          <Column id="event_comp_day" type="STRING" size="256"/>
          <Column id="cncl_work" type="STRING" size="256"/>
          <Column id="dead_man_nm" type="STRING" size="256"/>
          <Column id="sangju_nm" type="STRING" size="256"/>
          <Column id="cp_nm" type="STRING" size="256"/>
          <Column id="event_place" type="STRING" size="256"/>
          <Column id="branch_cl" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
          <Column id="evt_seq" type="STRING" size="256"/>
          <Column id="etc_loc" type="STRING" size="256"/>
          <Column id="jibu" type="STRING" size="256"/>
          <Column id="mngr_cd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_evnt_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cnt" type="STRING" size="256"/>
          <Column id="event_proc_day" type="STRING" size="256"/>
          <Column id="event_comp_day" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="stat" type="STRING" size="256"/>
          <Column id="evt_mngr_nm" type="STRING" size="256"/>
          <Column id="branch_nm" type="STRING" size="256"/>
          <Column id="etc_loc_nm" type="STRING" size="256"/>
          <Column id="event_place_cl" type="STRING" size="256"/>
          <Column id="bur_cre_cl" type="STRING" size="256"/>
          <Column id="cemetery" type="STRING" size="256"/>
          <Column id="val7" type="STRING" size="256"/>
          <Column id="val_hm" type="STRING" size="256"/>
          <Column id="cfn_dt" type="STRING" size="256"/>
          <Column id="cfn_hm" type="STRING" size="256"/>
          <Column id="brplot" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_evt_loc" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_mngr_cd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cd_nm" type="STRING" size="256"/>
          <Column id="adtl_cd" type="STRING" size="256"/>
          <Column id="adtl_cd_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_event_man" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cnt" type="STRING" size="256"/>
          <Column id="gubun" type="STRING" size="256"/>
          <Column id="mngr_nm" type="STRING" size="256"/>
          <Column id="idn_no" type="STRING" size="256"/>
          <Column id="cell" type="STRING" size="256"/>
          <Column id="mngr_cd" type="STRING" size="256"/>
          <Column id="job_duty" type="STRING" size="256"/>
          <Column id="evt_mngr_cd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_branch_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_t1_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cl" type="STRING" size="256"/>
          <Column id="cnt" type="STRING" size="256"/>
          <Column id="pct" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_t1_list2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cl" type="STRING" size="256"/>
          <Column id="cnt" type="STRING" size="256"/>
          <Column id="pct" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_t1_list3" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cl" type="STRING" size="256"/>
          <Column id="cnt" type="STRING" size="256"/>
          <Column id="pct" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_t1_list4" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cl" type="STRING" size="256"/>
          <Column id="cnt" type="STRING" size="256"/>
          <Column id="pct" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_t1_list5" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cl" type="STRING" size="256"/>
          <Column id="cnt" type="STRING" size="256"/>
          <Column id="pct" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_t1_list6" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cl" type="STRING" size="256"/>
          <Column id="cnt" type="STRING" size="256"/>
          <Column id="pct" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_t2_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="gubun" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_t2_head" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="branch_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_t3_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="gubun" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_t3_head" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="gubun_nm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_prodList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="page_indx" type="STRING" size="6"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="mon_pay_amt" type="STRING" size="256"/>
          <Column id="expr_no" type="STRING" size="256"/>
          <Column id="prod_amt" type="STRING" size="256"/>
          <Column id="use_cnt" type="STRING" size="256"/>
          <Column id="reg_dm" type="STRING" size="256"/>
          <Column id="prod_cl" type="STRING" size="256"/>
          <Column id="prod_cl_nm" type="STRING" size="256"/>
          <Column id="sale_gubn" type="STRING" size="256"/>
          <Column id="sale_cl" type="STRING" size="256"/>
          <Column id="sale_close_day" type="STRING" size="256"/>
          <Column id="prod_save_point" type="STRING" size="256"/>
          <Column id="pay_type" type="STRING" size="256"/>
          <Column id="pay_type_nm" type="STRING" size="256"/>
          <Column id="join_type" type="STRING" size="256"/>
          <Column id="join_type_nm" type="STRING" size="256"/>
          <Column id="join_gift_card_sort" type="STRING" size="256"/>
          <Column id="join_gift_card_sort_nm" type="STRING" size="256"/>
          <Column id="join_gift_card_amt" type="STRING" size="256"/>
          <Column id="prod_dc_cnt" type="STRING" size="256"/>
          <Column id="membership" type="STRING" size="256"/>
          <Column id="ocb_point" type="STRING" size="256"/>
          <Column id="ocb_fee" type="STRING" size="256"/>
          <Column id="upd_man" type="STRING" size="256"/>
          <Column id="lgbestcl" type="STRING" size="256"/>
          <Column id="order_seq" type="STRING" size="256"/>
          <Column id="acuon_yn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_accntInqCndt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srch_typ" type="STRING" size="256"/>
          <Column id="srch_vl" type="STRING" size="256"/>
          <Column id="option" type="STRING" size="256"/>
          <Column id="ns_yn" type="STRING" size="256"/>
          <Column id="popup_yn" type="STRING" size="256"/>
          <Column id="orderBy" type="STRING" size="256"/>
          <Column id="orderDirection" type="STRING" size="256"/>
          <Column id="sController" type="STRING" size="256"/>
          <Column id="dsName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_accnt_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="page_indx" type="STRING" size="6"/>
          <Column id="accnt_no" type="STRING" size="100"/>
          <Column id="mem_no" type="STRING" size="100"/>
          <Column id="mem_nm" type="STRING" size="100"/>
          <Column id="home_tel" type="STRING" size="100"/>
          <Column id="cell" type="STRING" size="100"/>
          <Column id="wrpl_tel" type="STRING" size="100"/>
          <Column id="idn_no" type="STRING" size="100"/>
          <Column id="prod_cd" type="STRING" size="100"/>
          <Column id="prod_nm" type="STRING" size="100"/>
          <Column id="prod_amt" type="STRING" size="100"/>
          <Column id="mon_pay_amt" type="STRING" size="100"/>
          <Column id="expr_no" type="STRING" size="100"/>
          <Column id="emple_no" type="STRING" size="100"/>
          <Column id="emple_nm" type="STRING" size="100"/>
          <Column id="appfm_no" type="STRING" size="100"/>
          <Column id="join_dt" type="STRING" size="100"/>
          <Column id="compt_dt" type="STRING" size="100"/>
          <Column id="bef_emple_cd" type="STRING" size="100"/>
          <Column id="pay_perd" type="STRING" size="100"/>
          <Column id="pay_mthd" type="STRING" size="100"/>
          <Column id="join_prod" type="STRING" size="100"/>
          <Column id="new_chan_gunsu" type="STRING" size="100"/>
          <Column id="certf_rcv_chk" type="STRING" size="100"/>
          <Column id="pay_stat_1no" type="STRING" size="100"/>
          <Column id="ichae_dt" type="STRING" size="100"/>
          <Column id="bank_accnt_no" type="STRING" size="100"/>
          <Column id="old_mid" type="STRING" size="100"/>
          <Column id="reg_dm" type="STRING" size="100"/>
          <Column id="reg_man" type="STRING" size="100"/>
          <Column id="upd_dm" type="STRING" size="100"/>
          <Column id="upd_man" type="STRING" size="100"/>
          <Column id="accnt_stat" type="STRING" size="100"/>
          <Column id="total_pay" type="STRING" size="100"/>
          <Column id="last_no" type="STRING" size="100"/>
          <Column id="real_pay_no" type="STRING" size="100"/>
          <Column id="ded_no" type="STRING" size="100"/>
          <Column id="join_cl" type="STRING" size="100"/>
          <Column id="trans_gubun" type="STRING" size="100"/>
          <Column id="brth_mon_day" type="STRING" size="100"/>
          <Column id="pay_mthd" type="STRING" size="100"/>
          <Column id="emp_cell" type="STRING" size="100"/>
          <Column id="join_stat" type="STRING" size="100"/>
          <Column id="pay_stat" type="STRING" size="100"/>
          <Column id="pay_no" type="STRING" size="100"/>
          <Column id="pay_allt_no" type="STRING" size="100"/>
          <Column id="pay_add_no" type="STRING" size="100"/>
          <Column id="pay_amt" type="STRING" size="100"/>
          <Column id="pay_allt_amt" type="STRING" size="100"/>
          <Column id="pay_add_amt" type="STRING" size="100"/>
          <Column id="model_cl_nm" type="STRING" size="100"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_evt_uji" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cnt" type="STRING" size="256"/>
          <Column id="event_proc_day" type="STRING" size="256"/>
          <Column id="event_comp_day" type="STRING" size="256"/>
          <Column id="accnt_no" type="STRING" size="256"/>
          <Column id="mem_nm" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_nm" type="STRING" size="256"/>
          <Column id="val6" type="STRING" size="256"/>
          <Column id="work_dept" type="STRING" size="256"/>
          <Column id="event_place" type="STRING" size="256"/>
          <Column id="evt_accno" type="STRING" size="256"/>
          <Column id="prod_nm_bf" type="STRING" size="256"/>
          <Column id="kstbit" type="STRING" size="256"/>
          <Column id="no" type="STRING" size="256"/>
          <Column id="yen_che" type="STRING" size="256"/>
          <Column id="prod_cd_bf" type="STRING" size="256"/>
          <Column id="b2bcom" type="STRING" size="256"/>
          <Column id="last_pay" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*********************************************
 * 화면명 : 행사현황 및 분석
 * 작성자 : 정출연
 * 작성일 : 2016.10.27
 * 변경이력 : 
*/

/********************************************************************************************/
/* 1. Include Library include, variables Declaration 영역                                  */
/********************************************************************************************/
include "LIB::lib_All.xjs";

var tc_prod = 0;	// 전체건수


//권한
var rgsnYn; //등록권한
var inqYn; //조회권한
var amntYn; //수정권한
var dltnYn; //삭제권한
var pritYn; //출력권한
var xlsYn; //엑셀권한
var athrPpupYn; //팝업오픈권한
var xlsRrnoYn; //엑셀 개인정보 권한 여부 

var gvMenuId;  // 프로그램 로그 추가 2018.03.12
/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리                                           	*/
/********************************************************************************************/
function frm_onload(obj:Form, e:LoadEventInfo)
{
	///////////////////////////////////////////////////////////////////////////////////////////
	// 프로그램 로그 추가 2018.03.12 정승철
	gvMenuId = GV_LOGMENUID;
	///////////////////////////////////////////////////////////////////////////////////////////
	
	gfn_initForm(obj);
	fn_setAthrPgmBtn(); // 권한에 따른 버튼 설정
	fn_init();
	fn_getBranchList(); // 지부 콤보박스 리스트	
	Tab_Main_onchanged(); // 검색조건 visible 초기화
}


/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
function fn_callBack(svcid, errcd, errmsg) 
{
	if (errcd != 0) {
	    switch (svcid) {
	        // 공통
  			case "selectDlwCode":
				alert("코드 적재를 실패하였습니다.");
			break;
	    }
		return false;
	} 
	
	switch (svcid) {
		// 공통
		case "selectDlwCode": // 공통코드 조회 callBack Service ID
			gfn_getCode("02", "ALL", ds_evt_typ, gds_DmlCd); // 코드조회결과 필터
			cbo_event.index = 0;
			fn_init(); // 검색부 초기화
			fn_getBranchList(); // 지부 콤보박스 리스트
		break;
		
		case "srchEventAnlList":
			var tc_prod = ds_evnt_list.rowcount;
			sta_cnt.text = tc_prod;
		break;
		
		case "srchBranchList":
			ds_branch_list.insertRow(0);
			ds_branch_list.setColumn(0, "cd_nm", "전체");
		break;
		
		case "srchEventBranchAnal":
			//trace(ds_t2_head.saveXML())
			//trace(ds_t2_list.saveXML())
			fn_create_header();
		break;
		
		case "srchEventEmplAnal":
			//trace(ds_t3_head.saveXML())		
			fn_create_header2();		
		break;
	}
}

/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)                                                   	*/
/********************************************************************************************/
//조회전 처리 조회조건셋팅
function fn_preSearch(sType) {

	ds_inqCndt.clearData();
	ds_inqCndt.addRow();
	
	ds_inqCndt.setColumn(0, "dt_typ", cbo_dt_typ.value);
	ds_inqCndt.setColumn(0, "stt_dt", stt_dt.value);
	ds_inqCndt.setColumn(0, "end_dt", end_dt.value);
	ds_inqCndt.setColumn(0, "etc_loc", cbo_loc.value);
	ds_inqCndt.setColumn(0, "jibu", cbo_jibu.value);
	ds_inqCndt.setColumn(0, "mngr_cd", edt_mngr_cd.value);
	ds_inqCndt.setColumn(0, "accnt_no", edt_accnt_no.value);
	ds_inqCndt.setColumn(0, "prod_cd", edt_prod_cd.value);	
	return true;
}

// 조회
function fn_commSearch(sType) {
	
	var szSvcid       = "";
    var szController  = "";
    var szInDs        = "";
    var szOutDs       = "";
    var szParam       = "";
    var szRetCallback = "";

	if(!fn_preSearch(sType)) return false;
	//if(!gfn_pageSearch(sType, ds_evnt_list, sta_TotalCnt, 500, tc_prod)) return;
	
	if (tab_main.tabindex == 0){ // 행사현황

		szSvcid       = "srchEventAnlList";
		szController  = "/dlw/evnt/annl-list";
		szInDs        = "ds_input=ds_inqCndt";
		szOutDs       = "ds_evnt_list=ds_output";
		szParam       = "";
		szRetCallback = "fn_callBack";
	 
	}else if(tab_main.tabindex == 1){ // 행사현황 종합분석
	
		szSvcid       = "srchEventTotAnal";
		szController  = "/dlw/evnt/total-anal";
		szInDs        = "ds_input=ds_inqCndt";
		szOutDs       = "ds_t1_list=ds_output ds_t1_list2=ds_output2 ds_t1_list3=ds_output3 ds_t1_list4=ds_output4"
					  + " ds_t1_list5=ds_output5 ds_t1_list6=ds_output6";	
		szParam       = "";
		szRetCallback = "fn_callBack";	
		
	}else if(tab_main.tabindex == 2){
	
		szSvcid       = "srchEventBranchAnal";
		szController  = "/dlw/evnt/total-branchanal";
		szInDs        = "ds_input=ds_inqCndt";
		szOutDs       = "ds_t2_head=ds_output ds_t2_list=ds_output2";	
		szParam       = "";
		szRetCallback = "fn_callBack";		 
	
	}else if(tab_main.tabindex == 3){

		szSvcid       = "srchEventEmplAnal";
		szController  = "/dlw/evnt/total-Emplanal";
		szInDs        = "ds_input=ds_inqCndt";
		szOutDs       = "ds_t3_head=ds_output ds_t3_list=ds_output2";	
		szParam       = "";
		szRetCallback = "fn_callBack";	
		
	}else if(tab_main.tabindex == 4){

		szSvcid       = "srchEventUjiAnal";
		szController  = "/dlw/evnt/evt_ujilist";
		szInDs        = "ds_input=ds_inqCndt";
		szOutDs       = "ds_evt_uji=ds_output";	
		szParam       = "";
		szRetCallback = "fn_callBack";	
		
	}

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,"","","S",gvMenuId);
}

// 지부 콤보박스 리스트
function fn_getBranchList()
{
	var szSvcid       = "srchBranchList";
    var szController  = "/dlw/evnt/branch-list";
    var szInDs        = "";
    var szOutDs       = "ds_branch_list=ds_output";
    var szParam       = "";
    var szRetCallback = "fn_callBack";

    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback,false);
}

//조회 결과 
function fn_postSearch()
{
	if(ds_evnt_list.rowcount < 1) {
		trace("조회 결과가 없습니다.");
 	}
	return;
}


/********************************************************************************************/
/**   6. 사용자 함수                                                                   	*/
/********************************************************************************************/
//초기화
function fn_init()
{
	var objDate = new Date();
	strDate = objDate.toFormatString("%Y%m");
	endDate = objDate.toFormatString("%Y%m%d");
	
	stt_dt.value = strDate;
	end_dt.value = endDate;
	cbo_loc.index = 0;
	cbo_jibu.index = 0;
	edt_mngr_cd.value = "";
	edt_mngr_nm.value = "";
	edt_accnt_no.value = "";
	edt_prod_cd.value = "";
	edt_prod_nm.value = "";
}

// 행사분석(상품분류별 / 지부별) 그리드 동적 생성
function fn_create_header()
{
	var v_Formats = "";
	var v_Columns = "";
	var v_Rows = "";
	var v_BandHead = "";
	var v_BandBody = "";

	v_Columns += '<Column size="100" />\n';
	//v_Columns += '<Column size="100" />\n';
	
	v_Rows += '<Row size="30" band="head" />\n';
	//v_Rows += '<Row size="23" band="head" />\n';
	v_Rows += '<Row size="23" />\n';
	
	v_BandHead += '<Cell rowspan="1" colspan="1" text="상품분류"/>\n';
	
	v_BandBody += '<Cell text="bind:gubun" suppress="1"/>\n';
	v_BandBody += '<Cell col="1" text="bind:gubun"/>\n';
	
	// 포맷 생성
	var v_HeadText = '';
	var v_HeadColIdx = 1;
	var v_BodyColIdx = 1;
	
	for (var i=0; i<ds_t2_head.getRowCount(); i++) {
		
		// Column 생성
		v_Columns += '<Column size="100" />\n';

		// Head 생성
		if (v_HeadText != ds_t2_head.getColumn(i, "branch_nm")) {
			v_HeadText = ds_t2_head.getColumn(i, "branch_nm");
			
			var v_Colspan = ds_t2_head.getCaseCount("branch_nm=='" + v_HeadText + "'");
			
			// Row 1
			v_BandHead += '<Cell col="'+v_HeadColIdx+'" colspan="'+v_Colspan+'" text="'+v_HeadText+'"/>\n';
			v_HeadColIdx++;
		}
		
		trace(ds_t2_head.getColumn(i, "branch_nm"))
		// Body 생성
		v_BandBody += '<Cell style="align:right;" col="'+v_BodyColIdx+'" displaytype="number" text="bind:'+ds_t2_head.getColumn(i, "branch_nm")+'"/>\n';
		v_BodyColIdx++;
	}

	v_Formats = '<Formats>\n';
	v_Formats += '<Format id="default">\n';
	v_Formats += '<Columns>\n';
	v_Formats += v_Columns;
	v_Formats += '</Columns>\n';
	v_Formats += '<Rows>\n';
	v_Formats += v_Rows;
	v_Formats += '</Rows>\n';
	v_Formats += '<Band id="head">\n';
	v_Formats += v_BandHead;
	v_Formats += '</Band>\n';	
	v_Formats += '<Band id="body">\n';
	v_Formats += v_BandBody;
	v_Formats += '</Band>\n';		
	v_Formats += '</Format>\n';	
	v_Formats += '</Formats>\n';
	
	trace(v_Formats);
	tab_main.tabpage2.grid_branch.enableredraw = false;
	tab_main.tabpage2.grid_branch.formats = v_Formats;
	tab_main.tabpage2.grid_branch.enableredraw = true;
}

// 행사분석(상품분류별 / 지부별) 그리드 동적 생성
function fn_create_header2()
{
	var v_Formats = "";
	var v_Columns = "";
	var v_Rows = "";
	var v_BandHead = "";
	var v_BandBody = "";

	v_Columns += '<Column size="100" />\n';
	//v_Columns += '<Column size="100" />\n';
	
	v_Rows += '<Row size="30" band="head" />\n';
	//v_Rows += '<Row size="23" band="head" />\n';
	v_Rows += '<Row size="23" />\n';
	
	v_BandHead += '<Cell rowspan="1" colspan="1" text="CP명"/>\n';
	
	v_BandBody += '<Cell text="bind:gubun" suppress="1"/>\n';
	v_BandBody += '<Cell col="1" text="bind:gubun"/>\n';
	
	// 포맷 생성
	var v_HeadText = '';
	var v_HeadColIdx = 1;
	var v_BodyColIdx = 1;
	
	for (var i=0; i<ds_t3_head.getRowCount(); i++) {
		
		// Column 생성
		v_Columns += '<Column size="100" />\n';

		// Head 생성
		if (v_HeadText != ds_t3_head.getColumn(i, "gubun_nm")) {
			v_HeadText = ds_t3_head.getColumn(i, "gubun_nm");
			
			var v_Colspan = ds_t3_head.getCaseCount("gubun_nm=='" + v_HeadText + "'");
			
			// Row 1
			v_BandHead += '<Cell col="'+v_HeadColIdx+'" colspan="'+v_Colspan+'" text="'+v_HeadText+'"/>\n';
			v_HeadColIdx++;
		}
		
		// Body 생성
		v_BandBody += '<Cell style="align:right;" col="'+v_BodyColIdx+'" displaytype="number" text="bind:'+ds_t3_head.getColumn(i, "gubun_nm")+'"/>\n';
		v_BodyColIdx++;
	}

	v_Formats = '<Formats>\n';
	v_Formats += '<Format id="default">\n';
	v_Formats += '<Columns>\n';
	v_Formats += v_Columns;
	v_Formats += '</Columns>\n';
	v_Formats += '<Rows>\n';
	v_Formats += v_Rows;
	v_Formats += '</Rows>\n';
	v_Formats += '<Band id="head">\n';
	v_Formats += v_BandHead;
	v_Formats += '</Band>\n';	
	v_Formats += '<Band id="body">\n';
	v_Formats += v_BandBody;
	v_Formats += '</Band>\n';		
	v_Formats += '</Format>\n';	
	v_Formats += '</Formats>\n';
	
	tab_main.tabpage3.grid_emple.enableredraw = false;
	tab_main.tabpage3.grid_emple.formats = v_Formats;
	tab_main.tabpage3.grid_emple.enableredraw = true;
}
/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
//조회 버튼 이벤트
function btn_Search_onclick()
{
	fn_commSearch(gfn_getCommTypeInit());
}

//초기화 버튼 이벤트
function btn_Init_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_init();
}


// 그리드 헤더 클릭
function grd_onheadclick(obj:Grid, e:GridClickEventInfo)
{ 
	gfn_grdHeadClick(obj, e);
}

//엑셀버튼 클릭 시
function fn_excel_data(obj:Button,  e:ClickEventInfo)
{
	if(tab_main.tabindex == 0){
		var ss = gfn_ExportMultSheet("행사현황","tab_main.tabpage0.grd_dlvList::01");
	}else if(tab_main.tabindex == 1){
		alert("분석화면은 엑셀데이터를 반출할수 없습니다.");
		return;
	}else if(tab_main.tabindex == 2){
		var ss = gfn_ExportMultSheet("행사분석(상품분류별,지부별)","tab_main.tabpage2.grid_branch::01");
	}else if(tab_main.tabindex == 3){
		var ss = gfn_ExportMultSheet("행사분석(CP별,상품분류별)","tab_main.tabpage3.grid_emple::01");
	}else if(tab_main.tabindex == 4){
		var ss = gfn_ExportMultSheet("행사후유지현황","tab_main.tabpage5.grd_Uji::01");
	}
}


/********************************************************************************************/
/**   8. 팝업 관련 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
// 행사자 팝업
function fn_openPopup(){
	var sPrmr = {p_prod_cd:"", p_prod_nm:"", p_mode:"CP"};
	var reVal = gfn_diaLog("행사자 조회", -1, -1, -1, -1, "PS990000::PS992210.xfdl", false, sPrmr, true, false, true, null, null, true);
}
 
// 행사자 선택팝업에서 행사자 선택시 호출
function fn_prodChcResl()
{
	// 모델분류 조회
 	var sMngrCd = ds_event_man.getColumn(0, "mngr_cd");
 	if (gfn_isNull(sMngrCd)) {
 		alert("행사자코드가 없습니다.");
 		return false;
 	}

	edt_mngr_cd.value = sMngrCd;
	edt_mngr_nm.value = ds_event_man.getColumn(0, "mngr_nm");

}

// 상품선택 팝업
function fn_ProdPopup(obj:Button,  e:ClickEventInfo){
	var sPrmr = {p_prod_cd:"", p_prod_nm:"", p_mode:"set"};
	var reVal = gfn_diaLog("상품조회", -1, -1, -1, -1, "PS990000::PS992200.xfdl", false, sPrmr, true, false, true, null, null, true);	
}

// 상품 선택팝업에서 상품 선택시 호출
function fn_prodSetInfo()
{
	// 모델분류 조회
	var sProdCd = ds_prodList.getColumn(0, "prod_cd");
	if (gfn_isNull(sProdCd)) {
		alert("상품코드가 없습니다.");
		return false;
	}
	
	edt_prod_cd.value = sProdCd;
	edt_prod_nm.value = ds_prodList.getColumn(0, "prod_nm");
}

// 회원 조회 버튼 클릭
function btn_accnt_onclick (obj, typ) {

	var srch_typ = "";
	var option = "";
	var gubun_mode = "";
	var srch_vl = "";
	if (obj != null) {
		if ("btn_mem_nm" == obj.name || "edt_mem_nm" == obj.name) { // 회원명
			srch_typ = "mem_nm";
		} else if ("btn_accnt_no" == obj.name || "edt_accnt_no" == obj.name){ // 회원번호
			srch_typ = "accnt_no";
		} 
	}
	
	if (typ == "Y") {
		srch_typ = ds_accntInqCndt.getColumn(0,"srch_typ");
		srch_vl = ds_accntInqCndt.getColumn(0,"srch_vl");
	}

	var sPrmr = {p_srch_typ:srch_typ, p_srch_vl:srch_vl, p_gubun_mode:gubun_mode, p_option:option};
	gfn_diaLog("회원 조회", -1, -1, 884, 601, "PS990000::PS992400.xfdl", false, sPrmr, true, false, true, null, null, true);
}
function fn_setAccntNo(){
	if(ds_accnt_info.getColumn(0, "accnt_no") != ""){	
		var accnt_no = ds_accnt_info.getColumn(0, "accnt_no");
		edt_accnt_no.value = accnt_no;
	}
}

function Tab_Main_onchanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	if(tab_main.tabindex == 4){
		stc_03.visible = false;
		cbo_loc.visible = false;
		stc_00.visible = false;
		cbo_jibu.visible = false;
		stc_05.visible = false;
		edt_mngr_cd.visible = false;
		edt_mngr_nm.visible = false;
		btn_01.visible = false;
		
		stc_02.visible = true;
		edt_accnt_no.visible = true;
		btn_accnt_no.visible = true;
		stc_01.visible = true;
		edt_prod_cd.visible = true;
		edt_prod_nm.visible = true;
		btn_00.visible = true;		
	}else{
		stc_03.visible = true;
		cbo_loc.visible = true;
		stc_00.visible = true;
		cbo_jibu.visible = true;
		stc_05.visible = true;
		edt_mngr_cd.visible = true;
		edt_mngr_nm.visible = true;
		btn_01.visible = true;
		
		stc_02.visible = false;
		edt_accnt_no.visible = false;
		btn_accnt_no.visible = false;
		stc_01.visible = false;
		edt_prod_cd.visible = false;
		edt_prod_nm.visible = false;
		btn_00.visible = false;		
	}
}

// 권한에 따른 버튼 설정
function fn_setAthrPgmBtn()
{
	gfn_athrPgm(gfn_gdsCd_admin());
	
	if (xlsYn == "N") {
		btn_excel.visible = false;
	}
}]]></Script>
  </Form>
</FDL>
