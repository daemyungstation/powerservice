<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="DL460500" classname="캠페인관리" inheritanceid="" position="absolute 0 0 989 795" titletext="해약현황" onload="DL460500_onload" scrollbars="none" enableevent="true">
    <Layouts>
      <Layout>
        <Tab id="tab" taborder="29" position2="absolute l:0 r:0 t:8 b:13" positiontype="position2" tabindex="0" scrollbars="autoboth" onchanged="tab_onchanged">
          <Tabpages>
            <Tabpage id="tabpage1" text="월별" scrollbars="autovert">
              <Layouts>
                <Layout width="739" height="223">
                  <Static id="stc_01" class="sta_workSrcBg" position2="absolute l:10 r:11 t:10px h:42" positiontype="position2"/>
                  <Static id="stc_grd_1" text="**년 해약현황" class="sta_workTitle2" position2="absolute l:10 w:129 t:65 h:20" positiontype="position2"/>
                  <Button id="btn_search" taborder="0" onclick="btn_search_onclick" class="btn_WF_Search" position2="absolute r:97 w:72 t:21 h:20" positiontype="position2" tooltiptext="조회" style="shadow:drop 0,0 0 #00000033;"/>
                  <Button id="btn_excel" taborder="1" text="엑셀" onclick="btn_excel_onclick" class="btn_WF_Common" position2="absolute r:23 w:72 t:21 h:20" positiontype="position2" style="padding:0 0 0 0;"/>
                  <Grid id="grd_1" taborder="2" binddataset="ds_list_grd1" scrollbars="none" useinputpanel="false" cellsizingtype="col" autofittype="col" onvscrolllastover="fn_Grid_onvscrolllastover" position2="absolute l:10 r:11 t:85px h:144" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="95" band="left"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="80"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background:cornsilk;">
                            <Cell text="구분"/>
                          </Cell>
                          <Cell col="1" style="align: ;background:cornsilk;" text="1월"/>
                          <Cell col="2" style="align: ;background:cornsilk;" text="2월"/>
                          <Cell col="3" style="align: ;background:cornsilk;" text="3월"/>
                          <Cell col="4" style="align: ;background:cornsilk;" text="4월"/>
                          <Cell col="5" style="align: ;background:cornsilk;" text="5월"/>
                          <Cell col="6" style="align: ;background:cornsilk;" text="6월"/>
                          <Cell col="7" style="align: ;background:cornsilk;" text="7월"/>
                          <Cell col="8" style="align: ;background:cornsilk;" text="8월"/>
                          <Cell col="9" style="align: ;background:cornsilk;" text="9월"/>
                          <Cell col="10" style="align: ;background:cornsilk;" text="10월"/>
                          <Cell col="11" style="align: ;background:cornsilk;" text="11월"/>
                          <Cell col="12" style="align: ;background:cornsilk;" text="12월"/>
                          <Cell col="13" style="align: ;background:cornsilk;" text="합계"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:gbn"/>
                          <Cell col="1" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month01"/>
                          <Cell col="2" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month02"/>
                          <Cell col="3" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month03"/>
                          <Cell col="4" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month04"/>
                          <Cell col="5" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month05"/>
                          <Cell col="6" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month06"/>
                          <Cell col="7" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month07"/>
                          <Cell col="8" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month08"/>
                          <Cell col="9" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month09"/>
                          <Cell col="10" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month10"/>
                          <Cell col="11" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month11"/>
                          <Cell col="12" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month12"/>
                          <Cell col="13" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:month01+month02+month03+month04+month05+month06+month07+month08+month09+month10+month11+month12"/>
                        </Band>
                        <Band id="summary">
                          <Cell text="합계"/>
                          <Cell col="1" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month01'))"/>
                          <Cell col="2" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month02'))"/>
                          <Cell col="3" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month03'))"/>
                          <Cell col="4" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month04'))"/>
                          <Cell col="5" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month05'))"/>
                          <Cell col="6" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month06'))"/>
                          <Cell col="7" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month07'))"/>
                          <Cell col="8" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month08'))"/>
                          <Cell col="9" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month09'))"/>
                          <Cell col="10" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month10'))"/>
                          <Cell col="11" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month11'))"/>
                          <Cell col="12" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month12'))"/>
                          <Cell col="13" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month01')+getSum('month02')+getSum('month03')+getSum('month04')+getSum('month05')+getSum('month06')+getSum('month07')+getSum('month08')+getSum('month09')+getSum('month10')+getSum('month11')+getSum('month12'))"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="stc_grd_2" text="**년 해약현황" class="sta_workTitle2" position2="absolute l:10 w:129 t:265 h:20" positiontype="position2"/>
                  <Grid id="grd_2" taborder="3" binddataset="ds_list_grd2" scrollbars="none" useinputpanel="false" cellsizingtype="col" autofittype="col" onvscrolllastover="fn_Grid_onvscrolllastover" position2="absolute l:10 r:11 t:285px h:144" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="95" band="left"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="75"/>
                          <Column size="80"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background:cornsilk;">
                            <Cell text="구분"/>
                          </Cell>
                          <Cell col="1" style="align: ;background:cornsilk;" text="1월"/>
                          <Cell col="2" style="align: ;background:cornsilk;" text="2월"/>
                          <Cell col="3" style="align: ;background:cornsilk;" text="3월"/>
                          <Cell col="4" style="align: ;background:cornsilk;" text="4월"/>
                          <Cell col="5" style="align: ;background:cornsilk;" text="5월"/>
                          <Cell col="6" style="align: ;background:cornsilk;" text="6월"/>
                          <Cell col="7" style="align: ;background:cornsilk;" text="7월"/>
                          <Cell col="8" style="align: ;background:cornsilk;" text="8월"/>
                          <Cell col="9" style="align: ;background:cornsilk;" text="9월"/>
                          <Cell col="10" style="align: ;background:cornsilk;" text="10월"/>
                          <Cell col="11" style="align: ;background:cornsilk;" text="11월"/>
                          <Cell col="12" style="align: ;background:cornsilk;" text="12월"/>
                          <Cell col="13" style="align: ;background:cornsilk;" text="합계"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:gbn"/>
                          <Cell col="1" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month01"/>
                          <Cell col="2" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month02"/>
                          <Cell col="3" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month03"/>
                          <Cell col="4" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month04"/>
                          <Cell col="5" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month05"/>
                          <Cell col="6" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month06"/>
                          <Cell col="7" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month07"/>
                          <Cell col="8" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month08"/>
                          <Cell col="9" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month09"/>
                          <Cell col="10" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month10"/>
                          <Cell col="11" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month11"/>
                          <Cell col="12" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:month12"/>
                          <Cell col="13" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:month01+month02+month03+month04+month05+month06+month07+month08+month09+month10+month11+month12"/>
                        </Band>
                        <Band id="summary">
                          <Cell text="합계"/>
                          <Cell col="1" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month01'))"/>
                          <Cell col="2" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month02'))"/>
                          <Cell col="3" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month03'))"/>
                          <Cell col="4" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month04'))"/>
                          <Cell col="5" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month05'))"/>
                          <Cell col="6" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month06'))"/>
                          <Cell col="7" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month07'))"/>
                          <Cell col="8" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month08'))"/>
                          <Cell col="9" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month09'))"/>
                          <Cell col="10" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month10'))"/>
                          <Cell col="11" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month11'))"/>
                          <Cell col="12" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month12'))"/>
                          <Cell col="13" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('month01')+getSum('month02')+getSum('month03')+getSum('month04')+getSum('month05')+getSum('month06')+getSum('month07')+getSum('month08')+getSum('month09')+getSum('month10')+getSum('month11')+getSum('month12'))"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Calendar id="cal_srch_yr" taborder="4" dateformat="yyyy" editformat="yyyy" position2="absolute l:95 w:95 t:21 h:20" positiontype="position2"/>
                  <Static id="stc_02" text="조회년도" class="sta_workSrcLabel1" position2="absolute l:30 w:59 t:21 h:20" positiontype="position2"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage2" text="채권/비채권">
              <Layouts>
                <Layout>
                  <Static id="stc_01" class="sta_workSrcBg" position2="absolute l:10 r:11 t:10px h:42" positiontype="position2"/>
                  <Static id="Static27" text="h10" onclick="Static15_onclick" visible="false" position2="absolute l:407 w:41 t:756 h:11" positiontype="position2" style="background:yellow;align:center middle;"/>
                  <Static id="stc_grd_3" text="종합 해약현황" class="sta_workTitle2" position2="absolute l:10 w:129 t:65 h:20" positiontype="position2"/>
                  <Grid id="grd_3" taborder="2" binddataset="ds_list_grd3" scrollbars="none" useinputpanel="false" cellsizingtype="col" autofittype="col" onvscrolllastover="fn_Grid_onvscrolllastover" position2="absolute l:10 r:11 t:85px h:144" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="95" band="left"/>
                          <Column size="160"/>
                          <Column size="160"/>
                          <Column size="200"/>
                          <Column size="160"/>
                          <Column size="160"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="align: ;background:cornsilk;" text="구분"/>
                          <Cell col="1" style="align: ;background:cornsilk;" text="건수"/>
                          <Cell col="2" style="align: ;background:cornsilk;" text="상조부금"/>
                          <Cell col="3" style="align: ;background:cornsilk;" text="합금액(할부원금+추가부담금)"/>
                          <Cell col="4" style="align: ;background:cornsilk;" text="환불금액"/>
                          <Cell col="5" style="align: ;background:cornsilk;" text="해약수익계"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="string" style="align:left;padding:0 5 0 5;background:EXPR(gbn1==null ? '#faebd7ff' : '');" text="bind:gbn2"/>
                          <Cell col="1" displaytype="number" style="align:right;padding:0 5 0 5;background:EXPR(gbn1==null ? '#faebd7ff' : '');" text="bind:cnt"/>
                          <Cell col="2" displaytype="number" style="align:right;padding:0 5 0 5;background:EXPR(gbn1==null ? '#faebd7ff' : '');" text="bind:col1"/>
                          <Cell col="3" displaytype="number" style="align:right;padding:0 5 0 5;background:EXPR(gbn1==null ? '#faebd7ff' : '');" text="bind:col2"/>
                          <Cell col="4" displaytype="number" style="align:right;padding:0 5 0 5;background:EXPR(gbn1==null ? '#faebd7ff' : '');" text="bind:col3"/>
                          <Cell col="5" displaytype="number" style="align:right;padding:0 5 0 5;background:EXPR(gbn1==null ? '#faebd7ff' : '');" text="bind:col4"/>
                        </Band>
                        <Band id="summary">
                          <Cell text="합계"/>
                          <Cell col="1" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('cnt'))"/>
                          <Cell col="2" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('col1'))"/>
                          <Cell col="3" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('col2'))"/>
                          <Cell col="4" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('col3'))"/>
                          <Cell col="5" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('col4'))"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="grd_4" taborder="3" binddataset="ds_list_grd4" scrollbars="none" useinputpanel="false" cellsizingtype="col" autofittype="col" onvscrolllastover="fn_Grid_onvscrolllastover" position2="absolute l:10 r:11 t:261px h:97" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="95" band="left"/>
                          <Column size="160"/>
                          <Column size="160"/>
                          <Column size="200"/>
                          <Column size="160"/>
                          <Column size="160"/>
                        </Columns>
                        <Rows>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="body">
                          <Cell col="0" displaytype="string" style="align:left;padding:0 5 0 5;background:EXPR(gbn1==null ? '#faebd7ff' : '');" text="bind:gbn2"/>
                          <Cell col="1" displaytype="number" style="align:right;padding:0 5 0 5;background:EXPR(gbn1==null ? '#faebd7ff' : '');" text="bind:cnt"/>
                          <Cell col="2" displaytype="number" style="align:right;padding:0 5 0 5;background:EXPR(gbn1==null ? '#faebd7ff' : '');" text="bind:col1"/>
                          <Cell col="3" displaytype="number" style="align:right;padding:0 5 0 5;background:EXPR(gbn1==null ? '#faebd7ff' : '');" text="bind:col2"/>
                          <Cell col="4" displaytype="number" style="align:right;padding:0 5 0 5;background:EXPR(gbn1==null ? '#faebd7ff' : '');" text="bind:col3"/>
                          <Cell col="5" displaytype="number" style="align:right;padding:0 5 0 5;background:EXPR(gbn1==null ? '#faebd7ff' : '');" text="bind:col4"/>
                        </Band>
                        <Band id="summary">
                          <Cell text="합계"/>
                          <Cell col="1" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('cnt'))"/>
                          <Cell col="2" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('col1'))"/>
                          <Cell col="3" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('col2'))"/>
                          <Cell col="4" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('col3'))"/>
                          <Cell col="5" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('col4'))"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="stc_02" text="조회일자" class="sta_workSrcLabel1" position2="absolute l:30 w:59 t:21 h:20" positiontype="position2"/>
                  <Button id="btn_search" taborder="4" onclick="btn_search_onclick" class="btn_WF_Search" position2="absolute r:97 w:72 t:21 h:20" positiontype="position2" tooltiptext="조회" style="shadow:drop 0,0 0 #00000033;"/>
                  <Button id="btn_excel" taborder="5" text="엑셀" onclick="btn_excel_onclick" class="btn_WF_Common" position2="absolute r:23 w:72 t:21 h:20" positiontype="position2" style="padding:0 0 0 0;"/>
                  <Calendar id="cal_srch_stt_dt" taborder="6" dateformat="yyyy-MM-dd" position="absolute 95 21 184 41"/>
                  <Static id="sta_Dash01" text="~" position="absolute 191 23 204 38"/>
                  <Calendar id="cal_srch_end_dt" taborder="7" dateformat="yyyy-MM-dd" position="absolute 206 21 295 41"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage3" text="상품군별">
              <Layouts>
                <Layout>
                  <Static id="Static27" text="h10" onclick="Static15_onclick" visible="false" position2="absolute l:407 w:41 t:756 h:11" positiontype="position2" style="background:yellow;align:center middle;"/>
                  <Static id="stc_grd_5" text="상품군별 해약현황" class="sta_workTitle2" position2="absolute l:10 w:129 t:65 h:20" positiontype="position2"/>
                  <Grid id="grd_5" taborder="2" binddataset="ds_list_grd5" scrollbars="fixedvert" useinputpanel="false" cellsizingtype="col" autofittype="col" onvscrolllastover="fn_Grid_onvscrolllastover" position2="absolute l:10 r:10 t:85 b:10" positiontype="position2">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="95" band="left"/>
                          <Column size="95"/>
                          <Column size="95"/>
                          <Column size="95"/>
                          <Column size="95"/>
                          <Column size="95"/>
                          <Column size="95"/>
                          <Column size="95"/>
                          <Column size="95"/>
                          <Column size="95"/>
                          <Column size="95"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell rowspan="2" style="background:cornsilk;" text="구분" taborder="undefined"/>
                          <Cell col="1" colspan="5" style="background:cornsilk;" text="월별" taborder="undefined"/>
                          <Cell col="6" colspan="5" style="background:cornsilk;" text="년간누적" taborder="undefined"/>
                          <Cell col="11" colspan="2" style="background:cornsilk;" text="월별" taborder="undefined">
                            <Cell style="background:cornsilk;"/>
                            <Cell col="1" style="background:cornsilk;"/>
                            <Cell col="2" style="background:cornsilk;"/>
                            <Cell col="3" style="background:cornsilk;"/>
                          </Cell>
                          <Cell col="11" colspan="2" style="background:cornsilk;" text="월별" taborder="undefined">
                            <Cell style="background:cornsilk;"/>
                            <Cell col="1" style="background:cornsilk;"/>
                            <Cell col="2" style="background:cornsilk;"/>
                            <Cell col="3" style="background:cornsilk;"/>
                          </Cell>
                          <Cell col="11" colspan="2" style="background:cornsilk;" text="월별" taborder="undefined">
                            <Cell style="background:cornsilk;"/>
                            <Cell col="1" style="background:cornsilk;"/>
                            <Cell col="2" style="background:cornsilk;"/>
                          </Cell>
                          <Cell col="11" style="background:cornsilk;"/>
                          <Cell col="12" style="background:cornsilk;"/>
                          <Cell col="13" style="background:cornsilk;"/>
                          <Cell col="14" style="background:cornsilk;"/>
                          <Cell row="1" col="1" style="align: ;background:cornsilk;" text="청약철회"/>
                          <Cell row="1" col="2" style="line: ;background:cornsilk;" text="해약완료"/>
                          <Cell row="1" col="3" style="align: ;background:cornsilk;" text="점유율"/>
                          <Cell row="1" col="4" style="align: ;background:cornsilk;" text="해약접수"/>
                          <Cell row="1" col="5" style="align: ;background:cornsilk;" text="월요약"/>
                          <Cell row="1" col="6" style="align: ;background:cornsilk;" text="청약철회"/>
                          <Cell row="1" col="7" style="align: ;background:cornsilk;" text="해약완료"/>
                          <Cell row="1" col="8" style="align: ;background:cornsilk;" text="점유율"/>
                          <Cell row="1" col="9" style="align: ;background:cornsilk;" text="해약접수"/>
                          <Cell row="1" col="10" style="align: ;background:cornsilk;" text="합계"/>
                          <Cell row="1" col="12" style="align: ;background:cornsilk;" text="점유율"/>
                          <Cell row="1" col="13" style="align: ;background:cornsilk;" text="해약접수"/>
                          <Cell row="1" col="14" style="align: ;background:cornsilk;" text="월요약"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="string" style="align:left;padding:0 5 0 5;" text="bind:gbn"/>
                          <Cell col="1" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:mn_cnt1"/>
                          <Cell col="2" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:mn_cnt2"/>
                          <Cell col="3" displaytype="number" style="align:right;padding:0 5 0 5;" text="expr:isFinite(Math.round((mn_cnt2/getSum('mn_cnt2')*100),0))==false?0+' %':Math.round((mn_cnt2/getSum('mn_cnt2')*100),0)+' %'"/>
                          <Cell col="4" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:mn_cnt3"/>
                          <Cell col="5" displaytype="number" style="align:right;padding:0 5 0 5;" text="expr:mn_cnt1+mn_cnt2+mn_cnt3"/>
                          <Cell col="6" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:yr_cnt1"/>
                          <Cell col="7" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:yr_cnt2"/>
                          <Cell col="8" displaytype="number" style="align:right;padding:0 5 0 5;" text="expr:isFinite(Math.round((yr_cnt2/getSum('yr_cnt2')*100),0))==false?0+' %':Math.round((yr_cnt2/getSum('yr_cnt2')*100),0)+' %'"/>
                          <Cell col="9" displaytype="number" style="align:right;padding:0 5 0 5;" text="bind:yr_cnt3"/>
                          <Cell col="10" displaytype="number" style="align:right;padding:0 5 0 5;" text="expr:yr_cnt1+yr_cnt2+yr_cnt3"/>
                        </Band>
                        <Band id="summary">
                          <Cell text="합계"/>
                          <Cell col="1" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('mn_cnt1'))"/>
                          <Cell col="2" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('mn_cnt2'))"/>
                          <Cell col="3" displaytype="number" style="align:right;padding:0 5 0 5;" text="100%"/>
                          <Cell col="4" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('mn_cnt3'))"/>
                          <Cell col="5" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('mn_cnt1')+getSum('mn_cnt2')+getSum('mn_cnt3'))"/>
                          <Cell col="6" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('yr_cnt1'))"/>
                          <Cell col="7" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('yr_cnt2'))"/>
                          <Cell col="8" displaytype="number" style="align:right;padding:0 5 0 5;" text="100%"/>
                          <Cell col="9" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('yr_cnt3'))"/>
                          <Cell col="10" displaytype="number" style="align:right;padding:0 5 0 5;" expr="expr:gfn_commaStr(getSum('yr_cnt1')+getSum('yr_cnt2')+getSum('yr_cnt3'))"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="stc_01" class="sta_workSrcBg" position2="absolute l:10 r:11 t:10px h:42" positiontype="position2"/>
                  <Static id="stc_02" text="조회일자" class="sta_workSrcLabel1" position2="absolute l:30 w:59 t:21 h:20" positiontype="position2"/>
                  <Button id="btn_search" taborder="3" onclick="btn_search_onclick" class="btn_WF_Search" position2="absolute r:97 w:72 t:21 h:20" positiontype="position2" tooltiptext="조회" style="shadow:drop 0,0 0 #00000033;"/>
                  <Button id="btn_excel" taborder="4" text="엑셀" onclick="btn_excel_onclick" class="btn_WF_Common" position2="absolute r:23 w:72 t:21 h:20" positiontype="position2" style="padding:0 0 0 0;"/>
                  <Calendar id="cal_srch_stt_dt" taborder="5" dateformat="yyyy-MM-dd" position="absolute 95 21 184 41"/>
                  <Static id="sta_Dash01" text="~" position="absolute 191 23 204 38"/>
                  <Calendar id="cal_srch_end_dt" taborder="6" dateformat="yyyy-MM-dd" position="absolute 206 21 295 41"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Edit id="edt_cpdcTitlNm08" taborder="11" position="absolute 756 -531 889 -511"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item3" compid="tab.tabpage2.cal_srch_stt_dt" propid="value" datasetid="ds_prod" columnid="join_dt"/>
      <BindItem id="item0" compid="tab.tabpage2.cal_srch_end_dt" propid="value" datasetid="ds_prod" columnid="join_dt"/>
      <BindItem id="item1" compid="tab.tabpage3.cal_srch_stt_dt" propid="value" datasetid="ds_prod" columnid="join_dt"/>
      <BindItem id="item2" compid="tab.tabpage3.cal_srch_end_dt" propid="value" datasetid="ds_prod" columnid="join_dt"/>
    </Bind>
    <Objects>
      <Dataset id="ds_list_tmp"/>
      <ExportObject id="ExportObject00" exporttype="0" exporteventtype="itemrecord" onexport="ExportObject00_onexport"/>
      <Dataset id="ds_trans_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="strSvcID" type="STRING" size="256"/>
          <Column id="strURL" type="STRING" size="256"/>
          <Column id="strInDatasets" type="STRING" size="256"/>
          <Column id="strOutDatasets" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_grd1">
        <ColumnInfo>
          <Column id="gbn" type="STRING" size="256"/>
          <Column id="month01" type="INT" size="15"/>
          <Column id="month02" type="INT" size="15"/>
          <Column id="month03" type="INT" size="15"/>
          <Column id="month04" type="INT" size="15"/>
          <Column id="month05" type="INT" size="15"/>
          <Column id="month06" type="INT" size="15"/>
          <Column id="month07" type="INT" size="15"/>
          <Column id="month08" type="INT" size="15"/>
          <Column id="month09" type="INT" size="15"/>
          <Column id="month10" type="INT" size="15"/>
          <Column id="month11" type="INT" size="15"/>
          <Column id="month12" type="INT" size="15"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="gbn">무환급해약</Col>
            <Col id="month01">21</Col>
            <Col id="month02">16</Col>
            <Col id="month03">10</Col>
            <Col id="month04">4</Col>
            <Col id="month05">3</Col>
            <Col id="month06">10</Col>
            <Col id="month07">4</Col>
            <Col id="month08">15</Col>
            <Col id="month09">5</Col>
            <Col id="month10">1</Col>
            <Col id="month12">11</Col>
          </Row>
          <Row>
            <Col id="gbn">청약철회</Col>
            <Col id="month01">417</Col>
            <Col id="month02">309</Col>
            <Col id="month03">389</Col>
            <Col id="month04">265</Col>
            <Col id="month05">285</Col>
            <Col id="month06">313</Col>
            <Col id="month07">466</Col>
            <Col id="month08">578</Col>
            <Col id="month09">403</Col>
            <Col id="month10">444</Col>
            <Col id="month11">480</Col>
            <Col id="month12">439</Col>
          </Row>
          <Row>
            <Col id="gbn">해약</Col>
            <Col id="month01">364</Col>
            <Col id="month02">310</Col>
            <Col id="month03">463</Col>
            <Col id="month04">435</Col>
            <Col id="month05">475</Col>
            <Col id="month06">462</Col>
            <Col id="month07">427</Col>
            <Col id="month08">490</Col>
            <Col id="month09">599</Col>
            <Col id="month10">449</Col>
            <Col id="month11">414</Col>
            <Col id="month12">555</Col>
          </Row>
          <Row>
            <Col id="gbn">미처리건</Col>
            <Col id="month01">8</Col>
            <Col id="month02">19</Col>
            <Col id="month03">16</Col>
            <Col id="month04">21</Col>
            <Col id="month05">39</Col>
            <Col id="month06">32</Col>
            <Col id="month07">25</Col>
            <Col id="month08">78</Col>
            <Col id="month09">24</Col>
            <Col id="month10">16</Col>
            <Col id="month11">15</Col>
            <Col id="month12">34</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list_grd2">
        <ColumnInfo>
          <Column id="gbn" type="STRING" size="256"/>
          <Column id="month01" type="INT" size="15"/>
          <Column id="month02" type="INT" size="15"/>
          <Column id="month03" type="INT" size="15"/>
          <Column id="month04" type="INT" size="15"/>
          <Column id="month05" type="INT" size="15"/>
          <Column id="month06" type="INT" size="15"/>
          <Column id="month07" type="INT" size="15"/>
          <Column id="month08" type="INT" size="15"/>
          <Column id="month09" type="INT" size="15"/>
          <Column id="month10" type="INT" size="15"/>
          <Column id="month11" type="INT" size="15"/>
          <Column id="month12" type="INT" size="15"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="gbn">무환급해약</Col>
            <Col id="month01">17</Col>
          </Row>
          <Row>
            <Col id="gbn">청약철회</Col>
            <Col id="month01">378</Col>
            <Col id="month02">418</Col>
            <Col id="month03">538</Col>
            <Col id="month04">384</Col>
          </Row>
          <Row>
            <Col id="gbn">해약</Col>
            <Col id="month01">484</Col>
            <Col id="month02">462</Col>
            <Col id="month03">709</Col>
            <Col id="month04">606</Col>
          </Row>
          <Row>
            <Col id="gbn">미처리건</Col>
            <Col id="month01">26</Col>
            <Col id="month02">52</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list_grd3" reversesubsum="true">
        <ColumnInfo>
          <Column id="gbn1" type="STRING" size="256"/>
          <Column id="gbn2" type="STRING" size="256"/>
          <Column id="cnt" type="INT" size="15"/>
          <Column id="col1" type="INT" size="15"/>
          <Column id="col2" type="INT" size="15"/>
          <Column id="col3" type="INT" size="15"/>
          <Column id="col4" type="INT" size="15"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="gbn1">청약철회</Col>
            <Col id="cnt">8</Col>
            <Col id="col1">194510</Col>
            <Col id="col2">249490</Col>
            <Col id="col3">444000</Col>
            <Col id="gbn2">비 채권</Col>
          </Row>
          <Row>
            <Col id="gbn1">해약완료</Col>
            <Col id="cnt">10</Col>
            <Col id="col1">7986310</Col>
            <Col id="col2">2334290</Col>
            <Col id="col3">6189655</Col>
            <Col id="col4">1796655</Col>
            <Col id="gbn2">비 채권</Col>
          </Row>
          <Row>
            <Col id="gbn1">해약완료</Col>
            <Col id="cnt">9</Col>
            <Col id="col1">7732810</Col>
            <Col id="col2">1839290</Col>
            <Col id="col3">5974180</Col>
            <Col id="col4">1758630</Col>
            <Col id="gbn2">채권</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list_grd5">
        <ColumnInfo>
          <Column id="gbn" type="STRING" size="256"/>
          <Column id="mn_cnt1" type="INT" size="15"/>
          <Column id="mn_cnt2" type="INT" size="15"/>
          <Column id="mn_rat2" type="INT" size="15"/>
          <Column id="mn_cnt3" type="INT" size="15"/>
          <Column id="mn_tot" type="INT" size="15"/>
          <Column id="yr_cnt1" type="INT" size="15"/>
          <Column id="yr_cnt2" type="INT" size="15"/>
          <Column id="yr_rat2" type="INT" size="15"/>
          <Column id="yr_cnt3" type="INT" size="15"/>
          <Column id="yr_tot" type="INT" size="15"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="gbn">S</Col>
            <Col id="mn_cnt1">1067</Col>
            <Col id="mn_cnt2">464</Col>
            <Col id="mn_rat2">20</Col>
            <Col id="mn_cnt3">37</Col>
            <Col id="mn_tot">1568</Col>
            <Col id="yr_cnt1">1067</Col>
            <Col id="yr_cnt2">464</Col>
            <Col id="yr_rat2">20</Col>
            <Col id="yr_cnt3">37</Col>
            <Col id="yr_tot">1568</Col>
          </Row>
          <Row>
            <Col id="gbn">SL</Col>
            <Col id="mn_cnt1">534</Col>
            <Col id="mn_cnt2">246</Col>
            <Col id="mn_rat2">11</Col>
            <Col id="mn_cnt3">19</Col>
            <Col id="mn_tot">799</Col>
            <Col id="yr_cnt1">534</Col>
            <Col id="yr_cnt2">246</Col>
            <Col id="yr_rat2">11</Col>
            <Col id="yr_cnt3">19</Col>
            <Col id="yr_tot">799</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list_grd4" reversesubsum="true">
        <ColumnInfo>
          <Column id="gbn1" type="STRING" size="256"/>
          <Column id="gbn2" type="STRING" size="256"/>
          <Column id="cnt" type="INT" size="15"/>
          <Column id="col1" type="INT" size="15"/>
          <Column id="col2" type="INT" size="15"/>
          <Column id="col3" type="INT" size="15"/>
          <Column id="col4" type="INT" size="15"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="gbn1">해약접수</Col>
            <Col id="cnt">24</Col>
            <Col id="col1">22105840</Col>
            <Col id="col2">3987460</Col>
            <Col id="col3">16692214</Col>
            <Col id="col4">5413626</Col>
            <Col id="gbn2">비 채권</Col>
          </Row>
          <Row>
            <Col id="gbn1">해약접수</Col>
            <Col id="cnt">22</Col>
            <Col id="col1">20740040</Col>
            <Col id="col2">2324260</Col>
            <Col id="col3">15531284</Col>
            <Col id="col4">5208756</Col>
            <Col id="gbn2">채권</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/********************************************************************************************/
/* 1. Include Library include, variables Declaration 영역                                  */
/********************************************************************************************/
include "LIB::lib_All.xjs";

//전역변수
var bXls = false;

/********************************************************************************************/
/* 2. Form 관련(onload 및 Form 이벤트) 처리                                           	*/
/********************************************************************************************/
function DL460500_onload(obj:Form, e:LoadEventInfo)
{	
	gfn_initForm(obj);
	
	gfn_athrPgm(gfn_gdsCd_admin()); //권한조회
	
	bXls = "Y" == ds_athrPgmFilter.getColumn(0, 'xls_yn');
	
	tab.tabpage1.btn_excel.visible = bXls;
	tab.tabpage2.btn_excel.visible = bXls;
	tab.tabpage3.btn_excel.visible = bXls;
	
    fn_init();
    
    fn_commSearch(gfn_getCommTypeInit()); // 조회
}

/********************************************************************************************/
/* 3. Callback(gfn_Transaction 호출 후 처리내용)                                   		*/
/********************************************************************************************/
function fn_callBack(svcid, errcd, errmsg) 
{
	if (errcd != 0) {
		return false;
	} else {
		gfn_setWaitCursor(false);
		switch (svcid) {
		case "getResnStatList":
			switch (tab.tabindex) {
			case 0:
				// 타이틀 년도 변경
				var oDate = new Date(tab.tabpage1.cal_srch_yr.value);
				var cYear = oDate.toFormatString("%Y");
				oDate.addYear(-1);
				var dYear = oDate.toFormatString("%Y");
				oDate = null;
				
				// 작년 데이터 필터링
				tab.tabpage1.stc_grd_1.text = dYear + "년 해약현황";
				ds_list_tmp.filter("resn_proc_yr =='" + dYear + "'");
				ds_list_grd1.clearData();
				ds_list_grd1.addRow();
				ds_list_grd1.setColumn(ds_list_grd1.rowcount-1, "gbn", "무환급해약");
				ds_list_grd1.addRow();
				ds_list_grd1.setColumn(ds_list_grd1.rowcount-1, "gbn", "청약철회");
				ds_list_grd1.addRow();
				ds_list_grd1.setColumn(ds_list_grd1.rowcount-1, "gbn", "해약");
				ds_list_grd1.addRow();
				ds_list_grd1.setColumn(ds_list_grd1.rowcount-1, "gbn", "미처리건");

				for(var i=0; i<ds_list_tmp.rowcount; i++) {
					ds_list_grd1.setColumn(0, "month"+ds_list_tmp.getColumn(i, "resn_proc_mn"), ds_list_tmp.getColumn(i, "무환급해약"));
					ds_list_grd1.setColumn(1, "month"+ds_list_tmp.getColumn(i, "resn_proc_mn"), ds_list_tmp.getColumn(i, "청약철회"));
					ds_list_grd1.setColumn(2, "month"+ds_list_tmp.getColumn(i, "resn_proc_mn"), ds_list_tmp.getColumn(i, "해약"));
					ds_list_grd1.setColumn(3, "month"+ds_list_tmp.getColumn(i, "resn_proc_mn"), ds_list_tmp.getColumn(i, "미처리건"));
				}
				
				for(var i=ds_list_tmp.rowcount+1; i<=12; i++) {
					ds_list_grd1.setColumn(0, "month"+(i<10? '0'+i : i), 0);
					ds_list_grd1.setColumn(1, "month"+(i<10? '0'+i : i), 0);
					ds_list_grd1.setColumn(2, "month"+(i<10? '0'+i : i), 0);
					ds_list_grd1.setColumn(3, "month"+(i<10? '0'+i : i), 0);
				}
				
				// 금년 데이터 필터링
				tab.tabpage1.stc_grd_2.text = cYear + "년 해약현황";
				ds_list_tmp.filter("resn_proc_yr =='" + cYear + "'");
				ds_list_grd2.clearData();
				ds_list_grd2.addRow();
				ds_list_grd2.setColumn(ds_list_grd2.rowcount-1, "gbn", "무환급해약");
				ds_list_grd2.addRow();
				ds_list_grd2.setColumn(ds_list_grd2.rowcount-1, "gbn", "청약철회");
				ds_list_grd2.addRow();
				ds_list_grd2.setColumn(ds_list_grd2.rowcount-1, "gbn", "해약");
				ds_list_grd2.addRow();
				ds_list_grd2.setColumn(ds_list_grd2.rowcount-1, "gbn", "미처리건");
				
				for(var i=0; i<ds_list_tmp.rowcount; i++) {
					ds_list_grd2.setColumn(0, "month"+ds_list_tmp.getColumn(i, "resn_proc_mn"), ds_list_tmp.getColumn(i, "무환급해약"));
					ds_list_grd2.setColumn(1, "month"+ds_list_tmp.getColumn(i, "resn_proc_mn"), ds_list_tmp.getColumn(i, "청약철회"));
					ds_list_grd2.setColumn(2, "month"+ds_list_tmp.getColumn(i, "resn_proc_mn"), ds_list_tmp.getColumn(i, "해약"));
					ds_list_grd2.setColumn(3, "month"+ds_list_tmp.getColumn(i, "resn_proc_mn"), ds_list_tmp.getColumn(i, "미처리건"));
				}
				
				for(var i=ds_list_tmp.rowcount+1; i<=12; i++) {
					ds_list_grd2.setColumn(0, "month"+(i<10? '0'+i : i), 0);
					ds_list_grd2.setColumn(1, "month"+(i<10? '0'+i : i), 0);
					ds_list_grd2.setColumn(2, "month"+(i<10? '0'+i : i), 0);
					ds_list_grd2.setColumn(3, "month"+(i<10? '0'+i : i), 0);
				}
				
				break;
				
			case 1:
				// ds_list_tmp.keystring = "G:gbn1";
				// ds_list_tmp.reversesubsum = true;
				
				ds_list_tmp.filter("gbn1 !='해약접수'");
				ds_list_grd3.copyData(ds_list_tmp, true);
				var basiRow = ds_list_grd3.getRowCount()-1;
				var sumCnt = 0;
				var sumCol1 = 0;
				var sumCol2 = 0;
				var sumCol3 = 0;
				var sumCol4 = 0;
				
				for (var i=ds_list_grd3.getRowCount()-1; i>=0; i--) {
					// trace("basiRow:" + basiRow + ", i:" + i + ", " + ds_list_grd3.getColumn(basiRow, "gbn1") + "," + ds_list_grd3.getColumn(i, "gbn1"));
					if (ds_list_grd3.getColumn(basiRow, "gbn1") != ds_list_grd3.getColumn(i, "gbn1")) {
						ds_list_grd3.insertRow(i+1);
						trace(basiRow-1);
						ds_list_grd3.setColumn(i+1, "gbn2", ds_list_grd3.getColumn(basiRow+1, "gbn1"));
						ds_list_grd3.setColumn(i+1, "cnt", sumCnt);
						ds_list_grd3.setColumn(i+1, "col1", sumCol1);
						ds_list_grd3.setColumn(i+1, "col2", sumCol2);
						ds_list_grd3.setColumn(i+1, "col3", sumCol3);
						ds_list_grd3.setColumn(i+1, "col4", sumCol4);
						
						sumCnt = 0;
						sumCol1 = 0;
						sumCol2 = 0;
						sumCol3 = 0;
						sumCol4 = 0;
						basiRow = i;
					}
					
					sumCnt += ds_list_grd3.getColumn(i, "cnt");
					sumCol1 += ds_list_grd3.getColumn(i, "col1");
					sumCol2 += ds_list_grd3.getColumn(i, "col2");
					sumCol3 += ds_list_grd3.getColumn(i, "col3");
					sumCol4 += ds_list_grd3.getColumn(i, "col4");
				}
				
				ds_list_grd3.insertRow(0);
				ds_list_grd3.setColumn(0, "gbn2", ds_list_grd3.getColumn(basiRow+1, "gbn1"));
				ds_list_grd3.setColumn(0, "cnt", sumCnt);
				ds_list_grd3.setColumn(0, "col1", sumCol1);
				ds_list_grd3.setColumn(0, "col2", sumCol2);
				ds_list_grd3.setColumn(0, "col3", sumCol3);
				ds_list_grd3.setColumn(0, "col4", sumCol4);
				
				
				ds_list_tmp.filter("gbn1 == '해약접수'");
				ds_list_grd4.copyData(ds_list_tmp, true);
				basiRow = ds_list_grd4.getRowCount()-1;
				sumCnt = 0;
				sumCol1 = 0;
				sumCol2 = 0;
				sumCol3 = 0;
				sumCol4 = 0;
				
				for (var i=ds_list_grd4.getRowCount()-1; i>=0; i--) {
					// trace("basiRow:" + basiRow + ", i:" + i + ", " + ds_list_grd4.getColumn(basiRow, "gbn1") + "," + ds_list_grd4.getColumn(i, "gbn1"));
					if (ds_list_grd4.getColumn(basiRow, "gbn1") != ds_list_grd4.getColumn(i, "gbn1")) {
						ds_list_grd4.insertRow(i+1);
						ds_list_grd4.setColumn(i+1, "gbn2", ds_list_grd4.getColumn(basiRow+1, "gbn1"));
						ds_list_grd4.setColumn(i+1, "cnt", sumCnt);
						ds_list_grd4.setColumn(i+1, "col1", sumCol1);
						ds_list_grd4.setColumn(i+1, "col2", sumCol2);
						ds_list_grd4.setColumn(i+1, "col3", sumCol3);
						ds_list_grd4.setColumn(i+1, "col4", sumCol4);
						
						sumCnt = 0;
						sumCol1 = 0;
						sumCol2 = 0;
						sumCol3 = 0;
						sumCol4 = 0;
						basiRow = i;
					}
					
					sumCnt += ds_list_grd4.getColumn(i, "cnt");
					sumCol1 += ds_list_grd4.getColumn(i, "col1");
					sumCol2 += ds_list_grd4.getColumn(i, "col2");
					sumCol3 += ds_list_grd4.getColumn(i, "col3");
					sumCol4 += ds_list_grd4.getColumn(i, "col4");
				}
				
				ds_list_grd4.insertRow(0);						
				ds_list_grd4.setColumn(0, "gbn2", ds_list_grd4.getColumn(basiRow+1, "gbn1"));
				ds_list_grd4.setColumn(0, "cnt", sumCnt);
				ds_list_grd4.setColumn(0, "col1", sumCol1);
				ds_list_grd4.setColumn(0, "col2", sumCol2);
				ds_list_grd4.setColumn(0, "col3", sumCol3);
				ds_list_grd4.setColumn(0, "col4", sumCol4);
				break;
				
			case 2:
				ds_list_grd5.assign(ds_list_tmp)
				break;
			}
			
			break;
		}
	}
}

/********************************************************************************************/
/**   4. Validation 처리                                                                   	*/
/********************************************************************************************/

/********************************************************************************************/
/**   5. 서비스 호출(gfn_Transaction)                                                   	*/
/********************************************************************************************/
// 조회
function fn_commSearch(sType) {
    var szSvcid       = "getResnStatList";
	var szController  = "/dlw/resn/stat-list";
	var szInDs        = "";
	var szOutDs       = "ds_list_tmp=ds_output"
	var szParam       = "";
	var szRetCallback = "fn_callBack";
	
    switch (tab.tabindex) {
	case 0:
		var sSrchYr = tab.tabpage1.cal_srch_yr.value;
		if (gfn_isNull(sSrchYr)) {
			alert("조회년도를 입력하세요.");
			tab.tabpage1.cal_srch_yr.setFocus();
			return;
		}
		sSrchYr = String(sSrchYr).replace(/\D/g, "").substring(0, 4);
		szParam = "stat_gbn=Stat1 srch_yr=" + sSrchYr;
		break;
		
	case 1:
		var sSrchSttDt = tab.tabpage2.cal_srch_stt_dt.value;
		var sSrchEndDt = tab.tabpage2.cal_srch_end_dt.value;
		if (gfn_isNull(sSrchSttDt)) {
			alert("조회일자를 입력하세요.");
			tab.tabpage2.cal_srch_stt_dt.setFocus();
			return;
		}
		if (gfn_isNull(sSrchEndDt)) {
			alert("조회일자를 입력하세요.");
			tab.tabpage2.cal_srch_end_dt.setFocus();
			return;
		}
		sSrchSttDt = String(sSrchSttDt).replace(/\D/g, "");
		sSrchSttDt = sSrchSttDt.substring(0, 4) + "-" + sSrchSttDt.substring(4, 6) + "-" + sSrchSttDt.substring(6, 8);
		sSrchEndDt = String(sSrchEndDt).replace(/\D/g, "");
		sSrchEndDt = sSrchEndDt.substring(0, 4) + "-" + sSrchEndDt.substring(4, 6) + "-" + sSrchEndDt.substring(6, 8);
		szParam = "stat_gbn=Stat2 srch_stt_dt=" + sSrchSttDt + " srch_end_dt=" + sSrchEndDt;
		break;
		
	case 2:
		var sSrchSttDt = tab.tabpage3.cal_srch_stt_dt.value;
		var sSrchEndDt = tab.tabpage3.cal_srch_end_dt.value;
		if (gfn_isNull(sSrchSttDt)) {
			alert("조회일자를 입력하세요.");
			tab.tabpage3.cal_srch_stt_dt.setFocus();
			return;
		}
		if (gfn_isNull(sSrchEndDt)) {
			alert("조회일자를 입력하세요.");
			tab.tabpage3.cal_srch_end_dt.setFocus();
			return;
		}
		sSrchSttDt = String(sSrchSttDt).replace(/\D/g, "");
		sSrchSttDt = sSrchSttDt.substring(0, 4) + "-" + sSrchSttDt.substring(4, 6) + "-" + sSrchSttDt.substring(6, 8);
		sSrchEndDt = String(sSrchEndDt).replace(/\D/g, "");
		sSrchEndDt = sSrchEndDt.substring(0, 4) + "-" + sSrchEndDt.substring(4, 6) + "-" + sSrchEndDt.substring(6, 8);
		szParam = "stat_gbn=Stat3 srch_stt_dt=" + sSrchSttDt + " srch_end_dt=" + sSrchEndDt;
		break;
    }
    
    if (gfn_isNull(szParam)) {
        return;
    }
    // alert(szParam);
    
    // 트랜젝션 공통함수 호출
    gfn_transaction(this, szSvcid, szController, szInDs, szOutDs, szParam, szRetCallback);
}


/********************************************************************************************/
/**   6. 사용자 함수                                                                   	*/
/********************************************************************************************/
// 초기화
function fn_init()
{
    var sToday = gfn_getToday();
    tab.tabpage1.cal_srch_yr.value = sToday;
    tab.tabpage2.cal_srch_stt_dt.value = sToday;
    tab.tabpage2.cal_srch_end_dt.value = sToday;
    tab.tabpage3.cal_srch_stt_dt.value = sToday;
    tab.tabpage3.cal_srch_end_dt.value = sToday;
}

// 권한에 따른 버튼 설정
function fn_setAthrPgmBtn()
{
	gfn_athrPgm(gfn_gdsCd_admin());

	if (xlsYn == "N") {
	    tab.tabpage1.btn_excel.visible = false;
	    tab.tabpage2.btn_excel.visible = false;
	    tab.tabpage3.btn_excel.visible = false;
	}
}

// 엑셀 타이틀 생성
function fn_createExcelTitle(psTitleNm, psTitleCnts)
{
	var sTitleHead = "<Formats><Format id='format01'><Columns><Column size='227'/></Columns><Rows><Row size='24' band='head'/></Rows><Band id='head'><Cell style='align:left;line:1 solid white;background:white;barcolor:white;' text='";
	var sTitleTail = "'/></Band></Format></Formats>";
	
	var oTmpTitleGrd = new Grid(psTitleNm, 10, 10, 10, 10);	
	this.addChild(psTitleNm, oTmpTitleGrd); 
	eval(psTitleNm).formats = sTitleHead + psTitleCnts + sTitleTail;
}

// 그리드 엑셀파일 출력
function fn_exportGridToExcel(sFileName, sSheetName)
{
	var oExport = new ExportObject();
	
    switch (tab.tabindex) {
        case 0: // 월별
			var sSheetName = "월별해약현황";
			var sFileName = sSheetName + "_" + gfn_getTodayFull();
			
			sFileName = gfn_fileSavePath("", sFileName, "EXCEL");
			if (gfn_isNull(sFileName)) {
			    return false;
			}
	
			oExport.exporttype = ExportTypes.EXCEL;
			oExport.activepagename = sSheetName;	
			oExport.exportfilename = sFileName;
			oExport.exportopenmode = "overwrite";
			
			fn_createExcelTitle("grd_title_1", "■ " + tab.tabpage1.stc_grd_1.text);
			oExport.addExportItem(ExportItemTypes.GRID, grd_title_1, sSheetName + "!A1", "", "", "", "onlyvalue");
			
			oExport.addExportItem(ExportItemTypes.GRID, tab.tabpage1.grd_1, sSheetName + "!A2");
			
			fn_createExcelTitle("grd_title_2", "■ " + tab.tabpage1.stc_grd_2.text);
			oExport.addExportItem(ExportItemTypes.GRID, grd_title_2, sSheetName + "!A11", "", "", "", "onlyvalue");
			
			oExport.addExportItem(ExportItemTypes.GRID, tab.tabpage1.grd_2, sSheetName + "!A12");

			oExport.exporteventtype = "itemrecord";
			oExport.exportuitype = "exportprogress";
			oExport.exportmessageprocess = "%d 엑셀을 출력중입니다.%d/%d";
			oExport.exportsavemode = "save";
			
			oExport.export();
			
			break;
			
        case 1: // 종합
			var sSheetName = "종합해약현황";
			var sFileName = sSheetName + "_" + gfn_getTodayFull();
			
			sFileName = gfn_fileSavePath("", sFileName, "EXCEL");
			if (gfn_isNull(sFileName)) {
			    return false;
			}
	
			oExport.exporttype = ExportTypes.EXCEL;
			oExport.activepagename = sSheetName;	
			oExport.exportfilename = sFileName;
			oExport.exportopenmode = "overwrite";
			
			fn_createExcelTitle("grd_title_3", "■ " + tab.tabpage2.stc_grd_3.text);
			oExport.addExportItem(ExportItemTypes.GRID, grd_title_3, sSheetName + "!A1", "", "", "", "onlyvalue");
			
			oExport.addExportItem(ExportItemTypes.GRID, tab.tabpage2.grd_3, sSheetName + "!A2");
			
			oExport.addExportItem(ExportItemTypes.GRID, tab.tabpage2.grd_4, sSheetName + "!A9");

			oExport.exporteventtype = "itemrecord";
			oExport.exportuitype = "exportprogress";
			oExport.exportmessageprocess = "%d 엑셀을 출력중입니다.%d/%d";
			oExport.exportsavemode = "save";
			
			oExport.export();
			
			break;
			
        case 2: // 상품군별
			var sSheetName = "상품군별해약현황";
			var sFileName = sSheetName + "_" + gfn_getTodayFull();
			
			sFileName = gfn_fileSavePath("", sFileName, "EXCEL");
			if (gfn_isNull(sFileName)) {
			    return false;
			}
	
			oExport.exporttype = ExportTypes.EXCEL;
			oExport.activepagename = sSheetName;	
			oExport.exportfilename = sFileName;
			oExport.exportopenmode = "overwrite";
			
			fn_createExcelTitle("grd_title_5", "■ " + tab.tabpage3.stc_grd_5.text);
			oExport.addExportItem(ExportItemTypes.GRID, grd_title_5, sSheetName + "!A1", "", "", "", "onlyvalue");
			
			oExport.addExportItem(ExportItemTypes.GRID, tab.tabpage3.grd_5, sSheetName + "!A2");

			oExport.exporteventtype = "itemrecord";
			oExport.exportuitype = "exportprogress";
			oExport.exportmessageprocess = "%d 엑셀을 출력중입니다.%d/%d";
			oExport.exportsavemode = "save";
			
			oExport.export();
			
			break;
	}
	
	oExport = null;
}


/********************************************************************************************/
/**   7. 이벤트(Event) Function                                                          	*/
/********************************************************************************************/
// 조회 버튼 클릭 시
function btn_search_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_commSearch(gfn_getCommTypeInit()); // 조회
}

// 엑셀 버튼 클릭 시
function btn_excel_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_exportGridToExcel();
}

function tab_onchanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	fn_commSearch(gfn_getCommTypeInit());
}
]]></Script>
  </Form>
</FDL>
