<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="test3" classname="test3" inheritanceid="" position="absolute 0 0 1024 768" titletext="New Form">
    <Layouts>
      <Layout>
        <Grid id="Grid00" taborder="0" useinputpanel="false" position="absolute 47 23 395 215" binddataset="ds_list" formats="&lt;Formats&gt;&#10;  &lt;Format id=&quot;default&quot;&gt;&#10;    &lt;Columns&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;    &lt;/Columns&gt;&#10;    &lt;Rows&gt;&#10;      &lt;Row band=&quot;head&quot; size=&quot;24&quot;/&gt;&#10;      &lt;Row band=&quot;body&quot; size=&quot;24&quot;/&gt;&#10;    &lt;/Rows&gt;&#10;    &lt;Band id=&quot;head&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;_chk&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;Column1&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;Column2&quot;/&gt;&#10;    &lt;/Band&gt;&#10;    &lt;Band id=&quot;body&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;bind:_chk&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;bind:Column1&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;bind:Column2&quot;/&gt;&#10;    &lt;/Band&gt;&#10;  &lt;/Format&gt;&#10;&lt;/Formats&gt;&#10;" autoenter="select">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="_chk"/>
                <Cell col="1" text="aaa"/>
                <Cell col="2" text="Column2"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" text="bind:_chk" suppress="1"/>
                <Cell col="1" edittype="normal" text="bind:Column1" suppress="2" suppressalign="middle,over"/>
                <Cell col="2" text="bind:Column2"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="Button00" taborder="1" text="Button00" position="absolute 681 85 825 122" onclick="Button00_onclick"/>
        <MaskEdit id="MaskEdit00" taborder="1" position="absolute 609 16 795 45" type="number" mask="###,##0"/>
        <Edit id="Edit00" taborder="1" position="absolute 609 50 785 80"/>
        <Grid id="Grid01" taborder="1" useinputpanel="false" position="absolute 737 153 936 248">
          <Formats/>
        </Grid>
        <Grid id="Grid02" taborder="1" useinputpanel="false" position="absolute 59 270 645 469" binddataset="ds_list" formats="&lt;Formats&gt;&#10;  &lt;Format id=&quot;default&quot;&gt;&#10;    &lt;Columns&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;    &lt;/Columns&gt;&#10;    &lt;Rows&gt;&#10;      &lt;Row band=&quot;head&quot; size=&quot;24&quot;/&gt;&#10;      &lt;Row band=&quot;body&quot; size=&quot;24&quot;/&gt;&#10;    &lt;/Rows&gt;&#10;    &lt;Band id=&quot;head&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;_chk&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;Column1&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;Column2&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;Column0&quot;/&gt;&#10;    &lt;/Band&gt;&#10;    &lt;Band id=&quot;body&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;bind:_chk&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;bind:Column1&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;bind:Column2&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;bind:Column0&quot;/&gt;&#10;    &lt;/Band&gt;&#10;  &lt;/Format&gt;&#10;&lt;/Formats&gt;&#10;">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="_chk"/>
                <Cell col="1" text="Column1"/>
                <Cell col="2" text="Column2"/>
                <Cell col="3" text="Column0"/>
              </Band>
              <Band id="body">
                <Cell text="bind:_chk"/>
                <Cell col="1" text="bind:Column1"/>
                <Cell col="2" text="bind:Column2"/>
                <Cell col="3" text="expr:Column2+String.fromCharCode(13)+String.fromCharCode(10)+'('+Column0+')'"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="Grid03" taborder="1" useinputpanel="false" position="absolute 555 270 866 476" formats="&lt;Formats&gt;&#10;  &lt;Format id=&quot;default&quot;&gt;&#10;    &lt;Columns&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;    &lt;/Columns&gt;&#10;    &lt;Rows&gt;&#10;      &lt;Row band=&quot;head&quot; size=&quot;24&quot;/&gt;&#10;      &lt;Row band=&quot;body&quot; size=&quot;24&quot;/&gt;&#10;    &lt;/Rows&gt;&#10;    &lt;Band id=&quot;head&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;_chk&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;Column1&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;Column2&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;Column0&quot;/&gt;&#10;    &lt;/Band&gt;&#10;    &lt;Band id=&quot;body&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;bind:_chk&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;bind:Column1&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;bind:Column2&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;bind:Column0&quot;/&gt;&#10;    &lt;/Band&gt;&#10;  &lt;/Format&gt;&#10;&lt;/Formats&gt;&#10;">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" text="_chk" displaytype="normal"/>
                <Cell col="1" text="Column1" displaytype="normal"/>
                <Cell col="2" text="Column2" displaytype="normal"/>
                <Cell col="3" text="Column0" displaytype="normal"/>
              </Band>
              <Band id="body">
                <Cell col="0" text="bind:_chk" displaytype="normal"/>
                <Cell col="1" text="bind:Column1" displaytype="normal"/>
                <Cell col="2" text="bind:Column2" displaytype="normal"/>
                <Cell col="3" text="bind:Column0" displaytype="normal"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="Button01" taborder="1" text="&gt;&gt;&gt;" position="absolute 432 345 505 388" onclick="Button01_onclick"/>
        <ImageViewer id="ImageViewer00" taborder="1" text="ImageViewer00" position="absolute 435 86 659 239" image="URL('http://10.3.8.37:8080/forum/templates/default/images/logo.gif')"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="_chk" type="STRING" size="256"/>
          <Column id="Column1" type="STRING" size="256"/>
          <Column id="Column2" type="STRING" size="256"/>
          <Column id="Column0" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="Column1">a</Col>
            <Col id="Column2">1</Col>
            <Col id="Column0">a1111</Col>
          </Row>
          <Row>
            <Col id="Column1">a</Col>
            <Col id="Column2">2</Col>
            <Col id="Column0">a2222</Col>
          </Row>
          <Row>
            <Col id="Column1">a</Col>
            <Col id="Column2">2</Col>
            <Col id="Column0">a3333</Col>
          </Row>
          <Row>
            <Col id="Column1">b</Col>
            <Col id="Column2">3</Col>
            <Col id="Column0">b1111</Col>
          </Row>
          <Row>
            <Col id="Column1">b</Col>
            <Col id="Column2">4</Col>
            <Col id="Column0">b2222</Col>
          </Row>
          <Row>
            <Col id="Column1">c</Col>
            <Col id="Column2">5</Col>
            <Col id="Column0">b3333</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="Dataset00" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="Column0" type="STRING" size="256"/>
          <Column id="Column1" type="STRING" size="256"/>
          <Column id="Column2" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="Column0">1000</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="MaskEdit00" propid="value" datasetid="Dataset00" columnid="Column0"/>
      <BindItem id="item1" compid="Edit00" propid="value" datasetid="Dataset00" columnid="Column0"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "LIB::lib_All.xjs";

function Button00_onclick(obj:Button,  e:ClickEventInfo)
{
	var objEx = new ExtCommon();
	//var rtn = objEx.ds2Csv(this.ds_list, "C:\\aaa.csv");
	var rtn = objEx.ds2CsvNF(ds_list,"C:\\aaa.csv",false,true,",","\r\n");
	trace(rtn);
}

function Button01_onclick(obj:Button,  e:ClickEventInfo)
{
	var sColList = "Column1,Column2";		// Key String(구분자:",")
	var objDs = fn_getDuplExclusionDs(ds_list, sColList);
	
	Grid03.binddataset = objDs;
}

function fn_getDuplExclusionDs(objDs, sColList)
{
	var arrColList = sColList.split(",");
	var sFindStr;
		
	//ds_list_temp.clearData();
	var objDsTemp = gfn_createDataset(this, objDs.name+"_Dupl");
	objDsTemp.clear();
	
	for(var i=0;i<objDs.getColCount();i++)
	{
		var objColumnInfo = objDs.getColumnInfo(i);
		var nIndex = objDsTemp.addColumnInfo(objColumnInfo.name,objColumnInfo);
	}
	
	//trace(objDsTemp.saveXML());
	
	for(var i=0;i<objDs.rowcount;i++)
	{
		// Find 대상 Key String 생성
		for(var j=0;j<arrColList.length;j++)
		{
			if(j == 0)
				sFindStr = arrColList[j] + "=='"+objDs.getColumn(i, arrColList[j])+"'";
			else
				sFindStr += "&&"+arrColList[j] + "=='"+objDs.getColumn(i, arrColList[j])+"'";
		}
			
		//trace("sFindStr::"+sFindStr);	
	
		var nFRow = objDsTemp.findRowExpr(sFindStr);
		
		if(nFRow == -1) {
			var nRow = objDsTemp.addRow();
			objDsTemp.copyRow(nRow, objDs, i);
		}
	}
	
	//trace(objDsTemp.saveXML());
	
	//Grid03.binddataset = objDsTemp;
	
	return objDsTemp;
}]]></Script>
  </Form>
</FDL>
