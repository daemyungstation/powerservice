<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="Sample_06" classname="Sample_06" inheritanceid="" position="absolute 0 0 843 738" titletext="EASY PAY 7.0 플러그인" onload="FrmDev_onload">
    <Layouts>
      <Layout>
        <Static id="stc_09" class="sta_workSrcBg" position="absolute 7 285 836 576"/>
        <Static id="stc_01" text="가맹점 정보(필수)" class="sta_workTitle3" position="absolute 10 24 216 44"/>
        <Static id="stc_33" class="sta_workSrcBg" position="absolute 7 45 836 136"/>
        <Edit id="EP_mall_id" taborder="0" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 132 61 382 86" value="T0002095"/>
        <Static id="stc_00" text="가맹점 아이디" class="sta_workSrcLabel1" position="absolute 17 64 117 84"/>
        <Static id="stc_02" text="가맹점명" class="sta_workSrcLabel1" position="absolute 17 96 117 116"/>
        <Edit id="EP_mall_nm" taborder="2" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 132 93 382 118" value="교원 테스트 가맹점 1호"/>
        <Edit id="EP_mall_pwd" taborder="1" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 572 61 822 86" value="T0002095"/>
        <Static id="stc_07" text="가맹점 패스워드" class="sta_workSrcLabel1" position="absolute 457 64 557 84"/>
        <Static id="stc_03" text="가맹점 CI URL" class="sta_workSrcLabel1" position="absolute 457 96 557 116"/>
        <Edit id="EP_ci_url" taborder="3" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 572 93 822 118" value="http://testoffice.easypay.co.kr"/>
        <Static id="stc_04" class="sta_workSrcBg" position="absolute 7 181 836 239"/>
        <Static id="stc_05" text="고객 주민번호" class="sta_workSrcLabel1" position="absolute 17 200 117 220" style="font:dotum,9,bold;"/>
        <Edit id="EP_soc_no" taborder="4" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 132 197 382 222" style="compositecolor:#ffffff67;" value="8204211047519"/>
        <Static id="stc_06" text="플러그인 정보(필수)" class="sta_workTitle3" position="absolute 10 160 216 180"/>
        <Static id="stc_08" text="플러그인 정보(필수)" class="sta_workTitle3" position="absolute 10 264 216 284"/>
        <Edit id="EP_order_no" taborder="5" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 132 301 382 326" value="ORDER_201302081360305081587"/>
        <Static id="stc_10" text="주문 번호" class="sta_workSrcLabel1" position="absolute 17 304 117 324"/>
        <Edit id="EP_user_id" taborder="7" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 132 333 382 358" value="USER_1360305081587"/>
        <Static id="stc_11" text="고객 ID" class="sta_workSrcLabel1" position="absolute 17 336 117 356"/>
        <Edit id="EP_user_mail" taborder="9" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 132 365 382 390" value="test@kicc.co.kr"/>
        <Static id="stc_12" text="고객 Email" class="sta_workSrcLabel1" position="absolute 17 368 117 388"/>
        <Edit id="EP_user_phone2" taborder="11" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 132 397 382 422" value="01012345678"/>
        <Static id="stc_13" text="고객 휴대폰" class="sta_workSrcLabel1" position="absolute 17 400 117 420"/>
        <Edit id="EP_user_addr" taborder="12" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 132 429 822 459" value="서울 금천구 가산동 459-9 "/>
        <Static id="stc_14" text="고객 주소" class="sta_workSrcLabel1" position="absolute 17 437 117 457"/>
        <Edit id="EP_product_nm" taborder="13" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 132 466 382 491" value="☆테스트상품☆"/>
        <Static id="stc_15" text="상품명" class="sta_workSrcLabel1" position="absolute 17 471 117 491"/>
        <Static id="stc_16" text="상품 구분" class="sta_workSrcLabel1" position="absolute 17 501 117 521"/>
        <Static id="stc_17" text="사용자 구분" class="sta_workSrcLabel1" position="absolute 457 302 557 322"/>
        <Static id="stc_18" text="고객명" class="sta_workSrcLabel1" position="absolute 457 334 557 354" style="font:dotum,9,bold;"/>
        <Edit id="EP_user_nm" taborder="8" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 572 331 822 356" style="compositecolor:#ffffff67;" value="김태형"/>
        <Static id="stc_19" text="고객 전화번호" class="sta_workSrcLabel1" position="absolute 457 366 557 386"/>
        <Edit id="EP_user_phone1" taborder="10" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 572 363 822 388" value="0212344567"/>
        <Edit id="EP_product_amt" taborder="14" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 572 466 822 491" value="0"/>
        <Static id="stc_20" text="상품 금액" class="sta_workSrcLabel1" position="absolute 457 471 557 491"/>
        <Combo id="EP_user_type" taborder="6" text="회원" position="absolute 572 299 642 324" innerdataset="@userType" codecolumn="value" datacolumn="title" index="1" value="2"/>
        <Combo id="EP_product_type" taborder="15" innerdataset="@itemType" codecolumn="value" datacolumn="title" index="0" position="absolute 133 498 203 523" value="0" text="실물" onitemchanged="EP_product_type_onitemchanged"/>
        <ActiveX id="plugin_obj" position="absolute 8 694 181 728" taborder="19" progid="{5BBC9EAD-D958-4F1F-8778-31F3F0DD2254}" codebase="https://testgw.easypay.co.kr/plugin/file/EasyPayPlugin.cab#Version=1,0,0,4"/>
        <Static id="stc_21" text="무이자 여부" class="sta_workSrcLabel1" position="absolute 17 532 117 552"/>
        <Combo id="EP_noint" taborder="17" innerdataset="@noint" codecolumn="value" datacolumn="title" index="0" position="absolute 133 529 203 554" value="00" text="예"/>
        <Static id="stc_22" text="할부 개월" class="sta_workSrcLabel1" position="absolute 456 501 556 521"/>
        <Combo id="EP_install_period" taborder="16" innerdataset="@installPeriod" codecolumn="value" datacolumn="title" index="0" position="absolute 572 498 656 523" value="00" text="일시불"/>
        <Button id="btn_Submit00" taborder="1" text="결제 요청" onclick="fn_easypay_submit" position="absolute 751 13 834 40"/>
        <Button id="btn_Submit01" taborder="1" text="결제 취소" onclick="fn_easypay_cancle" position="absolute 749 587 832 614"/>
        <Static id="stc_23" text="플러그인 정보(필수)" class="sta_workTitle3" position="absolute 10 600 216 620"/>
        <Static id="stc_24" class="sta_workSrcBg" position="absolute 7 621 836 680"/>
        <Edit id="org_cno" taborder="1" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 132 637 382 662" style="compositecolor:#ffffff67;"/>
        <Static id="stc_25" text="PG거래번호" class="sta_workSrcLabel1" position="absolute 17 640 117 660" style="font:dotum,9,bold;"/>
        <Edit id="req_id" taborder="1" value="USER_1360305081587" onkeydown="edt_email2_onkeydown" oneditclick="edt_email2_oneditclick" position="absolute 572 637 822 662" style="compositecolor:#ffffff67;"/>
        <Static id="stc_26" text="요청자 ID" class="sta_workSrcLabel1" position="absolute 457 639 557 659"/>
        <Button id="btn_Submit02" taborder="1" text="결제 승인 리스트" onclick="fn_easypay_cancle" position="absolute 624 587 741 614"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item1" compid="EP_mall_id" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item0" compid="EP_mall_nm" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item6" compid="EP_mall_pwd" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item2" compid="EP_ci_url" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item3" compid="EP_soc_no" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item4" compid="EP_order_no" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item5" compid="EP_user_id" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item7" compid="EP_user_mail" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item8" compid="EP_user_phone2" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item9" compid="EP_user_addr" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item10" compid="EP_product_nm" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item13" compid="EP_user_nm" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item14" compid="EP_user_phone1" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item15" compid="EP_product_amt" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item11" compid="org_cno" propid="value" datasetid="ds_input" columnid="prdtNm"/>
      <BindItem id="item12" compid="req_id" propid="value" datasetid="ds_input" columnid="prdtNm"/>
    </Bind>
    <Objects>
      <Dataset id="userType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="title" type="STRING" size="256"/>
          <Column id="value" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="title">일반</Col>
            <Col id="value">1</Col>
          </Row>
          <Row>
            <Col id="title">회원</Col>
            <Col id="value">2</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="itemType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="title" type="STRING" size="256"/>
          <Column id="value" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="title">실물</Col>
            <Col id="value">0</Col>
          </Row>
          <Row>
            <Col id="title">컨텐츠</Col>
            <Col id="value">1</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="installPeriod" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="title" type="STRING" size="256"/>
          <Column id="value" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="title">일시불</Col>
            <Col id="value">00</Col>
          </Row>
          <Row>
            <Col id="title">02 개월</Col>
            <Col id="value">02</Col>
          </Row>
          <Row>
            <Col id="title">03 개월</Col>
            <Col id="value">03</Col>
          </Row>
          <Row>
            <Col id="title">04 개월</Col>
            <Col id="value">04</Col>
          </Row>
          <Row>
            <Col id="title">05 개월</Col>
            <Col id="value">05</Col>
          </Row>
          <Row>
            <Col id="title">06 개월</Col>
            <Col id="value">06</Col>
          </Row>
          <Row>
            <Col id="title">07 개월</Col>
            <Col id="value">07</Col>
          </Row>
          <Row>
            <Col id="title">08 개월</Col>
            <Col id="value">08</Col>
          </Row>
          <Row>
            <Col id="title">09 개월</Col>
            <Col id="value">09</Col>
          </Row>
          <Row>
            <Col id="title">10 개월</Col>
            <Col id="value">10</Col>
          </Row>
          <Row>
            <Col id="title">11 개월</Col>
            <Col id="value">11</Col>
          </Row>
          <Row>
            <Col id="title">12 개월</Col>
            <Col id="value">12</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="noint" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="title" type="STRING" size="256"/>
          <Column id="value" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="title">일반</Col>
            <Col id="value">00</Col>
          </Row>
          <Row>
            <Col id="title">무이자</Col>
            <Col id="value">02</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_in_easyPay" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="trCd" type="STRING" size="256"/>
          <Column id="traceNo" type="STRING" size="256"/>
          <Column id="sessionKey" type="STRING" size="256"/>
          <Column id="encryptData" type="STRING" size="256"/>
          <Column id="payType" type="STRING" size="256"/>
          <Column id="complexYn" type="STRING" size="256"/>
          <Column id="cardCode" type="STRING" size="256"/>
          <Column id="clientIp" type="STRING" size="256"/>
          <Column id="userType" type="STRING" size="256"/>
          <Column id="orderNo" type="STRING" size="256"/>
          <Column id="mallId" type="STRING" size="256"/>
          <Column id="membUserNo" type="STRING" size="256"/>
          <Column id="userId" type="STRING" size="256"/>
          <Column id="userNm" type="STRING" size="256"/>
          <Column id="userMail" type="STRING" size="256"/>
          <Column id="userPhone1" type="STRING" size="256"/>
          <Column id="userPhone2" type="STRING" size="256"/>
          <Column id="userAddr" type="STRING" size="256"/>
          <Column id="productType" type="STRING" size="256"/>
          <Column id="productNm" type="STRING" size="256"/>
          <Column id="productAmt" type="STRING" size="256"/>
          <Column id="installPeriod" type="STRING" size="256"/>
          <Column id="totAmt" type="STRING" size="256"/>
          <Column id="currency" type="STRING" size="256"/>
          <Column id="escrowYn" type="STRING" size="256"/>
          <Column id="cardTxType" type="STRING" size="256"/>
          <Column id="reqType" type="STRING" size="256"/>
          <Column id="cardAmt" type="STRING" size="256"/>
          <Column id="cardNo" type="STRING" size="256"/>
          <Column id="noint" type="STRING" size="256"/>
          <Column id="wcc" type="STRING" size="256"/>
          <Column id="mgrTxType" type="STRING" size="256"/>
          <Column id="mgrSubtype" type="STRING" size="256"/>
          <Column id="orgCno" type="STRING" size="256"/>
          <Column id="mgrAmt" type="STRING" size="256"/>
          <Column id="mgrRemAmt" type="STRING" size="256"/>
          <Column id="mgrTaxFlg" type="STRING" size="256"/>
          <Column id="mgrTaxAmt" type="STRING" size="256"/>
          <Column id="mgrFreeAmt" type="STRING" size="256"/>
          <Column id="mgrVatAmt" type="STRING" size="256"/>
          <Column id="mgrBankCd" type="STRING" size="256"/>
          <Column id="mgrAccount" type="STRING" size="256"/>
          <Column id="mgrDepositor" type="STRING" size="256"/>
          <Column id="mgrSocno" type="STRING" size="256"/>
          <Column id="mgrTelno" type="STRING" size="256"/>
          <Column id="deliCd" type="STRING" size="256"/>
          <Column id="deliCorpCd" type="STRING" size="256"/>
          <Column id="deliInvoice" type="STRING" size="256"/>
          <Column id="deliRcvNm" type="STRING" size="256"/>
          <Column id="deliRcvTel" type="STRING" size="256"/>
          <Column id="reqIp" type="STRING" size="256"/>
          <Column id="reqId" type="STRING" size="256"/>
          <Column id="mgrMsg" type="STRING" size="256"/>
          <Column id="mgrData" type="STRING" size="256"/>
          <Column id="txReqData" type="STRING" size="256"/>
          <Column id="bDBProc" type="STRING" size="256"/>
          <Column id="resCd" type="STRING" size="256"/>
          <Column id="resMsg" type="STRING" size="256"/>
          <Column id="GWURL" type="STRING" size="256"/>
          <Column id="GWPORT" type="STRING" size="256"/>
          <Column id="CERTPATH" type="STRING" size="256"/>
          <Column id="LOGPATH" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_out_easyPay" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="resCd" type="STRING" size="256"/>
          <Column id="resMsg" type="STRING" size="256"/>
          <Column id="userNm" type="STRING" size="256"/>
          <Column id="cno" type="STRING" size="256"/>
          <Column id="amount" type="STRING" size="256"/>
          <Column id="msgType" type="STRING" size="256"/>
          <Column id="orderNo" type="STRING" size="256"/>
          <Column id="notiType" type="STRING" size="256"/>
          <Column id="authNo" type="STRING" size="256"/>
          <Column id="tranDate" type="STRING" size="256"/>
          <Column id="pntAuthNo" type="STRING" size="256"/>
          <Column id="pntTranDate" type="STRING" size="256"/>
          <Column id="cponAuthNo" type="STRING" size="256"/>
          <Column id="cponTranDate" type="STRING" size="256"/>
          <Column id="cardNo" type="STRING" size="256"/>
          <Column id="issuerCd" type="STRING" size="256"/>
          <Column id="issuerNm" type="STRING" size="256"/>
          <Column id="acquirerCd" type="STRING" size="256"/>
          <Column id="acquirerNm" type="STRING" size="256"/>
          <Column id="installPeriod" type="STRING" size="256"/>
          <Column id="noint" type="STRING" size="256"/>
          <Column id="bankCd" type="STRING" size="256"/>
          <Column id="bankNm" type="STRING" size="256"/>
          <Column id="accountNo" type="STRING" size="256"/>
          <Column id="depositNm" type="STRING" size="256"/>
          <Column id="expireDate" type="STRING" size="256"/>
          <Column id="cashResCd" type="STRING" size="256"/>
          <Column id="cashResMsg" type="STRING" size="256"/>
          <Column id="cashAuthNo" type="STRING" size="256"/>
          <Column id="cashTranDate" type="STRING" size="256"/>
          <Column id="authId" type="STRING" size="256"/>
          <Column id="billid" type="STRING" size="256"/>
          <Column id="mobileNo" type="STRING" size="256"/>
          <Column id="arsNo" type="STRING" size="256"/>
          <Column id="cpCd" type="STRING" size="256"/>
          <Column id="usedPnt" type="STRING" size="256"/>
          <Column id="remainPnt" type="STRING" size="256"/>
          <Column id="payPnt" type="STRING" size="256"/>
          <Column id="accruePnt" type="STRING" size="256"/>
          <Column id="remainCpon" type="STRING" size="256"/>
          <Column id="usedCpon" type="STRING" size="256"/>
          <Column id="mallNm" type="STRING" size="256"/>
          <Column id="escrowYn" type="STRING" size="256"/>
          <Column id="complexYn" type="STRING" size="256"/>
          <Column id="cancAcqDate" type="STRING" size="256"/>
          <Column id="cancDate" type="STRING" size="256"/>
          <Column id="refundDate" type="STRING" size="256"/>
          <Column id="payType" type="STRING" size="0"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="cancle_in_easypay" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="trCd" type="STRING" size="256"/>
          <Column id="mgrTxtype" type="STRING" size="256"/>
          <Column id="orgCno" type="STRING" size="256"/>
          <Column id="reqIp" type="STRING" size="256"/>
          <Column id="reqId" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[include "LIB::lib_All.xjs"; //공통함수 호출

//real server url 
/*
var GW_URL  = "gw.easypay.co.kr";
var GW_PORT = "80";
var UPDATE_URL = "https://pg.easypay.co.kr/plugin/file";
var HOME_URL   = "https://pg.easypay.co.kr/plugin";
var ISP_URL    = "https://pg.easypay.co.kr/isp";
var V3D_URL    = "https://pg.easypay.co.kr/v3d";
*/

//test server val
var GW_URL  = "testgw.easypay.co.kr";
var GW_PORT = "80";
var UPDATE_URL = "http://testpg.easypay.co.kr/plugin/file";
var HOME_URL   = "http://testpg.easypay.co.kr/plugin";
var ISP_URL    = "http://testpg.easypay.co.kr/isp";
var V3D_URL    = "http://testpg.easypay.co.kr/v3d";

var EP_PI_WIM = "https://pg.easypay.co.kr/plugin/file/easypayplugin.exe";
var EP_NPPI_NANE = "KICC";
var EP_NPPI_VER  = "KICC Plugin v.1.0.0.2";
var EP_IS_WINDOWS   = false;
var EP_BROWSER_TYPE = "XP";


//플러그인 설치 페이지 URL
var INSTALLPAGE = "http://10.1.20.66:9191/easyPay/";
//easy pay 인증키 파일 위치
var CERTPATH	= "D:/easypay/cert";
//log 폴더 위치
var LOGPATH 	= "D:/easypay/log";

function FrmDev_onload(obj:Form, e:LoadEventInfo)
{
	// 시스템 공통함수 호출
	//gfn_commInit(obj);
	_gfn_createPagingDataset(obj);	
		
	fn_installCheck();
}

function fn_easypay_submit(obj:Button,  e:ClickEventInfo)
{
	// 플러그인으로 인증요청(XP->EasyPay)
	fn_setPluginVal();
	
	// 결재요청 및 승인
	var rtn = gfn_reqEasyPayPayment(plugin_obj)
}

function gfn_reqEasyPayPayment(objEP)
{
	if(objEP.EP_start() != "SUCC"){
		objEP.EP_clean();
        return false;
	}else{
		// 결재요청정보 설정
		gfn_setEasyPayPaymentInfo(objEP);
			
		gfn_kwDataInit();
		gfn_setKwData_trscCode("SYS00006R01");				
		gfn_setKwData_systemCode("KRP_EASY"); 	

		gfn_tranNMCI("easyPay7" 
					, "ds_in_easyPay=ds_in_easyPay"
					, "ds_out_easyPay=ds_out_easyPay"
					, "fn_easyPay_callBack");	

		objEP.EP_clean();		
	}
}

function fn_easyPay_callBack(strSvcID, nErrorCode, strErrorMsg)
{	
	
	if(nErrorCode == 0) 
	{
		if(ds_out_easyPay.getColumn(0, "resCd") == "0000")
		{
			alert("결제 작업이 정상적으로 처리 되었습니다");
		}else
		{
			alert(ds_out_easyPay.getColumn(0, "resMsg"));
		}
	}else
	{
		alert("시스템 오류가 발생하여 결제가 취소 되었습니다.");	
	}
}

/*
*	플러그인 Install Check function
*/
function fn_installCheck()
{
	var bRet = plugin_obj.isInstalled(true);
	//인스톨 확인
	if(bRet == 0)
	{
		//미 설치 상태
		//system.execBrowser(INSTALLPAGE);
	}
	else if(bRet == 1)
	{
		//정상적으로 인스톨 되어 있는 상태
		//trace("installed");	
	}
	else if(bRet == 2)
	{
		//업데이트가 필요한 상태
		//system.execBrowser(UPDATEPAGE);
	}
}

/**
*	Easy Pay 플러그인으로 전송할 값 Setter Function
*/

function fn_setPluginVal()
{
	plugin_obj.EP_init("EasyPay70");	 
	
	//가맹점 아이디
	plugin_obj.EP_setdata( "Config", "mall_id", EP_mall_id.value );
	//가맹점 패스워드
	plugin_obj.EP_setdata( "Config", "mall_pwd", EP_mall_pwd.value );
	//가맹점 이름
	plugin_obj.EP_setdata( "Config", "mall_nm", EP_mall_nm.value );
	//가맹점 CI URL
	plugin_obj.EP_setdata( "Config", "ci_url", EP_ci_url.value );
	//언어 flag
	plugin_obj.EP_setdata( "Config", "lang_flag", "KOR");
	//가맹점 개발언어
	plugin_obj.EP_setdata( "Config", "agent_ver", "JSP");

	//결제수단 
	plugin_obj.EP_setdata( "Payment", "pay_type", "11:21:31" );
	//신용카드 인증방식
	plugin_obj.EP_setdata( "Payment", "cert_type", "");
	//해외카드인증구분
	plugin_obj.EP_setdata( "Payment", "os_cert_flag", "2" );
	//통화코드
	plugin_obj.EP_setdata( "Payment", "currency", "00" );
	//복합유무
	plugin_obj.EP_setdata( "Payment", "complex_yn", "N" );
	//주문번호
	plugin_obj.EP_setdata( "Order" , "order_no", EP_order_no.value );
	//사용자 구분
	plugin_obj.EP_setdata( "Order" , "user_type", EP_user_type.value );
	//고객 아이디
	plugin_obj.EP_setdata( "Order" , "user_id", EP_user_id.value );	
	//고객 이름
	plugin_obj.EP_setdata( "Order" , "user_nm", EP_user_nm.value );
	//고객 주민번호
	plugin_obj.EP_setdata( "Payment", "soc_no", EP_soc_no.value );
	//고객 이메일
	plugin_obj.EP_setdata( "Order" , "user_mail", EP_user_mail.value );
	//고객 연락처 
	plugin_obj.EP_setdata( "Order" , "user_phone1", EP_user_phone1.value );
	//고객 휴대폰 연락처
	plugin_obj.EP_setdata( "Order" , "user_phone2", EP_user_phone2.value );
	//고객 주소
	plugin_obj.EP_setdata( "Order" , "user_addr", EP_user_addr.value );
	//상품명
	plugin_obj.EP_setdata( "Order" , "product_nm", EP_product_nm.value );
	//상품금액 
	plugin_obj.EP_setdata( "Order" , "product_amt", EP_product_amt.value );
	//상품구분
	plugin_obj.EP_setdata( "Order" , "product_type", EP_product_type.value );

	plugin_obj.EP_setdata( "Config", "gw_url",       GW_URL);
	plugin_obj.EP_setdata( "Config", "gw_port",      GW_PORT);
	plugin_obj.EP_setdata( "Config", "update_addr",  UPDATE_URL);
	plugin_obj.EP_setdata( "Config", "home_addr",    HOME_URL);
	plugin_obj.EP_setdata( "Config", "isp_addr",     ISP_URL);
	plugin_obj.EP_setdata( "Config", "v3d_addr",     V3D_URL);
	plugin_obj.EP_setdata( "Config", "browser_type", EP_BROWSER_TYPE );
}

//추가
/*
// 플러그인으로 인증요청(XP->EasyPay)
function fn_setPluginVal(objEP)
{
	plugin_obj.EP_init("EasyPay70");	 

	//가맹점 아이디
	plugin_obj.EP_setdata( "Config", "mall_id", objEP.mall_id );
	//가맹점 패스워드
	plugin_obj.EP_setdata( "Config", "mall_pwd", objEP.mall_pwd );
	//가맹점 이름
	plugin_obj.EP_setdata( "Config", "mall_nm", objEP.mall_nm );
	//가맹점 CI URL
	plugin_obj.EP_setdata( "Config", "ci_url", objEP.ci_url );
	//언어 flag
	plugin_obj.EP_setdata( "Config", "lang_flag", "KOR");
	//가맹점 개발언어
	plugin_obj.EP_setdata( "Config", "agent_ver", "JSP");

	//결제수단 
	plugin_obj.EP_setdata( "Payment", "pay_type", "11:21:31" );
	//신용카드 인증방식
	plugin_obj.EP_setdata( "Payment", "cert_type", "");
	//해외카드인증구분
	plugin_obj.EP_setdata( "Payment", "os_cert_flag", "2" );
	//통화코드
	plugin_obj.EP_setdata( "Payment", "currency", "00" );
	//복합유무
	plugin_obj.EP_setdata( "Payment", "complex_yn", "N" );
	//주문번호
	plugin_obj.EP_setdata( "Order" , "order_no", objEP.order_no );
	//사용자 구분
	plugin_obj.EP_setdata( "Order" , "user_type", objEP.user_type );
	//고객 아이디
	plugin_obj.EP_setdata( "Order" , "user_id", objEP.user_id );	
	//고객 이름
	plugin_obj.EP_setdata( "Order" , "user_nm", objEP.user_nm );
	//고객 주민번호
	plugin_obj.EP_setdata( "Payment", "soc_no", objEP.soc_no );
	//고객 이메일
	plugin_obj.EP_setdata( "Order" , "user_mail", objEP.user_mail );
	//고객 연락처 
	plugin_obj.EP_setdata( "Order" , "user_phone1", objEP.user_phone1 );
	//고객 휴대폰 연락처
	plugin_obj.EP_setdata( "Order" , "user_phone2", objEP.user_phone2 );
	//고객 주소
	plugin_obj.EP_setdata( "Order" , "user_addr", objEP.user_addr );
	//상품명
	plugin_obj.EP_setdata( "Order" , "product_nm", objEP.product_nm );
	//상품금액 
	plugin_obj.EP_setdata( "Order" , "product_amt", objEP.product_amt );
	//상품구분
	plugin_obj.EP_setdata( "Order" , "product_type", objEP.product_type );

	plugin_obj.EP_setdata( "Config", "gw_url",       GW_URL);
	plugin_obj.EP_setdata( "Config", "gw_port",      GW_PORT);
	plugin_obj.EP_setdata( "Config", "update_addr",  UPDATE_URL);
	plugin_obj.EP_setdata( "Config", "home_addr",    HOME_URL);
	plugin_obj.EP_setdata( "Config", "isp_addr",     ISP_URL);
	plugin_obj.EP_setdata( "Config", "v3d_addr",     V3D_URL);
	plugin_obj.EP_setdata( "Config", "browser_type", EP_BROWSER_TYPE );
}
*/

/**
*	서버로 전송될 ds_out_easyPay DataSet에 담을 값 Setter Function
*
*/
function gfn_setEasyPayPaymentInfo(objEP)	
{
	//ds_in_easyPay.clearData();
	//var nRow = ds_in_easyPay.addRow();
	
	var objInDS 	= gfn_createDataset(this, "ds_in_easyPay");
	var objOutDS 	= gfn_createDataset(this, "ds_out_easyPay");
	
	objInDS.addColumn("trCd", "String", 255);
	objInDS.addColumn("traceNo", "String", 255);
	objInDS.addColumn("sessionKey", "String", 255);
	objInDS.addColumn("encryptData", "String", 255);
	objInDS.addColumn("payType", "String", 255);
	objInDS.addColumn("complexYn", "String", 255);
	objInDS.addColumn("cardCode", "String", 255);
	objInDS.addColumn("clientIp", "String", 255);
	objInDS.addColumn("userType", "String", 255);
	objInDS.addColumn("orderNo", "String", 255);
	objInDS.addColumn("membUserNo", "String", 255);
	objInDS.addColumn("userId", "String", 255);
	objInDS.addColumn("userNm", "String", 255);
	objInDS.addColumn("userMail", "String", 255);
	objInDS.addColumn("userPhone1", "String", 255);
	objInDS.addColumn("userPhone2", "String", 255);
	objInDS.addColumn("userAddr", "String", 255);
	objInDS.addColumn("productType", "String", 255);
	objInDS.addColumn("productNm", "String", 255);
	objInDS.addColumn("productAmt", "String", 255);
	objInDS.addColumn("mallId", "String", 255);
	objInDS.addColumn("GWURL", "String", 255);
	objInDS.addColumn("GWPORT", "String", 255);
	objInDS.addColumn("CERTPATH", "String", 255);
	objInDS.addColumn("LOGPATH", "String", 255);
	
	var nRow = objInDS.addRow();
	
	//[필수] 요청구분
	objInDS.setColumn(nRow, "trCd",			"00101000");
	//[필수] 추적 고유 번호
	objInDS.setColumn(nRow, "traceNo",		objEP.EP_getdata( "trace_no" ));
	//[필수] 암호화키
	objInDS.setColumn(nRow, "sessionKey",	objEP.EP_getdata( "sessionkey" ));
	//[필수] 암호화 데이터
	objInDS.setColumn(nRow, "encryptData",	objEP.EP_getdata( "encrypt_data" ));
	//[선택] 결제수단
	objInDS.setColumn(nRow, "payType",	"11:21:22:31");
	//[선택] 복합결제 유무
	objInDS.setColumn(nRow, "complexYn",	"");
	//[선택] 신용카드 카드코드
	objInDS.setColumn(nRow, "cardCode",		objEP.EP_getdata( "card_code" ));
	//[선택] 결제고객 IP
	var objExcomm = new ExtCommon(); 
	objInDS.setColumn(nRow, "clientIp",		objExcomm.getIPAddress()[0]);
	//[선택] 사용자구분구분//[1:일반,2:회원]
	objInDS.setColumn(nRow, "userType",		EP_user_type.value);
	//[필수] 주문번호
	objInDS.setColumn(nRow, "orderNo",		EP_order_no.value);
	//[선택] 가맹점 고객일련번호
	objInDS.setColumn(nRow, "membUserNo",	"");
	//[선택] 고객 ID
	objInDS.setColumn(nRow, "userId",		EP_user_id.value);
	//[필수] 고객명
	objInDS.setColumn(nRow, "userNm",		EP_user_nm.value);
	//[필수] 고객 E-mail
	objInDS.setColumn(nRow, "userMail",		EP_user_mail.value);
	//[필수] 가맹점 고객 연락처1
	objInDS.setColumn(nRow, "userPhone1",	EP_user_phone1.value);
	//[필수] 가맹점 고객 연락처2
	objInDS.setColumn(nRow, "userPhone2",	EP_user_phone2.value);
	//[선택] 가맹점 고객 주소
	objInDS.setColumn(nRow, "userAddr",		EP_user_addr.value);
	//[필수] 상품정보구분//[0:실물,1:컨텐츠]
	objInDS.setColumn(nRow, "productType",	EP_product_type.value);
	//[필수] 상품명
	objInDS.setColumn(nRow, "productNm",		EP_product_nm.value);
	//[필수] 상품금액
	objInDS.setColumn(nRow, "productAmt",	EP_product_amt.value);
	
	//[필수] 가맹점 ID 
	objInDS.setColumn(nRow, "mallId",	EP_mall_id.value);

	objInDS.setColumn(nRow, "GWURL",	GW_URL);
	objInDS.setColumn(nRow, "GWPORT",	GW_PORT);
	objInDS.setColumn(nRow, "CERTPATH",	CERTPATH);
	objInDS.setColumn(nRow, "LOGPATH",	LOGPATH);
}

//주문 번호 가져오는 function
function gfn_getOrdNo(){
	var ordNo = "";
	
	return ordNo;
}

//주문 번호 생성 호출
function gfn_reqOrdNo()
{
	gfn_kwDataInit();
	gfn_setKwData_trscCode("SYS00006R03");				
	gfn_setKwData_systemCode("KRP_EASY"); 	

	gfn_tranNMCI("easyPay7" 
				, ""
				, "ds_out_easyPay=ds_out_easyPay"
				, "fn_callback_reqOrdNo");	
}

function fn_callback_reqOrdNo(strSvcID, nErrorCode, strErrorMsg)
{
	var orderNo = "";
	if(nErrorCode != 0) {
		orderNo = 
		alert(orderNo);
		return;
	}else{
		alert("주문번호 생성에 실패하였습니다.");
	}
}
//결제 취소
function fn_easypay_cancle(obj:Button,  e:ClickEventInfo)
{
	fn_setCancleVal();
	
}

function fn_setCancleVal(){
	cancle_in_easypay.clearData();
	var nRow = cancle_in_easypay.addRow();
	
	cancle_in_easypay.setColumn(nRow, "trCd", "00201000");
	cancle_in_easypay.setColumn(nRow, "mgrTxtype", "40");
	cancle_in_easypay.setColumn(nRow, "orgCno", org_cno.value);
	
	var objExcomm = new ExtCommon(); 
	cancle_in_easypay.setColumn(nRow, "reqIp",	objExcomm.getIPAddress()[0]);
	cancle_in_easypay.setColumn(nRow, "reqId",	req_id.value);
}

]]></Script>
  </Form>
</FDL>
